<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Antenatal Care Journey | Nari Swasthya</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <!-- Three.js for 3D Antibody Visualization -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>

<style >
  
:root{
  --pink:#ec407a;
  --deep-pink:#d81b60;
  --primary:#ec407a;
  --primary-dark:#d81b60;
  --primary-light:#f48fb1;
  --lavender:#ede7f6;
  --bg:#faf5fb;
  --card-bg:#ffffff;
  --text-main:#212121;
  --text-soft:#555;
  --border-soft:#e0e0e0;
  --success:#66bb6a;
  --warning:#ffa726;
  --critical:#ef5350;
  --info:#4fc3f7;

  --emergency:#ff1744;
  --urgent:#ff9100;
  --monitor:#42a5f5;

  --shadow: 0 8px 30px rgba(0,0,0,0.08);
  --shadow-strong: 0 15px 40px rgba(236, 64, 122, 0.18);
}

*{margin:0;padding:0;box-sizing:border-box;}
html,body{height:100%;}
body{
  font-family:'Manrope', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background:var(--bg);
  color:var(--text-main);
  line-height:1.6;
  overflow-x:hidden;
}
h1,h2,h3,h4{font-family:'Playfair Display', Georgia, serif;}
button,input,select{font-family:inherit;}
a{color:inherit;}
.center{text-align:center;}
.muted{color:var(--text-soft);}

/* ===================== HEADER ===================== */
.site-header{
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(24px);
  -webkit-backdrop-filter:blur(24px);
  padding:0;
  box-shadow:0 2px 24px rgba(236,64,122,0.09);
  position:sticky;top:0;z-index:1000;
  border-bottom:1px solid rgba(236,64,122,0.08);
}
.nav-container{
  max-width:1400px;margin:0 auto;
  padding:0 1.5rem;
  display:flex;justify-content:space-between;align-items:center;
  height:64px;
}
.logo{display:flex;align-items:center;gap:.65rem;flex-shrink:0;}
.logo-icon{
  width:40px;height:40px;border-radius:12px;
  background:linear-gradient(135deg,#ec407a,#ad1457);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 14px rgba(236,64,122,0.35);
  flex-shrink:0;
}
.logo-icon svg{width:22px;height:22px;fill:white;}
.logo-text{display:flex;flex-direction:column;gap:0;}
.logo-text a{
  text-decoration:none;
  font-family:'Playfair Display',serif;
  font-weight:900;font-size:1.25rem;line-height:1.1;
  background:linear-gradient(135deg,#ec407a,#ad1457);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.logo-text span{
  font-size:.62rem;color:var(--text-soft);
  font-family:'Manrope',sans-serif;font-weight:500;
  letter-spacing:.1em;text-transform:uppercase;
}
.main-nav{display:flex;align-items:center;gap:.2rem;}
.nav-item{position:relative;}
.nav-link{
  display:flex;align-items:center;gap:.3rem;
  text-decoration:none;color:var(--text-main);
  font-weight:500;font-size:.875rem;
  padding:.55rem .75rem;border-radius:8px;
  transition:all .25s;white-space:nowrap;
  cursor:pointer;background:none;border:none;font-family:inherit;
}
.nav-link:hover,.nav-link.active{color:var(--deep-pink);background:rgba(236,64,122,0.06);}
.nav-link .chevron{
  font-size:.6rem;transition:transform .25s;
  color:var(--text-soft);margin-top:1px;
}
.nav-item:hover .chevron{transform:rotate(180deg);}
.nav-dropdown{
  position:absolute;top:calc(100% + 8px);left:50%;
  transform:translateX(-50%) translateY(-6px);
  min-width:220px;
  background:white;
  border-radius:16px;
  box-shadow:0 16px 50px rgba(0,0,0,0.12),0 4px 16px rgba(236,64,122,0.1);
  border:1px solid rgba(236,64,122,0.1);
  padding:.5rem;
  opacity:0;pointer-events:none;
  transition:all .25s cubic-bezier(.23,1.01,.32,1);
  z-index:200;
}
.nav-dropdown::before{
  content:'';position:absolute;top:-6px;left:50%;transform:translateX(-50%);
  border:6px solid transparent;border-bottom-color:white;
  border-top:none;filter:drop-shadow(0 -2px 4px rgba(0,0,0,0.06));
}
.nav-item:hover .nav-dropdown,.nav-item:focus-within .nav-dropdown{
  opacity:1;pointer-events:all;
  transform:translateX(-50%) translateY(0);
}
.dd-item{
  display:flex;align-items:center;gap:.75rem;
  padding:.65rem .9rem;border-radius:10px;
  text-decoration:none;color:var(--text-main);
  font-size:.85rem;font-weight:500;
  transition:all .2s;
}
.dd-item:hover{background:rgba(236,64,122,0.07);color:var(--deep-pink);padding-left:1.1rem;}
.dd-icon{
  width:28px;height:28px;border-radius:8px;
  display:flex;align-items:center;justify-content:center;
  font-size:.8rem;flex-shrink:0;
}
.dd-sep{height:1px;background:var(--border-soft);margin:.3rem .5rem;}
.nav-actions{display:flex;gap:.6rem;align-items:center;}
.btn-nav{
  padding:.46rem 1.1rem;border-radius:50px;text-decoration:none;
  font-weight:600;font-size:.82rem;transition:all .3s;border:none;cursor:pointer;
  font-family:inherit;display:inline-flex;align-items:center;gap:.4rem;
}
.btn-nav.outline{
  background:linear-gradient(135deg,#ec407a,#ad1457);
  color:#fff;box-shadow:0 4px 15px rgba(236,64,122,0.3);border:none;
}
.btn-nav.outline:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(236,64,122,0.4);color:#fff;}
.btn-nav.primary{
  border:1.5px solid var(--deep-pink);
  color:var(--deep-pink);background:#fff;box-shadow:none;
}
.btn-nav.primary:hover{background:rgba(236,64,122,0.05);border-color:var(--deep-pink);}
.hamburger{
  display:none;width:38px;height:38px;border-radius:10px;
  background:none;border:1.5px solid var(--border-soft);
  align-items:center;justify-content:center;cursor:pointer;
  flex-direction:column;gap:4px;padding:8px;
}
.hamburger span{display:block;height:2px;background:var(--text-main);border-radius:2px;transition:all .3s;}
.mobile-menu{
  display:none;position:fixed;inset:0;top:64px;
  background:rgba(255,255,255,0.98);backdrop-filter:blur(20px);
  z-index:999;padding:1.5rem;overflow-y:auto;
}
.mobile-menu.open{display:block;}
.mm-link{
  display:flex;align-items:center;gap:.75rem;
  padding:.85rem 1rem;border-radius:12px;
  text-decoration:none;color:var(--text-main);
  font-weight:500;font-size:1rem;
  transition:all .2s;border-bottom:1px solid var(--border-soft);
}
.mm-link:hover{color:var(--deep-pink);background:rgba(236,64,122,0.05);}
.mm-section{font-size:.72rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.1em;padding:.6rem 1rem .3rem;}
@media(max-width:1060px){.main-nav{display:none;}.hamburger{display:flex;}}
@media(max-width:600px){.nav-actions .btn-nav{display:none;}}
/* Always keep Sign In + Contact Us visible inside mobile menu overlay */
.mobile-menu .btn-nav{display:inline-flex !important;}
/* Flyout sub-menus */
.dd-has-flyout{position:relative;cursor:pointer;}
.dd-has-flyout .dd-flyout-arrow{font-size:.55rem;color:var(--text-soft);margin-left:auto;transition:transform .2s;}
.dd-flyout{
  position:absolute;left:calc(100% + 6px);top:0;
  min-width:230px;
  background:white;
  border-radius:14px;
  box-shadow:0 16px 50px rgba(0,0,0,0.12),0 4px 16px rgba(236,64,122,0.1);
  border:1px solid rgba(236,64,122,0.1);
  padding:.4rem;
  opacity:0;pointer-events:none;
  transition:all .22s cubic-bezier(.23,1.01,.32,1);
  z-index:300;
  transform:translateX(-4px);
}
.dd-has-flyout:hover .dd-flyout{opacity:1;pointer-events:all;transform:translateX(0);}
.dd-has-flyout:hover .dd-flyout-arrow{transform:rotate(90deg);color:var(--deep-pink);}
.dd-has-flyout:hover{background:rgba(236,64,122,0.07);color:var(--deep-pink);border-radius:10px;}

/* Page shell */
.page-shell{
  max-width:1400px;
  margin:0 auto;
  padding:0 2rem;
}

/* Background (particle + gradient morph concept from GD) */
/* Background - Enhanced Particle Effect (Depression.html style) */
/* Background - Enhanced Particle Effect (Hero Section Only) */
/* Background - Enhanced Particle Effect (Hero Section Only) */
.hero-constellation-bg {
  position: absolute;
  inset: 0;
  z-index: 1;
  overflow: hidden;
  pointer-events: none;
}

#particleCanvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0.7;
}

.gradient-morph {
  position: absolute;
  inset: 0;
  background: radial-gradient(
    circle at 50% 50%, 
    rgba(236, 64, 122, 0.15) 0%,
    transparent 65%
  );
  animation: morph-pulse 8s ease-in-out infinite;
  z-index: 1;
  pointer-events: none;
}

@keyframes morph-pulse {
  0%, 100% { 
    opacity: 0.6; 
    transform: scale(1); 
  }
  50% { 
    opacity: 1; 
    transform: scale(1.15); 
  }
}

/* Hero Section - Container for Particles */
/* Line 115 */

/* Background - Enhanced Particle Effect (Hero Section Only) */
.hero-constellation-bg {
  position: absolute;           /* Changed from fixed */
  inset: 0;
  z-index: 1;                  /* Changed from -1 */
  overflow: hidden;
  pointer-events: none;        /* Added */
}

/* Line 130 */
#particleCanvas {
  /* ... same ... */
}

/* Line 138 */
.hero {
  position: relative;
  display: grid;
  grid-template-columns: 1.1fr .9fr;
  gap: 4rem;
  align-items: center;
  padding: 4rem 0 2rem;
  overflow: hidden;            /* Added */
  background: linear-gradient(180deg,  /* Moved here */
    #faf5fb 0%, 
    #f5f0fa 50%, 
    #ede7f6 100%
  );
  border-radius: 32px;         /* Added */
  margin-bottom: 3rem;         /* Added */
  min-height: 85vh;            /* Added */
}



/* Ensure content is above particles */
.hero-content {
  position: relative;
  z-index: 2;
}

.hero-visual-3d {
  position: relative;
  z-index: 2;
}

#particleCanvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0.7;  /* Increased from 0.55 for better visibility */
}

.gradient-morph {
  position: absolute;
  inset: 0;
  background: radial-gradient(
    circle at 50% 50%, 
    rgba(236, 64, 122, 0.15) 0%,   /* Increased opacity */
    transparent 65%
  );
  animation: morph-pulse 8s ease-in-out infinite;
  z-index: 1;
  pointer-events: none;
}

@keyframes morph-pulse {
  0%, 100% { 
    opacity: 0.6; 
    transform: scale(1); 
  }
  50% { 
    opacity: 1; 
    transform: scale(1.15); 
  }
}

/* Hero */
/* Hero */
.hero {
  position: relative;  /* REQUIRED for absolute positioning of particles */
  display: grid;
  grid-template-columns: 1.1fr .9fr;
  gap: 4rem;
  align-items: center;
  padding: 4rem 0 2rem;
  overflow: hidden;  /* Keep particles inside hero section */
  background: linear-gradient(180deg,   /* Move background here */
    #faf5fb 0%, 
    #f5f0fa 50%, 
    #ede7f6 100%
  );
  border-radius: 32px;  /* Optional: rounded corners like depression.html */
  margin-bottom: 3rem;  /* Optional: spacing */
  min-height: 85vh;  /* Optional: ensure sufficient height */
}

.hero-content {
  position: relative;
  z-index: 2;  /* Above particles */
}

.hero-visual-3d {
  position: relative;
  z-index: 2;  /* Above particles */
}



.hero-content{animation:slideInLeft .8s ease;}
@keyframes slideInLeft{
  from{opacity:0; transform:translateX(-35px);}
  to{opacity:1; transform:translateX(0);}
}
.hero-badge{
  display:inline-flex;
  align-items:center;
  gap:.6rem;
  background:linear-gradient(135deg, rgba(236,64,122,0.10), rgba(168,230,207,0.10));
  padding:.6rem 1.2rem;
  border-radius:999px;
  border:2px solid rgba(236,64,122,0.18);
  margin-bottom:1.5rem;
  animation:float 3s ease-in-out infinite;
}
@keyframes float{0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);}}
.badge-icon{font-size:1.4rem;}
.badge-text{font-weight:800;color:var(--primary-dark);font-size:.92rem;}

.hero-title-3d{
  font-size:clamp(2.4rem,5vw,4rem);
  font-weight:900;
  line-height:1.08;
  margin-bottom:1.2rem;
  background:linear-gradient(135deg,#212121 0%, #555 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.title-emphasis{
  background:linear-gradient(135deg, #ec407a 0%, #d81b60 50%, #ad1457 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  animation:title-shimmer 3s ease-in-out infinite;
  filter:drop-shadow(0 2px 10px rgba(236,64,122,.35));
}
@keyframes title-shimmer{
  0%,100%{filter:brightness(1) drop-shadow(0 2px 10px rgba(236,64,122,.35));}
  50%{filter:brightness(1.35) drop-shadow(0 5px 18px rgba(236,64,122,.55));}
}
.hero-subtitle{
  font-size:1.15rem;
  color:var(--text-soft);
  margin-bottom:2rem;
  line-height:1.85;
}
.hero-stats{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:1rem;
  margin-bottom:1.75rem;
}
.stat-item{
  background:#fff;
  border-radius:16px;
  padding:1.1rem;
  box-shadow:0 4px 15px rgba(0,0,0,0.08);
  border:2px solid transparent;
  transition:transform .25s ease, box-shadow .25s ease, border-color .25s ease;
  text-align:center;
}
.stat-item:hover{
  transform:translateY(-4px);
  box-shadow:0 8px 25px rgba(255,107,157,0.18);
  border-color:rgba(244,143,177,0.55);
}
.stat-number{
  display:block;
  font-size:1.9rem;
  font-weight:900;
  color:var(--primary);
  font-family:'Playfair Display', serif;
}
.stat-label{display:block;font-size:.9rem;color:var(--text-soft);font-weight:600;}

.hero-cta-row{display:flex;gap:1rem;flex-wrap:wrap;}
.btn-primary,.btn-secondary{
  padding:1rem 2rem;
  border-radius:999px;
  font-weight:900;
  font-size:1rem;
  cursor:pointer;
  border:none;
  transition:all .25s ease;
}
.btn-primary{
  background:linear-gradient(135deg, var(--deep-pink), #f06292);
  color:#fff;
  box-shadow:0 10px 25px rgba(216, 27, 96, 0.30);
  animation:float-btn 3s ease-in-out infinite;
}
@keyframes float-btn{0%,100%{transform:translateY(0);}50%{transform:translateY(-5px);}}
.btn-primary:hover{transform:translateY(-3px); box-shadow:0 15px 35px rgba(216,27,96,0.42);}
.btn-secondary{
  background:#fff;
  border:2px solid var(--primary);
  color:var(--primary);
}
.btn-secondary:hover{background:var(--primary); color:#fff;}

.daily-tip{
  margin-top:2rem;
  max-width:900px;
  padding:1.2rem 1.4rem;
  background:linear-gradient(135deg,#fff8e1 0%, #ffecb3 100%);
  border-radius:16px;
  border-left:6px solid var(--warning);
  display:flex;
  gap:1rem;
  align-items:center;
  box-shadow:0 4px 15px rgba(255,167,38,0.18);
}
.tip-icon{font-size:2rem;}
.daily-tip p{font-weight:800;color:#f57c00;}

/* Hero visual 3D (GD-inspired) */
.hero-visual-3d{position:relative; animation:slideInRight .8s ease;}
@keyframes slideInRight{
  from{opacity:0; transform:translateX(35px);}
  to{opacity:1; transform:translateX(0);}
}
.pregnancy-3d-container{
  position:relative;
  width:100%;
  height:520px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.pregnancy-core{
  position:relative;
  width:450px;
  height:450px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.center-glow{
  position:absolute;
  width:110px;
  height:110px;
  border-radius:50%;
  background:radial-gradient(circle at center,
    rgba(236,64,122,0.85) 0%,
    rgba(236,64,122,0.42) 40%,
    rgba(236,64,122,0.12) 70%,
    transparent 100%
  );
  box-shadow:
    0 0 65px rgba(236,64,122,0.6),
    0 0 110px rgba(236,64,122,0.35),
    inset 0 0 45px rgba(255,255,255,0.25);
  animation:glow 3s ease-in-out infinite;
  pointer-events:none;
}
@keyframes glow{
  0%,100%{transform:scale(1);opacity:.85;}
  50%{transform:scale(1.18);opacity:1;}
}
.pulse-ring{
  position:absolute;
  border-radius:50%;
  border:4px solid rgba(244,143,177,0.9);
  box-shadow:0 0 20px rgba(236,64,122,0.3), 0 10px 40px rgba(0,0,0,0.18);
  animation:wave-pulse 4s ease-out infinite;
}
.ring-1{width:180px;height:180px; animation-delay:0s;}
.ring-2{width:280px;height:280px; animation-delay:1.3s;}
.ring-3{width:380px;height:380px; animation-delay:2.6s;}
@keyframes wave-pulse{
  0%{transform:scale(.72); opacity:0;}
  25%{transform:scale(.9) translateY(-10px); opacity:.55;}
  50%{transform:scale(1) translateY(-5px); opacity:.78;}
  75%{transform:scale(1.15) translateY(5px); opacity:.35;}
  100%{transform:scale(1.3); opacity:0;}
}
.health-icon{
  position:absolute;
  background:#fff;
  border:2px solid rgba(236,64,122,0.15);
  border-radius:20px;
  padding:1.1rem 1.3rem;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.4rem;
  cursor:pointer;
  box-shadow:0 10px 30px rgba(236,64,122,0.22);
  transition:transform .25s ease, box-shadow .25s ease, border-color .25s ease;
}
.health-icon:hover{
  transform:scale(1.1) !important;
  box-shadow:0 15px 40px rgba(236,64,122,0.35);
  border-color:rgba(236,64,122,0.35);
}
.icon-inner{font-size:2rem;}
.icon-label{font-size:.76rem;font-weight:900;color:var(--text-soft);white-space:nowrap;}
.icon-1{animation:orbit1 12s ease-in-out infinite;}
.icon-2{animation:orbit2 14s ease-in-out infinite;}
.icon-3{animation:orbit3 16s ease-in-out infinite;}
.icon-4{animation:orbit4 18s ease-in-out infinite;}
.icon-5{animation:orbit5 13s ease-in-out infinite;}
@keyframes orbit1{0%,100%{transform:translate(-190px,0) rotate(0deg);}25%{transform:translate(-195px,-10px) rotate(90deg);}50%{transform:translate(-190px,0) rotate(180deg);}75%{transform:translate(-185px,10px) rotate(270deg);}}
@keyframes orbit2{0%,100%{transform:translate(-134px,-134px) rotate(0deg);}25%{transform:translate(-139px,-139px) rotate(90deg);}50%{transform:translate(-134px,-134px) rotate(180deg);}75%{transform:translate(-129px,-129px) rotate(270deg);}}
@keyframes orbit3{0%,100%{transform:translate(134px,-134px) rotate(0deg);}25%{transform:translate(139px,-139px) rotate(90deg);}50%{transform:translate(134px,-134px) rotate(180deg);}75%{transform:translate(129px,-129px) rotate(270deg);}}
@keyframes orbit4{0%,100%{transform:translate(190px,0) rotate(0deg);}25%{transform:translate(195px,10px) rotate(90deg);}50%{transform:translate(190px,0) rotate(180deg);}75%{transform:translate(185px,-10px) rotate(270deg);}}
@keyframes orbit5{0%,100%{transform:translate(-134px,134px) rotate(0deg);}25%{transform:translate(-139px,139px) rotate(90deg);}50%{transform:translate(-134px,134px) rotate(180deg);}75%{transform:translate(-129px,129px) rotate(270deg);}}

.week-dial{
  position:absolute;
  bottom:18px;
  right:24px;
  width:210px;
  background:#fff;
  border-radius:20px;
  box-shadow:0 8px 30px rgba(0,0,0,0.15);
  padding:1.2rem;
  text-align:center;
}
.meter-reading{margin-bottom:.4rem;}
.reading-value{
  font-size:2.4rem;
  font-weight:900;
  color:var(--success);
  font-family:'Playfair Display', serif;
}
.reading-unit{font-size:.9rem;color:var(--text-soft);margin-left:.25rem;}
.meter-status{
  display:inline-block;
  font-size:.85rem;
  font-weight:900;
  padding:.3rem .8rem;
  border-radius:999px;
  background:rgba(102,187,106,0.12);
  color:var(--success);
  margin-bottom:.9rem;
}
.meter-bar{height:9px;border-radius:999px;background:#e0e0e0;overflow:hidden;}
.meter-fill{
  height:100%;
  width:30%;
  background:linear-gradient(90deg, var(--success), var(--primary));
  border-radius:999px;
  transition:width .35s ease;
}

.hero-info-box{
  margin-top:2rem;
  background:#fff;
  border-radius:20px;
  padding:2rem;
  box-shadow:0 8px 30px rgba(0,0,0,0.1);
  border-left:5px solid var(--primary);
}
.info-badge{
  display:inline-flex;
  align-items:center;
  gap:.5rem;
  padding:.5rem 1rem;
  border-radius:999px;
  background:rgba(236,64,122,0.10);
  margin-bottom:1rem;
  font-weight:900;
}
.info-title{font-size:1.45rem;color:var(--primary-dark);margin-bottom:.6rem;}
.info-text{color:var(--text-soft);line-height:1.75;}

/* Section headers (GD prominent pattern) */
.section-header{text-align:center; margin:1rem 0 2.5rem;}
.header-badge-prominent{
  display:inline-flex;
  align-items:center;
  gap:.8rem;
  background:linear-gradient(135deg, rgba(236,64,122,0.1), rgba(168,230,207,0.15));
  padding:.8rem 1.8rem;
  border-radius:999px;
  border:2px solid rgba(236,64,122,0.3);
  margin-bottom:1.5rem;
  box-shadow:0 4px 20px rgba(236,64,122,0.15);
  animation:badge-float-prominent 3s ease-in-out infinite;
  position:relative;
  overflow:hidden;
}
.header-badge-prominent::before{
  content:'';
  position:absolute;
  top:-50%;left:-50%;
  width:200%;height:200%;
  background:linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
  animation:badge-shine 3s infinite;
}
@keyframes badge-shine{
  0%{transform:translateX(-100%) translateY(-100%) rotate(45deg);}
  100%{transform:translateX(100%) translateY(100%) rotate(45deg);}
}
@keyframes badge-float-prominent{
  0%,100%{transform:translateY(0); box-shadow:0 4px 20px rgba(236,64,122,0.15);}
  50%{transform:translateY(-8px); box-shadow:0 8px 30px rgba(236,64,122,0.25);}
}
.badge-pulse{
  width:10px;height:10px;border-radius:50%;
  background:var(--primary);
  animation:pulse-dot 2s ease-in-out infinite;
  position:relative; z-index:1;
}
@keyframes pulse-dot{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.5;transform:scale(1.3);}}
.header-badge-prominent .badge-text{font-weight:900; letter-spacing:.5px; text-transform:uppercase; color:var(--primary); position:relative; z-index:1;}

.section-title-prominent{
  font-size:clamp(2.2rem, 5vw, 3.6rem);
  font-weight:900;
  line-height:1.1;
  margin-bottom:1.2rem;
  background:linear-gradient(135deg,#212121 0%, #555 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.title-highlight{
  background:linear-gradient(135deg, #ec407a 0%, #d81b60 40%, #ad1457 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 3px 12px rgba(236,64,122,0.35));
}
.section-subtitle-prominent{
  font-size:1.12rem;
  color:var(--text-main);
  max-width:900px;
  margin:0 auto;
  line-height:1.9;
  padding:1.6rem 2rem;
  border-radius:24px;
  border:2px solid rgba(236,64,122,0.12);
  background:linear-gradient(135deg, rgba(236,64,122,0.03), rgba(168,230,207,0.05), rgba(236,64,122,0.03));
  box-shadow:0 8px 30px rgba(236,64,122,0.08), inset 0 2px 0 rgba(255,255,255,0.85);
  backdrop-filter: blur(10px);
}
.section-subtitle-prominent strong{
  font-weight:900;
  background:linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

/* Journey timeline */
.journey-section{
  padding:1.5rem 0 3rem;
  background:linear-gradient(135deg, rgba(236,64,122,0.05), rgba(237,231,246,0.05));
  border-radius:30px;
  margin:0 0 2rem;
}
.timeline-container{
  position:relative;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:1.5rem;
  padding:2rem 0;
}
.timeline-rail{
  position:absolute;
  top:50%;
  left:10%;
  right:10%;
  height:4px;
  background:linear-gradient(90deg, var(--primary-light), var(--primary-dark));
  transform:translateY(-50%);
  z-index:0;
  border-radius:999px;
}
.timeline-stage{
  background:transparent;
  border:none;
  text-align:center;
  cursor:pointer;
  transition:transform .25s ease;
  z-index:1;
}
.timeline-stage:hover{transform:scale(1.04);}
.stage-marker{position:relative;width:80px;height:80px;margin:0 auto 1rem;}
.marker-dot{
  width:80px;height:80px;border-radius:50%;
  background:linear-gradient(135deg,#ff6b9d 0%, #ec407a 50%, #d81b60 100%);
  display:flex;align-items:center;justify-content:center;
  font-weight:900;
  font-size:2rem;
  color:#fff;
  box-shadow:0 12px 30px rgba(236,64,122,0.28);
}
.marker-pulse{
  position:absolute; inset:-8px;
  border-radius:50%;
  border:2px solid rgba(236,64,122,0.35);
  animation:markerPulse 2.2s ease-out infinite;
}
@keyframes markerPulse{
  0%{transform:scale(.85);opacity:.7;}
  100%{transform:scale(1.25);opacity:0;}
}
.stage-title{font-size:1.25rem; margin-bottom:.25rem;}
.stage-weeks{font-weight:900;color:var(--primary-dark); margin-bottom:.35rem;}
.stage-desc{color:var(--text-soft); font-weight:600;}
.stage-icon{font-size:2rem; margin-top:.6rem;}

.stage-detail-panel{
  margin-top:2rem;
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:1.8rem;
}
.panel-placeholder{text-align:center;color:var(--text-soft);}
.placeholder-icon{font-size:3rem;margin-bottom:.5rem;}

.visit-sim{
  margin-top:2.5rem;
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:2rem;
}
.visit-sim-header h3{font-size:1.6rem;margin-bottom:.5rem;}
.visit-sim-grid{
  display:grid;
  grid-template-columns: 1.15fr .85fr;
  gap:1.5rem;
  margin-top:1.5rem;
}
.field-label{display:block;font-weight:900;margin-bottom:.4rem;}

/* Range input styling for visibility */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 10px;
  border-radius: 5px;
  background: linear-gradient(90deg, var(--primary-light) 0%, var(--primary) 50%, var(--primary-dark) 100%);
  outline: none;
  opacity: 0.9;
  transition: opacity 0.2s;
  margin: 0.8rem 0;
  cursor: pointer;
}

input[type="range"]:hover {
  opacity: 1;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--deep-pink), var(--primary));
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.4);
  border: 3px solid #fff;
}

input[type="range"]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--deep-pink), var(--primary));
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.4);
  border: 3px solid #fff;
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(236, 64, 122, 0.6);
}

input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(236, 64, 122, 0.6);
}

.range-row{display:flex;justify-content:space-between;color:var(--text-soft);font-size:.8rem;margin-top:.3rem;}
.visit-metrics{
  margin-top:1.2rem;
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:1rem;
}
.metric-card{
  background:var(--lavender);
  border-radius:16px;
  padding:1rem;
  min-height:150px;
}
.metric-top{display:flex;align-items:center;justify-content:space-between;}
.metric-icon{font-size:1.4rem;}
.metric-name{font-weight:900;}
.metric-controls{margin-top:.6rem;font-weight:900;}
.metric-controls input{width:70px;padding:.4rem .5rem;border-radius:10px;border:2px solid rgba(0,0,0,0.08);}
.metric-card select{
  width:100%;
  margin-top:.6rem;
  padding:.55rem .65rem;
  border-radius:12px;
  border:2px solid rgba(0,0,0,0.08);
}
.mini-btn{
  margin-top:.8rem;
  width:100%;
  border:none;
  background:linear-gradient(135deg, var(--primary), var(--primary-dark));
  color:#fff;
  border-radius:12px;
  padding:.6rem .8rem;
  font-weight:900;
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease;
}
.mini-btn:hover{transform:translateY(-2px); box-shadow:0 10px 20px rgba(236,64,122,0.22);}
.mini-btn.outline{
  background:#fff;
  border:2px solid rgba(236,64,122,0.35);
  color:var(--primary-dark);
}
.visit-output{
  background:linear-gradient(135deg, rgba(236,64,122,0.04), rgba(237,231,246,0.35));
  border:2px solid rgba(236,64,122,0.12);
  border-radius:20px;
  padding:1.4rem;
}
.visit-output-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:.8rem;
  margin-bottom:1rem;
}
.chip{
  display:inline-flex;
  align-items:center;
  gap:.5rem;
  padding:.35rem .8rem;
  border-radius:999px;
  background:#fff;
  border:2px solid rgba(236,64,122,0.15);
  font-weight:900;
  color:var(--primary-dark);
}
.visit-output-body{color:var(--text-main);}

/* Control center */
.control-section{margin-top:2rem;}
.control-grid{
  display:grid;
  grid-template-columns: 1.2fr .8fr;
  gap:1.5rem;
  position: relative; /* ADDED: Enable absolute positioning within this section */
}
.body-stage{
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:1.6rem;
}
.body-stage-top{display:flex;gap:1rem; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;}
.week-slider-container{
  flex:1;
  min-width:320px;
  background:var(--lavender);
  border-radius:16px;
  padding:1.1rem 1.2rem;
}
.slider-label{font-weight:900;margin-bottom:.7rem;display:block;}
.week-slider{
  width:100%;
  height:8px;
  border-radius:999px;
  appearance:none;
  outline:none;
  background:linear-gradient(to right, var(--primary-light), var(--primary), var(--primary-dark));
}
.week-slider::-webkit-slider-thumb{
  appearance:none;
  width:24px;height:24px;border-radius:50%;
  background:#fff;border:3px solid var(--primary);
  box-shadow:0 2px 10px rgba(0,0,0,0.18);
}
.week-slider::-moz-range-thumb{
  width:24px;height:24px;border-radius:50%;
  background:#fff;border:3px solid var(--primary);
  box-shadow:0 2px 10px rgba(0,0,0,0.18);
}
.slider-markers{display:flex;justify-content:space-between;font-size:.75rem;color:var(--text-soft);margin-top:.4rem;}

.body-canvas{position:relative; margin-top:1.2rem; border-radius:18px; overflow:hidden; background:linear-gradient(135deg,#f5f5f5 0%, #eaeaea 100%); min-height:640px;}
.body-svg-2{width:100%;height:640px; display:block;}
.skin{fill:#f5c6a0; stroke:#e0a882; stroke-width:2;}
.hair{fill:#5c3d2e;}
.dress{fill:#e8a0b8; stroke:#d47a9a; stroke-width:2;}
.belly{fill:#e8a0b8; stroke:#d47a9a; stroke-width:2; opacity:.95;}
.hot-organ{fill:rgba(236,64,122,0.22); stroke:rgba(236,64,122,0.25); stroke-width:2; cursor:pointer; transition:all .2s ease;}
.hot-organ:hover{fill:rgba(236,64,122,0.38); filter:drop-shadow(0 0 10px rgba(236,64,122,0.35));}
.baby-dot{fill:rgba(216,27,96,0.5); animation:babyPulse 2.2s ease-in-out infinite;}
@keyframes babyPulse{0%,100%{transform:scale(1); opacity:.5;}50%{transform:scale(1.08); opacity:.75;}}

.growth-ring{fill:none; stroke:rgba(244,143,177,0.8); stroke-width:1; opacity:0; animation:ringExpand 4s ease-out infinite;}
.ring-a{animation-delay:0s;}
.ring-b{animation-delay:1.3s;}
.ring-c{animation-delay:2.6s;}
@keyframes ringExpand{0%{opacity:.6;}100%{opacity:0; transform:scale(1.45);}}

/* hotspots */
.hotspot{
  position:absolute;
  transform:translate(-50%,-50%);
  cursor:pointer;
  z-index:5;
}
.hotspot-pulse{
  position:absolute;
  width:42px;height:42px;border-radius:50%;
  background:var(--primary);
  opacity:.25;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  animation:hotspotPulse 2s ease-out infinite;
}
@keyframes hotspotPulse{
  0%{transform:translate(-50%,-50%) scale(1); opacity:.55;}
  100%{transform:translate(-50%,-50%) scale(2); opacity:0;}
}
.hotspot-icon{
  position:relative;
  width:54px;height:54px;border-radius:50%;
  background:#fff;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 6px 18px rgba(0,0,0,0.15);
  font-size:1.45rem;
  transition:transform .2s ease;
}
.hotspot:hover .hotspot-icon{transform:scale(1.08);}
.hotspot-label{
  position:absolute;
  top:62px;
  left:50%;
  transform:translateX(-50%);
  background:#111;
  color:#fff;
  padding:.35rem .75rem;
  border-radius:10px;
  font-size:.75rem;
  font-weight:900;
  opacity:0;
  transition:opacity .2s ease;
  white-space:nowrap;
}
.hotspot:hover .hotspot-label{opacity:1;}

.insight-panel{
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:1.5rem;
  position:sticky;
  top:95px;
  height:fit-content;
}
.insight-head{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:1rem;}
.icon-btn{
  width:38px;height:38px;border-radius:50%;
  border:none;
  background:rgba(236,64,122,0.08);
  font-size:1.4rem;
  cursor:pointer;
  font-weight:900;
}
.insight-body{color:var(--text-main); line-height:1.75;}
.insight-actions{display:flex;gap:.8rem;margin-top:1.2rem;}
.insight-actions .btn-primary,.insight-actions .btn-secondary{
  padding:.85rem 1rem;
  flex:1;
}

/* Week-by-Week Comparison Chart - NOW IN SECTION HEADER */
.week-comparison-chart {
  margin-top: 2rem; /* Space below instruction text */
  margin-bottom: 2rem; /* Space before control grid */
  padding: 2rem 0;
  text-align: center;
  max-width: 100%; /* Full width within section header */
}

.week-comparison-chart h3 {
  font-size: 1.8rem;
  color: var(--text-main);
  margin-bottom: 1.5rem;
  text-align: center;
  font-weight: 700;
}

.comparison-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  max-width: 1200px;
  margin: 0 auto; /* Center the grid */
}


/* Tests/scans split */
.tests-section{margin-top:2rem;}
.split{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:1.5rem;
}
.card-surface{
  background:#fff;
  border-radius:24px;
  padding:1.8rem;
  box-shadow:var(--shadow);
}
.subhead h3{font-size:1.6rem;margin-bottom:.35rem;}
.subhead p{color:var(--text-soft); font-weight:600; margin-bottom:1.2rem;}
.test-grid{
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:1rem;
}
.test-card{
  border:none;
  background:linear-gradient(135deg, rgba(236,64,122,0.05), rgba(237,231,246,0.30));
  border:2px solid rgba(236,64,122,0.10);
  border-radius:18px;
  padding:1.1rem;
  cursor:pointer;
  text-align:left;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
}
.test-card:hover{
  transform:translateY(-4px);
  box-shadow:var(--shadow-strong);
  border-color:rgba(236,64,122,0.22);
}
.test-icon{font-size:2.1rem;margin-bottom:.4rem;}
.test-name{font-family:'Manrope', sans-serif; font-weight:900; font-size:1.05rem;}
.test-meta{
  display:flex;
  gap:.6rem;
  align-items:center;
  margin:.5rem 0;
  color:var(--text-soft);
  font-weight:800;
  font-size:.85rem;
}
.pill{
  padding:.25rem .6rem;
  border-radius:999px;
  font-weight:900;
  font-size:.75rem;
  color:#fff;
}
.pill.critical{background:var(--critical);}
.pill.warn{background:var(--warning);}
.test-preview{color:var(--text-soft); font-weight:600; font-size:.92rem;}

.scan-grid{
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:1rem;
}
.scan-card{
  border:none;
  background:#fff;
  border-radius:20px;
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
  padding:1rem;
  cursor:pointer;
  text-align:left;
  border:2px solid transparent;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
}
.scan-card:hover{transform:translateY(-4px); box-shadow:0 12px 32px rgba(236,64,122,0.18); border-color:rgba(236,64,122,0.25);}
.scan-card.featured{border-color:rgba(236,64,122,0.55);}
.scan-week{
  display:inline-block;
  padding:.25rem .65rem;
  border-radius:999px;
  background:rgba(236,64,122,0.10);
  color:var(--primary-dark);
  font-weight:900;
  font-size:.78rem;
}
.scan-visual{
  height:120px;
  border-radius:14px;
  margin:.9rem 0 .7rem;
  background:linear-gradient(135deg,#f5f5f5 0%, #e8e8e8 100%);
  position:relative;
  overflow:hidden;
}
.scan-visual::after{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 55% 55%, rgba(236,64,122,0.18), transparent 60%);
  animation:scanGlow 2.4s ease-in-out infinite;
}
@keyframes scanGlow{0%,100%{opacity:.5;}50%{opacity:1;}}
.scan-visual.dating::before{
  content:'';
  position:absolute;
  width:26px;height:26px;border-radius:50%;
  background:rgba(236,64,122,0.7);
  left:50%;top:50%;
  transform:translate(-50%,-50%);
  animation:dotPulse 1.8s ease-in-out infinite;
}
@keyframes dotPulse{0%,100%{transform:translate(-50%,-50%) scale(1);}50%{transform:translate(-50%,-50%) scale(1.15);}}
.scan-visual.nt::before{
  content:'';
  position:absolute;
  width:70px;height:85px;
  border:3px solid rgba(236,64,122,0.55);
  border-radius:50% 50% 40% 40%;
  left:50%;top:50%;
  transform:translate(-50%,-50%);
}
.scan-visual.anatomy::before{
  content:'';
  position:absolute;
  width:90px;height:105px;
  border-radius:50% 50% 45% 45%;
  background:linear-gradient(135deg, rgba(244,143,177,0.65), rgba(236,64,122,0.65));
  left:50%;top:50%;
  transform:translate(-50%,-50%);
}
.scan-visual.growth::before{
  content:'';
  position:absolute;
  width:105px;height:115px;
  border-radius:50% 50% 45% 45%;
  background:rgba(236,64,122,0.45);
  left:50%;top:50%;
  transform:translate(-50%,-50%) rotate(-4deg);
  animation:wiggle 3s ease-in-out infinite;
}
@keyframes wiggle{0%,100%{transform:translate(-50%,-50%) rotate(-5deg);}50%{transform:translate(-50%,-50%) rotate(5deg);}}

.memory-drill{
  margin-top:1.3rem;
  background:var(--lavender);
  border-radius:18px;
  padding:1.2rem;
}
.drill-row{display:flex;gap:.6rem;align-items:center;margin-top:.7rem;flex-wrap:wrap;}
.drill-row input{
  width:120px;
  padding:.55rem .7rem;
  border-radius:12px;
  border:2px solid rgba(0,0,0,0.08);
  font-weight:900;
}
.drill-output{
  margin-top:.9rem;
  background:#fff;
  border-radius:14px;
  padding:1rem;
  border:2px solid rgba(236,64,122,0.10);
}

/* Vaccine section */
.vaccine-interactive{
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:1.8rem;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:1.2rem;
}
.vaccine-timeline{display:flex;flex-direction:column;gap:1rem;}
.vaccine-item{
  border:none;
  width:100%;
  cursor:pointer;
  border-radius:18px;
  padding:1.2rem;
  display:flex;
  align-items:center;
  gap:1rem;
  border:2px solid transparent;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
}
.vaccine-item:hover{transform:translateY(-3px); box-shadow:0 10px 22px rgba(236,64,122,0.18); border-color:rgba(236,64,122,0.22);}
.vaccine-item.recommended{background:linear-gradient(135deg,#e8f5e9 0%, #c8e6c9 100%);}
.vaccine-item.avoid{background:linear-gradient(135deg,#ffebee 0%, #ffcdd2 100%);}
.vaccine-icon{font-size:2.3rem;}
.vaccine-info h3{font-size:1.1rem;margin-bottom:.25rem;}
.vaccine-timing{color:var(--text-soft); font-weight:800;}
.vaccine-status{
  display:inline-block;
  margin-top:.35rem;
  padding:.25rem .6rem;
  border-radius:10px;
  font-size:.8rem;
  font-weight:900;
  color:#fff;
}
.vaccine-status.recommended{background:var(--success);}
.vaccine-status.avoid{background:var(--critical);}
.vaccine-expand{margin-left:auto; font-size:1.6rem; font-weight:900; color:rgba(0,0,0,0.55);}

.vaccine-detail-panel{
  background:var(--lavender);
  border-radius:18px;
  padding:1.4rem;
  border:2px solid rgba(236,64,122,0.10);
  display:flex;
  align-items:flex-start;
  justify-content:center;
  min-height:220px;
  max-height:600px;
  overflow-y: auto;
}

/* Custom scrollbar for vaccine panel */
.vaccine-detail-panel::-webkit-scrollbar {
  width: 8px;
}

.vaccine-detail-panel::-webkit-scrollbar-track {
  background: rgba(236, 64, 122, 0.05);
  border-radius: 10px;
}

.vaccine-detail-panel::-webkit-scrollbar-thumb {
  background: rgba(236, 64, 122, 0.3);
  border-radius: 10px;
}

.vaccine-detail-panel::-webkit-scrollbar-thumb:hover {
  background: rgba(236, 64, 122, 0.5);
}

/* ===============================================
   ANTIBODY TRANSFER 3D VISUALIZATION
   =============================================== */

.antibody-transfer-panel {
  background: linear-gradient(135deg, rgba(237,231,246,0.4), rgba(255,255,255,0.9));
  border-radius: 24px;
  padding: 2rem;
  border: 2px solid rgba(236,64,122,0.15);
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  box-shadow: 0 8px 32px rgba(236,64,122,0.12);
}

.transfer-header {
  text-align: center;
  margin-bottom: 1rem;
}

.transfer-header h3 {
  font-size: 1.6rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 0.5rem;
}

.transfer-subtitle {
  font-size: 1.1rem;
  color: var(--primary);
  font-weight: 600;
  letter-spacing: 0.5px;
}

/* 3D Canvas Container */
.transfer-visualization-container {
  position: relative;
  width: 100%;
  height: 400px;
  background: radial-gradient(circle at center, 
    rgba(236,64,122,0.05) 0%, 
    rgba(237,231,246,0.1) 50%,
    rgba(255,255,255,0.8) 100%);
  border-radius: 20px;
  overflow: hidden;
  border: 3px solid rgba(236,64,122,0.15);
  box-shadow: inset 0 4px 20px rgba(0,0,0,0.05);
}

.antibody-canvas {
  width: 100%;
  height: 100%;
  display: block;
}

/* Overlay Info Steps */
.transfer-overlay-info {
  position: absolute;
  bottom: 15px;
  left: 20px;
  right: 20px;
  pointer-events: none;
  z-index: 10;
}

.info-step {
  background: rgba(255,255,255,0.95);
  backdrop-filter: blur(10px);
  padding: 0.6rem 1rem;
  border-radius: 12px;
  border: 2px solid rgba(236,64,122,0.2);
  box-shadow: 0 4px 16px rgba(0,0,0,0.12);
  animation: slideInFromBottom 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  display: flex;
  align-items: center;
  gap: 0.8rem;
}

@keyframes slideInFromBottom {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.info-step .step-icon {
  font-size: 1.8rem;
  flex-shrink: 0;
  animation: pulse 2s ease infinite;
}

@keyframes pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}

.info-step h4 {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--primary);
  margin: 0;
  margin-bottom: 0.1rem;
}

.info-step p {
  font-size: 0.85rem;
  color: var(--text-soft);
  line-height: 1.3;
  margin: 0;
}

.step-content {
  flex: 1;
  min-width: 0;
}

/* Controls */
.transfer-controls {
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.control-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 14px;
  font-weight: 700;
  font-size: 0.95rem;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  box-shadow: 0 4px 12px rgba(236,64,122,0.25);
}

.control-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(236,64,122,0.35);
}

.control-btn:active {
  transform: translateY(-1px);
}

.btn-icon {
  font-size: 1.1rem;
}

/* Timeline */
.transfer-timeline {
  background: white;
  padding: 1.5rem;
  border-radius: 16px;
  border: 2px solid rgba(236,64,122,0.12);
}

.timeline-track {
  position: relative;
  height: 8px;
  background: linear-gradient(to right,
    rgba(236,64,122,0.2) 0%,
    rgba(236,64,122,0.5) 50%,
    rgba(76,175,80,0.5) 100%);
  border-radius: 10px;
  margin-bottom: 1rem;
  overflow: hidden;
}

.timeline-track::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(255,255,255,0.3) 50%, 
    transparent 100%);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

.timeline-marker {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translate(-50%, -50%);
  width: 24px;
  height: 24px;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  border-radius: 50%;
  border: 3px solid white;
  box-shadow: 0 4px 12px rgba(236,64,122,0.5);
  transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 2;
}

.timeline-marker::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 12px;
  height: 12px;
  background: white;
  border-radius: 50%;
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.5);
    opacity: 0.5;
  }
}

.timeline-labels {
  display: flex;
  justify-content: space-between;
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 600;
}

/* Facts Cards */
.transfer-facts {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
}

.fact-card {
  background: white;
  padding: 1.2rem;
  border-radius: 14px;
  border: 2px solid rgba(236,64,122,0.12);
  display: flex;
  gap: 1rem;
  align-items: flex-start;
  transition: all 0.3s;
}

.fact-card:hover {
  transform: translateY(-4px);
  border-color: rgba(236,64,122,0.3);
  box-shadow: 0 8px 20px rgba(236,64,122,0.15);
}

.fact-icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.fact-content {
  flex: 1;
}

.fact-content h5 {
  font-size: 1rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.3rem;
}

.fact-content p {
  font-size: 0.9rem;
  color: var(--text-soft);
  line-height: 1.5;
}

/* Learn More */
.transfer-learn-more {
  text-align: center;
}

.learn-more-btn {
  padding: 1rem 2rem;
  background: white;
  color: var(--primary);
  border: 2px solid var(--primary);
  border-radius: 14px;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 0.8rem;
}

.learn-more-btn:hover {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border-color: transparent;
  transform: translateY(-3px);
  box-shadow: 0 8px 24px rgba(236,64,122,0.3);
}

/* Responsive */
@media (max-width: 768px) {
  .antibody-transfer-panel {
    padding: 1.5rem;
  }
  
  .transfer-visualization-container {
    height: 300px;
  }
  
  .transfer-overlay-info {
    bottom: 10px;
    left: 10px;
    right: 10px;
  }
  
  .info-step {
    padding: 0.5rem 0.8rem;
    gap: 0.6rem;
  }
  
  .info-step .step-icon {
    font-size: 1.4rem;
  }
  
  .info-step h4 {
    font-size: 0.85rem;
  }
  
  .info-step p {
    font-size: 0.75rem;
  }
  
  .transfer-facts {
    grid-template-columns: 1fr;
  }
  
  .transfer-controls {
    flex-direction: column;
  }
  
  .control-btn {
    width: 100%;
    justify-content: center;
  }
}

/* Vaccine Detail Enhancements */
.vax-header-row {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.vax-badge {
  padding: 0.4rem 1rem;
  border-radius: 50px;
  font-weight: 700;
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.vax-badge.vax-strong {
  background: linear-gradient(135deg, #66bb6a, #388e3c);
  color: white;
}

.vax-badge.vax-recommended {
  background: linear-gradient(135deg, #42a5f5, #1976d2);
  color: white;
}

.vax-badge.vax-avoid {
  background: linear-gradient(135deg, #ef5350, #c62828);
  color: white;
}

.vax-details-box {
  background: linear-gradient(135deg, #f5f5f5, #eeeeee);
  border-left: 4px solid var(--primary);
  border-radius: 8px;
  padding: 1rem;
  margin-top: 1.5rem;
}

.vax-details-box p {
  line-height: 1.7;
  color: var(--text-main);
}

.vax-detail ul {
  margin: 0.75rem 0;
  padding-left: 1.5rem;
}

.vax-detail ul li {
  margin: 0.5rem 0;
  line-height: 1.6;
}

.vax-detail h5 {
  font-size: 1rem;
  font-weight: 700;
}

/* Wellness */
.wellness-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:1.5rem;
}
.nutrient-slots{
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:1rem;
  margin-top:1.2rem;
}
.nutrient-slot{
  background:var(--lavender);
  border-radius:16px;
  padding:1.1rem;
}
.slot-header{display:flex;align-items:center;gap:.6rem;margin-bottom:.6rem;}
.nutrient-icon{font-size:1.4rem;}
.nutrient-name{font-weight:900;}
.nutrient-target{color:var(--text-soft);font-weight:700;font-size:.9rem;margin-bottom:.45rem;}
.nutrient-progress{height:12px;border-radius:999px;background:#fff;overflow:hidden;margin-bottom:.45rem;}
.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg, var(--primary), var(--success));
  transition:width .35s ease;
}
.nutrient-current{font-weight:900;}

.food-selection{
  margin-top:1rem;
  background:var(--lavender);
  border-radius:18px;
  padding:1.1rem;
}
.food-selection-title{font-weight:900;margin-bottom:.8rem;}
.food-grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:.8rem;
}
.food-item{
  border:none;
  background:#fff;
  border-radius:16px;
  padding:1rem;
  cursor:pointer;
  border:2px solid transparent;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  text-align:center;
}
.food-item:hover{transform:translateY(-3px); box-shadow:0 10px 22px rgba(236,64,122,0.18); border-color:rgba(236,64,122,0.22);}
.food-icon{font-size:2rem;margin-bottom:.4rem;}
.food-name{font-weight:900;}
.food-nutrients{color:var(--text-soft); font-weight:700; font-size:.8rem;}

.row{display:flex;gap:.8rem;align-items:center;justify-content:flex-start;margin-top:1rem;flex-wrap:wrap;}
.nutrition-score-panel{
  margin-top:1rem;
  background:#fff;
  border-radius:18px;
  padding:1.4rem;
  box-shadow:0 4px 16px rgba(0,0,0,0.06);
  text-align:center;
}
.score-circle-container{position:relative;width:150px;height:150px;margin:0 auto 1rem;}
.score-circle-svg{transform:rotate(-90deg);}
.score-bg-circle{fill:none;stroke:var(--lavender);stroke-width:10;}
.score-fill-circle{
  fill:none;
  stroke:var(--success);
  stroke-width:10;
  stroke-dasharray:314;
  stroke-dashoffset:314;
  transition:stroke-dashoffset .35s ease;
  stroke-linecap:round;
}
.score-value{
  position:absolute;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  font-size:2rem;
  font-weight:900;
  color:var(--primary);
}
.score-feedback{font-weight:800;color:var(--text-soft);}

.discomfort-grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:.8rem;
  margin-top:1rem;
}
.discomfort-card{
  border:none;
  background:linear-gradient(135deg, rgba(236,64,122,0.06), rgba(237,231,246,0.45));
  border:2px solid rgba(236,64,122,0.10);
  border-radius:16px;
  padding:1rem;
  cursor:pointer;
  font-weight:900;
  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
}
.discomfort-card:hover{transform:translateY(-3px); box-shadow:var(--shadow-strong); border-color:rgba(236,64,122,0.22);}
.discomfort-output{
  margin-top:1rem;
  background:var(--lavender);
  border-radius:18px;
  padding:1.2rem;
  border:2px solid rgba(236,64,122,0.10);
  min-height:130px;
}
.red-flag-game{margin-top:1rem;}
.mini-quiz{margin-top:1.2rem; padding-top:1.2rem; border-top:2px dashed rgba(236,64,122,0.18);}

.avoid-foods-section{margin-top:1.4rem;}
.avoid-title{color:var(--critical); text-align:center; margin-bottom:1rem;}
.avoid-grid{
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:1rem;
}
.avoid-card{
  background:linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
  border-radius:16px;
  padding:1rem;
  border:2px solid rgba(239,83,80,0.25);
  text-align:center;
}
.avoid-icon{font-size:2rem;margin-bottom:.4rem;}
.avoid-card h4{color:var(--critical);margin-bottom:.2rem;}
.avoid-card p{color:var(--text-soft);font-weight:700;font-size:.9rem;}

/* Warning/triage */
.triage{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:1.5rem;
}
.scenario-grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:.8rem;
  margin-top:1rem;
}
.scenario-card{
  border:none;
  border-radius:16px;
  padding:1rem;
  font-weight:900;
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease;
  color:#fff;
}
.scenario-card.emergency{background:linear-gradient(135deg, var(--emergency), #ff5252);}
.scenario-card.urgent{background:linear-gradient(135deg, var(--urgent), #ffb74d); color:#1a1a1a;}
.scenario-card.monitor{background:linear-gradient(135deg, var(--monitor), #64b5f6);}
.scenario-card:hover{transform:translateY(-3px); box-shadow:0 12px 26px rgba(0,0,0,0.18);}
.triage-actions{display:flex;gap:.8rem;margin-top:1rem;}
.triage-right{
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:1.6rem;
  border:2px solid rgba(236,64,122,0.10);
  min-height:260px;
}

/* Kick counter */
.kick-counter-game{
  background:#fff;
  border-radius:24px;
  box-shadow:var(--shadow);
  padding:2rem;
}
.kick-counter-interactive{
  display:grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap:1.5rem;
  align-items:start;
}
.kick-count-circle{
  width:160px;height:160px;border-radius:50%;
  background:linear-gradient(135deg, var(--primary), var(--primary-dark));
  color:#fff;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  box-shadow:0 10px 28px rgba(236,64,122,0.28);
  margin-bottom:1rem;
}
.count-number{font-size:3rem;font-weight:900;}
.timer-card{
  background:var(--lavender);
  border-radius:18px;
  padding:1.1rem;
  text-align:center;
  border:2px solid rgba(236,64,122,0.10);
}
.timer-value{font-weight:900;font-size:2rem;}
.timer-label{color:var(--text-soft);font-weight:800;}
.kick-controls{display:flex;gap:.8rem;margin-top:1rem;flex-wrap:wrap;}
.kick-note{margin-top:1rem;}

.baby-outline-kick{
  height:320px;
  border-radius:24px;
  background:linear-gradient(135deg, rgba(236,64,122,0.08), rgba(237,231,246,0.65));
  border:2px dashed rgba(236,64,122,0.25);
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  overflow:hidden;
}
.kick-zone{
  position:absolute;
  width:140px;height:140px;border-radius:50%;
  background:rgba(236,64,122,0.25);
  opacity:0;
  transition:opacity .2s ease;
  filter:blur(1px);
}
.zone-1{left:15%;top:30%;}
.zone-2{left:48%;top:45%;}
.zone-3{left:65%;top:22%;}
.kick-instruction{position:absolute; bottom:12px; color:var(--text-soft); font-weight:900;}
.kick-history{
  background:var(--lavender);
  border-radius:18px;
  padding:1.1rem;
  border:2px solid rgba(236,64,122,0.10);
}
.history-list{margin-top:.6rem; display:flex; flex-direction:column; gap:.6rem;}
.no-data{color:var(--text-soft); font-weight:800;}
.session-row{
  background:#fff;
  border-radius:14px;
  padding:.8rem;
  border:2px solid rgba(236,64,122,0.10);
}
.session-row strong{color:var(--primary-dark);}

/* Birth Plan - Revolutionary Interactive UI V2 */
.birth-plan-section-v2 {
  position: relative;
  padding: 3rem 0;
}

/* Progress Ring */
.birth-plan-progress-ring {
  display: flex;
  justify-content: center;
  margin: 2rem 0 3rem;
  position: relative;
}

.progress-ring {
  transform: rotate(-90deg);
}

.progress-ring-circle-bg {
  fill: none;
  stroke: rgba(236,64,122,0.1);
  stroke-width: 12;
}

.progress-ring-circle {
  fill: none;
  stroke: url(#progressGradient);
  stroke-width: 12;
  stroke-linecap: round;
  stroke-dasharray: 502.4;
  stroke-dashoffset: 502.4;
  transition: stroke-dashoffset 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.progress-content {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

.progress-percentage {
  font-size: 2.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.progress-label {
  font-size: 0.9rem;
  color: var(--text-soft);
  font-weight: 600;
  margin-top: -0.3rem;
}

/* Journey Builder Container */
.birth-journey-builder {
  display: grid;
  grid-template-columns: 280px 1fr 320px;
  gap: 2rem;
  margin-top: 2rem;
  align-items: start;
}

/* Stage Navigation */
.journey-stages-nav {
  position: sticky;
  top: 120px;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  padding: 1.5rem;
  background: white;
  border-radius: 24px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  position: relative;
}

.stages-timeline-line {
  position: absolute;
  left: 3.5rem;
  top: 5rem;
  bottom: 5rem;
  width: 3px;
  background: linear-gradient(180deg, 
    rgba(236,64,122,0.3) 0%,
    rgba(236,64,122,0.1) 100%);
  z-index: 0;
}

.journey-stage-btn {
  position: relative;
  z-index: 1;
  background: white;
  border: 2px solid rgba(236,64,122,0.15);
  border-radius: 18px;
  padding: 1rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 1rem;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  text-align: left;
}

.journey-stage-btn:hover {
  transform: translateX(8px);
  border-color: rgba(236,64,122,0.4);
  box-shadow: 0 8px 20px rgba(236,64,122,0.15);
}

.journey-stage-btn.active {
  background: linear-gradient(135deg, rgba(236,64,122,0.08), rgba(237,231,246,0.3));
  border-color: var(--primary);
  transform: translateX(12px) scale(1.02);
  box-shadow: 0 12px 28px rgba(236,64,122,0.2);
}

.stage-icon-wrapper {
  position: relative;
  flex-shrink: 0;
}

.stage-icon {
  width: 50px;
  height: 50px;
  border-radius: 14px;
  background: linear-gradient(135deg, rgba(236,64,122,0.1), rgba(237,231,246,0.2));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.8rem;
  transition: all 0.3s;
}

.journey-stage-btn.active .stage-icon {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  transform: scale(1.1) rotate(-5deg);
  box-shadow: 0 6px 16px rgba(236,64,122,0.3);
}

.stage-check {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 24px;
  height: 24px;
  background: #4caf50;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  font-weight: 700;
  opacity: 0;
  transform: scale(0);
  transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  box-shadow: 0 3px 10px rgba(76,175,80,0.4);
}

.stage-check.visible {
  opacity: 1;
  transform: scale(1);
}

.stage-info {
  flex: 1;
}

.stage-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 0.2rem;
}

.stage-subtitle {
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 500;
}

/* Stage Content Area */
.birth-stage-content {
  background: white;
  border-radius: 24px;
  padding: 2rem;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  min-height: 600px;
}

.stage-content-header {
  margin-bottom: 2rem;
}

.stage-content-title {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.8rem;
}

.stage-content-desc {
  color: var(--text-soft);
  line-height: 1.7;
  font-size: 1rem;
}

/* Preference Cards Grid */
.preference-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.preference-card {
  background: linear-gradient(135deg, rgba(237,231,246,0.3), rgba(255,255,255,0.9));
  border: 2px solid rgba(236,64,122,0.12);
  border-radius: 20px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.preference-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(236,64,122,0.05), rgba(126,87,194,0.05));
  opacity: 0;
  transition: opacity 0.3s;
}

.preference-card:hover {
  transform: translateY(-8px);
  border-color: rgba(236,64,122,0.3);
  box-shadow: 0 12px 32px rgba(236,64,122,0.15);
}

.preference-card:hover::before {
  opacity: 1;
}

.preference-card.selected {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  border-color: transparent;
  color: white;
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 16px 40px rgba(236,64,122,0.3);
}

.preference-card.selected .card-icon {
  transform: scale(1.2) rotate(10deg);
  filter: brightness(1.3);
}

.preference-card.selected .card-title,
.preference-card.selected .card-desc {
  color: white;
}

.card-icon {
  font-size: 2.5rem;
  margin-bottom: 0.8rem;
  display: block;
  transition: all 0.3s;
}

.card-title {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  color: var(--text-main);
}

.card-desc {
  font-size: 0.9rem;
  color: var(--text-soft);
  line-height: 1.5;
}

.card-info-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  width: 24px;
  height: 24px;
  background: rgba(236,64,122,0.1);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: help;
  transition: all 0.3s;
}

.card-info-badge:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

/* Slider Preferences */
.slider-preference {
  background: rgba(237,231,246,0.3);
  border-radius: 18px;
  padding: 1.5rem;
  margin-top: 1.5rem;
  border: 2px solid rgba(236,64,122,0.12);
}

.slider-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.slider-title {
  font-size: 1.05rem;
  font-weight: 700;
  color: var(--text-main);
}

.slider-value {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--primary);
  padding: 0.3rem 0.8rem;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(236,64,122,0.1);
}

.custom-slider {
  width: 100%;
  height: 8px;
  border-radius: 10px;
  background: linear-gradient(to right, 
    rgba(236,64,122,0.2) 0%, 
    rgba(236,64,122,0.5) 50%,
    var(--primary) 100%);
  outline: none;
  -webkit-appearance: none;
  cursor: pointer;
}

.custom-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(236,64,122,0.3);
  transition: all 0.3s;
}

.custom-slider::-webkit-slider-thumb:hover {
  transform: scale(1.2);
  box-shadow: 0 6px 18px rgba(236,64,122,0.5);
}

.custom-slider::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(236,64,122,0.3);
  border: none;
  transition: all 0.3s;
}

.slider-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: var(--text-soft);
}

/* Toggle Preferences */
.toggle-preference {
  background: white;
  border: 2px solid rgba(236,64,122,0.12);
  border-radius: 16px;
  padding: 1.2rem 1.5rem;
  margin-top: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: all 0.3s;
}

.toggle-preference:hover {
  border-color: rgba(236,64,122,0.3);
  background: rgba(237,231,246,0.2);
  transform: translateX(4px);
}

.toggle-preference.active {
  background: linear-gradient(135deg, rgba(236,64,122,0.08), rgba(237,231,246,0.3));
  border-color: var(--primary);
}

.toggle-label {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-main);
}

.toggle-switch {
  position: relative;
  width: 54px;
  height: 28px;
  background: rgba(0,0,0,0.1);
  border-radius: 20px;
  transition: all 0.3s;
}

.toggle-preference.active .toggle-switch {
  background: var(--primary);
}

.toggle-switch::after {
  content: '';
  position: absolute;
  top: 3px;
  left: 3px;
  width: 22px;
  height: 22px;
  background: white;
  border-radius: 50%;
  transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.toggle-preference.active .toggle-switch::after {
  transform: translateX(26px);
}

/* Live Preview Panel */
.birth-plan-live-preview {
  position: sticky;
  top: 120px;
  background: white;
  border-radius: 24px;
  padding: 1.5rem;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  max-height: calc(100vh - 160px);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.preview-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid rgba(236,64,122,0.1);
}

.preview-header h3 {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-main);
}

.preview-actions {
  display: flex;
  gap: 0.5rem;
}

.icon-btn {
  width: 36px;
  height: 36px;
  border: none;
  background: rgba(236,64,122,0.08);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 1.2rem;
}

.icon-btn:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

/* Mood Board */
.preview-mood-board {
  background: linear-gradient(135deg, rgba(237,231,246,0.3), rgba(255,255,255,0.5));
  border-radius: 18px;
  padding: 2rem;
  margin-bottom: 1.5rem;
  min-height: 180px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border: 2px dashed rgba(236,64,122,0.2);
}

.mood-board-empty {
  text-align: center;
  color: var(--text-soft);
}

.empty-icon {
  font-size: 3rem;
  margin-bottom: 0.5rem;
  opacity: 0.5;
}

.mood-board-items {
  display: flex;
  flex-wrap: wrap;
  gap: 0.8rem;
  justify-content: center;
}

.mood-item {
  font-size: 2rem;
  animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes popIn {
  0% {
    transform: scale(0);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Preview Selections */
.preview-selections-list {
  flex: 1;
  margin-bottom: 1.5rem;
  overflow-y: auto;
}

.preview-category {
  margin-bottom: 1.5rem;
}

.preview-category-title {
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 0.8rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.preview-item {
  background: rgba(237,231,246,0.2);
  border-radius: 12px;
  padding: 0.8rem 1rem;
  margin-bottom: 0.6rem;
  font-size: 0.9rem;
  color: var(--text-main);
  display: flex;
  align-items: center;
  gap: 0.8rem;
  animation: slideInRight 0.3s ease;
}

@keyframes slideInRight {
  from {
    transform: translateX(20px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.preview-item-icon {
  font-size: 1.2rem;
}

/* Preview Stats */
.preview-stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-bottom: 1.5rem;
  padding: 1rem 0;
  border-top: 2px solid rgba(236,64,122,0.1);
  border-bottom: 2px solid rgba(236,64,122,0.1);
}

.stat-item {
  text-align: center;
}

.stat-number {
  display: block;
  font-size: 2rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.stat-label {
  display: block;
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 600;
  margin-top: 0.2rem;
}

/* Preview Actions Bottom */
.preview-actions-bottom {
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.btn-preview-action {
  width: 100%;
  padding: 0.9rem 1rem;
  border: 2px solid rgba(236,64,122,0.2);
  background: white;
  color: var(--text-main);
  border-radius: 14px;
  font-weight: 700;
  font-size: 0.95rem;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.6rem;
}

.btn-preview-action:hover {
  transform: translateY(-2px);
  border-color: rgba(236,64,122,0.4);
  box-shadow: 0 6px 16px rgba(236,64,122,0.15);
}

.btn-preview-action.primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border-color: transparent;
}

.btn-preview-action.primary:hover {
  box-shadow: 0 8px 20px rgba(236,64,122,0.3);
}

.btn-preview-action.outline {
  background: transparent;
  color: var(--text-soft);
}

.btn-icon {
  font-size: 1.2rem;
}

/* Quick Actions Bar */
.birth-plan-quick-actions {
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  margin-top: 3rem;
  flex-wrap: wrap;
}

.quick-action-btn {
  background: white;
  border: 2px solid rgba(236,64,122,0.15);
  border-radius: 18px;
  padding: 1.2rem 1.8rem;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.6rem;
  min-width: 140px;
}

.quick-action-btn:hover {
  transform: translateY(-6px);
  border-color: rgba(236,64,122,0.4);
  box-shadow: 0 12px 28px rgba(236,64,122,0.15);
}

.qa-icon {
  font-size: 2.5rem;
}

.qa-label {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--text-main);
  text-align: center;
}

/* Education Cards */
.birth-education-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 1.5rem;
  margin-top: 3rem;
}

.edu-card {
  background: linear-gradient(135deg, rgba(237,231,246,0.4), white);
  border: 2px solid rgba(236,64,122,0.12);
  border-radius: 20px;
  padding: 2rem 1.5rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
}

.edu-card:hover {
  transform: translateY(-8px);
  border-color: rgba(236,64,122,0.3);
  box-shadow: 0 12px 32px rgba(236,64,122,0.15);
}

.edu-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.edu-card h4 {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 0.5rem;
}

.edu-card p {
  font-size: 0.9rem;
  color: var(--text-soft);
  line-height: 1.5;
}

/* Responsive Design */
@media (max-width: 1200px) {
  .birth-journey-builder {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .journey-stages-nav {
    position: static;
    flex-direction: row;
    overflow-x: auto;
    padding: 1rem;
  }
  
  .stages-timeline-line {
    display: none;
  }
  
  .journey-stage-btn {
    min-width: 200px;
  }
  
  .birth-plan-live-preview {
    position: static;
    max-height: none;
  }
}

@media (max-width: 768px) {
  .preference-cards-grid {
    grid-template-columns: 1fr;
  }
  
  .birth-plan-quick-actions {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .birth-education-cards {
    grid-template-columns: 1fr;
  }
  
  .progress-percentage {
    font-size: 2rem;
  }
}

/* Postpartum */
.postpartum-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:1.5rem;
}
.checklist{
  display:grid;
  grid-template-columns: 1fr;
  gap:.8rem;
  margin-top:1rem;
}
.check-item{
  background:var(--lavender);
  border-radius:16px;
  padding:.9rem 1rem;
  border:2px solid rgba(236,64,122,0.10);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:1rem;
}
.check-item label{font-weight:900;}
.check-item input{width:20px;height:20px;}

.mood-cards{display:grid;grid-template-columns: 1fr; gap:1rem; margin-top:1rem;}
.mood-card{
  background:var(--lavender);
  border-radius:18px;
  padding:1.2rem;
  border:2px solid rgba(236,64,122,0.10);
}
.mood-card.critical{
  background:linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
  border-color:rgba(239,83,80,0.28);
}
.mood-card h4{margin-bottom:.4rem;}
.mood-card p{color:var(--text-soft);font-weight:700;}

/* Footer */
.site-footer{padding:3rem 0 4rem;}
.footer-inner{
  background:#fff;
  border-radius:22px;
  box-shadow:var(--shadow);
  padding:1.4rem;
  display:flex;
  justify-content:space-between;
  gap:1rem;
  align-items:center;
  flex-wrap:wrap;
}

/* Modal */
.modal-backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.35);
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease;
  z-index:2000;
}
.modal-backdrop.open{
  opacity:1;
  pointer-events:all;
}
.modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:2100;
}
.modal[hidden]{display:none;}
.modal.open{
  display:flex;
}
.modal-content{
  width:min(900px, 92vw);
  max-height:86vh;
  background:#fff;
  border-radius:24px;
  padding:1.6rem 1.6rem 1.2rem;
  box-shadow:0 30px 80px rgba(0,0,0,0.25);
  position:relative;
  display: flex;
  flex-direction: column;
}

/* Modal body with scroll */
#modalBody {
  overflow-y: auto;
  max-height: calc(86vh - 150px); /* Account for title and actions - INCREASED */
  padding-right: 0.5rem;
  flex: 1;
  min-height: 0; /* Important for flex scrolling */
}

/* Custom scrollbar for modal */
#modalBody::-webkit-scrollbar {
  width: 8px;
}

#modalBody::-webkit-scrollbar-track {
  background: rgba(236, 64, 122, 0.05);
  border-radius: 10px;
}

#modalBody::-webkit-scrollbar-thumb {
  background: rgba(236, 64, 122, 0.3);
  border-radius: 10px;
}

#modalBody::-webkit-scrollbar-thumb:hover {
  background: rgba(236, 64, 122, 0.5);
}
.modal-close{
  position:absolute;
  top:14px;
  right:14px;
  width:42px;height:42px;
  border-radius:50%;
  border:none;
  background:rgba(236,64,122,0.08);
  font-size:1.6rem;
  cursor:pointer;
  font-weight:900;
}
.modal-actions{margin-top:1rem; display:flex; gap:.8rem; flex-wrap:wrap;}

/* ===================================================================
   BEAUTIFUL INTERPRET DIALOG STYLING
   =================================================================== */

/* BP Interpretation Styling */
.bp-interpretation {
  padding: 0.5rem 0;
}

.bp-reading-display {
  background: linear-gradient(135deg, #f5f5f5 0%, #eeeeee 100%);
  border-radius: 16px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.bp-numbers {
  font-size: 3rem;
  font-weight: 900;
  font-family: 'Playfair Display', Georgia, serif;
  margin-bottom: 0.75rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.25rem;
}

.bp-numbers.emergency {
  color: var(--emergency);
}

.bp-numbers.urgent {
  color: var(--urgent);
}

.bp-numbers.monitor {
  color: var(--monitor);
}

.bp-numbers.normal {
  color: var(--success);
}

.bp-separator {
  font-size: 2.5rem;
  opacity: 0.5;
  margin: 0 0.25rem;
}

.bp-unit {
  font-size: 1.2rem;
  opacity: 0.6;
  margin-left: 0.5rem;
  font-weight: 600;
}

.bp-status-badge {
  display: inline-block;
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-weight: 700;
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.bp-status-badge.emergency {
  background: var(--emergency);
  color: white;
}

.bp-status-badge.urgent {
  background: var(--urgent);
  color: white;
}

.bp-status-badge.monitor {
  background: var(--monitor);
  color: white;
}

.bp-status-badge.normal {
  background: var(--success);
  color: white;
}

/* Interpret Info Sections */
.bp-emergency-info,
.bp-urgent-info,
.bp-monitor-info,
.bp-normal-info,
.urine-info,
.weight-info {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
}

.bp-emergency-info {
  border: 3px solid var(--emergency);
  background: linear-gradient(135deg, #fff5f5 0%, #ffebee 100%);
}

.bp-urgent-info {
  border: 3px solid var(--urgent);
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
}

.bp-monitor-info {
  border: 3px solid var(--monitor);
  background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%);
}

.bp-normal-info {
  border: 3px solid var(--success);
  background: linear-gradient(135deg, #f1f8e9 0%, #dcedc8 100%);
}

.urine-info {
  border: 3px solid var(--primary);
  background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);
}

.weight-info {
  border: 3px solid var(--info);
  background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
}

.bp-emergency-info h4,
.bp-urgent-info h4,
.bp-monitor-info h4,
.bp-normal-info h4,
.urine-info h4,
.weight-info h4 {
  font-size: 1.3rem;
  margin-bottom: 1rem;
  color: var(--text-main);
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.bp-emergency-info ul,
.bp-urgent-info ul,
.bp-monitor-info ul,
.bp-normal-info ul,
.urine-info ul,
.weight-info ul {
  list-style: disc;
  padding-left: 2rem;
  margin: 1rem 0;
}

.bp-emergency-info ul li,
.bp-urgent-info ul li,
.bp-monitor-info ul li,
.bp-normal-info ul li,
.urine-info ul li,
.weight-info ul li {
  padding: 0.5rem 0;
  line-height: 1.7;
  text-align: left;
  display: list-item;
}

/* Color the bullets */
.bp-emergency-info ul li {
  color: var(--text-main);
}

.bp-emergency-info ul li::marker {
  color: var(--emergency);
  font-size: 1.2rem;
}

.bp-urgent-info ul li::marker {
  color: var(--urgent);
  font-size: 1.2rem;
}

.bp-monitor-info ul li::marker {
  color: var(--monitor);
  font-size: 1.2rem;
}

.bp-normal-info ul li::marker {
  color: var(--success);
  font-size: 1.2rem;
}

.urine-info ul li::marker {
  color: var(--primary);
  font-size: 1.2rem;
}

.weight-info ul li::marker {
  color: var(--info);
  font-size: 1.2rem;
}

.bp-emergency-info ol,
.bp-urgent-info ol,
.bp-monitor-info ol,
.bp-normal-info ol,
.urine-info ol,
.weight-info ol {
  margin: 1rem 0;
  padding-left: 1.5rem;
  counter-reset: item;
}

.bp-emergency-info ol li,
.bp-urgent-info ol li,
.bp-monitor-info ol li,
.bp-normal-info ol li,
.urine-info ol li,
.weight-info ol li {
  padding: 0.4rem 0;
  line-height: 1.6;
}

/* Nested lists within ordered lists */
.bp-emergency-info ol li ul,
.bp-urgent-info ol li ul,
.bp-monitor-info ol li ul,
.bp-normal-info ol li ul,
.urine-info ol li ul,
.weight-info ol li ul {
  margin: 0.5rem 0 0.5rem 0;
  padding-left: 0;
  list-style: none;
}

.bp-emergency-info ol li ul li,
.bp-urgent-info ol li ul li,
.bp-monitor-info ol li ul li,
.bp-normal-info ol li ul li,
.urine-info ol li ul li,
.weight-info ol li ul li {
  padding: 0.3rem 0 0.3rem 1.5rem;
  position: relative;
  line-height: 1.5;
  font-size: 0.95rem;
}

.bp-emergency-info ol li ul li::before,
.bp-urgent-info ol li ul li::before,
.bp-monitor-info ol li ul li::before,
.bp-normal-info ol li ul li::before,
.urine-info ol li ul li::before,
.weight-info ol li ul li::before {
  content: "";
  position: absolute;
  left: 0;
  font-size: 1.2rem;
  color: var(--text-soft);
  font-weight: 700;
}

.bp-emergency-info p,
.bp-urgent-info p,
.bp-monitor-info p,
.bp-normal-info p,
.urine-info p,
.weight-info p {
  margin: 0.75rem 0;
  line-height: 1.7;
}

.bp-emergency-info strong,
.bp-urgent-info strong,
.bp-monitor-info strong,
.bp-normal-info strong,
.urine-info strong,
.weight-info strong {
  color: var(--text-main);
  font-weight: 700;
}

.critical-note {
  background: rgba(255, 23, 68, 0.1);
  border-left: 4px solid var(--emergency);
  padding: 1rem;
  margin-top: 1rem;
  border-radius: 8px;
  font-weight: 600;
}

/* Urine & Weight specific styling */
.urine-interpretation,
.weight-interpretation {
  padding: 0.5rem 0;
}

.result-display {
  background: linear-gradient(135deg, #f5f5f5 0%, #eeeeee 100%);
  border-radius: 16px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.result-value {
  font-size: 2rem;
  font-weight: 900;
  margin-bottom: 0.75rem;
  text-transform: capitalize;
}

.result-badge {
  display: inline-block;
  padding: 0.5rem 1.5rem;
  border-radius: 50px;
  font-weight: 700;
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: var(--primary);
  color: white;
}

/* Command palette */
.palette{
  position:fixed;
  inset:0;
  z-index:2200;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding-top:90px;
}
.palette[hidden]{display:none;}
.palette-content{
  width:min(760px, 92vw);
  background:#fff;
  border-radius:24px;
  box-shadow:0 30px 80px rgba(0,0,0,0.22);
  padding:1.1rem;
}
.palette-head{display:flex;align-items:center;justify-content:space-between;gap:1rem; padding:.4rem .6rem;}
#paletteSearch{
  width:100%;
  margin-top:.6rem;
  padding:.9rem 1rem;
  border-radius:16px;
  border:2px solid rgba(236,64,122,0.18);
  font-weight:900;
  outline:none;
}
.palette-results{
  margin-top:.8rem;
  display:flex;
  flex-direction:column;
  gap:.6rem;
  max-height:46vh;
  overflow:auto;
  padding:.2rem;
}
.palette-item{
  border:none;
  background:linear-gradient(135deg, rgba(236,64,122,0.05), rgba(237,231,246,0.40));
  border:2px solid rgba(236,64,122,0.10);
  border-radius:16px;
  padding:1rem;
  text-align:left;
  cursor:pointer;
  transition:transform .2s ease, border-color .2s ease;
}
.palette-item:hover{transform:translateY(-2px); border-color:rgba(236,64,122,0.22);}
.palette-hint{padding:.7rem .6rem;}

/* ===================================================================
   REVOLUTIONARY UI ENHANCEMENTS - Beautiful Animations & Interactions
   =================================================================== */

/* Week Chip Animation - WHITE BACKGROUND FOR READABILITY */
.week-chip {
  background: white !important;
  color: var(--primary) !important;
  border: 2px solid var(--primary) !important;
  font-weight: 700 !important;
  box-shadow: 0 4px 15px rgba(236, 64, 122, 0.3);
  transition: all 0.3s ease;
}

.chip-animate {
  animation: chipPulse 0.6s ease-out;
}

@keyframes chipPulse {
  0%, 100% { 
    transform: scale(1); 
  }
  50% { 
    transform: scale(1.05); 
    box-shadow: 0 6px 25px rgba(236, 64, 122, 0.5); 
  }
}

/* ===================================================================
   Insight Panel V2 - Revolutionary Design
   =================================================================== */

.insight-panel-v2 {
  position: absolute;
  top: 0;
  right: 0; /* CHANGED: Now positioned within control-grid section */
  width: min(420px, 100%);
  height: 100vh; /* FIXED: Set to viewport height */
  max-height: 100vh;
  background: white;
  box-shadow: -10px 0 40px rgba(0, 0, 0, 0.15);
  z-index: 100; /* CHANGED: Lower z-index since it's now relative to section */
  transition: transform 0.4s cubic-bezier(0.4, 0.0, 0.2, 1), opacity 0.4s ease;
  overflow: hidden;
  transform: translateX(100%); /* Start off-screen to the right */
  opacity: 0;
}

.insight-panel-v2.open {
  transform: translateX(0); /* Slide in over the week-by-week section */
  opacity: 1;
}

.insight-panel-inner {
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
}

/* Beautiful Header with Gradient */
.insight-header-v2 {
  background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
  padding: 1.5rem 1.2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  position: relative;
  overflow: hidden;
  animation: headerShine 3s ease infinite;
}

.insight-header-v2::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    45deg,
    transparent 30%,
    rgba(255, 255, 255, 0.2) 50%,
    transparent 70%
  );
  animation: shine 3s ease infinite;
}

@keyframes headerShine {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes shine {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

/* Icon Badge */
.insight-icon-badge {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.1));
  border: 3px solid rgba(255, 255, 255, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.insight-emoji {
  font-size: 2rem;
  animation: iconFloat 2s ease-in-out infinite;
}

@keyframes iconFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.insight-title-group {
  flex: 1;
  color: white;
}

.insight-title-v2 {
  font-size: 1.3rem;
  font-weight: 700;
  margin: 0 0 0.3rem 0;
  color: white;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.insight-week-badge-v2 {
  display: inline-block;
  background: rgba(255, 255, 255, 0.25);
  border: 1.5px solid rgba(255, 255, 255, 0.4);
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  color: white;
  backdrop-filter: blur(10px);
}

/* Scrollable Content */
.insight-content-scroll {
  flex: 1;
  overflow-y: scroll; /* CHANGED: Always show scrollbar area */
  overflow-x: hidden;
  padding: 1.5rem 1.2rem;
  scroll-behavior: smooth;
  min-height: 200px;
  max-height: calc(100vh - 120px); /* Account for header */
}

/* Custom Scrollbar */
.insight-content-scroll::-webkit-scrollbar {
  width: 8px;
}

.insight-content-scroll::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.insight-content-scroll::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  border-radius: 10px;
}

.insight-content-scroll::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(135deg, var(--primary-dark), var(--deep-pink));
}

/* Welcome State */
.insight-welcome {
  text-align: center;
  padding: 2rem 1rem;
}

.welcome-icon {
  font-size: 3.5rem;
  margin-bottom: 1rem;
  animation: pointDown 1.5s ease-in-out infinite;
}

@keyframes pointDown {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(10px); }
}

.insight-welcome h4 {
  font-size: 1.4rem;
  margin-bottom: 0.8rem;
  color: var(--primary);
}

.insight-welcome p {
  color: var(--text-soft);
  margin-bottom: 1rem;
}

.welcome-list {
  list-style: none;
  text-align: left;
  max-width: 320px;
  margin: 0 auto 1.5rem;
}

.welcome-list li {
  padding: 0.5rem 0;
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.check-icon {
  width: 24px;
  height: 24px;
  background: linear-gradient(135deg, var(--success), #4caf50);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  flex-shrink: 0;
}

.explore-hint {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.08), rgba(237, 231, 246, 0.4));
  padding: 1rem;
  border-radius: 12px;
  font-weight: 600;
  color: var(--primary);
}

.pulse-dot {
  width: 12px;
  height: 12px;
  background: var(--primary);
  border-radius: 50%;
  animation: pulseDot 2s ease infinite;
}

@keyframes pulseDot {
  0%, 100% { 
    transform: scale(1); 
    opacity: 1; 
  }
  50% { 
    transform: scale(1.5); 
    opacity: 0.5; 
  }
}

/* Content Wrapper */
.insight-content-wrapper h4 {
  color: var(--primary);
  margin-top: 1.5rem;
  margin-bottom: 0.8rem;
  font-size: 1.15rem;
}

.insight-content-wrapper ul {
  margin-left: 1.2rem;
  margin-bottom: 1rem;
}

.insight-content-wrapper li {
  margin-bottom: 0.5rem;
  line-height: 1.6;
}

.insight-content-wrapper strong {
  color: var(--primary);
}

/* Footer Note */
.insight-footer-note {
  background: linear-gradient(135deg, #fff9c4, #fff59d);
  border-left: 4px solid #fbc02d;
  padding: 1rem;
  border-radius: 8px;
  margin-top: 1.5rem;
  display: flex;
  gap: 0.75rem;
}

.note-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.insight-footer-note p {
  margin: 0;
  font-size: 0.9rem;
  color: #555;
}

/* Related Topics */
.related-topics {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 2px solid #f0f0f0;
}

.related-topics h5 {
  font-size: 0.95rem;
  color: var(--text-soft);
  margin-bottom: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.topic-pills {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.topic-pill {
  display: inline-block;
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.1), rgba(237, 231, 246, 0.3));
  border: 1.5px solid rgba(236, 64, 122, 0.2);
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--primary);
  cursor: pointer;
  transition: all 0.3s ease;
}

.topic-pill:hover {
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.2), rgba(237, 231, 246, 0.5));
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.3);
}

/* Action Buttons */
.insight-actions-v2 {
  padding: 1rem 1.2rem;
  border-top: 2px solid #f5f5f5;
  display: flex;
  gap: 0.75rem;
  background: #fafafa;
}

.insight-btn {
  flex: 1;
  padding: 0.75rem 1rem;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  transition: all 0.3s ease;
}

.insight-btn.primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.3);
}

.insight-btn.primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(236, 64, 122, 0.4);
}

.insight-btn.secondary {
  background: white;
  border: 2px solid #e0e0e0;
  color: var(--text-main);
}

.insight-btn.secondary:hover {
  background: #f5f5f5;
  border-color: var(--primary);
  transform: translateY(-2px);
}

.btn-icon {
  font-size: 1.1rem;
}

/* Close Button - Properly Positioned */
.insight-close-v2 {
  position: absolute;
  top: 1rem;
  right: 1rem;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  border: 2px solid rgba(255, 255, 255, 0.5);
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  z-index: 10;
}

.insight-close-v2:hover {
  background: rgba(255, 255, 255, 0.5);
  transform: rotate(90deg);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.close-icon {
  line-height: 1;
}

/* Panel Entrance Animation */
.insight-entering {
  animation: insightSlideIn 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
}

@keyframes insightSlideIn {
  from {
    opacity: 0;
    transform: translateX(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateX(0) scale(1);
  }
}

/* ===================================================================
   Scan Modal - Baby Visualization
   =================================================================== */

.scan-modal-content {
  display: grid;
  grid-template-columns: 1fr 1.2fr;
  gap: 2rem;
  margin-top: 1rem;
}

.scan-visual-section {
  background: linear-gradient(135deg, #ffe5f0 0%, #ffc4dd 100%);
  border-radius: 16px;
  padding: 2rem 1.5rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.5rem;
}

.baby-illustration {
  width: 100%;
  max-width: 200px;
  animation: babyBreath 3s ease-in-out infinite;
}

@keyframes babyBreath {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

.baby-svg {
  width: 100%;
  height: auto;
  filter: drop-shadow(0 4px 12px rgba(255, 64, 129, 0.3));
}

.heartbeat-dot {
  animation: heartBeat 1.2s ease-in-out infinite;
  transform-origin: center;
}

@keyframes heartBeat {
  0%, 100% { 
    transform: scale(1); 
    opacity: 1;
  }
  15% { 
    transform: scale(1.3); 
    opacity: 0.8;
  }
  30% { 
    transform: scale(1); 
    opacity: 1;
  }
}

.baby-stats {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.stat-badge {
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.stat-icon {
  font-size: 1.5rem;
}

.stat-label {
  font-size: 0.9rem;
  color: var(--text-soft);
}

.stat-label strong {
  color: var(--primary);
  font-weight: 700;
}

.scan-info-section h4 {
  color: var(--primary);
  margin-bottom: 1rem;
}

.scan-timing {
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.1), rgba(237, 231, 246, 0.3));
  padding: 0.75rem 1rem;
  border-radius: 10px;
  border-left: 4px solid var(--primary);
  font-weight: 600;
}

.scan-checklist {
  margin-top: 1.5rem;
}

.scan-checklist h5 {
  font-size: 1rem;
  color: var(--text-main);
  margin-bottom: 0.75rem;
}

.scan-checklist ul {
  list-style: none;
  padding: 0;
}

.scan-checklist li {
  padding: 0.5rem 0;
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  line-height: 1.6;
}

.check-mark {
  color: var(--success);
  font-weight: 900;
  font-size: 1.1rem;
  flex-shrink: 0;
}

.development-insight {
  margin-top: 1.5rem;
  background: linear-gradient(135deg, #fff5f8, #ffe5ec);
  border-radius: 12px;
  padding: 1.25rem;
  border: 2px solid rgba(236, 64, 122, 0.15);
  display: flex;
  gap: 1rem;
  animation: gentlePulse 3s ease-in-out infinite;
}

@keyframes gentlePulse {
  0%, 100% { 
    box-shadow: 0 2px 8px rgba(236, 64, 122, 0.15); 
  }
  50% { 
    box-shadow: 0 4px 16px rgba(236, 64, 122, 0.25); 
  }
}

.insight-icon-small {
  font-size: 2rem;
  flex-shrink: 0;
}

.development-insight h5 {
  font-size: 1.05rem;
  color: var(--primary);
  margin-bottom: 0.5rem;
}

.development-insight p {
  font-size: 0.95rem;
  line-height: 1.7;
  color: var(--text-main);
}

.scan-footer-tip {
  margin-top: 1.5rem;
  background: linear-gradient(135deg, #fff9c4, #fff59d);
  border-left: 4px solid #fbc02d;
  padding: 1rem;
  border-radius: 8px;
  font-size: 0.9rem;
}

.scan-footer-tip strong {
  color: #f57f17;
}

/* ===================================================================
   Enhanced Hotspot Animations
   =================================================================== */

.hotspot.v3 {
  animation: hotspotFloat 3s ease-in-out infinite;
}

@keyframes hotspotFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}

.hotspot:hover {
  transform: scale(1.1) translateY(-4px) !important;
  z-index: 10;
}

.hotspot:hover .hotspot-icon {
  transform: scale(1.15);
  filter: drop-shadow(0 0 8px rgba(236, 64, 122, 0.6));
}

.hotspot:hover .hotspot-label {
  opacity: 1;
  transform: translateY(0);
}

/* ===================================================================
   REVOLUTIONARY SCAN ENHANCEMENTS - Type Badges & Animations
   =================================================================== */

/* Scan Type Badges */
.scan-type-badge {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark)) !important;
  color: white !important;
  font-weight: 700;
  border: none !important;
  animation: badgeGlow 2s ease-in-out infinite;
}

.scan-type-2d {
  background: linear-gradient(135deg, #42a5f5, #1976d2) !important;
}

.scan-type-doppler {
  background: linear-gradient(135deg, #ff6b9d, #c44569) !important;
  animation: dopplerPulse 2s ease-in-out infinite;
}

.scan-type-3d4d {
  background: linear-gradient(135deg, #9c27b0, #6a1b9a) !important;
  animation: sparkle3D 3s ease-in-out infinite;
}

.scan-type-bpp {
  background: linear-gradient(135deg, #66bb6a, #388e3c) !important;
  animation: bppDataPulse 2s ease-in-out infinite;
}

.scan-type-nst {
  background: linear-gradient(135deg, #ffa726, #f57c00) !important;
  animation: heartbeatPulse 1s ease-in-out infinite;
}

@keyframes badgeGlow {
  0%, 100% { 
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); 
  }
  50% { 
    box-shadow: 0 4px 16px rgba(236, 64, 122, 0.4); 
  }
}

@keyframes dopplerPulse {
  0%, 100% { 
    box-shadow: 0 2px 8px rgba(255, 107, 157, 0.3); 
  }
  50% { 
    box-shadow: 0 4px 20px rgba(255, 107, 157, 0.6); 
  }
}

@keyframes sparkle3D {
  0%, 100% { 
    box-shadow: 0 2px 8px rgba(156, 39, 176, 0.3); 
  }
  50% { 
    box-shadow: 0 4px 20px rgba(156, 39, 176, 0.6); 
  }
}

@keyframes bppDataPulse {
  0%, 100% { 
    box-shadow: 0 2px 8px rgba(102, 187, 106, 0.3); 
  }
  50% { 
    box-shadow: 0 4px 20px rgba(102, 187, 106, 0.6); 
  }
}

@keyframes heartbeatPulse {
  0%, 100% { 
    transform: scale(1); 
  }
  50% { 
    transform: scale(1.05); 
  }
}

/* Enhanced Scan Card Visuals for New Scan Types */
.scan-visual.doppler {
  background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
  position: relative;
  overflow: hidden;
}

.scan-visual.doppler::before {
  content: '';
  position: absolute;
  font-size: 2.5rem;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: flowPulse 2s ease-in-out infinite;
}

@keyframes flowPulse {
  0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
  50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
}

.scan-visual.threedfourd {
  background: linear-gradient(135deg, #9c27b0 0%, #6a1b9a 100%);
  position: relative;
  overflow: hidden;
}

.scan-visual.threedfourd::before {
  content: '';
  position: absolute;
  font-size: 2.5rem;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: threedSpin 4s ease-in-out infinite;
}

@keyframes threedSpin {
  0%, 100% { transform: translate(-50%, -50%) rotateY(0deg); }
  50% { transform: translate(-50%, -50%) rotateY(15deg); }
}

.scan-visual.bpp {
  background: linear-gradient(135deg, #66bb6a 0%, #388e3c 100%);
  position: relative;
  overflow: hidden;
}

.scan-visual.bpp::before {
  content: '';
  position: absolute;
  font-size: 2.5rem;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: dataPulse 2s ease-in-out infinite;
}

@keyframes dataPulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

.scan-visual.nst {
  background: linear-gradient(135deg, #ffa726 0%, #f57c00 100%);
  position: relative;
  overflow: hidden;
}

.scan-visual.nst::before {
  content: '';
  position: absolute;
  font-size: 2.5rem;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: heartbeatBounce 1s ease-in-out infinite;
}

@keyframes heartbeatBounce {
  0%, 100% { transform: translate(-50%, -50%) scale(1); }
  50% { transform: translate(-50%, -50%) scale(1.15); }
}

/* Enhanced Scan Card Hover Effects */
.scan-card {
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.scan-card::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(
    45deg,
    transparent 30%,
    rgba(255, 255, 255, 0.3) 50%,
    transparent 70%
  );
  transform: rotate(45deg);
  transition: all 0.6s ease;
  opacity: 0;
}

.scan-card:hover::after {
  animation: scanCardSweep 1.5s ease-in-out;
}

@keyframes scanCardSweep {
  0% { 
    left: -50%;
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% { 
    left: 150%;
    opacity: 0;
  }
}

/* Mobile Responsive Adjustments */
@media (max-width: 768px) {
  .insight-panel-v2 {
    width: 100vw;
    right: -100vw;
  }
  
  .scan-modal-content {
    grid-template-columns: 1fr;
  }
  
  .scan-visual-section {
    order: -1;
  }
}

/* ================================
   COMMUNITY SECTION
   ================================ */
.community-section {
  padding: 3rem 0;
  background: linear-gradient(135deg, rgba(237,231,246,0.1), rgba(236,64,122,0.1));
  border-radius: 30px;
  margin: 2rem 0;
}

.community-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2rem;
  margin-top: 3rem;
}

.community-card {
  background: white;
  padding: 2.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  text-align: center;
  transition: all 0.3s;
  border: 2px solid transparent;
  position: relative;
}

.community-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(255,107,157,0.2);
  border-color: var(--primary-light);
}

.community-card.clickable {
  cursor: pointer;
}

.card-icon-animated {
  font-size: 4rem;
  margin-bottom: 1rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

.card-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 700;
  color: white;
}

.card-badge.live {
  background: #66bb6a;
  animation: livePulse 1.5s ease-in-out infinite;
}

.card-badge.popular {
  background: #ec407a;
}

.card-badge.expert {
  background: #4facfe;
}

.card-badge.global {
  background: #9c27b0;
}

.card-badge.inspiring {
  background: #ffa726;
}

@keyframes livePulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

.community-card h3 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--primary-dark);
}

.community-card p {
  color: var(--text-soft);
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.community-stats {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
}

.stat {
  background: rgba(255,107,157,0.1);
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--primary-dark);
  display: flex;
  align-items: center;
  gap: 0.3rem;
}

.stat-icon {
  font-size: 1rem;
}

.stat-text {
  font-size: 0.8rem;
}

.live-activity {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
  font-size: 0.85rem;
  color: #66bb6a;
  font-weight: 600;
}

.activity-dot {
  width: 8px;
  height: 8px;
  background: #66bb6a;
  border-radius: 50%;
  animation: livePulse 1.5s ease-in-out infinite;
}

.recent-topics, .channel-preview, .reddit-highlights, .next-session, .story-preview, .expert-panel {
  margin-top: 1rem;
  padding: 1rem;
  background: rgba(236,64,122,0.05);
  border-radius: 12px;
  text-align: left;
}

.recent-topics h4, .channel-preview h4, .reddit-highlights h4, .next-session h4, .expert-panel h4 {
  font-size: 0.9rem;
  margin-bottom: 0.8rem;
  color: var(--text-main);
}

.recent-topics ul, .reddit-highlights ul, .expert-panel ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.recent-topics li, .reddit-highlights li, .expert-panel li {
  padding: 0.4rem 0;
  font-size: 0.85rem;
  color: var(--text-soft);
}

.recent-topics li:before, .reddit-highlights li:before {
  content: ' ';
  color: #ec407a;
  font-weight: 700;
}

.expert-panel li:before {
  content: ' ';
  color: #ec407a;
  font-weight: 700;
}

.channel-preview p, .next-session p {
  font-size: 0.85rem;
  color: var(--text-soft);
  margin: 0.3rem 0;
}

.story-quote {
  font-style: italic;
  color: var(--text-soft);
  line-height: 1.7;
  font-size: 0.95rem;
}

.location-finder {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
}

.city-input {
  flex: 1;
  padding: 0.8rem;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  font-family: 'Manrope', sans-serif;
  font-size: 0.9rem;
}

.find-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.find-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(236,64,122,0.3);
}

.community-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.community-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255,107,157,0.3);
}

.btn-arrow {
  font-size: 1.2rem;
  transition: transform 0.3s;
}

.community-card:hover .btn-arrow {
  transform: translateX(5px);
}

/* Community Guidelines */
.community-guidelines {
  margin-top: 3rem;
  background: white;
  padding: 3rem;
  border-radius: 30px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.community-guidelines h3 {
  text-align: center;
  margin-bottom: 2rem;
  font-size: 2rem;
  color: var(--text-main);
}

.guidelines-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 2rem;
}

.guideline-item {
  text-align: center;
}

.guideline-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  display: block;
}

.guideline-item h4 {
  font-size: 1.1rem;
  margin-bottom: 0.5rem;
  color: #ec407a;
}

.guideline-item p {
  color: var(--text-soft);
  font-size: 0.9rem;
}

/* Responsive */
@media(max-width:1100px){
  .hero{grid-template-columns:1fr; gap:2rem;}
  .pregnancy-3d-container{height:460px;}
  .control-grid, .split, .triage, .wellness-grid, .postpartum-grid, .birth-plan-builder, .vaccine-interactive{grid-template-columns:1fr;}
  .kick-counter-interactive{grid-template-columns:1fr;}
  .visit-sim-grid{grid-template-columns:1fr;}
  .test-grid, .scan-grid, .food-grid, .discomfort-grid, .scenario-grid{grid-template-columns:1fr 1fr;}
}

@media(max-width:900px){
  /* New medical sections responsive */
  div[style*="grid-template-columns:repeat(auto-fit,minmax(320px,1fr))"],
  div[style*="grid-template-columns:repeat(auto-fit,minmax(300px,1fr))"],
  div[style*="grid-template-columns:repeat(auto-fit,minmax(280px,1fr))"] {
    grid-template-columns: 1fr !important;
  }
  div[style*="grid-template-columns:1.2fr 0.8fr"],
  div[style*="grid-template-columns:1fr 1fr"] {
    grid-template-columns: 1fr !important;
  }
}

@media(max-width:768px){
  /* Section padding adjustments */
  section[style*="padding:4rem 0"] {
    padding: 3rem 0 !important;
  }
  div[style*="max-width:1300px"] {
    padding: 0 1.5rem !important;
  }
  /* Card padding */
  div[style*="padding:2rem"],
  div[style*="padding:2.5rem"] {
    padding: 1.5rem !important;
  }
  /* Text sizing */
  .section-title-prominent {
    font-size: 2rem !important;
  }
  .section-subtitle-prominent {
    font-size: 1rem !important;
  }
}

@media(max-width:600px){
  .page-shell{padding:0 1rem;}
  .test-grid, .scan-grid, .food-grid, .discomfort-grid, .scenario-grid{grid-template-columns:1fr;}
  
  /* Further mobile adjustments for new sections */
  section[style*="padding:4rem 0"],
  section[style*="padding:3rem 0"] {
    padding: 2rem 0 !important;
  }
  div[style*="padding:2rem"],
  div[style*="padding:2.5rem"],
  div[style*="padding:1.8rem"] {
    padding: 1rem !important;
  }
  /* Grid gaps */
  div[style*="gap:2rem"] {
    gap: 1rem !important;
  }
  .section-title-prominent {
    font-size: 1.6rem !important;
  }
  .section-subtitle-prominent {
    font-size: 0.9rem !important;
  }
}


/* =====================================================
   COMPREHENSIVE MOBILE RESPONSIVENESS ENHANCEMENTS
   ===================================================== */

/* ---- Page Shell ---- */
@media(max-width:768px){
  .page-shell{padding:0 1rem;}
}

/* ---- HERO ---- */
@media(max-width:1100px){
  .hero{
    grid-template-columns:1fr;
    padding:2.5rem 1.5rem 2rem;
    border-radius:20px;
    min-height:auto;
    gap:2.5rem;
  }
  .hero-content{order:1;}
  .hero-visual-3d{order:2;}
}

@media(max-width:768px){
  .hero{
    padding:2rem 1rem 1.5rem;
    border-radius:16px;
    gap:2rem;
  }
  .hero-title-3d{font-size:clamp(1.8rem,7vw,2.4rem);}
  .hero-subtitle{font-size:1rem;}
  .hero-stats{
    grid-template-columns:repeat(3,1fr);
    gap:.6rem;
  }
  .stat-number{font-size:1.4rem;}
  .stat-label{font-size:.75rem;}
  .hero-cta-row{flex-direction:column; gap:.75rem;}
  .btn-primary,.btn-secondary{width:100%; text-align:center; padding:.9rem 1.5rem; font-size:.95rem;}
  .daily-tip{padding:1rem; gap:.75rem;}
  .tip-icon{font-size:1.5rem;}
  .daily-tip p{font-size:.9rem;}
}

@media(max-width:480px){
  .hero{padding:1.5rem .75rem 1.5rem;}
  .hero-title-3d{font-size:1.65rem;}
  .hero-stats{grid-template-columns:1fr; gap:.5rem;}
  .hero-badge{padding:.5rem 1rem; font-size:.82rem;}
  .badge-text{font-size:.82rem;}
}

/* ---- HERO VISUAL / 3D Container ---- */
@media(max-width:1100px){
  .pregnancy-3d-container{height:380px;}
  .pregnancy-core{width:340px; height:340px;}
  .ring-1{width:140px;height:140px;}
  .ring-2{width:220px;height:220px;}
  .ring-3{width:300px;height:300px;}
  .center-glow{width:85px;height:85px;}
  /* Scale down orbit translations for smaller container */
  @keyframes orbit1{0%,100%{transform:translate(-145px,0);}25%{transform:translate(-150px,-8px);}50%{transform:translate(-145px,0);}75%{transform:translate(-140px,8px);}}
  @keyframes orbit2{0%,100%{transform:translate(-102px,-102px);}25%{transform:translate(-107px,-107px);}50%{transform:translate(-102px,-102px);}75%{transform:translate(-97px,-97px);}}
  @keyframes orbit3{0%,100%{transform:translate(102px,-102px);}25%{transform:translate(107px,-107px);}50%{transform:translate(102px,-102px);}75%{transform:translate(97px,-97px);}}
  @keyframes orbit4{0%,100%{transform:translate(145px,0);}25%{transform:translate(150px,8px);}50%{transform:translate(145px,0);}75%{transform:translate(140px,-8px);}}
  @keyframes orbit5{0%,100%{transform:translate(-102px,102px);}25%{transform:translate(-107px,107px);}50%{transform:translate(-102px,102px);}75%{transform:translate(-97px,97px);}}
}

@media(max-width:768px){
  .pregnancy-3d-container{height:320px;}
  .pregnancy-core{width:280px; height:280px;}
  .ring-1{width:110px;height:110px;}
  .ring-2{width:180px;height:180px;}
  .ring-3{width:250px;height:250px;}
  .week-dial{width:170px; padding:.9rem; bottom:10px; right:10px;}
  .reading-value{font-size:1.8rem;}
  .health-icon{padding:.7rem .9rem;}
  .icon-inner{font-size:1.5rem;}
  .hero-info-box{padding:1.5rem; margin-top:1rem;}
  .info-title{font-size:1.2rem;}
}

@media(max-width:480px){
  .pregnancy-3d-container{height:260px;}
  .pregnancy-core{width:220px; height:220px;}
  .ring-1{width:85px;height:85px;}
  .ring-2{width:140px;height:140px;}
  .ring-3{width:195px;height:195px;}
  .health-icon{padding:.55rem .7rem;}
  .icon-inner{font-size:1.25rem;}
  .icon-label{font-size:.65rem;}
  .week-dial{width:140px; padding:.7rem; font-size:.85rem;}
  .reading-value{font-size:1.4rem;}
  .meter-status{font-size:.72rem;}
}

/* ---- SECTION HEADERS ---- */
@media(max-width:768px){
  .section-header{margin:0 0 1.5rem;}
  .header-badge-prominent{padding:.6rem 1.2rem; font-size:.85rem;}
  .section-title-prominent{font-size:clamp(1.5rem,5vw,2.2rem);}
  .section-subtitle-prominent{
    font-size:.92rem;
    padding:1.2rem 1.2rem;
    line-height:1.75;
  }
}

/* ---- JOURNEY / TIMELINE ---- */
@media(max-width:900px){
  .timeline-container{
    grid-template-columns:repeat(2,1fr);
    gap:1rem;
  }
  .timeline-rail{display:none;}
}

@media(max-width:600px){
  .timeline-container{
    grid-template-columns:1fr;
    gap:.8rem;
    padding:1rem 0;
  }
  .timeline-stage{
    display:flex;
    align-items:center;
    gap:1rem;
    text-align:left;
    padding:.75rem;
    background:#fff;
    border-radius:16px;
    box-shadow:0 4px 12px rgba(0,0,0,0.06);
    border:2px solid rgba(236,64,122,0.1);
  }
  .stage-marker{width:56px;height:56px;margin:0;flex-shrink:0;}
  .marker-dot{width:56px;height:56px;font-size:1.4rem;}
  .stage-content{flex:1;}
  .stage-title{font-size:1rem;margin-bottom:.15rem;}
  .stage-desc{font-size:.82rem;}
  .stage-icon{margin-top:.2rem;font-size:1.5rem;}
}

/* ---- VISIT SIMULATOR ---- */
@media(max-width:768px){
  .visit-sim{padding:1.5rem;}
  .visit-sim-header h3{font-size:1.3rem;}
  .visit-sim-grid{grid-template-columns:1fr; gap:1rem; margin-top:1rem;}
  .visit-metrics{grid-template-columns:1fr 1fr; gap:.75rem;}
}

@media(max-width:480px){
  .visit-metrics{grid-template-columns:1fr; gap:.6rem;}
  .metric-card{min-height:auto; padding:.85rem;}
  .metric-controls input{width:60px;}
}

/* ---- STAGE DETAIL PANEL ---- */
@media(max-width:768px){
  .stage-detail-panel{padding:1.2rem;}
}

/* ---- CONTROL GRID / BODY STAGE / INSIGHT ---- */
@media(max-width:1100px){
  .control-grid{grid-template-columns:1fr;}
  .insight-panel{position:static; margin-top:1rem;}
}

@media(max-width:768px){
  .body-stage{padding:1.2rem;}
  .body-stage-top{flex-direction:column;}
  .week-slider-container{min-width:0; width:100%;}
  .body-canvas{min-height:480px;}
  .body-svg-2{height:480px;}
  .insight-panel{padding:1.2rem;}
  .insight-actions{flex-direction:column; gap:.6rem;}
  .insight-actions .btn-primary,
  .insight-actions .btn-secondary{width:100%;}
}

@media(max-width:480px){
  .body-canvas{min-height:380px;}
  .body-svg-2{height:380px;}
}

/* ---- TESTS / SCANS SPLIT ---- */
@media(max-width:900px){
  .split{grid-template-columns:1fr;}
}

@media(max-width:768px){
  .card-surface{padding:1.2rem;}
  .test-grid{grid-template-columns:1fr 1fr;}
  .scan-grid{grid-template-columns:1fr 1fr;}
}

@media(max-width:480px){
  .test-grid{grid-template-columns:1fr;}
  .scan-grid{grid-template-columns:1fr;}
  .test-card,.scan-card{padding:.9rem;}
  .test-name{font-size:.95rem;}
}

/* ---- VACCINE SECTION ---- */
@media(max-width:900px){
  .vaccine-interactive{grid-template-columns:1fr;}
  .vaccine-detail-panel{min-height:auto;}
}

@media(max-width:480px){
  .vaccine-interactive{padding:1.2rem;}
  .vaccine-item{padding:.9rem; gap:.75rem;}
  .vaccine-icon{font-size:1.8rem;}
  .vaccine-info h3{font-size:.95rem;}
}

/* ---- ANTIBODY TRANSFER PANEL ---- */
@media(max-width:768px){
  .antibody-transfer-panel{padding:1.2rem;}
  .transfer-visualization-container{height:260px;}
  .transfer-facts{grid-template-columns:1fr;}
  .transfer-controls{flex-direction:column; align-items:stretch;}
  .control-btn{width:100%; justify-content:center;}
  .transfer-header h3{font-size:1.3rem;}
}

@media(max-width:480px){
  .transfer-visualization-container{height:220px;}
  .fact-card{flex-direction:row;}
}

/* ---- WELLNESS SECTION ---- */
@media(max-width:900px){
  .wellness-grid{grid-template-columns:1fr;}
}

@media(max-width:768px){
  .nutrient-slots{grid-template-columns:1fr 1fr; gap:.75rem;}
  .food-grid{grid-template-columns:1fr 1fr; gap:.6rem;}
  .discomfort-grid{grid-template-columns:1fr 1fr; gap:.6rem;}
  .avoid-grid{grid-template-columns:1fr 1fr; gap:.75rem;}
}

@media(max-width:480px){
  .nutrient-slots{grid-template-columns:1fr;}
  .food-grid{grid-template-columns:repeat(3,1fr); gap:.5rem;}
  .food-item{padding:.65rem .5rem;}
  .food-icon{font-size:1.6rem;}
  .food-name{font-size:.78rem;}
  .food-nutrients{font-size:.7rem;}
  .discomfort-grid{grid-template-columns:repeat(2,1fr);}
  .avoid-grid{grid-template-columns:1fr;}
  .score-circle-container{width:120px; height:120px;}
}

/* ---- WARNING / TRIAGE ---- */
@media(max-width:900px){
  .triage{grid-template-columns:1fr;}
}

@media(max-width:768px){
  .scenario-grid{grid-template-columns:1fr 1fr; gap:.6rem;}
  .triage-actions{flex-direction:column; gap:.6rem;}
  .triage-actions .btn-primary,
  .triage-actions .btn-secondary{width:100%;}
}

@media(max-width:480px){
  .scenario-grid{grid-template-columns:1fr;}
  .scenario-card{padding:.85rem;}
}

/* ---- KICK COUNTER ---- */
@media(max-width:900px){
  .kick-counter-interactive{grid-template-columns:1fr; gap:1rem;}
  .baby-outline-kick{height:260px;}
}

@media(max-width:480px){
  .kick-count-circle{width:130px;height:130px;}
  .count-number{font-size:2.4rem;}
  .kick-controls{flex-direction:column; gap:.6rem;}
  .kick-controls .btn-primary,
  .kick-controls .btn-secondary{width:100%;}
  .baby-outline-kick{height:220px;}
}

/* ---- BIRTH PLAN V2 ---- */
@media(max-width:1200px){
  .birth-journey-builder{grid-template-columns:1fr;}
  .journey-stages-nav{
    position:static;
    flex-direction:row;
    overflow-x:auto;
    padding:1rem;
    gap:1rem;
    -webkit-overflow-scrolling:touch;
  }
  .stages-timeline-line{display:none;}
  .journey-stage-btn{min-width:180px; flex-shrink:0;}
  .journey-stage-btn:hover{transform:none;}
  .journey-stage-btn.active{transform:scale(1.02);}
  .birth-plan-live-preview{position:static; max-height:none;}
}

@media(max-width:768px){
  .birth-stage-content{padding:1.2rem; min-height:auto;}
  .preference-cards-grid{grid-template-columns:1fr 1fr; gap:1rem;}
  .stage-content-title{font-size:1.4rem;}
  .birth-plan-quick-actions{gap:1rem;}
  .quick-action-btn{min-width:110px; padding:1rem 1.2rem;}
  .birth-education-cards{grid-template-columns:1fr 1fr;}
  .birth-plan-progress-ring{margin:1rem 0 2rem;}
}

@media(max-width:480px){
  .preference-cards-grid{grid-template-columns:1fr;}
  .birth-education-cards{grid-template-columns:1fr;}
  .birth-plan-quick-actions{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:.75rem;
  }
  .quick-action-btn{min-width:0; width:100%;}
  .toggle-preference{flex-direction:row; gap:.75rem; padding:1rem;}
  .toggle-label{font-size:.9rem;}
}

/* ---- POSTPARTUM ---- */
@media(max-width:900px){
  .postpartum-grid{grid-template-columns:1fr;}
}

@media(max-width:480px){
  .check-item{flex-direction:row; gap:.75rem;}
  .mood-cards{gap:.75rem;}
}

/* ---- COMMUNITY ---- */
@media(max-width:600px){
  .community-card{padding:1.8rem 1.4rem;}
  .community-guidelines{padding:1.5rem 1rem;}
  .community-guidelines h3{font-size:1.4rem;}
}

/* ---- MODAL ---- */
@media(max-width:600px){
  .modal-content{
    width:96vw;
    max-height:92vh;
    padding:1.2rem 1rem 1rem;
    border-radius:18px;
  }
  #modalBody{max-height:calc(92vh - 120px);}
  .scan-modal-content{grid-template-columns:1fr;}
  .scan-visual-section{order:-1; padding:1.5rem 1rem;}
}

/* ---- WEEK COMPARISON CHART ---- */
@media(max-width:600px){
  .week-comparison-chart h3{font-size:1.3rem;}
  .comparison-grid{grid-template-columns:1fr;}
}

/* ---- INSIGHT PANEL V2 ---- */
@media(max-width:768px){
  .insight-panel-v2{
    width:100vw !important;
    right:-100vw !important;
    border-radius:20px 20px 0 0;
    top:auto !important;
    bottom:0;
    height:85vh;
    max-height:85vh;
  }
  .insight-panel-v2.open{
    right:0 !important;
    transform:translateY(0) !important;
  }
  .insight-content-scroll{max-height:calc(85vh - 120px);}
  .insight-actions-v2{flex-direction:column; gap:.6rem;}
  .insight-btn{width:100%;}
}

/* ---- FOOTER ---- */
@media(max-width:600px){
  .footer-inner{flex-direction:column; text-align:center; padding:1rem; gap:1rem;}
  .site-footer{padding:2rem 0 3rem;}
}

/* ---- MEMORY / DRILL ROW ---- */
@media(max-width:480px){
  .drill-row{flex-direction:column; align-items:stretch;}
  .drill-row input{width:100%;}
}

/* ---- TRANSFER TIMELINE ---- */
@media(max-width:480px){
  .timeline-labels{font-size:.75rem;}
}

/* ---- GENERAL: overflow safety ---- */
@media(max-width:768px){
  .hero-constellation-bg,
  .pregnancy-3d-container,
  .body-canvas,
  .baby-outline-kick{
    overflow:hidden;
  }
  /* Ensure no horizontal scroll from orbit animations */
  .hero{overflow:hidden;}
}

/* ---- TOUCH / TAP IMPROVEMENTS ---- */
@media(hover:none) and (pointer:coarse){
  .hotspot-label{opacity:1; transform:translateX(-50%); font-size:.7rem;}
  .nav-dropdown{display:none;}
  .health-icon:hover{transform:none !important;}
  .scan-card:hover::after{animation:none;}
}

/* ---- PREVENT TEXT OVERFLOW ---- */
@media(max-width:480px){
  .logo-text a{font-size:1.05rem;}
  .logo-text span{font-size:.55rem;}
  .hero-badge .badge-text{font-size:.78rem;}
  .section-title-prominent{font-size:1.5rem !important;}
  .section-subtitle-prominent{font-size:.88rem !important; padding:1rem;}
  .visit-sim-header h3{font-size:1.15rem;}
}

/* ---- PREVENT HOTSPOT OVERFLOW ON MOBILE ---- */
@media(max-width:600px){
  .hotspot{
    display:none; /* hide floating hotspots on small screens to avoid overflow */
  }
}

/* ---- DAILY TIP RESPONSIVE ---- */
@media(max-width:600px){
  .daily-tip{flex-direction:column; align-items:flex-start; gap:.5rem; padding:1rem;}
  .tip-icon{font-size:1.6rem;}
}

/* ---- SCAN VISUAL HEIGHT RESPONSIVE ---- */
@media(max-width:480px){
  .scan-visual{height:90px;}
}

/* ---- COMPARISON CARD ANIMATIONS: PRESERVED ---- */
/* All @keyframes animations are maintained as-is. Only layout/sizing adjusted. */

/* ---- PRINT / MEDIA SAFETY ---- */
@media(max-width:360px){
  .page-shell{padding:0 .75rem;}
  .hero{padding:1.2rem .75rem 1.2rem;}
  .hero-title-3d{font-size:1.45rem;}
  .visit-metrics{grid-template-columns:1fr;}
  .nutrient-slots{grid-template-columns:1fr;}
  .food-grid{grid-template-columns:1fr 1fr;}
}

</style>

<body>
  <!-- SVG Definitions for Progress Ring -->
  <svg width="0" height="0" style="position: absolute;">
    <defs>
      <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#ec407a;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#d81b60;stop-opacity:1" />
      </linearGradient>
    </defs>
  </svg>

  <!-- ===== HEADER ===== -->
<header class="site-header">
  <div class="nav-container">
    <!-- Logo -->
    <div class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="white">
          <circle cx="12" cy="5.5" r="2.8"/>
          <path d="M9.3 4.8 Q9.1 2.5 12 2.2 Q14.9 2.5 14.7 4.8" opacity="0.7"/>
          <path d="M9.5 13.2 Q9 10.5 10 9.3 Q11 8.6 12 8.6 Q13 8.6 14 9.3 Q15 10.5 14.5 13.2Z"/>
          <path d="M9.5 13.2 Q7.2 13.8 6.8 16.2 Q7.8 16.4 8.8 15Z" opacity="0.85"/>
          <path d="M14.5 13.2 Q16.8 13.8 17.2 16.2 Q16.2 16.4 15.2 15Z" opacity="0.85"/>
          <path d="M8.8 15 Q8.2 17.5 9.5 19.5 Q11 21 12 21 Q13 21 14.5 19.5 Q15.8 17.5 15.2 15Z"/>
        </svg>
      </div>
      <div class="logo-text">
        <a href="index.html">Nari Swasthya</a>
        <span>Women's Health Platform</span>
      </div>
    </div>

    <nav class="main-nav" aria-label="Main navigation">

      <!-- Home -->
      <div class="nav-item"><a href="index.html" class="nav-link">Home</a></div>

      <!-- Journeys dropdown -->
      <div class="nav-item">
        <button class="nav-link" aria-haspopup="true">Journeys <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown">
          <a href="journeys.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
            <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;box-shadow:0 4px 12px rgba(236,64,122,0.35);"><i class="fa-solid fa-map"></i></div>
            <div><strong style="display:block;font-size:.82rem;color:var(--deep-pink);">View Full Journeys</strong><span style="font-size:.73rem;color:var(--text-soft);">Browse all her journeys</span></div>
          </a>
          <div class="dd-sep"></div>
          <a href="conceiving.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Conceiving</strong><span style="font-size:.73rem;color:var(--text-soft);">Preparation &amp; planning</span></div></a>
          <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-dna"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:var(--text-soft);">Cycle &amp; ovulation</span></div></a>
          <!-- Pregnancy Journey with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-baby-carriage"></i></div>
            <a href="pregnancy_journey.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Pregnancy Journey</strong><span style="font-size:.73rem;color:var(--text-soft);">Week by week guide</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="normal_delivery.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-circle-check"></i></div><div><strong style="display:block;font-size:.82rem;">Normal Delivery</strong><span style="font-size:.73rem;color:var(--text-soft);">Vaginal birth guide</span></div></a>
              <a href="csection.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-hospital"></i></div><div><strong style="display:block;font-size:.82rem;">C-Section</strong><span style="font-size:.73rem;color:var(--text-soft);">Surgical birth info</span></div></a>
              <a href="pregnancy_loss.html" class="dd-item"><div class="dd-icon" style="background:#fafafa;color:#9e9e9e;"><i class="fa-solid fa-hands-holding-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy Loss</strong><span style="font-size:.73rem;color:var(--text-soft);">Support &amp; care</span></div></a>
            </div>
          </div>
          <a href="antenatal_care.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-clipboard-list"></i></div><div><strong style="display:block;font-size:.82rem;">Antenatal Care</strong><span style="font-size:.73rem;color:var(--text-soft);">ANC visits &amp; checklist</span></div></a>
          <!-- NCD with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
            <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:var(--text-soft);">Diabetes, hypertension &amp; more</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:var(--text-soft);">Manage blood sugar</span></div></a>
              <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:var(--text-soft);">Blood pressure care</span></div></a>
              <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:var(--text-soft);">Simulation journey</span></div></a>
            </div>
          </div>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Newborn &amp; Postpartum</strong><span style="font-size:.73rem;color:var(--text-soft);">4th trimester care</span></div></a>
          <a href="breastfeeding_journey.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57c00;"><i class="fa-solid fa-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Breastfeeding</strong><span style="font-size:.73rem;color:var(--text-soft);">Latch, supply, nutrition</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-fire-flame-curved"></i></div><div><strong style="display:block;font-size:.82rem;">Menopause</strong><span style="font-size:.73rem;color:var(--text-soft);">Perimenopause &amp; beyond</span></div></a>
        </div>
      </div>

      <!-- Services dropdown (active) -->
      <div class="nav-item">
        <button class="nav-link active" aria-haspopup="true">Services <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown">
          <a href="services.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
            <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;box-shadow:0 4px 12px rgba(236,64,122,0.35);"><i class="fa-solid fa-grid-2"></i></div>
            <div><strong style="display:block;font-size:.82rem;color:var(--deep-pink);">Services Available</strong><span style="font-size:.73rem;color:var(--text-soft);">Browse all our services</span></div>
          </a>
          <div class="dd-sep"></div>
          <a href="symptom_checker.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-stethoscope"></i></div><div><strong style="display:block;font-size:.82rem;">Symptom Checker</strong><span style="font-size:.73rem;color:var(--text-soft);">AI-powered diagnosis</span></div></a>
          <a href="dashboard.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-gauge-high"></i></div><div><strong style="display:block;font-size:.82rem;">My Dashboard</strong><span style="font-size:.73rem;color:var(--text-soft);">Track your health</span></div></a>
          <a href="screening.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-magnifying-glass-plus"></i></div><div><strong style="display:block;font-size:.82rem;">Health Screening</strong><span style="font-size:.73rem;color:var(--text-soft);">Cancer &amp; preventive</span></div></a>
          <a href="vaccination.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-syringe"></i></div><div><strong style="display:block;font-size:.82rem;">Vaccination</strong><span style="font-size:.73rem;color:var(--text-soft);">Immunization schedule</span></div></a>
          <a href="otc.html" class="dd-item"><div class="dd-icon" style="background:#e0f7fa;color:#006064;"><i class="fa-solid fa-pills"></i></div><div><strong style="display:block;font-size:.82rem;">OTC Medicine Guide</strong><span style="font-size:.73rem;color:var(--text-soft);">Safe self-care options</span></div></a>
          <a href="government_schemes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#e65100;"><i class="fa-solid fa-landmark"></i></div><div><strong style="display:block;font-size:.82rem;">Govt Schemes</strong><span style="font-size:.73rem;color:var(--text-soft);">Benefits you deserve</span></div></a>
          <a href="insurance.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#1b5e20;"><i class="fa-solid fa-shield-halved"></i></div><div><strong style="display:block;font-size:.82rem;">Insurance</strong><span style="font-size:.73rem;color:var(--text-soft);">Coverage &amp; claims guide</span></div></a>
        </div>
      </div>

      <!-- Stories -->
      <div class="nav-item"><a href="stories.html" class="nav-link">Stories</a></div>

      <!-- About Us -->
      <div class="nav-item"><a href="about.html" class="nav-link">About Us</a></div>

      <!-- Additional Information dropdown -->
      <div class="nav-item">
        <button class="nav-link" aria-haspopup="true">Additional Info <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown" style="min-width:240px;">
          <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.08em;">Health Topics</div>
          <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:var(--text-soft);">Cycle, conceiving &amp; IVF</span></div></a>
          <a href="pregnancy_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-baby-carriage"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy</strong><span style="font-size:.73rem;color:var(--text-soft);">All trimesters covered</span></div></a>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Motherhood</strong><span style="font-size:.73rem;color:var(--text-soft);">Newborn &amp; postpartum</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-spa"></i></div><div><strong style="display:block;font-size:.82rem;">Wellness</strong><span style="font-size:.73rem;color:var(--text-soft);">Menopause, bone, mental</span></div></a>
          <div class="dd-sep"></div>
          <a href="community.html" class="dd-item"><div class="dd-icon" style="background:#ede7f6;color:#4527a0;"><i class="fa-solid fa-users"></i></div><div><strong style="display:block;font-size:.82rem;">Community</strong><span style="font-size:.73rem;color:var(--text-soft);">Share &amp; connect</span></div></a>
          <div class="dd-sep"></div>
          <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.08em;">Specialised Care</div>
          <!-- NCD with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
            <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:var(--text-soft);">Diabetes, hypertension &amp; more</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:var(--text-soft);">Manage blood sugar</span></div></a>
              <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:var(--text-soft);">Blood pressure care</span></div></a>
              <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:var(--text-soft);">Simulation journey</span></div></a>
            </div>
          </div>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Newborn &amp; Postpartum</strong><span style="font-size:.73rem;color:var(--text-soft);">4th trimester care</span></div></a>
          <a href="breastfeeding_journey.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57c00;"><i class="fa-solid fa-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Breastfeeding</strong><span style="font-size:.73rem;color:var(--text-soft);">Latch, supply, nutrition</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-fire-flame-curved"></i></div><div><strong style="display:block;font-size:.82rem;">Menopause</strong><span style="font-size:.73rem;color:var(--text-soft);">Perimenopause &amp; beyond</span></div></a>
        </div>
      </div>

    </nav>

    <!-- Right: Sign In + Contact Us -->
    <div class="nav-actions">
      <a class="btn-nav outline" href="signin.html">
        <i class="fa-regular fa-user"></i> Sign In
      </a>
      <a class="btn-nav primary" href="contact.html">
        <i class="fa-solid fa-envelope"></i> Contact Us
      </a>
      <!-- Mobile hamburger -->
      <button class="hamburger" id="hamburgerBtn" aria-label="Menu" onclick="toggleMobile()">
        <span id="hb1"></span><span id="hb2"></span><span id="hb3"></span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mm-section">Navigation</div>
  <a href="index.html" class="mm-link"><i class="fa-solid fa-house" style="color:var(--deep-pink);width:20px;"></i> Home</a>
  <div class="mm-section">Journeys</div>
  <a href="conceiving.html" class="mm-link"><i class="fa-solid fa-seedling" style="color:var(--deep-pink);width:20px;"></i> Conceiving</a>
  <a href="fertility.html" class="mm-link"><i class="fa-solid fa-dna" style="color:var(--deep-pink);width:20px;"></i> Fertility</a>
  <a href="pregnancy_journey.html" class="mm-link"><i class="fa-solid fa-baby-carriage" style="color:var(--deep-pink);width:20px;"></i> Pregnancy Journey</a>
  <a href="antenatal_care.html" class="mm-link"><i class="fa-solid fa-clipboard-list" style="color:var(--deep-pink);width:20px;"></i> Antenatal Care</a>
  <a href="newborn_postpartum_care.html" class="mm-link"><i class="fa-solid fa-baby" style="color:var(--deep-pink);width:20px;"></i> Newborn &amp; Postpartum</a>
  <a href="breastfeeding-journey.html" class="mm-link"><i class="fa-solid fa-heart" style="color:var(--deep-pink);width:20px;"></i> Breastfeeding</a>
  <a href="menopause.html" class="mm-link"><i class="fa-solid fa-fire-flame-curved" style="color:var(--deep-pink);width:20px;"></i> Menopause</a>
  <div class="mm-section">Services</div>
  <a href="symptom_checker.html" class="mm-link"><i class="fa-solid fa-stethoscope" style="color:var(--deep-pink);width:20px;"></i> Symptom Checker</a>
  <a href="dashboard.html" class="mm-link"><i class="fa-solid fa-gauge-high" style="color:var(--deep-pink);width:20px;"></i> My Dashboard</a>
  <a href="screening.html" class="mm-link"><i class="fa-solid fa-magnifying-glass-plus" style="color:var(--deep-pink);width:20px;"></i> Health Screening</a>
  <a href="government-schemes.html" class="mm-link"><i class="fa-solid fa-landmark" style="color:var(--deep-pink);width:20px;"></i> Govt Schemes</a>
  <div class="mm-section">More</div>
  <a href="stories.html" class="mm-link"><i class="fa-solid fa-book-open" style="color:var(--deep-pink);width:20px;"></i> Stories</a>
  <a href="community.html" class="mm-link"><i class="fa-solid fa-users" style="color:var(--deep-pink);width:20px;"></i> Community</a>
  <a href="about.html" class="mm-link"><i class="fa-solid fa-circle-info" style="color:var(--deep-pink);width:20px;"></i> About Us</a>
  <div style="display:flex;gap:.75rem;margin-top:1rem;padding:.5rem;">
    <a href="signin.html" class="btn-nav outline" style="flex:1;justify-content:center;"><i class="fa-regular fa-user"></i> Sign In</a>
    <a href="contact.html" class="btn-nav primary" style="flex:1;justify-content:center;"><i class="fa-solid fa-envelope"></i> Contact Us</a>
  </div>
</div>

  <div class="page-shell">

  <!-- HERO -->
  <section class="hero" id="top">
    <!-- Particle Background - MOVED INSIDE HERO -->
    <div class="hero-constellation-bg" aria-hidden="true">
      <canvas id="particleCanvas"></canvas>
      <div class="gradient-morph"></div>
    </div>
    
    <div class="hero-content">

        <div class="hero-badge">
          <span class="badge-icon"></span>
          <span class="badge-text">Your Complete Antenatal Care Guide</span>
        </div>

        <h1 class="hero-title-3d">
          Your <span class="title-emphasis">40Week Antenatal Care</span> during Pregnancy Journey
        </h1>

        <p class="hero-subtitle">
          Learn what happens inside your body, what each visit checks, and how every test protects you and your baby 
          through interactive simulations that help you remember.
        </p>

        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">1015</span>
            <span class="stat-label">Typical visits</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">8+</span>
            <span class="stat-label">Critical screenings</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">28+</span>
            <span class="stat-label">Weeks kick counts start</span>
          </div>
        </div>

        <div class="hero-cta-row">
          <button class="btn-primary" type="button" onclick="ANC.startJourney()">Begin Your Journey</button>
          <button class="btn-secondary" type="button" onclick="ANC.openKnowledgeSprint()">Take a 90sec Sprint</button>
        </div>

        <div class="daily-tip" id="dailyTip">
          <div class="tip-icon"></div>
          <p id="tipText">Tip loading</p>
        </div>
      </div>

      <!-- GD-style hero header image animation, repurposed -->
      <div class="hero-visual-3d">
        <div class="pregnancy-3d-container" aria-label="Interactive hero navigation">
          <div class="pregnancy-core" aria-hidden="true">
            <div class="center-glow"></div>
            <div class="pulse-ring ring-1"></div>
            <div class="pulse-ring ring-2"></div>
            <div class="pulse-ring ring-3"></div>
          </div>

          <button class="health-icon icon-1" type="button" onclick="ANC.scrollTo('#journey')">
            <div class="icon-inner"></div>
            <div class="icon-label">Timeline</div>
          </button>
          <button class="health-icon icon-2" type="button" onclick="ANC.scrollTo('#care-control')">
            <div class="icon-inner"></div>
            <div class="icon-label">Body Map</div>
          </button>
          <button class="health-icon icon-3" type="button" onclick="ANC.scrollTo('#tests-scans')">
            <div class="icon-inner"></div>
            <div class="icon-label">Tests</div>
          </button>
          <button class="health-icon icon-4" type="button" onclick="ANC.scrollTo('#wellness')">
            <div class="icon-inner"></div>
            <div class="icon-label">Wellness</div>
          </button>
          <button class="health-icon icon-5" type="button" onclick="ANC.scrollTo('#warning')">
            <div class="icon-inner"></div>
            <div class="icon-label">Warnings</div>
          </button>

          <!-- Week Dial -->
          <div class="week-dial" role="group" aria-label="Week explorer">
            <div class="meter-reading">
              <span class="reading-value" id="weekDialValue">12</span>
              <span class="reading-unit">wk</span>
            </div>
            <div class="meter-status" id="trimesterStatus">1st Trimester</div>
            <div class="meter-bar">
              <div class="meter-fill" id="weekDialFill"></div>
            </div>
          </div>
        </div>

        <div class="hero-info-box">
          <div class="info-badge">
            <span class="badge-icon"></span>
            <span class="badge-text">Interactive Learning</span>
          </div>
          <h3 class="info-title">Your Antenatal Care Control Center</h3>
          <p class="info-text">
            Pick a week, run a visit simulation, explore scans, and practice emergency decisions.
            The platform adapts content based on your week selection. 
          </p>
        </div>
      </div>
    </section>

    <!-- JOURNEY / TIMELINE -->
    <section id="journey" class="journey-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Your 40Week Journey</span>
        </div>
        <h2 class="section-title-prominent">
          Navigate Your <span class="title-highlight">Pregnancy Timeline</span>
        </h2>
        <p class="section-subtitle-prominent">
          Tap a trimester to unlock visits, tests, and what to expect  then run the Visit Simulator to practice.
          This schedule follows the standard frequency pattern of early monthly visits  then increasing frequency. 
        </p>
      </div>

      <div class="timeline-container">
        <div class="timeline-rail"></div>

        <button class="timeline-stage" data-stage="first" type="button" onclick="ANC.showStageDetails('first')">
          <div class="stage-marker">
            <div class="marker-dot">1</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">First Trimester</h3>
            <p class="stage-weeks">Weeks 112</p>
            <p class="stage-desc">Booking visit + baseline tests</p>
            <div class="stage-icon"></div>
          </div>
        </button>

        <button class="timeline-stage" data-stage="second" type="button" onclick="ANC.showStageDetails('second')">
          <div class="stage-marker">
            <div class="marker-dot">2</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Second Trimester</h3>
            <p class="stage-weeks">Weeks 1328</p>
            <p class="stage-desc">Anatomy scan + glucose screening</p>
            <div class="stage-icon"></div>
          </div>
        </button>

        <button class="timeline-stage" data-stage="third" type="button" onclick="ANC.showStageDetails('third')">
          <div class="stage-marker">
            <div class="marker-dot">3</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Third Trimester</h3>
            <p class="stage-weeks">Weeks 2940</p>
            <p class="stage-desc">Kick counts + GBS + delivery prep</p>
            <div class="stage-icon"></div>
          </div>
        </button>

        <button class="timeline-stage" data-stage="postpartum" type="button" onclick="ANC.showStageDetails('postpartum')">
          <div class="stage-marker">
            <div class="marker-dot">4</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Postpartum</h3>
            <p class="stage-weeks">After delivery</p>
            <p class="stage-desc">Recovery + mental health + planning</p>
            <div class="stage-icon"></div>
          </div>
        </button>
      </div>

      <div class="stage-detail-panel" id="stageDetailPanel" aria-live="polite">
        <div class="panel-placeholder">
          <div class="placeholder-icon"></div>
          <p>Tap a trimester to reveal the full care plan and interactive visit checklist.</p>
        </div>
      </div>

      <!-- Visit Simulator -->
      <div class="visit-sim">
        <div class="visit-sim-header">
          <h3>Visit Simulator: Practice a Real Appointment</h3>
          <p>
            Your provider checks blood pressure and urine every visit, and key tests at specific weeks. 
          </p>
        </div>

        <div class="visit-sim-grid">
          <div class="visit-controls">
            <label class="field-label" for="simWeek">Simulate Visit Week</label>
            <input id="simWeek" type="range" min="4" max="40" value="12" oninput="ANC.updateVisitSimWeek(this.value)">
            <div class="range-row">
              <span>4</span><span>12</span><span>20</span><span>28</span><span>36</span><span>40</span>
            </div>

            <div class="visit-metrics">
              <div class="metric-card">
                <div class="metric-top">
                  <span class="metric-icon"></span>
                  <span class="metric-name">BP</span>
                </div>
                <div class="metric-controls">
                  <input type="number" id="bpSys" value="118" min="80" max="200"> /
                  <input type="number" id="bpDia" value="76" min="40" max="130">
                </div>
                <button class="mini-btn" type="button" onclick="ANC.interpretBP()">Interpret</button>
              </div>

              <div class="metric-card">
                <div class="metric-top">
                  <span class="metric-icon"></span>
                  <span class="metric-name">Urine Protein</span>
                </div>
                <select id="urineProtein">
                  <option value="negative" selected>Negative</option>
                  <option value="trace">Trace</option>
                  <option value="positive">Positive</option>
                </select>
                <button class="mini-btn" type="button" onclick="ANC.interpretUrine()">Interpret</button>
              </div>

              <div class="metric-card">
                <div class="metric-top">
                  <span class="metric-icon"></span>
                  <span class="metric-name">Weight Trend</span>
                </div>
                <select id="weightTrend">
                  <option value="steady" selected>Steady gain</option>
                  <option value="low">Too low</option>
                  <option value="high">Too high</option>
                </select>
                <button class="mini-btn" type="button" onclick="ANC.interpretWeight()">Interpret</button>
              </div>
            </div>
          </div>

          <div class="visit-output">
            <div class="visit-output-head">
              <div class="chip" id="visitChip">Week 12</div>
              <button class="mini-btn outline" type="button" onclick="ANC.runVisitChecklist()">Run Checklist</button>
            </div>
            <div class="visit-output-body" id="visitOutputBody">
              <p>Adjust values and click Run Checklist to see visit tasks + why they matter.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CARE CONTROL CENTER -->
    <section id="care-control" class="control-section">
       <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Interactive Body Map</span>
        </div>
        <h2 class="section-title-prominent">
          Care <span class="title-highlight">Control Center</span>
        </h2>
        <p class="section-subtitle-prominent">
          Click body regions to reveal detailed insights about pregnancy changes, which tests relate to each area, and how your body adapts week by week.
          This interactive model uses real medical data to show you exactly what's happening inside.
        </p>
        
        <!-- Week-by-week comparison chart - MOVED HERE, CENTERED -->
        <div class="week-comparison-chart">
          <h3>Your Body's Journey: Week-by-Week Changes</h3>
          <div class="comparison-grid" id="comparisonGrid">
            <!-- Will be populated by JavaScript -->
          </div>
        </div>
      </div>

      <div class="control-grid">
        <div class="body-stage">
          <div class="body-stage-top">
            <div class="chip week-chip" id="weekOverviewChip">Week 12 Overview</div>

            <div class="week-slider-container">
              <label class="slider-label" for="weekSlider">Explore Pregnancy Week</label>
              <input type="range" id="weekSlider" min="1" max="40" value="12"
                     class="week-slider" oninput="ANC.updatePregnancyWeek(this.value)">
              <div class="slider-markers">
                <span>1</span><span>10</span><span>20</span><span>30</span><span>40</span>
              </div>
            </div>
          </div>

          <div class="body-canvas">
            <!-- Enhanced detailed pregnant woman SVG from gestational_diabetes.html -->
            <svg viewBox="0 0 320 600" class="body-svg-2" role="img" aria-label="Interactive pregnancy body map">
              <!-- Head -->
              <ellipse cx="160" cy="62" rx="42" ry="48" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Hair -->
              <ellipse cx="160" cy="38" rx="44" ry="30" fill="#5c3d2e"/>
              <rect x="116" y="30" width="12" height="55" rx="6" fill="#5c3d2e"/>
              <rect x="192" y="30" width="12" height="55" rx="6" fill="#5c3d2e"/>
              
              <!-- Eyes -->
              <circle cx="143" cy="65" r="4" fill="#3a2520"/>
              <circle cx="177" cy="65" r="4" fill="#3a2520"/>
              
              <!-- Smile -->
              <path d="M148 78 Q160 86 172 78" fill="none" stroke="#3a2520" stroke-width="2" stroke-linecap="round"/>
              
              <!-- Neck -->
              <rect x="148" y="106" width="24" height="28" rx="4" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              
              <!-- Torso (fitted dress) -->
              <path d="M100 134 Q100 128 130 128 L190 128 Q220 128 220 134 L220 280 Q220 285 215 285 L105 285 Q100 285 100 280 Z" 
                    fill="#e8a0b8" stroke="#d47a9a" stroke-width="2"/>
              
              <!-- Pregnant Belly - dynamically sized by week -->
              <ellipse id="belly" cx="160" cy="305" rx="64" ry="76" fill="#e8a0b8" stroke="#d47a9a" stroke-width="2" class="animated-belly"/>
              
              <!-- Collar detail -->
              <path d="M148 128 L148 148 Q160 156 172 148 L172 128" fill="none" stroke="#d47a9a" stroke-width="1.5"/>
              
              <!-- Arms -->
              <path d="M100 140 Q70 170 60 240 Q55 270 65 290 L82 290 Q85 270 90 240 Q100 175 118 145" 
                    fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              <path d="M220 140 Q250 170 260 240 Q265 270 255 290 L238 290 Q235 270 230 240 Q220 175 202 145" 
                    fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Hands -->
              <ellipse cx="74" cy="298" rx="14" ry="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              <ellipse cx="246" cy="298" rx="14" ry="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              
              <!-- Skirt -->
              <path d="M95 372 L88 480 Q88 490 100 490 L220 490 Q232 490 232 480 L225 372" 
                    fill="#c077a8" stroke="#a85d8a" stroke-width="2"/>
              
              <!-- Legs -->
              <rect x="118" y="488" width="34" height="90" rx="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              <rect x="168" y="488" width="34" height="90" rx="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Feet -->
              <ellipse cx="135" cy="586" rx="22" ry="10" fill="#8b5e83"/>
              <ellipse cx="185" cy="586" rx="22" ry="10" fill="#8b5e83"/>

              <!-- Internal organ hotspot circles (clickable areas) -->
              <circle id="hotHeart" cx="160" cy="185" r="20" class="hot-organ" onclick="ANC.openBodyInsight('heart')"/>
              <circle id="hotLungs" cx="160" cy="210" r="18" class="hot-organ" onclick="ANC.openBodyInsight('lungs')"/>
              <circle id="hotLiver" cx="195" cy="220" r="16" class="hot-organ" onclick="ANC.openBodyInsight('liver')"/>
              <circle id="hotStomach" cx="125" cy="230" r="14" class="hot-organ" onclick="ANC.openBodyInsight('stomach')"/>
              <circle id="hotUterus" cx="160" cy="305" r="35" class="hot-organ" onclick="ANC.openBodyInsight('uterus')"/>
              <circle id="hotKidneyL" cx="130" cy="265" r="14" class="hot-organ" onclick="ANC.openBodyInsight('kidney')"/>
              <circle id="hotKidneyR" cx="190" cy="265" r="14" class="hot-organ" onclick="ANC.openBodyInsight('kidney')"/>
              <circle id="hotBladder" cx="160" cy="360" r="12" class="hot-organ" onclick="ANC.openBodyInsight('bladder')"/>
              <circle id="hotSpine" cx="160" cy="250" r="18" class="hot-organ" onclick="ANC.openBodyInsight('spine')"/>

              <!-- Baby visualization - grows with weeks -->
              <circle id="babyDot" cx="160" cy="315" r="18" class="baby-dot" />
              
              <!-- Growth rings showing uterus expansion -->
              <circle class="growth-ring ring-a" cx="160" cy="305" r="50" />
              <circle class="growth-ring ring-b" cx="160" cy="305" r="68" />
              <circle class="growth-ring ring-c" cx="160" cy="305" r="86" />
            </svg>

            <!-- Floating interactive hotspot labels with animations -->
            <div class="hotspot v3 heart-spot" style="top: 28%; left: 62%;" onclick="ANC.openBodyInsight('blood')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Blood Volume</div>
            </div>

            <div class="hotspot v3 bp-spot" style="top: 32%; left: 16%;" onclick="ANC.openBodyInsight('bp')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Blood Pressure</div>
            </div>

            <div class="hotspot v3 baby-spot" style="top: 52%; left: 72%;" onclick="ANC.openBodyInsight('baby')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Baby Growth</div>
            </div>

            <div class="hotspot v3 weight-spot" style="top: 72%; left: 32%;" onclick="ANC.openBodyInsight('weight')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Weight Gain</div>
            </div>

            <div class="hotspot v3 placenta-spot" style="top: 56%; left: 48%;" onclick="ANC.openBodyInsight('placenta')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Placenta</div>
            </div>

            <div class="hotspot v3 fluid-spot" style="top: 60%; left: 62%;" onclick="ANC.openBodyInsight('fluid')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Amniotic Fluid</div>
            </div>

            <div class="hotspot v3 hormones-spot" style="top: 24%; left: 38%;" onclick="ANC.openBodyInsight('hormones')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Hormones</div>
            </div>

            <div class="hotspot v3 cervix-spot" style="top: 68%; left: 50%;" onclick="ANC.openBodyInsight('cervix')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Cervix</div>
            </div>

            <div class="hotspot v3 breasts-spot" style="top: 20%; left: 50%;" onclick="ANC.openBodyInsight('breasts')">
              <div class="hotspot-pulse"></div>
              <div class="hotspot-icon"></div>
              <div class="hotspot-label">Breast Changes</div>
            </div>

          </div>
        </div>

        <!-- Enhanced insight panel with more details -->
        <aside class="insight-panel-v2" id="insightPanel" aria-live="polite">
  <div class="insight-panel-inner">
    <!-- Beautiful header with gradient -->
    <div class="insight-header-v2">
      <div class="insight-icon-badge" id="insightIconBadge">
        <span class="insight-emoji"></span>
      </div>
      <div class="insight-title-group">
        <h3 id="insightTitle" class="insight-title-v2">Your Pregnancy Journey</h3>
        <div class="insight-week-badge-v2" id="insightWeekBadgeV2">Week 12</div>
      </div>
    </div>

    <!-- Scrollable content with welcome message -->
    <div class="insight-content-scroll" id="insightBody">
      <div class="insight-welcome">
        <div class="welcome-icon"></div>
        <h4>Explore Your Body's Changes</h4>
        <p>Click any highlighted region on the body map to discover:</p>
        <ul class="welcome-list">
          <li><span class="check-icon"></span> What's changing in that area</li>
          <li><span class="check-icon"></span> Which tests monitor it</li>
          <li><span class="check-icon"></span> Warning signs to watch</li>
          <li><span class="check-icon"></span> Week-by-week insights</li>
        </ul>
        <div class="explore-hint">
          <div class="pulse-dot"></div>
          <span>Hotspots are pulsing - click to learn!</span>
        </div>
      </div>
    </div>

    <!-- Beautiful action buttons -->
    <div class="insight-actions-v2">
      <button class="insight-btn secondary" type="button" onclick="ANC.pinInsight()">
        <span class="btn-icon"></span>
        <span>Pin This</span>
      </button>
      <button class="insight-btn primary" type="button" onclick="ANC.launchMicroQuiz()">
        <span class="btn-icon"></span>
        <span>Quick Quiz</span>
      </button>
    </div>

    <!-- PROPERLY POSITIONED close button -->
    <button class="insight-close-v2" type="button" onclick="ANC.closeInsight()" aria-label="Close panel">
      <span class="close-icon"></span>
    </button>
  </div>
</aside>

    </section>

    <!-- TESTS & SCANS -->
    <section id="tests-scans" class="tests-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Essential Screenings</span>
        </div>
        <h2 class="section-title-prominent">
          Tests & <span class="title-highlight">Scans</span>
        </h2>
        <p class="section-subtitle-prominent">
          Bloodwork detects anemia, infections, blood incompatibilities; ultrasounds track milestones; glucose screening is typically 2428 weeks. 
        </p>
      </div>

      <div class="split">
        <div class="card-surface">
          <div class="subhead">
            <h3>Lab Explorer</h3>
            <p>Click a test to open an interactive why it matters + what happens next walkthrough.</p>
          </div>

          <div class="test-grid">
            <button class="test-card" type="button" onclick="ANC.openTest('bloodType')">
              <div class="test-icon"></div>
              <h4 class="test-name">Blood Type & Rh</h4>
              <div class="test-meta"><span>First visit</span><span class="pill critical">Critical</span></div>
              <p class="test-preview">Detect incompatibility risk and plan RhoGAM if needed.</p>
            </button>

            <button class="test-card" type="button" onclick="ANC.openTest('cbc')">
              <div class="test-icon"></div>
              <h4 class="test-name">Complete Blood Count</h4>
              <div class="test-meta"><span>Each trimester</span><span class="pill warn">Important</span></div>
              <p class="test-preview">Anemia screening + infection clues.</p>
            </button>

            <button class="test-card" type="button" onclick="ANC.openTest('infections')">
              <div class="test-icon"></div>
              <h4 class="test-name">Infection Panel</h4>
              <div class="test-meta"><span>First trimester</span><span class="pill critical">Critical</span></div>
              <p class="test-preview">HIV, Hep B, syphilis, rubella immunity.</p>
            </button>

            <button class="test-card" type="button" onclick="ANC.openTest('glucose')">
              <div class="test-icon"></div>
              <h4 class="test-name">Glucose Screening</h4>
              <div class="test-meta"><span>2428 weeks</span><span class="pill critical">Critical</span></div>
              <p class="test-preview">Simulate what a high result triggers next.</p>
            </button>

            <button class="test-card" type="button" onclick="ANC.openTest('thyroid')">
              <div class="test-icon"></div>
              <h4 class="test-name">Thyroid (TSH)</h4>
              <div class="test-meta"><span>First trimester</span><span class="pill warn">Important</span></div>
              <p class="test-preview">Metabolism + baby brain development support.</p>
            </button>

            <button class="test-card" type="button" onclick="ANC.openTest('gbs')">
              <div class="test-icon"></div>
              <h4 class="test-name">Group B Strep</h4>
              <div class="test-meta"><span>3537 weeks</span><span class="pill warn">Important</span></div>
              <p class="test-preview">Plan antibiotics during labor if positive.</p>
            </button>
          </div>
        </div>

        <div class="card-surface">
          <div class="subhead">
            <h3>Ultrasound Studio</h3>
            <p>Open a scan to view the what you see overlays and a memory drill.</p>
          </div>

          <div class="scan-grid">
            <button class="scan-card" type="button" onclick="ANC.openScan('dating')">
              <div class="scan-week">610 w</div>
              <div class="scan-visual dating"></div>
              <h4>Dating Scan</h4>
              <p>Confirm location, heartbeat, accurate dating.</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('nt')">
              <div class="scan-week">1114 w</div>
              <div class="scan-visual nt"></div>
              <h4>NT Scan</h4>
              <p>Early risk screening with blood tests.</p>
            </button>

            <button class="scan-card featured" type="button" onclick="ANC.openScan('anatomy')">
              <div class="scan-week">1822 w</div>
              <div class="scan-visual anatomy"></div>
              <h4>Anatomy Scan</h4>
              <p>Detailed organ checks + placenta + fluid.</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('doppler')">
              <div class="scan-week">2440 w</div>
              <div class="scan-visual doppler"></div>
              <h4>Doppler Ultrasound</h4>
              <p>Blood flow through umbilical cord & placenta.</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('growth')">
              <div class="scan-week">2840 w</div>
              <div class="scan-visual growth"></div>
              <h4>Growth Scans</h4>
              <p>Size, percentiles, position, fluid.</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('threedFourd')">
              <div class="scan-week">2432 w</div>
              <div class="scan-visual threedfourd"></div>
              <h4>3D/4D Ultrasound</h4>
              <p>See baby's face in detaillifelike images!</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('bpp')">
              <div class="scan-week">3240 w</div>
              <div class="scan-visual bpp"></div>
              <h4>Biophysical Profile</h4>
              <p>5-component wellness check with monitoring.</p>
            </button>

            <button class="scan-card" type="button" onclick="ANC.openScan('nst')">
              <div class="scan-week">3240 w</div>
              <div class="scan-visual nst"></div>
              <h4>Non-Stress Test</h4>
              <p>Heart rate monitoring for baby's well-being.</p>
            </button>
          </div>

          <div class="memory-drill">
            <h4>Memory Drill: Whats due this week?</h4>
            <div class="drill-row">
              <input id="drillWeek" type="number" min="1" max="40" value="12">
              <button class="mini-btn" type="button" onclick="ANC.runDueThisWeek()">Show</button>
              <button class="mini-btn outline" type="button" onclick="ANC.quizDueThisWeek()">Quiz me</button>
            </div>
            <div class="drill-output" id="drillOutput">Enter a week and click Show.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- VACCINES -->
    <section id="vaccines" class="vaccine-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Protection & Prevention</span>
        </div>
        <h2 class="section-title-prominent">
          Pregnancy <span class="title-highlight">Vaccinations</span>
        </h2>
        <p class="section-subtitle-prominent">
          Tdap (2736w) and flu (any trimester/season) protect both you and baby; live vaccines are avoided during pregnancy. 
        </p>
      </div>

      <div class="vaccine-interactive">
        <div class="vaccine-timeline">
          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('tdap')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Tdap</h3>
              <div class="vaccine-timing">Weeks 2736</div>
              <div class="vaccine-status recommended">Strongly Recommended</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('flu')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Influenza</h3>
              <div class="vaccine-timing">Any trimester</div>
              <div class="vaccine-status recommended">Strongly Recommended</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('covid')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>COVID19</h3>
              <div class="vaccine-timing">Any trimester</div>
              <div class="vaccine-status recommended">Recommended</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('hepb')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Hepatitis B</h3>
              <div class="vaccine-timing">If at risk</div>
              <div class="vaccine-status recommended">Recommended for High-Risk</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item avoid" type="button" onclick="ANC.showVaccine('mmr')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>MMR</h3>
              <div class="vaccine-timing">Avoid in pregnancy</div>
              <div class="vaccine-status avoid">Not Safe</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item avoid" type="button" onclick="ANC.showVaccine('varicella')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Varicella (Chickenpox)</h3>
              <div class="vaccine-timing">Avoid in pregnancy</div>
              <div class="vaccine-status avoid">Not Safe</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('pneumo')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Pneumococcal</h3>
              <div class="vaccine-timing">If at risk</div>
              <div class="vaccine-status recommended">Recommended for High-Risk</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item recommended" type="button" onclick="ANC.showVaccine('meningococcal')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Meningococcal</h3>
              <div class="vaccine-timing">If at risk</div>
              <div class="vaccine-status recommended">Recommended for High-Risk</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>

          <button class="vaccine-item avoid" type="button" onclick="ANC.showVaccine('avoid')">
            <div class="vaccine-icon"></div>
            <div class="vaccine-info">
              <h3>Other Live Vaccines</h3>
              <div class="vaccine-timing">Avoid in pregnancy</div>
              <div class="vaccine-status avoid">Not Safe</div>
            </div>
            <div class="vaccine-expand">+</div>
          </button>
        </div>

        <!-- 3D Antibody Transfer Visualization -->
        <div class="antibody-transfer-panel">
          <div class="transfer-header">
            <h3>How Vaccines Protect Your Baby</h3>
            <p class="transfer-subtitle">Vertical Antibody Transfer</p>
          </div>

          <div class="transfer-visualization-container">
            <canvas id="antibodyCanvas" class="antibody-canvas"></canvas>
            
            <div class="transfer-overlay-info">
              <div class="info-step" id="step1" style="display: none;">
                <div class="step-icon"></div>
                <div class="step-content">
                  <h4>Step 1: Vaccination</h4>
                  <p>Mother receives vaccine</p>
                </div>
              </div>
              
              <div class="info-step" id="step2" style="display: none;">
                <div class="step-icon"></div>
                <div class="step-content">
                  <h4>Step 2: Antibody Production</h4>
                  <p>Maternal immune system creates antibodies</p>
                </div>
              </div>
              
              <div class="info-step" id="step3" style="display: none;">
                <div class="step-icon"></div>
                <div class="step-content">
                  <h4>Step 3: Placental Transfer</h4>
                  <p>Antibodies cross placenta via active transport</p>
                </div>
              </div>
              
              <div class="info-step" id="step4" style="display: none;">
                <div class="step-icon"></div>
                <div class="step-content">
                  <h4>Step 4: Baby Protected</h4>
                  <p>Baby receives passive immunity for first months</p>
                </div>
              </div>
            </div>
          </div>

          <div class="transfer-controls">
            <button class="control-btn" id="playBtn" onclick="ANC.playAntibodyAnimation()">
              <span class="btn-icon"></span> Play Animation
            </button>
            <button class="control-btn" id="pauseBtn" onclick="ANC.pauseAntibodyAnimation()" style="display: none;">
              <span class="btn-icon"></span> Pause
            </button>
            <button class="control-btn" onclick="ANC.resetAntibodyAnimation()">
              <span class="btn-icon"></span> Reset
            </button>
          </div>

          <div class="transfer-timeline">
            <div class="timeline-track">
              <div class="timeline-marker" id="timelineMarker"></div>
            </div>
            <div class="timeline-labels">
              <span>Vaccination</span>
              <span>2-3 weeks</span>
              <span>Birth</span>
              <span>3-6 months</span>
            </div>
          </div>

          <div class="transfer-facts">
            <div class="fact-card">
              <div class="fact-icon"></div>
              <div class="fact-content">
                <h5>Peak Protection</h5>
                <p>Antibodies peak at 2-3 weeks post-vaccination</p>
              </div>
            </div>
            <div class="fact-card">
              <div class="fact-icon"></div>
              <div class="fact-content">
                <h5>IgG Antibodies</h5>
                <p>Only IgG antibodies can cross placenta efficiently</p>
              </div>
            </div>
            <div class="fact-card">
              <div class="fact-icon"></div>
              <div class="fact-content">
                <h5>Best Timing</h5>
                <p>3rd trimester for maximum transfer to baby</p>
              </div>
            </div>
            <div class="fact-card">
              <div class="fact-icon"></div>
              <div class="fact-content">
                <h5>Duration</h5>
                <p>Protection lasts 2-6 months after birth</p>
              </div>
            </div>
          </div>

          <div class="transfer-learn-more">
            <button class="learn-more-btn" onclick="ANC.showAntibodyDetails()">
              <span class="btn-icon"></span> Learn More About Antibody Transfer
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- WELLNESS -->
    <section id="wellness" class="wellness-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Healthy Living</span>
        </div>
        <h2 class="section-title-prominent">
          Nutrition & <span class="title-highlight">Wellness</span>
        </h2>
        <p class="section-subtitle-prominent">
          Key targets: folic acid, iron, calcium, protein  plus avoid high-risk foods like unpasteurized dairy and alcohol. 
        </p>
      </div>

      <div class="wellness-grid">
        <div class="card-surface">
          <h3 class="center">Build Your Daily Nutrition Plan</h3>
          <p class="muted center">Pick foods to reach targets. Then take a quick recall quiz.</p>

          <div class="nutrient-slots">
            <div class="nutrient-slot">
              <div class="slot-header">
                <span class="nutrient-icon"></span>
                <span class="nutrient-name">Folic Acid</span>
              </div>
              <div class="nutrient-target">Target: 400800 mcg</div>
              <div class="nutrient-progress"><div class="progress-bar" id="folicProgress"></div></div>
              <div class="nutrient-current">Current: <span id="folicAmount">0</span> mcg</div>
            </div>

            <div class="nutrient-slot">
              <div class="slot-header">
                <span class="nutrient-icon"></span>
                <span class="nutrient-name">Iron</span>
              </div>
              <div class="nutrient-target">Target: 27 mg</div>
              <div class="nutrient-progress"><div class="progress-bar" id="ironProgress"></div></div>
              <div class="nutrient-current">Current: <span id="ironAmount">0</span> mg</div>
            </div>

            <div class="nutrient-slot">
              <div class="slot-header">
                <span class="nutrient-icon"></span>
                <span class="nutrient-name">Calcium</span>
              </div>
              <div class="nutrient-target">Target: 1000 mg</div>
              <div class="nutrient-progress"><div class="progress-bar" id="calciumProgress"></div></div>
              <div class="nutrient-current">Current: <span id="calciumAmount">0</span> mg</div>
            </div>

            <div class="nutrient-slot">
              <div class="slot-header">
                <span class="nutrient-icon"></span>
                <span class="nutrient-name">Protein</span>
              </div>
              <div class="nutrient-target">Target: 71 g</div>
              <div class="nutrient-progress"><div class="progress-bar" id="proteinProgress"></div></div>
              <div class="nutrient-current">Current: <span id="proteinAmount">0</span> g</div>
            </div>
          </div>

          <div class="food-selection">
            <h4 class="food-selection-title">Add Foods</h4>
            <div class="food-grid">
              <button class="food-item" type="button" onclick="ANC.addFood('spinach')">
                <div class="food-icon"></div><div class="food-name">Spinach</div><div class="food-nutrients">Iron + folate</div>
              </button>
              <button class="food-item" type="button" onclick="ANC.addFood('milk')">
                <div class="food-icon"></div><div class="food-name">Milk</div><div class="food-nutrients">Calcium + protein</div>
              </button>
              <button class="food-item" type="button" onclick="ANC.addFood('eggs')">
                <div class="food-icon"></div><div class="food-name">Eggs</div><div class="food-nutrients">Protein + folate</div>
              </button>
              <button class="food-item" type="button" onclick="ANC.addFood('lentils')">
                <div class="food-icon"></div><div class="food-name">Lentils</div><div class="food-nutrients">Iron + protein</div>
              </button>
              <button class="food-item" type="button" onclick="ANC.addFood('orangejuice')">
                <div class="food-icon"></div><div class="food-name">Fortified OJ</div><div class="food-nutrients">Folate + calcium</div>
              </button>
              <button class="food-item" type="button" onclick="ANC.addFood('salmon')">
                <div class="food-icon"></div><div class="food-name">Salmon</div><div class="food-nutrients">Protein + omega3</div>
              </button>
            </div>

            <div class="row">
              <button class="mini-btn outline" type="button" onclick="ANC.resetNutrients()">Reset</button>
              <button class="mini-btn" type="button" onclick="ANC.nutritionRecallQuiz()">Recall Quiz</button>
            </div>
          </div>

          <div class="nutrition-score-panel">
            <h4>Daily Nutrition Score</h4>
            <div class="score-circle-container">
              <svg class="score-circle-svg" viewBox="0 0 120 120">
                <circle cx="60" cy="60" r="50" class="score-bg-circle"/>
                <circle cx="60" cy="60" r="50" class="score-fill-circle" id="nutritionScoreCircle"/>
              </svg>
              <div class="score-value" id="nutritionScoreValue">0%</div>
            </div>
            <p class="score-feedback" id="nutritionFeedback">Start adding foods to see your score!</p>
          </div>
        </div>

        <div class="card-surface">
          <h3 class="center">Discomfort Lab</h3>
          <p class="muted center">
            Choose a discomfort and get safe firstline strategies (education-focused).
            Common discomforts shift across trimesters. 
          </p>

          <div class="discomfort-grid">
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('nausea')"> Nausea</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('heartburn')"> Heartburn</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('constipation')"> Constipation</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('backpain')"> Back pain</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('legcramps')"> Leg cramps</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('swelling')"> Swelling</button>
            <button class="discomfort-card" type="button" onclick="ANC.showDiscomfort('sleep')"> Sleep</button>
          </div>

          <div class="discomfort-output" id="discomfortOutput">
            Pick one to see strategies + when to call boundary.
          </div>

          <div class="mini-quiz">
            <h4>Remember This: Red Flag or Normal?</h4>
            <button class="mini-btn" type="button" onclick="ANC.startRedFlagGame()">Start game</button>
            <div id="redFlagGame" class="red-flag-game" aria-live="polite"></div>
          </div>

          <div class="avoid-foods-section">
            <h3 class="avoid-title"> Foods to Avoid</h3>
            <div class="avoid-grid">
              <div class="avoid-card"><div class="avoid-icon"></div><h4>Raw fish/meat</h4><p>Bacteria/parasite risk</p></div>
              <div class="avoid-card"><div class="avoid-icon"></div><h4>Unpasteurized dairy</h4><p>Listeria risk</p></div>
              <div class="avoid-card"><div class="avoid-icon"></div><h4>Highmercury fish</h4><p>Neurodevelopment risk</p></div>
              <div class="avoid-card"><div class="avoid-icon"></div><h4>Alcohol</h4><p>No safe amount</p></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== NUTRITION & SUPPLEMENTS SECTION ===== -->
    <section class="journey-section" style="background:linear-gradient(180deg,#f5eef8 0%,#fff 100%);padding:4rem 0;">
      <div style="max-width:1300px;margin:0 auto;padding:0 2rem;">
        <div class="section-header">
          <div style="display:inline-flex;align-items:center;gap:.5rem;background:rgba(76,175,80,0.1);border:1px solid rgba(76,175,80,0.2);color:#2e7d32;padding:.4rem 1rem;border-radius:50px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;margin-bottom:1rem;">
            <i class="fa-solid fa-apple-whole"></i> Essential Nutrition
          </div>
          <h2 class="section-title-prominent">
            Micronutrient <span style="background:linear-gradient(135deg,#ec407a,#ad1457);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Supplementation</span>
          </h2>
          <p class="section-subtitle-prominent">
            WHO/ICMR evidence-based guidelines for pregnancy nutrition - <strong>critical for maternal and fetal health</strong>
          </p>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;">
          <div style="background:white;border-radius:20px;padding:2rem;box-shadow:0 10px 35px rgba(0,0,0,0.08);border-left:4px solid #d32f2f;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#ffebee,#ffcdd2);color:#d32f2f;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(211,47,47,0.2);">
              <i class="fa-solid fa-droplet"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Iron Supplementation</h3>
            <div style="background:linear-gradient(135deg,#ffebee,#fff);padding:1.2rem;border-radius:12px;margin-bottom:1rem;">
              <p style="margin:0 0 .8rem;font-size:.88rem;color:#555;line-height:1.6;"><strong style="color:#d32f2f;">WHO 2016 Guideline:</strong></p>
              <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
                <li><strong>30-60mg elemental iron daily</strong> (entire pregnancy)</li>
                <li>If anemia detected: <strong>120mg daily</strong></li>
                <li>Take with Vitamin C for better absorption</li>
                <li>Avoid tea/coffee within 1 hour</li>
              </ul>
            </div>
            <div style="background:rgba(211,47,47,0.05);padding:1rem;border-radius:10px;">
              <p style="margin:0;font-size:.82rem;color:#555;"><strong>India context (ICMR):</strong> Anemia prevalence 50-80% among pregnant women. Iron deficiency linked to preterm birth, low birth weight, postpartum hemorrhage.</p>
            </div>
          </div>

          <div style="background:white;border-radius:20px;padding:2rem;box-shadow:0 10px 35px rgba(0,0,0,0.08);border-left:4px solid #f57c00;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#fff3e0,#ffecb3);color:#f57c00;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(245,124,0,0.2);">
              <i class="fa-solid fa-dna"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Folic Acid (Folate)</h3>
            <div style="background:linear-gradient(135deg,#fff3e0,#fff);padding:1.2rem;border-radius:12px;margin-bottom:1rem;">
              <p style="margin:0 0 .8rem;font-size:.88rem;color:#555;line-height:1.6;"><strong style="color:#f57c00;">ACOG/WHO Recommendation:</strong></p>
              <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
                <li><strong>400mcg (0.4mg) daily</strong> - at least 1 month pre-conception</li>
                <li>Continue throughout pregnancy</li>
                <li>High-risk: <strong>4-5mg daily</strong> (previous NTD, diabetes, epilepsy)</li>
                <li>Found in leafy greens, fortified cereals</li>
              </ul>
            </div>
            <div style="background:rgba(245,124,0,0.05);padding:1rem;border-radius:10px;">
              <p style="margin:0;font-size:.82rem;color:#555;"><strong>Why critical:</strong> Reduces neural tube defects (spina bifida, anencephaly) by 70%. Most NTDs occur before 28 days - often before pregnancy detected.</p>
            </div>
          </div>

          <div style="background:white;border-radius:20px;padding:2rem;box-shadow:0 10px 35px rgba(0,0,0,0.08);border-left:4px solid #1976d2;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#e3f2fd,#bbdefb);color:#1976d2;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(25,118,210,0.2);">
              <i class="fa-solid fa-sun"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Calcium & Vitamin D</h3>
            <div style="background:linear-gradient(135deg,#e3f2fd,#fff);padding:1.2rem;border-radius:12px;margin-bottom:1rem;">
              <p style="margin:0 0 .8rem;font-size:.88rem;color:#555;line-height:1.6;"><strong style="color:#1976d2;">WHO 2018 Guideline:</strong></p>
              <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
                <li><strong>Calcium: 1200-1500mg/day</strong> (areas with low dietary intake)</li>
                <li><strong>Vitamin D: 600 IU/day</strong> (1000-2000 IU if deficient)</li>
                <li>Reduces preeclampsia risk by 55%</li>
                <li>Essential for fetal bone development</li>
              </ul>
            </div>
            <div style="background:rgba(25,118,210,0.05);padding:1rem;border-radius:10px;">
              <p style="margin:0;font-size:.82rem;color:#555;"><strong>Food sources:</strong> Milk, yogurt, cheese, fortified OJ, fatty fish (salmon), egg yolks, sunlight exposure 10-15 min/day.</p>
            </div>
          </div>

          <div style="background:white;border-radius:20px;padding:2rem;box-shadow:0 10px 35px rgba(0,0,0,0.08);border-left:4px solid #9c27b0;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#f3e5f5,#e1bee7);color:#9c27b0;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(156,39,176,0.2);">
              <i class="fa-solid fa-fish"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Iodine & Omega-3</h3>
            <div style="background:linear-gradient(135deg,#f3e5f5,#fff);padding:1.2rem;border-radius:12px;margin-bottom:1rem;">
              <p style="margin:0 0 .8rem;font-size:.88rem;color:#555;line-height:1.6;"><strong style="color:#9c27b0;">WHO/ICMR Guidelines:</strong></p>
              <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
                <li><strong>Iodine: 250mcg/day</strong> (use iodized salt)</li>
                <li><strong>DHA: 200-300mg/day</strong> (omega-3 fatty acid)</li>
                <li>Critical for fetal brain development</li>
                <li>Deficiency causes intellectual disability</li>
              </ul>
            </div>
            <div style="background:rgba(156,39,176,0.05);padding:1rem;border-radius:10px;">
              <p style="margin:0;font-size:.82rem;color:#555;"><strong>Sources:</strong> Iodized salt, seafood, dairy. DHA: Fatty fish 2/week (avoid high-mercury fish), algae-based supplements for vegetarians.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== IMMUNIZATIONS SECTION ===== -->
    <section class="journey-section" style="background:#fff;padding:4rem 0;">
      <div style="max-width:1300px;margin:0 auto;padding:0 2rem;">
        <div class="section-header">
          <div style="display:inline-flex;align-items:center;gap:.5rem;background:rgba(33,150,243,0.1);border:1px solid rgba(33,150,243,0.2);color:#1976d2;padding:.4rem 1rem;border-radius:50px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;margin-bottom:1rem;">
            <i class="fa-solid fa-syringe"></i> Vaccination
          </div>
          <h2 class="section-title-prominent">
            Pregnancy <span style="background:linear-gradient(135deg,#ec407a,#ad1457);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Immunizations</span>
          </h2>
          <p class="section-subtitle-prominent">
            ACOG/CDC/WHO recommended vaccines to protect you and your baby - <strong>safe and effective during pregnancy</strong>
          </p>
        </div>

        <div style="background:white;border-radius:28px;padding:2.5rem;box-shadow:0 15px 50px rgba(0,0,0,0.1);margin-bottom:2rem;border:2px solid rgba(33,150,243,0.15);">
          <h3 style="font-size:1.35rem;margin-bottom:1.8rem;color:#1976d2;font-family:'Playfair Display',serif;text-align:center;">
            <i class="fa-solid fa-shield-virus"></i> Recommended Vaccines During Pregnancy
          </h3>
          
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;">
            <div style="background:linear-gradient(135deg,#e3f2fd,#fff);border-radius:16px;padding:1.8rem;border-left:4px solid #1976d2;">
              <h4 style="color:#1565c0;margin-bottom:1rem;font-size:1.1rem;display:flex;align-items:center;gap:.5rem;">
                <i class="fa-solid fa-virus-covid"></i> COVID-19 Vaccine
              </h4>
              <div style="background:white;padding:1rem;border-radius:10px;margin-bottom:.8rem;">
                <p style="margin:0 0 .6rem;font-size:.85rem;color:#555;line-height:1.6;"><strong>Recommendation:</strong> mRNA vaccines (Pfizer, Moderna) strongly recommended</p>
                <p style="margin:0;font-size:.82rem;color:#666;line-height:1.6;"><strong>Timing:</strong> Any trimester + booster as eligible</p>
              </div>
              <p style="margin:0;font-size:.8rem;color:#555;"><strong>Why:</strong> Pregnancy increases risk of severe COVID. Vaccine passes antibodies to baby, protecting newborn 2-6 months.</p>
            </div>

            <div style="background:linear-gradient(135deg,#fff3e0,#fff);border-radius:16px;padding:1.8rem;border-left:4px solid #f57c00;">
              <h4 style="color:#e65100;margin-bottom:1rem;font-size:1.1rem;display:flex;align-items:center;gap:.5rem;">
                <i class="fa-solid fa-baby"></i> Tdap (Whooping Cough)
              </h4>
              <div style="background:white;padding:1rem;border-radius:10px;margin-bottom:.8rem;">
                <p style="margin:0 0 .6rem;font-size:.85rem;color:#555;line-height:1.6;"><strong>Recommendation:</strong> ONE dose required each pregnancy</p>
                <p style="margin:0;font-size:.82rem;color:#666;line-height:1.6;"><strong>Timing:</strong> 27-36 weeks gestation (optimally 27-32 weeks)</p>
              </div>
              <p style="margin:0;font-size:.8rem;color:#555;"><strong>Why:</strong> Pertussis (whooping cough) deadly for newborns. Maternal antibodies protect baby until 2-month vaccines.</p>
            </div>

            <div style="background:linear-gradient(135deg,#f3e5f5,#fff);border-radius:16px;padding:1.8rem;border-left:4px solid #7b1fa2;">
              <h4 style="color:#6a1b9a;margin-bottom:1rem;font-size:1.1rem;display:flex;align-items:center;gap:.5rem;">
                <i class="fa-solid fa-virus"></i> Influenza (Flu) Shot
              </h4>
              <div style="background:white;padding:1rem;border-radius:10px;margin-bottom:.8rem;">
                <p style="margin:0 0 .6rem;font-size:.85rem;color:#555;line-height:1.6;"><strong>Recommendation:</strong> Inactivated flu vaccine only (NOT nasal spray)</p>
                <p style="margin:0;font-size:.82rem;color:#666;line-height:1.6;"><strong>Timing:</strong> Any trimester, during flu season (Oct-March)</p>
              </div>
              <p style="margin:0;font-size:.8rem;color:#555;"><strong>Why:</strong> Pregnant women 5 higher risk severe flu complications (pneumonia, hospitalization). Protects baby first 6 months.</p>
            </div>

            <div style="background:linear-gradient(135deg,#e8f5e9,#fff);border-radius:16px;padding:1.8rem;border-left:4px solid #2e7d32;">
              <h4 style="color:#1b5e20;margin-bottom:1rem;font-size:1.1rem;display:flex;align-items:center;gap:.5rem;">
                <i class="fa-solid fa-check-circle"></i> Hepatitis B (if at risk)
              </h4>
              <div style="background:white;padding:1rem;border-radius:10px;margin-bottom:.8rem;">
                <p style="margin:0 0 .6rem;font-size:.85rem;color:#555;line-height:1.6;"><strong>Recommendation:</strong> 3-dose series if not immune</p>
                <p style="margin:0;font-size:.82rem;color:#666;line-height:1.6;"><strong>Risk factors:</strong> Healthcare workers, IV drug use, multiple partners, HBV+ household contact</p>
              </div>
              <p style="margin:0;font-size:.8rem;color:#555;"><strong>Why:</strong> Mother-to-child transmission causes chronic hepatitis in 90% of infected newborns.</p>
            </div>
          </div>
        </div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:2rem;">
          <div style="background:linear-gradient(135deg,rgba(239,83,80,0.1),rgba(244,67,54,0.05));border-radius:20px;padding:2rem;border:2px solid rgba(239,83,80,0.3);">
            <h4 style="color:#d32f2f;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;font-size:1.05rem;">
              <i class="fa-solid fa-ban"></i> Vaccines to AVOID During Pregnancy
            </h4>
            <p style="color:#555;margin:0 0 1rem;line-height:1.7;font-size:.9rem;">Live vaccines contraindicated - can harm developing fetus:</p>
            <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
              <li>MMR (Measles, Mumps, Rubella)</li>
              <li>Varicella (Chickenpox)</li>
              <li>Live attenuated flu (nasal spray)</li>
              <li>BCG (Tuberculosis)</li>
              <li>Yellow Fever (unless traveling to endemic area)</li>
            </ul>
            <p style="margin:1rem 0 0;font-size:.8rem;color:#666;"><em>Get these vaccines BEFORE pregnancy or AFTER delivery if not immune.</em></p>
          </div>

          <div style="background:linear-gradient(135deg,rgba(33,150,243,0.08),rgba(66,165,245,0.05));border-radius:20px;padding:2rem;border:1px solid rgba(33,150,243,0.2);">
            <h4 style="color:#1976d2;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;font-size:1.05rem;">
              <i class="fa-solid fa-users"></i> Cocooning Strategy
            </h4>
            <p style="color:#555;margin:0 0 1rem;line-height:1.7;font-size:.9rem;">Protect newborn by vaccinating close contacts:</p>
            <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
              <li><strong>Partners, grandparents, caregivers</strong> should get Tdap if not vaccinated in past 10 years</li>
              <li>All household members should get annual flu shot</li>
              <li>COVID-19 vaccination and boosters for all close contacts</li>
            </ul>
            <p style="margin:1rem 0 0;font-size:.8rem;color:#666;"><strong>Critical period:</strong> First 2 months when baby too young for most vaccines.</p>
          </div>
        </div>
      </div>
    </section>


    <!-- WARNING SIGNS -->
    <section id="warning" class="warning-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Know the Signs</span>
        </div>
        <h2 class="section-title-prominent">
          When to <span class="title-highlight">Seek Help</span>
        </h2>
        <p class="section-subtitle-prominent">
          Bleeding, severe headache with vision changes, decreased movement after 28 weeks, fever >100.4F  dont wait. 
        </p>
      </div>

      <div class="triage">
        <div class="triage-left">
          <h3>Interactive Triage Simulator</h3>
          <p class="muted">
            Choose a scenario. The simulator teaches urgency and the safest next action (education-only; not medical advice).
          </p>

          <div class="scenario-grid">
            <button class="scenario-card emergency" type="button" onclick="ANC.openScenario('bleeding')">
               Bleeding
            </button>
            <button class="scenario-card emergency" type="button" onclick="ANC.openScenario('movement')">
               Decreased movement
            </button>
            <button class="scenario-card urgent" type="button" onclick="ANC.openScenario('fever')">
               Fever
            </button>
            <button class="scenario-card urgent" type="button" onclick="ANC.openScenario('swelling')">
               Sudden swelling
            </button>
            <button class="scenario-card monitor" type="button" onclick="ANC.openScenario('nausea')">
               Persistent vomiting
            </button>
            <button class="scenario-card urgent" type="button" onclick="ANC.openScenario('headache')">
               Severe headache + vision
            </button>
          </div>

          <div class="triage-actions">
            <button class="mini-btn outline" type="button" onclick="ANC.randomScenario()">Random scenario</button>
            <button class="mini-btn" type="button" onclick="ANC.triageQuiz()">Quiz mode</button>
          </div>
        </div>

        <div class="triage-right" id="triageOutput" aria-live="polite">
          <div class="panel-placeholder">
            <div class="placeholder-icon"></div>
            <p>Pick a scenario to see urgency + what to do now.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- KICK COUNTER -->
    <section id="kicks" class="kick-counter-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Fetal Movement</span>
        </div>
        <h2 class="section-title-prominent">
          Practice <span class="title-highlight">Kick Counting</span>
        </h2>
        <p class="section-subtitle-prominent">
          From 28 weeks onward, a common method is 10 movements within 2 hours during babys active time. 
        </p>
      </div>

      <div class="kick-counter-game">
        <div class="kick-counter-interactive">
          <div class="counter-display">
            <div class="kick-count-circle">
              <div class="count-number" id="kickCount">0</div>
              <div class="count-label">Movements</div>
            </div>

            <div class="timer-card">
              <div class="timer-value" id="kickTimer">00:00</div>
              <div class="timer-label">Elapsed</div>
            </div>

            <div class="kick-controls">
              <button class="btn-primary" id="startKickBtn" type="button" onclick="ANC.startKickCounter()">Start</button>
              <button class="btn-secondary" id="resetKickBtn" type="button" onclick="ANC.resetKickCounter()" disabled>Reset</button>
            </div>

            <div class="kick-note muted">
              Tip: pick the same daily time when baby is most active for consistent tracking.
            </div>
          </div>

          <div class="kick-visual">
            <div class="baby-outline-kick" onclick="ANC.recordKick()">
              <div class="kick-zone zone-1"></div>
              <div class="kick-zone zone-2"></div>
              <div class="kick-zone zone-3"></div>
              <p class="kick-instruction">Click anywhere to record a movement</p>
            </div>
          </div>

          <div class="kick-history">
            <h4>Sessions</h4>
            <div class="history-list" id="kickHistoryList">
              <p class="no-data">No sessions recorded yet</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- BIRTH PLAN - REVOLUTIONARY INTERACTIVE UI -->
    <section id="birth" class="birth-plan-section-v2">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Design Your Dream Birth Experience</span>
        </div>
        <h2 class="section-title-prominent">
          Create Your <span class="title-highlight">Birth Journey Plan</span>
        </h2>
        <p class="section-subtitle-prominent">
          Visualize, customize, and prepare for your perfect birth experience with our interactive planning studio.
        </p>
      </div>

      <!-- Progress Ring at Top -->
      <div class="birth-plan-progress-ring">
        <svg class="progress-ring" width="180" height="180">
          <circle class="progress-ring-circle-bg" cx="90" cy="90" r="80" />
          <circle class="progress-ring-circle" id="birthProgressCircle" cx="90" cy="90" r="80" />
        </svg>
        <div class="progress-content">
          <div class="progress-percentage" id="birthProgressPercentage">0%</div>
          <div class="progress-label">Complete</div>
        </div>
      </div>

      <!-- Interactive Journey Builder -->
      <div class="birth-journey-builder">
        
        <!-- Stage Navigation with Visual Timeline -->
        <div class="journey-stages-nav">
          <div class="stages-timeline-line"></div>
          
          <button class="journey-stage-btn active" data-stage="labor" onclick="ANC.switchBirthStage('labor')">
            <div class="stage-icon-wrapper">
              <div class="stage-icon"></div>
              <div class="stage-check" id="checkLabor"></div>
            </div>
            <div class="stage-info">
              <div class="stage-title">Labor</div>
              <div class="stage-subtitle">Your way</div>
            </div>
          </button>

          <button class="journey-stage-btn" data-stage="pain" onclick="ANC.switchBirthStage('pain')">
            <div class="stage-icon-wrapper">
              <div class="stage-icon"></div>
              <div class="stage-check" id="checkPain"></div>
            </div>
            <div class="stage-info">
              <div class="stage-title">Pain Relief</div>
              <div class="stage-subtitle">Your comfort</div>
            </div>
          </button>

          <button class="journey-stage-btn" data-stage="delivery" onclick="ANC.switchBirthStage('delivery')">
            <div class="stage-icon-wrapper">
              <div class="stage-icon"></div>
              <div class="stage-check" id="checkDelivery"></div>
            </div>
            <div class="stage-info">
              <div class="stage-title">Delivery</div>
              <div class="stage-subtitle">First moments</div>
            </div>
          </button>

          <button class="journey-stage-btn" data-stage="postpartum" onclick="ANC.switchBirthStage('postpartum')">
            <div class="stage-icon-wrapper">
              <div class="stage-icon"></div>
              <div class="stage-check" id="checkPostpartum"></div>
            </div>
            <div class="stage-info">
              <div class="stage-title">After Birth</div>
              <div class="stage-subtitle">Golden hour</div>
            </div>
          </button>
        </div>

        <!-- Main Content Area -->
        <div class="birth-stage-content" id="birthStageContent">
          <!-- Dynamic content loaded here -->
        </div>

        <!-- Live Preview Panel -->
        <div class="birth-plan-live-preview">
          <div class="preview-header">
            <h3>Your Birth Vision</h3>
            <div class="preview-actions">
              <button class="icon-btn" onclick="ANC.togglePreviewExpand()" title="Expand">
                <span id="expandIcon"></span>
              </button>
            </div>
          </div>

          <div class="preview-mood-board" id="previewMoodBoard">
            <div class="mood-board-empty">
              <div class="empty-icon"></div>
              <p>Start selecting to build your birth vision</p>
            </div>
          </div>

          <div class="preview-selections-list" id="previewSelectionsList">
            <!-- Dynamic selections -->
          </div>

          <div class="preview-stats">
            <div class="stat-item">
              <span class="stat-number" id="totalSelections">0</span>
              <span class="stat-label">Preferences</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" id="completedStages">0</span>
              <span class="stat-label">Stages Done</span>
            </div>
          </div>

          <div class="preview-actions-bottom">
            <button class="btn-preview-action" onclick="ANC.shareableBirthPlan()">
              <span class="btn-icon"></span> Create Shareable
            </button>
            <button class="btn-preview-action primary" onclick="ANC.downloadBirthPlanV2()">
              <span class="btn-icon"></span> Download PDF
            </button>
            <button class="btn-preview-action outline" onclick="ANC.clearBirthPlanV2()">
              <span class="btn-icon"></span> Start Over
            </button>
          </div>
        </div>
      </div>

      <!-- Quick Actions Bar -->
      <div class="birth-plan-quick-actions">
        <button class="quick-action-btn" onclick="ANC.showBirthPlanTemplates()">
          <span class="qa-icon"></span>
          <span class="qa-label">Use Template</span>
        </button>
        <button class="quick-action-btn" onclick="ANC.showBirthScenarios()">
          <span class="qa-icon"></span>
          <span class="qa-label">Try Scenarios</span>
        </button>
        <button class="quick-action-btn" onclick="ANC.showBirthAffirmations()">
          <span class="qa-icon"></span>
          <span class="qa-label">Add Affirmations</span>
        </button>
        <button class="quick-action-btn" onclick="ANC.showPartnerGuide()">
          <span class="qa-icon"></span>
          <span class="qa-label">Partner Guide</span>
        </button>
      </div>

      <!-- Educational Info Cards -->
      <div class="birth-education-cards">
        <div class="edu-card" onclick="ANC.showBirthInfo('stages')">
          <div class="edu-icon"></div>
          <h4>Labor Stages Explained</h4>
          <p>Understand what happens during each stage</p>
        </div>
        <div class="edu-card" onclick="ANC.showBirthInfo('positions')">
          <div class="edu-icon"></div>
          <h4>Labor Positions</h4>
          <p>Explore positions that can help</p>
        </div>
        <div class="edu-card" onclick="ANC.showBirthInfo('breathing')">
          <div class="edu-icon"></div>
          <h4>Breathing Techniques</h4>
          <p>Practice calming breath patterns</p>
        </div>
        <div class="edu-card" onclick="ANC.showBirthInfo('interventions')">
          <div class="edu-icon"></div>
          <h4>Common Interventions</h4>
          <p>Know your options and questions</p>
        </div>
      </div>
    </section>

    <!-- POSTPARTUM PLANNING -->
    <section id="postpartum-planning" class="postpartum-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">After Delivery</span>
        </div>
        <h2 class="section-title-prominent">
          Postpartum <span class="title-highlight">Recovery Plan</span>
        </h2>
        <p class="section-subtitle-prominent">
          Postpartum planning includes recovery expectations, contraception options, breastfeeding support, and mental health awareness. 
        </p>
      </div>

      <div class="postpartum-grid">
        <div class="card-surface">
          <h3>Recovery Checklist Builder</h3>
          <p class="muted">Toggle items to generate a personalized printable checklist.</p>

          <div class="checklist" id="ppChecklist"></div>

          <div class="row">
            <button class="mini-btn outline" type="button" onclick="ANC.resetPostpartumChecklist()">Reset</button>
            <button class="mini-btn" type="button" onclick="ANC.exportPostpartumChecklist()">Export</button>
          </div>
        </div>

        <div class="card-surface">
          <h3>Mood & Safety</h3>
          <p class="muted">
            This section teaches warning signs and when to seek help (education-only).
          </p>

          <div class="mood-cards">
            <div class="mood-card">
              <h4>Normal baby blues</h4>
              <p>Short-lived mood swings, tearfulness, overwhelm (common early).</p>
            </div>
            <div class="mood-card critical">
              <h4>Postpartum depression warning</h4>
              <p>Persistent sadness, hopelessness, loss of interest, or thoughts of harm  seek help urgently.</p>
            </div>
            <div class="mood-card">
              <h4>Support plan</h4>
              <p>Identify 2 people you can call + choose one daily recovery habit.</p>
              <button class="mini-btn" type="button" onclick="ANC.buildSupportPlan()">Build Support Plan</button>
              <div id="supportPlanOut" class="muted"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SUPPORT & COMMUNITIES -->

    <!-- ===== MENTAL HEALTH SCREENING SECTION ===== -->
    <section class="journey-section" style="background:linear-gradient(180deg,#faf5fb 0%,#f5eef8 100%);padding:4rem 0;">
      <div style="max-width:1300px;margin:0 auto;padding:0 2rem;">
        <div class="section-header">
          <div style="display:inline-flex;align-items:center;gap:.5rem;background:rgba(124,58,237,0.1);border:1px solid rgba(124,58,237,0.2);color:#7c3aed;padding:.4rem 1rem;border-radius:50px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;margin-bottom:1rem;">
            <i class="fa-solid fa-brain"></i> Mental Wellness
          </div>
          <h2 class="section-title-prominent">
            Mental Health <span style="background:linear-gradient(135deg,#ec407a,#ad1457);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Screening</span>
          </h2>
          <p class="section-subtitle-prominent">
            ACOG recommends depression screening at least once during perinatal period - <strong>your emotional health matters</strong>
          </p>
        </div>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:2rem;margin-bottom:2rem;">
          <div style="background:white;border-radius:24px;padding:2rem;box-shadow:0 10px 40px rgba(0,0,0,0.08);border-left:4px solid #7c3aed;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#ede7f6,#e1bee7);color:#7c3aed;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(124,58,237,0.2);">
              <i class="fa-solid fa-heart-pulse"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Prevalence & Risk</h3>
            <p style="color:#666;line-height:1.7;margin-bottom:1rem;font-size:.9rem;"><strong style="color:#7c3aed;">ACOG 2023:</strong> 10-15% experience depression during pregnancy; 13-19% postpartum. Early detection improves outcomes significantly.</p>
            <div style="background:rgba(124,58,237,0.05);padding:1rem;border-radius:12px;">
              <p style="margin:0;font-size:.85rem;color:#555;line-height:1.6;"><strong>Risk factors:</strong> Previous depression, family history, lack of support, stressful life events, unplanned pregnancy, intimate partner violence.</p>
            </div>
          </div>

          <div style="background:white;border-radius:24px;padding:2rem;box-shadow:0 10px 40px rgba(0,0,0,0.08);border-left:4px solid #9c27b0;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#f3e5f5,#e1bee7);color:#9c27b0;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(156,39,176,0.2);">
              <i class="fa-solid fa-clipboard-check"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">Screening Tools (WHO)</h3>
            <div style="display:grid;gap:.8rem;">
              <div style="background:linear-gradient(135deg,#f3e5f5,#fff);padding:1rem;border-radius:10px;">
                <strong style="display:block;color:#7b1fa2;margin-bottom:.4rem;font-size:.95rem;">Edinburgh Postnatal Depression Scale (EPDS)</strong>
                <p style="margin:0;font-size:.85rem;color:#555;line-height:1.6;">Gold standard 10-question tool. Score 10 indicates possible depression. Score 13 warrants referral. Question #10 screens for self-harm thoughts.</p>
              </div>
              <div style="background:linear-gradient(135deg,#fff8e1,#fff);padding:1rem;border-radius:10px;">
                <strong style="display:block;color:#f57c00;margin-bottom:.4rem;font-size:.95rem;">PHQ-9 (Patient Health Questionnaire)</strong>
                <p style="margin:0;font-size:.85rem;color:#555;line-height:1.6;">Alternative validated tool. Score 10 indicates moderate depression. Includes suicide risk question.</p>
              </div>
            </div>
          </div>

          <div style="background:white;border-radius:24px;padding:2rem;box-shadow:0 10px 40px rgba(0,0,0,0.08);border-left:4px solid #2e7d32;">
            <div style="width:56px;height:56px;border-radius:16px;background:linear-gradient(135deg,#e8f5e9,#c8e6c9);color:#2e7d32;display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin-bottom:1.2rem;box-shadow:0 4px 15px rgba(46,125,50,0.2);">
              <i class="fa-solid fa-hand-holding-heart"></i>
            </div>
            <h3 style="font-size:1.2rem;margin-bottom:.8rem;color:#212121;font-family:'Playfair Display',serif;">When to Seek Help</h3>
            <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.6rem;">
              <li style="display:flex;align-items:start;gap:.6rem;font-size:.88rem;color:#555;">
                <i class="fa-solid fa-check" style="color:#2e7d32;margin-top:.2rem;"></i>
                <span>Persistent sadness, hopelessness >2 weeks</span>
              </li>
              <li style="display:flex;align-items:start;gap:.6rem;font-size:.88rem;color:#555;">
                <i class="fa-solid fa-check" style="color:#2e7d32;margin-top:.2rem;"></i>
                <span>Loss of interest in activities/baby</span>
              </li>
              <li style="display:flex;align-items:start;gap:.6rem;font-size:.88rem;color:#555;">
                <i class="fa-solid fa-check" style="color:#2e7d32;margin-top:.2rem;"></i>
                <span>Difficulty bonding with baby</span>
              </li>
              <li style="display:flex;align-items:start;gap:.6rem;font-size:.88rem;color:#555;">
                <i class="fa-solid fa-check" style="color:#2e7d32;margin-top:.2rem;"></i>
                <span>Thoughts of harming self or baby</span>
              </li>
              <li style="display:flex;align-items:start;gap:.6rem;font-size:.88rem;color:#555;">
                <i class="fa-solid fa-check" style="color:#2e7d32;margin-top:.2rem;"></i>
                <span>Severe anxiety, panic attacks</span>
              </li>
            </ul>
            <div style="background:rgba(46,125,50,0.05);padding:1rem;border-radius:10px;margin-top:1rem;">
              <p style="margin:0;font-size:.85rem;color:#555;"><strong>Treatment:</strong> Psychotherapy (CBT, IPT) + SSRIs if needed (sertraline, fluoxetine safe in pregnancy/lactation). Support groups highly effective.</p>
            </div>
          </div>
        </div>

        <div style="background:linear-gradient(135deg,rgba(211,47,47,0.1),rgba(239,83,80,0.05));border-radius:20px;padding:2rem;border:2px solid rgba(211,47,47,0.3);">
          <h4 style="color:#d32f2f;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;font-size:1.1rem;font-family:'Playfair Display',serif;">
            <i class="fa-solid fa-phone"></i> Crisis Resources - Available 24/7
          </h4>
          <p style="color:#555;margin:0;line-height:1.7;font-size:.95rem;">
            <strong style="color:#d32f2f;">If experiencing suicidal thoughts or crisis:</strong><br>
             KIRAN Mental Health Helpline (India): <strong>1800-599-0019</strong><br>
             National Suicide Prevention Lifeline (USA): <strong>988</strong><br>
             Postpartum Support International: <strong>1-800-944-4773</strong> (Text "HELP" to 800-944-4773)
          </p>
        </div>
      </div>
    </section>

    <!-- ===== DOMESTIC VIOLENCE SCREENING SECTION ===== -->
    <section class="journey-section" style="background:#fff;padding:4rem 0;">
      <div style="max-width:1300px;margin:0 auto;padding:0 2rem;">
        <div class="section-header">
          <div style="display:inline-flex;align-items:center;gap:.5rem;background:rgba(239,83,80,0.1);border:1px solid rgba(239,83,80,0.2);color:#d32f2f;padding:.4rem 1rem;border-radius:50px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;margin-bottom:1rem;">
            <i class="fa-solid fa-shield-heart"></i> Safety First
          </div>
          <h2 class="section-title-prominent">
            Intimate Partner Violence <span style="background:linear-gradient(135deg,#ec407a,#ad1457);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Screening</span>
          </h2>
          <p class="section-subtitle-prominent">
            <strong>ACOG mandatory screening:</strong> All pregnant women should be screened for intimate partner violence at first visit, each trimester, and postpartum
          </p>
        </div>

        <div style="display:grid;grid-template-columns:1.2fr 0.8fr;gap:2rem;margin-bottom:2rem;">
          <div style="background:white;border-radius:24px;padding:2.5rem;box-shadow:0 12px 45px rgba(0,0,0,0.1);border:2px solid rgba(239,83,80,0.2);">
            <h3 style="font-size:1.3rem;margin-bottom:1.5rem;color:#d32f2f;font-family:'Playfair Display',serif;">
              <i class="fa-solid fa-exclamation-triangle"></i> Why Screening Matters
            </h3>
            <div style="display:grid;gap:1.2rem;">
              <div style="background:linear-gradient(135deg,#ffebee,#fff);padding:1.2rem;border-radius:12px;border-left:3px solid #d32f2f;">
                <strong style="display:block;color:#c62828;margin-bottom:.5rem;font-size:.95rem;">Prevalence During Pregnancy</strong>
                <p style="margin:0;font-size:.88rem;color:#555;line-height:1.6;">4-8% of pregnant women experience intimate partner violence (IPV). <strong>Pregnancy may trigger or escalate abuse.</strong> WHO data shows IPV increases risk of miscarriage, preterm birth, low birth weight, and maternal death.</p>
              </div>
              <div style="background:linear-gradient(135deg,#fff3e0,#fff);padding:1.2rem;border-radius:12px;border-left:3px solid #f57c00;">
                <strong style="display:block;color:#e65100;margin-bottom:.5rem;font-size:.95rem;">Screening Questions (HITS Tool)</strong>
                <p style="margin:0 0 .8rem;font-size:.82rem;color:#555;">Over the past year, how often has your partner:</p>
                <ol style="margin:0;padding-left:1.2rem;font-size:.82rem;color:#555;line-height:1.6;">
                  <li><strong>H</strong>urt you physically?</li>
                  <li><strong>I</strong>nsulted or talked down to you?</li>
                  <li><strong>T</strong>hreatened you with harm?</li>
                  <li><strong>S</strong>creamed or cursed at you?</li>
                </ol>
                <p style="margin:.8rem 0 0;font-size:.82rem;color:#555;"><em>Scale: Never (1) to Frequently (5). Score >10 indicates abuse.</em></p>
              </div>
              <div style="background:linear-gradient(135deg,#e8f5e9,#fff);padding:1.2rem;border-radius:12px;border-left:3px solid #2e7d32;">
                <strong style="display:block;color:#1b5e20;margin-bottom:.5rem;font-size:.95rem;">What Providers Should Do (ACOG)</strong>
                <ul style="margin:0;padding-left:1.2rem;font-size:.85rem;color:#555;line-height:1.7;">
                  <li>Screen in private, without partner present</li>
                  <li>Provide safety planning resources</li>
                  <li>Document findings without patient identifiers visible</li>
                  <li>Offer referrals to social work, legal aid, shelters</li>
                  <li>Mandatory reporting only if law requires</li>
                </ul>
              </div>
            </div>
          </div>

          <div>
            <div style="background:linear-gradient(135deg,#d32f2f,#c62828);border-radius:24px;padding:2rem;color:white;margin-bottom:1.5rem;box-shadow:0 10px 35px rgba(211,47,47,0.4);">
              <h4 style="font-size:1.15rem;margin-bottom:1rem;font-family:'Playfair Display',serif;">
                <i class="fa-solid fa-phone-volume"></i> Get Help Now
              </h4>
              <div style="background:rgba(255,255,255,0.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(10px);margin-bottom:1rem;">
                <p style="margin:0 0 .6rem;font-size:.85rem;opacity:.9;"><strong>National Domestic Violence Hotline</strong></p>
                <p style="margin:0;font-size:1.5rem;font-weight:700;">1-800-799-7233</p>
                <p style="margin:.3rem 0 0;font-size:.75rem;opacity:.8;">24/7 support in 200+ languages</p>
              </div>
              <div style="background:rgba(255,255,255,0.15);padding:1.2rem;border-radius:12px;backdrop-filter:blur(10px);">
                <p style="margin:0 0 .6rem;font-size:.85rem;opacity:.9;"><strong>India - Women Helpline</strong></p>
                <p style="margin:0;font-size:1.5rem;font-weight:700;">181</p>
                <p style="margin:.3rem 0 0;font-size:.75rem;opacity:.8;">Free, 24/7, confidential</p>
              </div>
            </div>
            <div style="background:white;border-radius:16px;padding:1.5rem;box-shadow:0 6px 25px rgba(0,0,0,0.08);">
              <h5 style="font-size:.95rem;margin-bottom:.8rem;color:#212121;">Safety Planning Essentials</h5>
              <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.5rem;">
                <li style="font-size:.8rem;color:#666;display:flex;align-items:start;gap:.5rem;">
                  <i class="fa-solid fa-circle-check" style="color:#2e7d32;margin-top:.2rem;font-size:.7rem;"></i>
                  <span>Keep emergency contacts saved</span>
                </li>
                <li style="font-size:.8rem;color:#666;display:flex;align-items:start;gap:.5rem;">
                  <i class="fa-solid fa-circle-check" style="color:#2e7d32;margin-top:.2rem;font-size:.7rem;"></i>
                  <span>Pack emergency bag (hidden)</span>
                </li>
                <li style="font-size:.8rem;color:#666;display:flex;align-items:start;gap:.5rem;">
                  <i class="fa-solid fa-circle-check" style="color:#2e7d32;margin-top:.2rem;font-size:.7rem;"></i>
                  <span>Identify safe place to go</span>
                </li>
                <li style="font-size:.8rem;color:#666;display:flex;align-items:start;gap:.5rem;">
                  <i class="fa-solid fa-circle-check" style="color:#2e7d32;margin-top:.2rem;font-size:.7rem;"></i>
                  <span>Document incidents (photos, dates)</span>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>


    <!-- ===== WARNING SIGNS SECTION ===== -->
    <section class="journey-section" style="background:linear-gradient(180deg,#fff 0%,#fce4ec 100%);padding:4rem 0;">
      <div style="max-width:1300px;margin:0 auto;padding:0 2rem;">
        <div class="section-header">
          <div style="display:inline-flex;align-items:center;gap:.5rem;background:rgba(211,47,47,0.1);border:1px solid rgba(211,47,47,0.2);color:#c62828;padding:.4rem 1rem;border-radius:50px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;margin-bottom:1rem;">
            <i class="fa-solid fa-bell"></i> Emergency Awareness
          </div>
          <h2 class="section-title-prominent">
            Warning Signs - <span style="background:linear-gradient(135deg,#ec407a,#ad1457);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Call Your Doctor Immediately</span>
          </h2>
          <p class="section-subtitle-prominent">
            ACOG guidance on pregnancy complications requiring urgent medical attention - <strong>don't wait, call immediately</strong>
          </p>
        </div>

        <div style="background:white;border-radius:28px;padding:2.5rem;box-shadow:0 20px 60px rgba(211,47,47,0.2);border:3px solid #d32f2f;margin-bottom:2rem;">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;">
            <div>
              <h3 style="color:#c62828;margin-bottom:1.2rem;font-size:1.2rem;font-family:'Playfair Display',serif;">
                <i class="fa-solid fa-heart-pulse"></i> Bleeding & Pain
              </h3>
              <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.7rem;">
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Vaginal bleeding</strong> (any amount, any trimester)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Severe abdominal/pelvic pain</strong></span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Fluid gush</strong> from vagina (possible rupture of membranes)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Contractions</strong> before 37 weeks (preterm labor)</span>
                </li>
              </ul>
            </div>

            <div>
              <h3 style="color:#c62828;margin-bottom:1.2rem;font-size:1.2rem;font-family:'Playfair Display',serif;">
                <i class="fa-solid fa-head-side-virus"></i> Preeclampsia Signs
              </h3>
              <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.7rem;">
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Severe persistent headache</strong> (doesn't respond to meds)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Vision changes</strong> (blurred, seeing spots, light sensitivity)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Sudden swelling</strong> face/hands/feet</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Right upper abdominal pain</strong></span>
                </li>
              </ul>
            </div>

            <div>
              <h3 style="color:#c62828;margin-bottom:1.2rem;font-size:1.2rem;font-family:'Playfair Display',serif;">
                <i class="fa-solid fa-baby"></i> Fetal Concerns
              </h3>
              <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.7rem;">
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Decreased fetal movement</strong> (<4 movements in 2 hours after 28 weeks)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>No fetal movement</strong> for several hours (after usually active)</span>
                </li>
              </ul>
            </div>

            <div>
              <h3 style="color:#c62828;margin-bottom:1.2rem;font-size:1.2rem;font-family:'Playfair Display',serif;">
                <i class="fa-solid fa-thermometer-full"></i> Infection/Other
              </h3>
              <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.7rem;">
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Fever >100.4F (38C)</strong></span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Persistent vomiting</strong> (can't keep fluids down)</span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Painful urination/burning</strong></span>
                </li>
                <li style="display:flex;align-items:start;gap:.6rem;font-size:.9rem;color:#333;">
                  <i class="fa-solid fa-exclamation-triangle" style="color:#d32f2f;margin-top:.2rem;"></i>
                  <span><strong>Chest pain/difficulty breathing</strong></span>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div style="background:linear-gradient(135deg,#c62828,#d32f2f);color:white;border-radius:20px;padding:2rem;text-align:center;box-shadow:0 15px 45px rgba(198,40,40,0.4);">
          <h3 style="font-size:1.5rem;margin-bottom:1rem;font-family:'Playfair Display',serif;">
            <i class="fa-solid fa-phone-volume"></i> When in Doubt, Call
          </h3>
          <p style="font-size:1.1rem;margin:0;line-height:1.8;opacity:.95;">
            <strong>Trust your instincts.</strong> If something feels wrong, contact your healthcare provider immediately.<br>
            Better to call unnecessarily than delay care for a true emergency.
          </p>
          <div style="margin-top:1.5rem;padding:1.5rem;background:rgba(255,255,255,0.15);border-radius:16px;backdrop-filter:blur(10px);">
            <p style="margin:0 0 .5rem;font-size:.9rem;opacity:.9;">Emergency Services</p>
            <p style="margin:0;font-size:2rem;font-weight:700;">108 (India) | 911 (USA)</p>
          </div>
        </div>
      </div>
    </section>
    <section id="support" class="community-section">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">You're Not Alone - 5,000+ Mothers</span>
        </div>
        <h2 class="section-title-prominent">
          Join Our <span class="title-highlight">Antenatal Care Community</span>
        </h2>
        <p class="section-subtitle-prominent">
          Connect with thousands of expecting mothers. Share experiences, get support, and learn from each other's pregnancy journeys.
        </p>
      </div>

      <div class="community-grid">
        <!-- WhatsApp Groups -->
        <div class="community-card clickable" onclick="window.open('https://chat.whatsapp.com/antenatal-support', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge live">Live Chat</div>
          <h3>WhatsApp Support Groups</h3>
          <p>24/7 peer support from expecting mothers at every stage of pregnancy</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">800+ Active Members</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">200+ Daily Messages</span>
            </span>
          </div>
          <div class="live-activity">
            <div class="activity-dot"></div>
            <span>24 members active now</span>
          </div>
          <button class="community-btn">
            <span>Join WhatsApp Group</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Facebook Groups -->
        <div class="community-card clickable" onclick="window.open('https://www.facebook.com/groups/antenatal-care-india', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge popular">Most Popular</div>
          <h3>Facebook Community</h3>
          <p>Share pregnancy milestones, ask questions, and celebrate victories together</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">2,500+ Members</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Daily Posts</span>
            </span>
          </div>
          <div class="recent-topics">
            <h4>Recent Topics:</h4>
            <ul>
              <li>"First trimester tips that worked for me"</li>
              <li>"Best exercises during second trimester"</li>
              <li>"Hospital bag checklist - don't forget these!"</li>
            </ul>
          </div>
          <button class="community-btn">
            <span>Join Facebook Group</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Telegram Channel -->
        <div class="community-card clickable" onclick="window.open('https://t.me/antenatal_care_india', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge expert">Expert Tips</div>
          <h3>Telegram Channel</h3>
          <p>Daily pregnancy tips, nutrition advice, and expert guidance delivered to your phone</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">1,200+ Subscribers</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Expert Curated</span>
            </span>
          </div>
          <div class="channel-preview">
            <h4>Today's Tip:</h4>
            <p>"Week 28: Start kick counting daily during baby's active times. 10 movements in 2 hours is reassuring!"</p>
          </div>
          <button class="community-btn">
            <span>Subscribe to Channel</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Reddit Community -->
        <div class="community-card clickable" onclick="window.open('https://www.reddit.com/r/PregnancyIndia/', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge global">Global Community</div>
          <h3>Reddit Discussions</h3>
          <p>In-depth discussions, evidence-based information, and global perspectives on pregnancy</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">25,000+ Members</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Evidence-Based</span>
            </span>
          </div>
          <div class="reddit-highlights">
            <h4>Top Discussions:</h4>
            <ul>
              <li>"Pregnancy success stories compilation"</li>
              <li>"Latest antenatal research and guidelines"</li>
              <li>"Birth plan templates and examples"</li>
            </ul>
          </div>
          <button class="community-btn">
            <span>Join Reddit</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Virtual Meetups -->
        <div class="community-card clickable" onclick="window.open('https://meet.google.com/antenatal-support', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge">Weekly Sessions</div>
          <h3>Virtual Support Meetups</h3>
          <p>Weekly video calls with healthcare educators, nutritionists, and peer support</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Every Sunday 4 PM</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Expert Led</span>
            </span>
          </div>
          <div class="next-session">
            <h4>Next Session:</h4>
            <p><strong>Sunday, Feb 16 at 4:00 PM</strong></p>
            <p>Topic: "Second Trimester Nutrition & Exercise"</p>
            <p>Speaker: Dr. Meera Kapoor, Obstetrician</p>
          </div>
          <button class="community-btn">
            <span>Register for Meetup</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Pregnancy Stories -->
        <div class="community-card clickable" onclick="ANC.openSuccessStories()">
          <div class="card-icon-animated"></div>
          <div class="card-badge inspiring">Inspiring</div>
          <h3>Pregnancy Stories</h3>
          <p>Read beautiful pregnancy journeys, birth stories, and experiences from other mothers</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">1,000+ Stories</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Hope & Inspiration</span>
            </span>
          </div>
          <div class="story-preview">
            <div class="story-quote">"From my first positive test to holding my baby, this journey taught me strength I never knew I had. Joining this community made all the difference!" - Anjali, Delhi</div>
          </div>
          <button class="community-btn">
            <span>Read Stories</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Expert Q&A -->
        <div class="community-card clickable" onclick="window.open('https://forms.gle/antenatal-expert-qa', '_blank')">
          <div class="card-icon-animated"></div>
          <div class="card-badge">Free</div>
          <h3>Ask the Experts</h3>
          <p>Monthly Q&A sessions with obstetricians, midwives, lactation consultants, and pediatricians</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">First Saturday/Month</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">Certified Experts</span>
            </span>
          </div>
          <div class="expert-panel">
            <h4>Expert Panel:</h4>
            <ul>
              <li>Dr. Priya Sharma - Obstetrician</li>
              <li>Dr. Rajesh Kumar - Pediatrician</li>
              <li>Sita Patel - Certified Midwife</li>
            </ul>
          </div>
          <button class="community-btn">
            <span>Submit Question</span>
            <span class="btn-arrow"></span>
          </button>
        </div>

        <!-- Local Support Groups -->
        <div class="community-card clickable" onclick="ANC.findLocalGroups()">
          <div class="card-icon-animated"></div>
          <div class="card-badge">Near You</div>
          <h3>Local Support Groups</h3>
          <p>Find in-person prenatal classes and support groups in your city</p>
          <div class="community-stats">
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">40+ Cities</span>
            </span>
            <span class="stat">
              <span class="stat-icon"></span>
              <span class="stat-text">In-Person Classes</span>
            </span>
          </div>
          <div class="location-finder">
            <input type="text" placeholder="Enter your city..." class="city-input">
            <button class="find-btn">Find Groups</button>
          </div>
          <button class="community-btn">
            <span>Browse All Cities</span>
            <span class="btn-arrow"></span>
          </button>
        </div>
      </div>

      <!-- Community Guidelines -->
      <div class="community-guidelines">
        <h3>Community Guidelines</h3>
        <div class="guidelines-grid">
          <div class="guideline-item">
            <span class="guideline-icon"></span>
            <h4>Be Kind & Supportive</h4>
            <p>We're all on this beautiful journey together</p>
          </div>
          <div class="guideline-item">
            <span class="guideline-icon"></span>
            <h4>Privacy First</h4>
            <p>What's shared here stays here</p>
          </div>
          <div class="guideline-item">
            <span class="guideline-icon"></span>
            <h4>Medical Advice Disclaimer</h4>
            <p>Always consult your healthcare provider</p>
          </div>
          <div class="guideline-item">
            <span class="guideline-icon"></span>
            <h4>Share Your Journey</h4>
            <p>Celebrate every milestone, big or small</p>
          </div>
        </div>
      </div>
    </section>


    <style>
  :root {
    --bg-footer:    #1e1a1e;
    --bg-bottom:    #161316;
    --pink-primary: #e8517a;
    --pink-soft:    #f0748e;
    --text-main-f:  #c9bfc9;
    --text-muted-f: #7c7080;
    --divider-f:    rgba(232,81,122,0.18);
    --font-display-f:'Playfair Display', Georgia, serif;
    --font-body-f:  'DM Sans', sans-serif;
  }
  footer.ns-footer {
    background: var(--bg-footer);
    color: var(--text-main-f);
    font-family: var(--font-body-f);
    border-top: 1px solid var(--divider-f);
  }
  .footer-main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 56px 32px 48px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 40px;
  }
  .footer-col h3 {
    font-family: var(--font-display-f);
    font-size: 1.05rem;
    font-weight: 600;
    color: var(--pink-primary);
    margin-bottom: 18px;
    letter-spacing: 0.01em;
  }
  .footer-col p {
    font-size: 0.875rem;
    line-height: 1.75;
    color: var(--text-main-f);
    font-weight: 300;
  }
  .footer-col ul { list-style: none; }
  .footer-col ul li {
    font-size: 0.875rem;
    color: var(--text-main-f);
    padding: 5px 0;
    font-weight: 300;
    position: relative;
    padding-left: 14px;
    transition: color 0.2s;
  }
  .footer-col ul li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: var(--pink-primary);
    opacity: 0.5;
  }
  .footer-col ul li:hover { color: var(--pink-soft); }
  .disclaimer-text { font-size: 0.875rem; line-height: 1.75; color: var(--text-main-f); font-weight: 300; }
  .emergency-alert { font-size: 0.875rem; line-height: 1.7; color: var(--pink-primary); font-weight: 500; }
  .emergency-alert strong { font-weight: 600; }
  .footer-meta {
    border-top: 1px solid var(--divider-f);
    max-width: 1200px;
    margin: 0 auto;
    padding: 28px 32px;
    text-align: center;
  }
  .footer-meta .meta-line { font-size: 0.8rem; color: var(--text-muted-f); letter-spacing: 0.04em; margin-bottom: 10px; }
  .footer-meta .meta-line .sep { color: var(--pink-primary); margin: 0 6px; }
  .footer-meta .tagline { font-size: 0.82rem; color: var(--text-muted-f); display: flex; align-items: center; justify-content: center; gap: 6px; }
  .footer-meta .tagline .heart { color: var(--pink-primary); font-size: 1rem; animation: footerPulse 2s ease-in-out infinite; }
  @keyframes footerPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.25); opacity: 0.8; } }
  .footer-bottom { background: var(--bg-bottom); border-top: 1px solid rgba(255,255,255,0.04); }
  .footer-bottom-inner { max-width: 1200px; margin: 0 auto; padding: 22px 32px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
  .footer-links { display: flex; gap: 36px; flex-wrap: wrap; justify-content: center; }
  .footer-links a { font-size: 0.82rem; color: var(--text-muted-f); text-decoration: none; letter-spacing: 0.03em; transition: color 0.2s; }
  .footer-links a:hover { color: var(--pink-soft); }
  .footer-copy { font-size: 0.78rem; color: var(--text-muted-f); opacity: 0.7; letter-spacing: 0.02em; }
  @media (max-width: 900px) { .footer-main { grid-template-columns: repeat(2,1fr); gap: 32px; } }
  @media (max-width: 540px) { .footer-main { grid-template-columns: 1fr; padding: 40px 20px 32px; } .footer-meta { padding: 20px; } .footer-bottom-inner { padding: 18px 20px; } .footer-links { gap: 20px; } }
</style>

<footer class="ns-footer" aria-label="Site footer">
  <div class="footer-main">
    <div class="footer-col">
      <h3>About This Guide</h3>
      <p>Comprehensive, evidence-based information synthesized from WHO, ACOG, ICMR guidelines, peer-reviewed research, and NFHS-5 data (724,115+ women).</p>
    </div>
    <div class="footer-col">
      <h3>Evidence Sources</h3>
      <ul>
        <li>World Health Organization</li>
        <li>ACOG Guidelines</li>
        <li>ICMR India</li>
        <li>NFHS-5 Survey</li>
      </ul>
    </div>
    <div class="footer-col">
      <h3>Important Disclaimer</h3>
      <p class="disclaimer-text">This provides general information only. Each pregnancy is unique. Medical decisions should be made with qualified healthcare providers who can assess your individual circumstances.</p>
    </div>
    <div class="footer-col">
      <h3>Emergency</h3>
      <p class="emergency-alert">Heavy bleeding, fever, chest pain, or severe abdominal pain require immediate medical attention. <strong>Don't delay.</strong></p>
    </div>
  </div>
  <div class="footer-meta">
    <p class="meta-line">Last Updated: February 2026 <span class="sep">|</span> Evidence-Based <span class="sep"></span> Comprehensive <span class="sep"></span> Empowering</p>
    <p class="tagline"><span class="heart"></span> Dedicated to empowering every mother</p>
  </div>
  <div class="footer-bottom">
    <div class="footer-bottom-inner">
      <nav class="footer-links" aria-label="Legal and support links">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms of Service</a>
        <a href="#">Contact Support</a>
      </nav>
      <p class="footer-copy">&copy; 2026 Nari Swasthya. Empowering Women's Health.</p>
    </div>
  </div>
</footer>
  </div>

  <!-- Modals -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true"></div>

  <div class="modal" id="mainModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalBody" hidden>
    <div class="modal-content">
      <button class="modal-close" type="button" onclick="ANC.closeModal()"></button>
      <h3 id="modalTitle"></h3>
      <div id="modalBody"></div>
      <div class="modal-actions" id="modalActions"></div>
    </div>
  </div>

  <!-- Command Palette -->
  <div class="palette" id="commandPalette" role="dialog" aria-modal="true" hidden>
    <div class="palette-content">
      <div class="palette-head">
        <h3>Quick Actions</h3>
        <button class="icon-btn" type="button" onclick="ANC.closePalette()"></button>
      </div>
      <input id="paletteSearch" type="text" placeholder="Type: 'week 20', 'kick', 'glucose', 'vaccines'" autocomplete="off" />
      <div class="palette-results" id="paletteResults"></div>
      <div class="muted palette-hint">Tip: press <strong>Esc</strong> to close.</div>
    </div>
  </div>

  <script src="antenatal_care.js"></script>
  <script>
/* Mobile menu toggle */
function toggleMobile(){
  const menu=document.getElementById('mobileMenu');
  const b1=document.getElementById('hb1'),b2=document.getElementById('hb2'),b3=document.getElementById('hb3');
  const open=menu.classList.toggle('open');
  if(open){
    b1.style.cssText='transform:rotate(45deg) translate(4px,4px);';
    b2.style.cssText='opacity:0;';
    b3.style.cssText='transform:rotate(-45deg) translate(4px,-4px);';
  } else {
    b1.style.cssText=''; b2.style.cssText=''; b3.style.cssText='';
  }
}
document.addEventListener('click',function(e){
  const menu=document.getElementById('mobileMenu');
  const btn=document.getElementById('hamburgerBtn');
  if(menu&&menu.classList.contains('open')&&!menu.contains(e.target)&&!btn.contains(e.target)){
    menu.classList.remove('open');
    document.getElementById('hb1').style.cssText='';
    document.getElementById('hb2').style.cssText='';
    document.getElementById('hb3').style.cssText='';
  }
});
  </script>
</body>

<script>
  
/* antenatal_care.js
   Nari Swasthya  Antenatal Care Journey
   Fixes applied:
   - Visit Simulator #simWeek works 440 and never snaps back
   - Combo selects + Interpret buttons work reliably
   - window.ANC is global and all inline onclick/oninput handlers function

   HTML wiring reference: antenatal_care.html 
   Clinical schedule/content basis: Comprehensive guide 
*/
(function () {
  "use strict";

  /* ---------------------------
   * 0) Global ANC object (required for inline onclick="ANC....")
   * --------------------------- */
  window.ANC = window.ANC || {};
  const ANC = window.ANC;

  /* ---------------------------
   * 1) Helpers
   * --------------------------- */
  const $ = (sel, root = document) => root.querySelector(sel);
  const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
  const clamp = (n, a, b) => Math.max(a, Math.min(b, n));

  const prefersReducedMotion = () =>
    window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  function safeText(idOrEl, txt) {
    const el = typeof idOrEl === "string" ? $("#" + idOrEl) : idOrEl;
    if (el) el.textContent = txt;
  }
  function safeHTML(idOrEl, html) {
    const el = typeof idOrEl === "string" ? $("#" + idOrEl) : idOrEl;
    if (el) el.innerHTML = html;
  }

  function scrollToSel(sel) {
    const el = $(sel);
    if (!el) return;
    el.scrollIntoView({ behavior: prefersReducedMotion() ? "auto" : "smooth", block: "start" });
  }

  function fmtTime(ms) {
    const s = Math.floor(ms / 1000);
    const mm = String(Math.floor(s / 60)).padStart(2, "0");
    const ss = String(s % 60).padStart(2, "0");
    return `${mm}:${ss}`;
  }

  function todayISO() {
    const d = new Date();
    const pad = (x) => String(x).padStart(2, "0");
    return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}`;
  }

  function downloadText(filename, text) {
    const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  /* ---------------------------
   * 2) Persistent state
   * --------------------------- */
  const STORAGE_KEY = "anc_ui_state_v2";
  const state = {
    // IMPORTANT: weekSlider (body map) can be independent of simWeek.
    week: 12,

    pinnedInsight: null,
    currentInsight: null,

    nutrients: { folic: 0, iron: 0, calcium: 0, protein: 0 },
    foods: [],

    kick: {
      running: false,
      startAt: 0,
      count: 0,
      timerId: null,
      sessions: []
    },

    redFlag: { active: false, score: 0, q: null },

    planCategory: "labor",
    birthPlan: { labor: [], pain: [], delivery: [], postpartum: [] },

    postpartumChecklist: {
      hydration: false,
      rest: false,
      mood: false,
      feeding: false,
      contraception: false,
      followup: false
    }
  };

  function loadState() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return;
      const parsed = JSON.parse(raw);
      Object.assign(state, parsed);

      state.nutrients ||= { folic: 0, iron: 0, calcium: 0, protein: 0 };
      state.kick ||= { running: false, startAt: 0, count: 0, timerId: null, sessions: [] };
      state.birthPlan ||= { labor: [], pain: [], delivery: [], postpartum: [] };
      state.postpartumChecklist ||= {
        hydration: false, rest: false, mood: false, feeding: false, contraception: false, followup: false
      };
    } catch {}
  }

  function saveState() {
    try {
      const copy = JSON.parse(JSON.stringify(state));
      copy.kick.timerId = null; // never persist interval IDs
      localStorage.setItem(STORAGE_KEY, JSON.stringify(copy));
    } catch {}
  }

  /* ---------------------------
   * 3) Modal system (IDs from HTML)
   * --------------------------- */
  function openModal(title, bodyHTML, actionsHTML = "") {
    const backdrop = $("#modalBackdrop");
    const modal = $("#mainModal");
    if (!backdrop || !modal) return;

    safeText("modalTitle", title);
    safeHTML("modalBody", bodyHTML);
    safeHTML("modalActions", actionsHTML);

    modal.removeAttribute("hidden");
    backdrop.classList.add("open");
    modal.classList.add("open");
    document.body.classList.add("modal-open");
  }

  function closeModal() {
    const backdrop = $("#modalBackdrop");
    const modal = $("#mainModal");
    if (!backdrop || !modal) return;

    backdrop.classList.remove("open");
    modal.classList.remove("open");
    document.body.classList.remove("modal-open");
    
    // Delay adding hidden to allow transition
    setTimeout(() => {
      modal.setAttribute("hidden", "");
    }, 200);
  }

  ANC.closeModal = () => closeModal();

  /* ---------------------------
   * 4) Command palette (IDs from HTML)
   * --------------------------- */
  function openPalette() {
    const pal = $("#commandPalette");
    if (!pal) return;
    pal.classList.add("open");
    $("#paletteSearch")?.focus();
    renderPaletteResults("");
  }

  function closePalette() {
    $("#commandPalette")?.classList.remove("open");
  }

  ANC.closePalette = () => closePalette();

  // Header button functions
  ANC.signIn = () => {
    openModal(
      "Sign In",
      `<p>Sign in functionality would be implemented here.</p>
       <p>This would typically connect to an authentication system.</p>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  ANC.contactUs = () => {
    openModal(
      "Contact Us",
      `<p><strong>Get in touch with us:</strong></p>
       <p> Email: support@narishakti.com</p>
       <p> Phone: +91-XXX-XXX-XXXX</p>
       <p> Hours: Mon-Fri 9AM-6PM IST</p>
       <p class="muted">This is a demo - actual contact information would be provided in production.</p>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  const paletteActions = [
    { label: "Go to Timeline", run: () => scrollToSel("#journey") },
    { label: "Go to Body Map", run: () => scrollToSel("#care-control") },
    { label: "Go to Tests & Scans", run: () => scrollToSel("#tests-scans") },
    { label: "Go to Vaccines", run: () => scrollToSel("#vaccines") },
    { label: "Go to Wellness", run: () => scrollToSel("#wellness") },
    { label: "Go to Warning Signs", run: () => scrollToSel("#warning") },
    { label: "Go to Kick Counter", run: () => scrollToSel("#kicks") },
    { label: "Go to Birth Plan", run: () => scrollToSel("#birth") },
    { label: "Take 90sec Sprint", run: () => ANC.openKnowledgeSprint() },
    { label: "Random Triage Scenario", run: () => ANC.randomScenario() },
    { label: "Quiz: Due this week", run: () => ANC.quizDueThisWeek() }
  ];

  function renderPaletteResults(query) {
    const host = $("#paletteResults");
    if (!host) return;

    query = (query || "").toLowerCase().trim();
    const list = paletteActions
      .filter((a) => !query || a.label.toLowerCase().includes(query))
      .slice(0, 10);

    host.innerHTML =
      list.map((a, i) => `
        <button class="palette-item" type="button" data-pal="${i}">
          <span class="pi-title">${a.label}</span>
        </button>
      `).join("") || `<div class="palette-empty">No actions</div>`;


    $$(".palette-item", host).forEach((btn, idx) => {
      btn.addEventListener("click", () => {
        closePalette();
        list[idx]?.run?.();
      });
    });
  }

  /* ---------------------------
   * 5) Particle background (canvas: #particleCanvas)
   * --------------------------- */
  const Particles = {
    canvas: null,
    ctx: null,
    w: 0,
    h: 0,
    p: [],
    raf: 0,
    init() {
      this.canvas = $("#particleCanvas");
      if (!this.canvas) return;
      this.ctx = this.canvas.getContext("2d", { alpha: true });

      const resize = () => {
        const r = this.canvas.getBoundingClientRect();
        const dpr = window.devicePixelRatio || 1;
        this.w = Math.floor(r.width * dpr);
        this.h = Math.floor(r.height * dpr);
        this.canvas.width = this.w;
        this.canvas.height = this.h;
        this.seed();
      };

      window.addEventListener("resize", resize, { passive: true });
      resize();

      if (!prefersReducedMotion()) this.loop();
      else this.drawOnce();
    },
    seed() {
      const target = clamp(Math.floor((this.w * this.h) / 45000), 35, 120);
      while (this.p.length < target) this.p.push(this.make());
      while (this.p.length > target) this.p.pop();
    },
    make() {
      const dpr = window.devicePixelRatio || 1;
      return {
        x: Math.random() * this.w,
        y: Math.random() * this.h,
        vx: (Math.random() - 0.5) * 0.25 * dpr,
        vy: (Math.random() - 0.5) * 0.25 * dpr,
        a: 0.2 + Math.random() * 0.6,
        s: 1.5 + Math.random() * 2.5  // Larger particles for better visibility
      };
    },
    drawOnce() {
      this.draw();
    },
    loop() {
      this.draw();
      this.raf = requestAnimationFrame(() => this.loop());
    },
    draw() {
  const ctx = this.ctx;
  if (!ctx) return;
  
  // Clear canvas (no background gradient - transparent)
  ctx.clearRect(0, 0, this.w, this.h);

  ctx.save();
  ctx.globalCompositeOperation = "lighter";

  // Draw particles with pink color
  for (const p of this.p) {
    p.x += p.vx;
    p.y += p.vy;

    if (p.x < -20) p.x = this.w + 20;
    if (p.x > this.w + 20) p.x = -20;
    if (p.y < -20) p.y = this.h + 20;
    if (p.y > this.h + 20) p.y = -20;

    ctx.beginPath();
    ctx.fillStyle = `rgba(236, 64, 122, ${p.a * 0.8})`;  // Pink particles
    ctx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
    ctx.fill();
  }

  // Draw connection lines between nearby particles (pink)
  const maxD = 120 * (window.devicePixelRatio || 1);
  for (let i = 0; i < this.p.length; i++) {
    for (let j = i + 1; j < this.p.length; j++) {
      const a = this.p[i], b = this.p[j];
      const dx = a.x - b.x;
      const dy = a.y - b.y;
      const d = Math.sqrt(dx * dx + dy * dy);
      
      if (d < maxD) {
        const alpha = 0.25 * (1 - d / maxD);
        ctx.strokeStyle = `rgba(236, 64, 122, ${alpha})`;
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(a.x, a.y);
        ctx.lineTo(b.x, b.y);
        ctx.stroke();
      }
    }
  }

  ctx.restore();
}


};

  /* ---------------------------
   * 6) Week UI sync (hero dial + belly)
   * --------------------------- */
  function trimesterForWeek(w) {
    w = Number(w);
    if (w <= 12) return "1st Trimester";
    if (w <= 28) return "2nd Trimester";
    return "3rd Trimester";
  }

  function syncWeekUI() {
    safeText("currentWeek", String(state.week));
    safeText("weekDialValue", String(state.week));
    safeText("trimesterStatus", trimesterForWeek(state.week));

    const fill = $("#weekDialFill");
    if (fill) fill.style.width = `${clamp((state.week / 40) * 100, 0, 100)}%`;

    const belly = $("#belly");
    if (belly) {
      const t = clamp((state.week - 6) / 34, 0, 1);
      belly.setAttribute("rx", String(64 + t * 18));
      belly.setAttribute("ry", String(76 + t * 22));
    }
    
    // Update week overview chip in Care Control Center
    const weekChip = $("#weekOverviewChip");
    if (weekChip) {
      weekChip.textContent = `Week ${state.week} Overview`;
      weekChip.classList.add('chip-animate');
      setTimeout(() => weekChip.classList.remove('chip-animate'), 600);
    }
  }

  /* ---------------------------
   * 7) Daily tip
   * --------------------------- */

  const TIPS = [
    "Hydrate early in the day; it helps fatigue and constipation.",
    "Write down questions before visitsshort lists get answered faster.",
    "If you feel reduced movement after 28w, dont waitseek advice.",
    "Protein + calcium at breakfast stabilizes energy.",
    "Practice a one-sentence summary of symptoms for urgent calls."
  ];
  function setDailyTip() {
    const el = $("#tipText");
    if (!el) return;
    const idx = Math.floor((Date.now() / (1000 * 60 * 60 * 24)) % TIPS.length);
    el.textContent = TIPS[idx];
  }

  /* ---------------------------
   * 8) Guide models (aligned to the comprehensive guide)
   * --------------------------- */
  const GUIDE = {
    schedule: {
      first: {
        title: "First Trimester (Weeks 112)",
        weeks: "Weeks 112",
        desc: "Booking visit + baseline tests",
        bullets: [
          "Confirm pregnancy + estimate EDD",
          "Baseline vitals: BP, BMI; risk assessment",
          "Core labs: CBC, blood type/Rh & antibodies, infection screen",
          "Folic acid 400800 g daily"
        ]
      },
      second: {
        title: "Second Trimester (Weeks 1328)",
        weeks: "Weeks 1328",
        desc: "Anatomy scan + glucose screening",
        bullets: [
          "Fundal height + fetal heart monitoring",
          "Anatomy scan 1822 weeks",
          "Glucose screening 2428 weeks"
        ]
      },
      third: {
        title: "Third Trimester (Weeks 2940)",
        weeks: "Weeks 2940",
        desc: "Kick counts + GBS + delivery prep",
        bullets: [
          "Kick counts from ~28 weeks (10 in 2 hours method)",
          "Tdap 2736 weeks; flu any trimester/season",
          "GBS screening 3537 weeks; finalize birth plan"
        ]
      },
      postpartum: {
        title: "Postpartum (After delivery)",
        weeks: "After delivery",
        desc: "Recovery + mental health + planning",
        bullets: [
          "Plan recovery supports + followup check",
          "Mood screening and early help",
          "Feeding + contraception planning"
        ]
      }
    },

    // Due-this-week helper (used by the drill + visit preview)
    dueThisWeek(week) {
      week = Number(week);
      const items = [];
      if (week <= 10) items.push("Booking visit + baseline labs (CBC, blood type/Rh, infection screen)");
      if (week >= 6 && week <= 10) items.push("Dating scan window (610w)");
      if (week >= 11 && week <= 14) items.push("NT scan window (1114w)");
      if (week >= 18 && week <= 22) items.push("Anatomy scan window (1822w)");
      if (week >= 24 && week <= 28) items.push("Glucose screening window (2428w)");
      if (week >= 27 && week <= 36) items.push("Tdap window (2736w)");
      if (week >= 35 && week <= 37) items.push("GBS swab window (3537w)");
      if (week >= 28) items.push("Kick counting practice (from ~28w)");
      if (!items.length) items.push("Routine visit checks (BP/urine) + personalized plan");
      return items;
    }
  };

  /* ---------------------------
   * 9) Timeline stage details panel (#stageDetailPanel)
   * --------------------------- */
  function renderStage(stageKey) {
    const st = GUIDE.schedule[stageKey];
    const panel = $("#stageDetailPanel");
    if (!panel || !st) return;

    panel.innerHTML = `
      <div class="panel-live">
        <div class="panel-live-head">
          <div class="chip">${st.weeks}</div>
          <h3>${st.title}</h3>
          <p class="muted">${st.desc}</p>
        </div>
        <div class="panel-live-body">
          <h4>What happens in this stage</h4>
          <ul>${st.bullets.map(b => `<li>${b}</li>`).join("")}</ul>
          <div class="panel-live-actions">
            <button class="mini-btn" type="button" onclick="ANC.runVisitChecklist()">Run Visit Simulator checklist</button>
            <button class="mini-btn outline" type="button" onclick="ANC.scrollTo('#tests-scans')">Open Tests & Scans</button>
          </div>
          <div class="panel-live-foot muted">
            This schedule follows increasing visit frequency through pregnancy. 
          </div>
        </div>
      </div>
    `;
  }

  /* ---------------------------
   * 10) Visit Simulator (FIXED)
   * - #simWeek range 440
   * - No snap-back
   * - Interpret buttons always work and read live values
   * --------------------------- */
  function interpretBP(sys, dia) {
    sys = Number(sys);
    dia = Number(dia);
    if (sys >= 160 || dia >= 110) return { level: "emergency", msg: "Severe-range BP  urgent assessment." };
    if (sys >= 140 || dia >= 90) return { level: "urgent", msg: "High BP range  contact clinician promptly." };
    if (sys < 90 || dia < 60) return { level: "monitor", msg: "Low BP can cause dizziness  hydrate and rise slowly." };
    return { level: "ok", msg: "BP in typical range." };
  }

  function interpretUrine(val) {
    val = String(val || "").toLowerCase();
    if (val === "positive") return { level: "urgent", msg: "Protein detected  discuss evaluation (esp. with high BP)." };
    if (val === "trace") return { level: "monitor", msg: "Trace protein  recheck and discuss if symptoms." };
    return { level: "ok", msg: "No protein detected." };
  }

  function interpretWeightTrend(val) {
    if (val === "low") return { level: "monitor", msg: "Low trend  focus on protein/calcium; discuss at visit." };
    if (val === "high") return { level: "monitor", msg: "High trend  review nutrition/activity with clinician." };
    return { level: "ok", msg: "Steady trend  keep aligning to clinician targets." };
  }

  function visitChecklist(week) {
    week = Number(week);
    const items = [];
    items.push({ title: "Vitals", why: "BP + urine are checked at each visit." });

    if (week <= 12) {
      items.push({ title: "Baseline labs", why: "CBC, blood type/Rh, infection screen often early." });
      items.push({ title: "Folic acid plan", why: "400800 g daily supports early development." });
    }
    if (week >= 11 && week <= 14) items.push({ title: "NT screening discussion", why: "1114w window for NT scan." });
    if (week >= 18 && week <= 22) items.push({ title: "Anatomy scan", why: "1822w detailed anatomy milestone." });
    if (week >= 24 && week <= 28) items.push({ title: "Glucose screening", why: "2428w common screening window." });
    if (week >= 27 && week <= 36) items.push({ title: "Tdap timing", why: "2736w recommended window." });
    if (week >= 35 && week <= 37) items.push({ title: "GBS swab", why: "3537w typical timing." });
    if (week >= 28) items.push({ title: "Kick count teaching", why: "From ~28w: 10 movements in 2 hours is a common method." });

    items.push({ title: "Questions & planning", why: "Personalized care: symptoms, mental health, birth plan." });
    return items;
  }

  // FIXED: this function is authoritative for simWeek and will not be overwritten by updatePregnancyWeek
  ANC.updateVisitSimWeek = (val) => {
    const w = clamp(Number(val), 4, 40);

    const sim = $("#simWeek");
    if (sim) sim.value = String(w); // prevents snap-back

    safeText("visitChip", `Week ${w}`);

    // Preview content in the output panel
    const due = GUIDE.dueThisWeek(w);
    safeHTML("visitOutputBody", `
      <p><strong>Week ${w} preview:</strong></p>
      <ul>${due.map(d => `<li>${d}</li>`).join("")}</ul>
      <p class="muted">Click Run Checklist to see tasks + why they matter.</p>
    `);
  };

  ANC.runVisitChecklist = () => {
    // Always read from simWeek (NOT state.week)
    const w = clamp(Number($("#simWeek")?.value ?? 12), 4, 40);
    safeText("visitChip", `Week ${w}`);

    const tasks = visitChecklist(w);
    safeHTML("visitOutputBody", `
      <h4>Visit checklist (Week ${w})</h4>
      <div class="checklist">
        ${tasks.map(t => `
          <div class="check-item">
            <div class="check-title">${t.title}</div>
            <div class="check-why muted">${t.why}</div>
          </div>
        `).join("")}
      </div>
      <div class="row">
        <button class="mini-btn outline" type="button" onclick="ANC.openScenario('headache')">Practice warning triage</button>
        <button class="mini-btn" type="button" onclick="ANC.openTest('cbc')">Open a test</button>
      </div>
      <p class="muted">Education-only.</p>
    `);
  };

  // FIXED: Interpret buttons read live values and open modal with ENHANCED details
  ANC.interpretBP = () => {
    const sys = Number($("#bpSys")?.value ?? 118);
    const dia = Number($("#bpDia")?.value ?? 76);
    const r = interpretBP(sys, dia);
    
    let details = '';
    if (r.level === 'emergency') {
      details = `<div class="bp-emergency-info">
        <h4> This Requires Immediate Medical Attention</h4>
        <p><strong>Why this matters:</strong> Blood pressure 160/110 can lead to:</p>
        <ul>
          <li><strong>Pre-eclampsia/Eclampsia:</strong> Dangerous condition affecting organs, can cause seizures</li>
          <li><strong>Stroke risk:</strong> Extremely high BP strains blood vessels</li>
          <li><strong>Placental abruption:</strong> Placenta may separate prematurely</li>
          <li><strong>HELLP syndrome:</strong> Serious liver and blood clotting disorder</li>
        </ul>
        <p><strong>What to do NOW:</strong></p>
        <ol>
          <li>Call your provider immediately OR go to emergency department</li>
          <li>Do not drive yourself</li>
          <li>Lie on your left side</li>
          <li>Note any symptoms: severe headache, vision changes, upper abdominal pain, sudden swelling</li>
        </ol>
        <p class="critical-note"> Time is critical. Severe hypertension in pregnancy is a medical emergency.</p>
      </div>`;
    } else if (r.level === 'urgent') {
      details = `<div class="bp-urgent-info">
        <h4> Contact Your Provider Within 24 Hours</h4>
        <p><strong>What this means:</strong> BP 140-159/90-109 is Stage 1 hypertension requiring prompt evaluation.</p>
        <p><strong>Why it's important:</strong></p>
        <ul>
          <li>Could be early gestational hypertension or pre-eclampsia</li>
          <li>Requires blood tests (kidney/liver function) and urine protein check</li>
          <li>May need more frequent monitoring</li>
          <li>Early intervention prevents complications</li>
        </ul>
        <p><strong>Watch for warning signs:</strong> Severe headache, visual disturbances, right upper belly pain, sudden face/hand swelling</p>
        <p><strong>Self-care while waiting:</strong> Rest on left side, stay hydrated, avoid excessive salt, monitor symptoms</p>
      </div>`;
    } else if (r.level === 'monitor') {
      details = `<div class="bp-monitor-info">
        <h4> Low Blood Pressure - Monitor for Symptoms</h4>
        <p><strong>Common in pregnancy:</strong> Hormones (progesterone) relax blood vessels, causing lower BP.</p>
        <p><strong>Symptoms to watch:</strong> Dizziness when standing, fainting, blurred vision, nausea, fatigue</p>
        <p><strong>Self-care strategies:</strong></p>
        <ol>
          <li>Stand up slowly from sitting/lying</li>
          <li>Stay well-hydrated (8-10 glasses water daily)</li>
          <li>Small frequent meals (low blood sugar worsens low BP)</li>
          <li>Compression stockings if recommended</li>
          <li>Sleep on left side, never flat on back after 20 weeks</li>
        </ol>
        <p><strong>Call provider if:</strong> Fainting episodes, severe dizziness, or symptoms interfere with daily activities</p>
      </div>`;
    } else {
      details = `<div class="bp-normal-info">
        <h4> Blood Pressure in Healthy Pregnancy Range</h4>
        <p><strong>Your reading ${sys}/${dia} is normal.</strong> Systolic <140 and Diastolic <90 are healthy targets.</p>
        <p><strong>Why we check at every visit:</strong></p>
        <ul>
          <li>Early detection of hypertensive disorders</li>
          <li>Establish your baseline to spot changes</li>
          <li>Screen for preeclampsia (high BP + protein in urine)</li>
        </ul>
        <p><strong>Keep BP healthy:</strong> Balanced diet, moderate exercise, adequate sleep (7-9 hrs on left side), stress management, stay hydrated</p>
        <p><strong>Expected patterns:</strong></p>
        <ul>
          <li>First trimester: Often decreases slightly</li>
          <li>Second trimester: Lowest point (5-10 points below baseline)</li>
          <li>Third trimester: Returns to pre-pregnancy levels</li>
        </ul>
        <p class="muted"><strong>Warning signs to always report:</strong> Severe headache, vision changes, upper abdominal pain, sudden face/hand swelling</p>
      </div>`;
    }
    
    openModal(
      "Blood Pressure Interpretation",
      `<div class="bp-interpretation">
        <div class="bp-reading-display">
          <div class="bp-numbers ${r.level}">
            <span class="sys-reading">${sys}</span><span class="bp-separator">/</span><span class="dia-reading">${dia}</span>
            <span class="bp-unit">mmHg</span>
          </div>
          <div class="bp-status-badge ${r.level}">${r.msg}</div>
        </div>
        ${details}
      </div>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Got it</button>`
    );
  };

  ANC.interpretUrine = () => {
    const v = String($("#urineProtein")?.value ?? "negative");
    const r = interpretUrine(v);
    
    let details = '';
    let statusClass = v === 'positive' ? 'emergency' : v === 'trace' ? 'monitor' : 'normal';
    
    if (v === 'positive') {
      details = `<div class="urine-info">
        <h4> Protein Detected - Requires Immediate Follow-up</h4>
        <p><strong>What this means:</strong> Protein in urine (proteinuria) is not normal in pregnancy and needs urgent evaluation.</p>
        <p><strong>Why it matters - Possible causes:</strong></p>
        <ul>
          <li><strong>Pre-eclampsia:</strong> When combined with high BP (140/90), this is the hallmark sign</li>
          <li><strong>Kidney stress:</strong> Kidneys work 50% harder in pregnancy and may be struggling</li>
          <li><strong>Urinary tract infection (UTI):</strong> Common in pregnancy, can lead to preterm labor if untreated</li>
          <li><strong>Pre-existing kidney disease:</strong> May worsen during pregnancy</li>
        </ul>
        <p><strong>What happens next:</strong></p>
        <ol>
          <li><strong>Immediate:</strong> Provider will likely order 24-hour urine collection or protein/creatinine ratio</li>
          <li><strong>Blood work:</strong> Kidney function tests, liver enzymes, platelet count</li>
          <li><strong>Blood pressure monitoring:</strong> Frequent checks, possibly at home</li>
          <li><strong>Symptom assessment:</strong> Headaches, visual changes, upper abdominal pain</li>
          <li><strong>Fetal monitoring:</strong> Ultrasound to check baby's growth and amniotic fluid</li>
        </ol>
        <p><strong>Warning signs - Seek immediate care if you have:</strong></p>
        <ul>
          <li>Severe headache that won't go away with acetaminophen</li>
          <li>Vision problems: blurriness, seeing spots, light sensitivity</li>
          <li>Pain under right ribs or in upper abdomen</li>
          <li>Nausea and vomiting (especially sudden onset in 2nd/3rd trimester)</li>
          <li>Sudden swelling of face, hands, or feet</li>
          <li>Decreased urination</li>
          <li>Decreased fetal movement</li>
        </ul>
        <p class="critical-note"> Contact your provider today. With high BP, this could indicate pre-eclampsia requiring urgent management.</p>
      </div>`;
    } else if (v === 'trace') {
      details = `<div class="urine-info">
        <h4> Trace Protein - Needs Follow-up Monitoring</h4>
        <p><strong>What "trace" means:</strong> Small amount of protein detected - could be normal or early warning sign.</p>
        <p><strong>Common benign causes:</strong></p>
        <ul>
          <li><strong>Concentrated urine:</strong> Dehydration makes trace protein show up</li>
          <li><strong>Timing:</strong> First morning urine often has trace protein</li>
          <li><strong>Exercise:</strong> Vigorous activity before test can cause temporary protein</li>
          <li><strong>Fever or stress:</strong> Can temporarily increase protein</li>
          <li><strong>Contamination:</strong> Vaginal discharge in sample can cause false trace</li>
        </ul>
        <p><strong>When to be concerned:</strong></p>
        <ul>
          <li>Trace protein + high blood pressure (140/90)</li>
          <li>Persistent trace on multiple tests</li>
          <li>Increasing amount over time</li>
          <li>Any pre-eclampsia symptoms present</li>
        </ul>
        <p><strong>What your provider may do:</strong></p>
        <ol>
          <li>Retest urine at next visit or sooner</li>
          <li>Check blood pressure trends</li>
          <li>May order 24-hour urine collection if concerned</li>
          <li>Review for any pre-eclampsia symptoms</li>
        </ol>
        <p><strong>Self-care:</strong></p>
        <ul>
          <li>Stay well-hydrated (8-10 glasses water daily)</li>
          <li>Provide clean catch urine sample (wipe front to back, catch midstream)</li>
          <li>Monitor for symptoms: headaches, vision changes, upper belly pain, swelling</li>
          <li>Keep all prenatal appointments</li>
        </ul>
        <p><strong>Follow-up:</strong> Discuss with provider at next visit. If you develop symptoms (headache, vision changes, upper abdominal pain), call sooner.</p>
      </div>`;
    } else {
      details = `<div class="urine-info">
        <h4> No Protein Detected - Excellent</h4>
        <p><strong>This is the healthy result we want to see!</strong> No protein in urine means kidneys are filtering normally.</p>
        <p><strong>Why we check urine protein:</strong></p>
        <ul>
          <li><strong>Pre-eclampsia screening:</strong> Protein + high BP is the classic combination</li>
          <li><strong>Kidney function:</strong> Ensures kidneys handling the 40-50% blood volume increase</li>
          <li><strong>UTI detection:</strong> Infections often show protein along with bacteria/white blood cells</li>
          <li><strong>Baseline establishment:</strong> Knowing your normal helps spot changes</li>
        </ul>
        <p><strong>How your kidneys change in pregnancy:</strong></p>
        <ul>
          <li><strong>Size increase:</strong> Kidneys actually grow larger to handle extra work</li>
          <li><strong>Blood flow:</strong> 50-80% more blood flows through kidneys</li>
          <li><strong>Filtration rate:</strong> Glomerular filtration increases 40-65%</li>
          <li><strong>Urine output:</strong> You may notice more frequent urination</li>
        </ul>
        <p><strong>Keep results negative:</strong></p>
        <ol>
          <li><strong>Hydration:</strong> Drink plenty of water - urine should be pale yellow</li>
          <li><strong>Hygiene:</strong> Wipe front to back to prevent UTIs</li>
          <li><strong>Don't hold it:</strong> Urinate when you feel the urge</li>
          <li><strong>Complete emptying:</strong> Lean forward when urinating to empty bladder completely</li>
          <li><strong>Monitor symptoms:</strong> Report pain, burning, or urgency immediately</li>
        </ul>
        <h5 style="margin-top: 1.5rem; margin-bottom: 0.75rem; color: var(--text-main);">When to report urinary symptoms:</h5>
        <ul>
          <li>Pain or burning with urination</li>
          <li>Urgent need to urinate but little comes out</li>
          <li>Blood in urine</li>
          <li>Lower back pain (kidney area)</li>
          <li>Fever with urinary symptoms</li>
        </ul>
        <p class="muted"><strong>Good to know:</strong> Frequent urination is normal in pregnancy (baby pressing on bladder), but painful urination is not - always report pain or burning.</p>
      </div>`;
    }
    
    openModal(
      "Urine Protein Analysis",
      `<div class="urine-interpretation">
        <div class="result-display">
          <div class="result-value ${statusClass}">${v.charAt(0).toUpperCase() + v.slice(1)}</div>
          <div class="result-badge ${statusClass}">${r.msg}</div>
        </div>
        ${details}
      </div>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Understood</button>`
    );
  };

  ANC.interpretWeight = () => {
    const v = String($("#weightTrend")?.value ?? "steady");
    const r = interpretWeightTrend(v);
    
    let details = '';
    let statusClass = v === 'low' ? 'monitor' : v === 'high' ? 'urgent' : 'normal';
    
    if (v === 'low') {
      details = `<div class="weight-info">
        <h4> Weight Gain Below Expected Range</h4>
        <p><strong>Why adequate weight gain matters:</strong></p>
        <ul>
          <li><strong>Baby's growth:</strong> Insufficient maternal weight gain can restrict fetal growth</li>
          <li><strong>Nutrient stores:</strong> Your body needs reserves for pregnancy, birth, and breastfeeding</li>
          <li><strong>Birth weight:</strong> Low maternal weight gain linked to low birth weight babies</li>
          <li><strong>Preterm risk:</strong> Inadequate gain may increase preterm birth risk</li>
        </ul>
        <p><strong>Healthy weight gain targets (total pregnancy):</strong></p>
        <ul>
          <li><strong>Underweight (BMI <18.5):</strong> 28-40 lbs (12.5-18 kg)</li>
          <li><strong>Normal weight (BMI 18.5-24.9):</strong> 25-35 lbs (11.5-16 kg)</li>
          <li><strong>Overweight (BMI 25-29.9):</strong> 15-25 lbs (7-11.5 kg)</li>
          <li><strong>Obese (BMI 30):</strong> 11-20 lbs (5-9 kg)</li>
        </ul>
        <p><strong>Recommended weekly gain (2nd & 3rd trimesters):</strong></p>
        <ul>
          <li>Underweight: 1-1.3 lbs/week</li>
          <li>Normal weight: 0.8-1 lb/week</li>
          <li>Overweight: 0.5-0.7 lbs/week</li>
          <li>Obese: 0.4-0.6 lbs/week</li>
        </ul>
        <p><strong>Strategies to increase healthy weight gain:</strong></p>
        <ol>
          <li><strong>Nutrient-dense foods:</strong> Nuts, nut butter, avocados, olive oil, cheese, whole milk</li>
          <li><strong>Protein focus:</strong> Eggs, lean meat, fish, beans, Greek yogurt (71g daily target)</li>
          <li><strong>Frequent small meals:</strong> 5-6 times daily if large meals are difficult</li>
          <li><strong>Healthy fats:</strong> Add olive oil, avocado to meals for calories without volume</li>
          <li><strong>Nutritious snacks:</strong> Trail mix, smoothies with protein powder, cheese and crackers</li>
          <li><strong>Strength shakes:</strong> Full-fat milk blended with banana, peanut butter, protein powder</li>
        </ol>
        <p><strong>When low gain might be concerning:</strong></p>
        <ul>
          <li>No weight gain or weight loss in 2nd/3rd trimester</li>
          <li>Severe nausea/vomiting (hyperemesis gravidarum)</li>
          <li>Baby measuring small for gestational age</li>
          <li>Signs of inadequate nutrition</li>
        </ul>
        <p><strong>Next steps:</strong> Discuss with provider. May refer to nutritionist, check baby's growth via ultrasound, review diet and any eating difficulties.</p>
      </div>`;
    } else if (v === 'high') {
      details = `<div class="weight-info">
        <h4> Weight Gain Above Recommended Range</h4>
        <p><strong>Potential concerns with excessive gain:</strong></p>
        <ul>
          <li><strong>Gestational diabetes:</strong> Excess weight can increase insulin resistance</li>
          <li><strong>Hypertension:</strong> Higher risk of pregnancy-related high blood pressure</li>
          <li><strong>Large baby (macrosomia):</strong> >9 lbs, can complicate delivery</li>
          <li><strong>C-section risk:</strong> Increased likelihood of surgical delivery</li>
          <li><strong>Postpartum retention:</strong> Harder to lose excess weight after birth</li>
          <li><strong>Long-term health:</strong> Increased Type 2 diabetes and obesity risk later</li>
        </ul>
        <p><strong>Healthy weight gain targets (reminder):</strong></p>
        <ul>
          <li>Underweight (BMI <18.5): 28-40 lbs total</li>
          <li>Normal weight (BMI 18.5-24.9): 25-35 lbs total</li>
          <li>Overweight (BMI 25-29.9): 15-25 lbs total</li>
          <li>Obese (BMI 30): 11-20 lbs total</li>
        </ul>
        <p><strong>Strategies for healthy, moderate gain:</strong></p>
        <ol>
          <li><strong>Quality over quantity:</strong> Focus on nutrient-rich foods, not "eating for two"</li>
          <li><strong>Portion awareness:</strong> You only need ~300-450 extra calories/day (2nd/3rd trimester)</li>
          <li><strong>Protein priority:</strong> Keeps you full longer, supports baby's growth (71g daily)</li>
          <li><strong>Limit empty calories:</strong> Reduce sugary drinks, sweets, processed snacks</li>
          <li><strong>Vegetables first:</strong> Fill half your plate with vegetables</li>
          <li><strong>Healthy fats:</strong> Choose avocado, nuts, olive oil over fried foods</li>
          <li><strong>Smart swaps:</strong> Whole grains instead of refined, water instead of soda</li>
          <li><strong>Regular activity:</strong> 30 min moderate exercise most days (if cleared by provider)</li>
          <li><strong>Mindful eating:</strong> Eat when hungry, stop when satisfied</li>
        </ol>
        <p><strong>When to be concerned:</strong></p>
        <ul>
          <li>Sudden rapid weight gain (>3-4 lbs in one week)</li>
          <li>Accompanied by swelling, headache, vision changes (could indicate preeclampsia)</li>
          <li>Difficulty breathing or extreme fatigue</li>
        </ul>
        <p><strong>Important note:</strong> Pregnancy is NOT the time to diet or restrict calories. Work with provider/nutritionist to moderate gain healthily while ensuring baby gets nutrients needed.</p>
        <p><strong>Next steps:</strong> Review diet with provider or nutritionist, screen for gestational diabetes if indicated, check baby's growth, ensure weight gain is gradual not sudden.</p>
      </div>`;
    } else {
      details = `<div class="weight-info">
        <h4> Weight Gain On Track</h4>
        <p><strong>You're doing great!</strong> Steady, gradual weight gain is exactly what we want to see.</p>
        <p><strong>Where the weight goes (25-35 lb total gain):</strong></p>
        <ul>
          <li><strong>Baby:</strong> 6-8 lbs</li>
          <li><strong>Placenta:</strong> 1-2 lbs</li>
          <li><strong>Amniotic fluid:</strong> 2 lbs</li>
          <li><strong>Uterus growth:</strong> 2 lbs</li>
          <li><strong>Breast tissue:</strong> 2 lbs</li>
          <li><strong>Blood volume:</strong> 4 lbs (increases 40-50%!)</li>
          <li><strong>Fluids in tissues:</strong> 4 lbs</li>
          <li><strong>Maternal fat stores:</strong> 7 lbs (energy for breastfeeding)</li>
        </ul>
        <p><strong>Expected gain pattern:</strong></p>
        <ul>
          <li><strong>First trimester:</strong> 2-4 lbs total (some gain little or lose due to nausea)</li>
          <li><strong>Second trimester:</strong> ~1 lb per week</li>
          <li><strong>Third trimester:</strong> ~1 lb per week (may slow at very end)</li>
        </ul>
        <p><strong>Keep your gain healthy:</strong></p>
        <ol>
          <li><strong>Balanced nutrition:</strong> Variety of fruits, vegetables, whole grains, lean proteins, healthy fats</li>
          <li><strong>Key nutrients:</strong>
            <ul>
              <li>Folic acid: 600-800 mcg daily (prevents neural tube defects)</li>
              <li>Iron: 27 mg daily (supports blood volume increase)</li>
              <li>Calcium: 1000 mg daily (baby's bones + maintains yours)</li>
              <li>Protein: 71g daily (tissue growth for you and baby)</li>
            </ul>
          </li>
          <li><strong>Hydration:</strong> 8-10 glasses water daily</li>
          <li><strong>Regular meals:</strong> Don't skip meals; blood sugar stability important</li>
          <li><strong>Physical activity:</strong> 30 min moderate exercise most days (walking, swimming, prenatal yoga)</li>
          <li><strong>Listen to hunger:</strong> Eat when hungry, stop when satisfied</li>
        </ol>
        <p><strong>When to report weight changes:</strong></p>
        <ul>
          <li>Sudden rapid gain (>3-4 lbs in one week) especially with swelling</li>
          <li>Weight loss or no gain for several weeks in 2nd/3rd trimester</li>
          <li>Inability to keep food down</li>
        </ul>
        <p class="muted"><strong>Remember:</strong> Every pregnancy is unique. These are guidelines, not strict rules. Your provider will assess your individual situation including pre-pregnancy weight, height, overall health, and baby's growth.</p>
      </div>`;
    }
    
    openModal(
      "Weight Gain Assessment",
      `<div class="weight-interpretation">
        <div class="result-display">
          <div class="result-value ${statusClass}">${v.charAt(0).toUpperCase() + v.slice(1)} Gain</div>
          <div class="result-badge ${statusClass}">${r.msg}</div>
        </div>
        ${details}
      </div>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Thank you</button>`
    );
  };

  /* ---------------------------
   * 11) Body-map week slider (kept independent from simWeek)
   * IMPORTANT FIX: does NOT overwrite #simWeek anymore
   * --------------------------- */
  ANC.updatePregnancyWeek = (val) => {
    state.week = clamp(Number(val), 1, 40);
    syncWeekUI();
    saveState();
  };

  /* ---------------------------
   * 12) Remaining inline handlers (kept functional)
   * --------------------------- */
  ANC.scrollTo = (sel) => scrollToSel(sel);
  ANC.startJourney = () => scrollToSel("#journey");

  ANC.openKnowledgeSprint = () => {
    openModal(
      "90Second Knowledge Sprint",
      `
      <p>Fast track: do these 4 actions to lock in the essentials:</p>
      <ol>
        <li>Pick a trimester on the timeline.</li>
        <li>Run the Visit Simulator checklist.</li>
        <li>Open one test + one scan.</li>
        <li>Try one warning scenario.</li>
      </ol>
      <div class="row">
        <button class="mini-btn" type="button" onclick="ANC.scrollTo('#journey');ANC.closeModal()">Timeline</button>
        <button class="mini-btn" type="button" onclick="ANC.scrollTo('#tests-scans');ANC.closeModal()">Tests/Scans</button>
        <button class="mini-btn" type="button" onclick="ANC.scrollTo('#warning');ANC.closeModal()">Warnings</button>
      </div>
      <p class="muted">Educational tool only.</p>
      `
    );
  };

  ANC.showStageDetails = (stageKey) => renderStage(stageKey);

  /* ---------------------------
   * 13) Tests, Scans, Drill, Vaccines, Wellness, Warning, Kicks, Birth plan, Postpartum
   * (Implementation kept compact but fully working with the existing UI IDs)
   * --------------------------- */

  // TEST MODAL (minimal but functional)
  const TESTS = {
    bloodType: {
      title: "Blood Type & Rh",
      when: "First visit",
      why: "Detect incompatibility risk and plan prophylaxis if needed."
    },
    cbc: {
      title: "Complete Blood Count (CBC)",
      when: "Each trimester",
      why: "Anemia screening + infection clues."
    },
    infections: {
      title: "Infection Panel",
      when: "First trimester",
      why: "HIV, Hep B, syphilis, rubella immunity screening (protocol dependent)."
    },
    glucose: {
      title: "Glucose Screening",
      when: "2428 weeks",
      why: "If high, often triggers confirmatory testing per protocol."
    },
    thyroid: {
      title: "Thyroid (TSH)",
      when: "First trimester (as indicated)",
      why: "Thyroid supports metabolism and fetal development; testing depends on risk."
    },
    gbs: {
      title: "Group B Strep (GBS)",
      when: "3537 weeks",
      why: "If positive, antibiotics during labor reduce newborn infection risk."
    }
  };

  ANC.openTest = (key) => {
    const t = TESTS[key];
    if (!t) return;
    openModal(
      t.title,
      `<p class="muted"><strong>When:</strong> ${t.when}</p><p>${t.why}</p>`,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // SCAN MODAL - Enhanced with baby visualization
  const SCANS = {
    dating: {
      title: "Dating Scan",
      when: "610 weeks",
      weeks: "8",
      type: "2D",
      lines: [
        "Confirm intrauterine pregnancy (not ectopic)",
        "Visualize gestational sac and yolk sac",
        "Detect fetal heartbeat (visible from 6 weeks)",
        "Measure crown-rump length for accurate dating",
        "Check for multiple pregnancies (twins/triplets)",
        "Assess viability of pregnancy"
      ],
      babySize: "Raspberry",
      babyLength: "1.6 cm",
      details: "At 8 weeks, your baby is about the size of a raspberry! The embryo is now officially called a fetus. Facial features are developingtiny eyelids, ears, and nose are forming. The heart beats at about 150-170 bpm (twice your rate!). Arms and legs are budding, though fingers and toes aren't distinct yet. All major organs have started developing. This scan confirms your baby is growing in the right place and gives you the most accurate due date."
    },
    nt: {
      title: "NT Scan (Nuchal Translucency)",
      when: "1114 weeks",
      weeks: "12",
      type: "2D",
      lines: [
        "Measure fluid at back of baby's neck (nuchal translucency)",
        "Check nasal bone presence",
        "Assess fetal heart rate",
        "Combined with blood tests (PAPP-A, free -hCG) for screening",
        "Screen for chromosomal abnormalities (Down syndrome, Edwards, Patau)",
        "Evaluate early anatomy development"
      ],
      babySize: "Lime",
      babyLength: "5.4 cm",
      details: "At 12 weeks (end of first trimester!), your baby is about the size of a lime. The face is looking more humaneyes have moved to the front, ears are in place. All major organs are formed and functioning. Baby can make spontaneous movements, flex fingers, and curl toes (though you can't feel it yet!). Intestines have migrated from the umbilical cord into the abdomen. The NT measurement helps assess risk for certain conditions when combined with blood tests."
    },
    anatomy: {
      title: "Anatomy Scan (20-Week Scan)",
      when: "1822 weeks",
      weeks: "20",
      type: "2D",
      lines: [
        "Detailed check of all organs (brain, heart, kidneys, stomach, bladder, spine)",
        "Examine four-chamber heart view and major vessels",
        "Assess spine from neck to tailbone",
        "Check face, lips (cleft screening), and skull",
        "Measure all limbs and check fingers/toes",
        "Evaluate placenta location and cord insertion",
        "Measure amniotic fluid volume",
        "Can often determine biological sex (if desired)"
      ],
      babySize: "Banana",
      babyLength: "16.4 cm",
      details: "At 20 weeks (halfway!), your baby is about the size of a banana. This is the most detailed scan of pregnancy. Baby can hear your voice and external sounds. Fingerprints are forming. Vernix caseosa (protective coating) covers the skin. Baby is swallowing amniotic fluid and 'practicing' breathing movements. You're likely feeling kicks and flutters now! Hair is growing on the head. The scan checks that all organs are developing normally and the placenta is well-positioned."
    },
    doppler: {
      title: "Doppler Ultrasound",
      when: "2440 weeks (as indicated)",
      weeks: "28",
      type: "Doppler",
      lines: [
        "Assess blood flow through umbilical artery and vein",
        "Evaluate placental function via resistance indices",
        "Check middle cerebral artery (brain perfusion)",
        "Monitor ductus venosus flow patterns",
        "Detect placental insufficiency early",
        "Guide management of growth restriction or hypertension",
        "Non-invasive color-coded blood flow visualization"
      ],
      babySize: "Eggplant",
      babyLength: "37.6 cm",
      details: "At 28 weeks (start of third trimester!), your baby is about the size of an eggplant. Doppler ultrasound uses sound waves to visualize blood flow in colorred for flow toward the probe, blue for flow away. This shows how well the placenta is nourishing your baby. Baby's eyes can now open and close, and they're developing regular sleep-wake cycles. Brain development is rapid. Lungs are still maturing but could function with help if born now. Baby can hiccup (you might feel rhythmic bumps!). This scan is especially important if there are concerns about baby's growth or if you have high blood pressure."
    },
    growth: {
      title: "Growth Scans",
      when: "2840 weeks (as indicated)",
      weeks: "32",
      type: "2D",
      lines: [
        "Measure head circumference, abdominal circumference, femur length",
        "Calculate estimated fetal weight and growth percentile",
        "Assess baby's position (head down, breech, transverse)",
        "Evaluate amniotic fluid levels (oligohydramnios/polyhydramnios screening)",
        "Check placental location and maturity",
        "Measure umbilical artery blood flow (if indicated)",
        "Monitor for growth restriction or macrosomia"
      ],
      babySize: "Squash",
      babyLength: "42 cm",
      details: "At 32 weeks, your baby is about the size of a squash (or large jicama!). Baby weighs around 1.7 kg (3.75 lbs) and is gaining about 200g per week now. The lungs are maturingsurfactant production increasing. Baby has less room to move but you should still feel regular movements. Fat is accumulating under the skin, making baby look more 'baby-like' and less wrinkled. Baby can distinguish between light and dark. Toenails have reached the tips of toes. If born now, survival chances are excellent with modern neonatal care."
    },
    threedFourd: {
      title: "3D/4D Ultrasound",
      when: "2432 weeks (optional)",
      weeks: "28",
      type: "3D/4D",
      lines: [
        "Create three-dimensional images of baby's face and body",
        "4D adds real-time movement (like a video)",
        "Best facial images when baby cooperates and fluid is adequate",
        "Can detect certain facial abnormalities (cleft lip/palate)",
        "Provide bonding experiencesee baby's expressions!",
        "Not medically necessary but emotionally meaningful",
        "May show baby yawning, sucking thumb, or smiling"
      ],
      babySize: "Eggplant",
      babyLength: "37.6 cm",
      details: "At 28 weeks, your baby is perfectly positioned for beautiful 3D/4D images! Unlike traditional 2D scans that show flat outlines, 3D creates depth and contours of your baby's face and body. 4D adds the dimension of timeyou see baby moving in real time, like watching a live video. Baby now has eyebrows and eyelashes. They might suck their thumb, yawn, or even appear to smile! Fat is filling out their cheeks, making facial features clearer. The best images happen when baby isn't facing your back and when there's enough amniotic fluid in front of their face. This scan is typically elective (not covered by insurance) but creates unforgettable keepsake images."
    },
    bpp: {
      title: "Biophysical Profile (BPP)",
      when: "3240 weeks (high-risk)",
      weeks: "36",
      type: "BPP",
      lines: [
        "Combines ultrasound with non-stress test (NST)",
        "Score 5 components: breathing movements, body movements, tone, fluid, heart rate",
        "Each component scored 0 or 2 points (max 10)",
        "Assess baby's well-being in late pregnancy",
        "Commonly used for post-dates, diabetes, hypertension",
        "Score 8 is reassuring; <6 may indicate need for delivery",
        "Usually takes 30 minutes to observe all movements"
      ],
      babySize: "Honeydew Melon",
      babyLength: "47.4 cm",
      details: "At 36 weeks, your baby is about the size of a honeydew melon and weighs around 2.6 kg (5.7 lbs). The BPP is like a comprehensive wellness check. Providers watch baby practice breathing (moving the diaphragm), make body or limb movements, show muscle tone (opening/closing hand or flexing), have adequate amniotic fluid, and maintain a healthy heart rate pattern. Baby is head-down in most cases now, preparing for birth. The digestive system is nearly mature. Baby is shedding lanugo (fine body hair) and vernix. If born now, baby would be considered 'late preterm' with excellent survival. The BPP helps ensure baby is thriving inside and guides the timing of delivery if concerns arise."
    },
    nst: {
      title: "Non-Stress Test (NST)",
      when: "3240 weeks (monitoring)",
      weeks: "38",
      type: "NST",
      lines: [
        "Monitor fetal heart rate for 2030 minutes while resting",
        "Look for accelerations (rate increases) with baby's movements",
        "Reactive NST: 2 accelerations of 15 bpm lasting 15 sec",
        "Non-invasivetwo belts on belly (heart monitor + movement sensor)",
        "Commonly used for post-dates, reduced movements, diabetes, hypertension",
        "Reactive result is reassuring; non-reactive may need further testing",
        "May drink cold water or juice to stimulate baby before test"
      ],
      babySize: "Mini Watermelon",
      babyLength: "49.8 cm",
      details: "At 38 weeks (considered full term!), your baby is about the size of a mini watermelon and weighs around 3.1 kg (6.8 lbs). The NST is a simple, safe way to check baby's heart health. You'll lie comfortably while monitors track baby's heartbeat and any movements or contractions. A healthy baby's heart rate speeds up when they movelike how your heart rate increases when you exercise. Baby is now shedding most of the vernix and lanugo. The first sticky poop (meconium) is accumulating in the intestines. Lungs are fully mature. Baby could arrive any day now! The NST provides peace of mind that baby is handling the final weeks well and isn't under stress. If results aren't immediately reactive, providers may try simple interventions (like giving you juice) to wake baby up."
    }
  };

  ANC.openScan = (key) => {
    const s = SCANS[key];
    if (!s) return;
    
    // Create stunning scan modal with baby illustration
    const babyIllustration = `
      <div class="baby-illustration" data-scan="${key}">
        <svg viewBox="0 0 200 240" class="baby-svg">
          <!-- Ultrasound-style background -->
          <defs>
            <radialGradient id="ultraGlow" cx="50%" cy="50%">
              <stop offset="0%" style="stop-color:#ffb3d9;stop-opacity:0.3" />
              <stop offset="100%" style="stop-color:#ff80bf;stop-opacity:0" />
            </radialGradient>
            <linearGradient id="bloodFlow" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#ff4444;stop-opacity:0.8">
                <animate attributeName="stop-color" values="#ff4444;#ff8888;#ff4444" dur="2s" repeatCount="indefinite"/>
              </stop>
              <stop offset="50%" style="stop-color:#ff6666;stop-opacity:0.6"/>
              <stop offset="100%" style="stop-color:#4444ff;stop-opacity:0.8">
                <animate attributeName="stop-color" values="#4444ff;#8888ff;#4444ff" dur="2s" repeatCount="indefinite"/>
              </stop>
            </linearGradient>
          </defs>
          <circle cx="100" cy="120" r="90" fill="url(#ultraGlow)"/>
          
          ${key === 'dating' ? `
            <!-- 8-week embryo - tiny curved form with breathing + scan line -->
            <ellipse cx="100" cy="120" rx="15" ry="25" fill="#ffb3d9" opacity="0.9">
              <animate attributeName="ry" values="25;26;25" dur="3s" repeatCount="indefinite"/>
            </ellipse>
            <circle cx="100" cy="108" r="8" fill="#ffc4e1"/>
            <circle cx="98" cy="107" r="2" fill="#ff4081" class="heartbeat-dot">
              <animate attributeName="r" values="2;3;2" dur="0.8s" repeatCount="indefinite"/>
            </circle>
            <!-- Scan line sweep -->
            <line x1="50" y1="120" x2="150" y2="120" stroke="#fff" stroke-width="1" opacity="0.4">
              <animate attributeName="y1" values="90;150;90" dur="4s" repeatCount="indefinite"/>
              <animate attributeName="y2" values="90;150;90" dur="4s" repeatCount="indefinite"/>
            </line>
          ` : key === 'nt' ? `
            <!-- 12-week fetus - head bob + arm flexing + NT measurement -->
            <g class="nt-baby">
              <circle cx="100" cy="100" r="18" fill="#ffb3d9">
                <animate attributeName="cy" values="100;98;100" dur="4s" repeatCount="indefinite"/>
              </circle>
              <ellipse cx="100" cy="135" rx="14" ry="25" fill="#ffb3d9">
                <animate attributeName="cy" values="135;133;135" dur="4s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="88" cy="138" rx="4" ry="12" fill="#ffc4e1">
                <animate attributeName="ry" values="12;14;12" dur="3s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="112" cy="138" rx="4" ry="12" fill="#ffc4e1">
                <animate attributeName="ry" values="12;14;12" dur="3s" begin="0.5s" repeatCount="indefinite"/>
              </ellipse>
              <circle cx="97" cy="98" r="2" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="2;3.5;2" dur="0.7s" repeatCount="indefinite"/>
              </circle>
              <!-- NT measurement indicator -->
              <path d="M 85 107 L 85 113" stroke="#ffff00" stroke-width="2" opacity="0.7">
                <animate attributeName="opacity" values="0.7;1;0.7" dur="2s" repeatCount="indefinite"/>
              </path>
            </g>
          ` : key === 'anatomy' ? `
            <!-- 20-week baby - floating + all limbs moving + visible eyes -->
            <g class="anatomy-baby">
              <circle cx="100" cy="90" r="22" fill="#ffb3d9">
                <animate attributeName="cy" values="90;88;90" dur="5s" repeatCount="indefinite"/>
              </circle>
              <ellipse cx="100" cy="135" rx="20" ry="35" fill="#ffb3d9">
                <animate attributeName="cy" values="135;133;135" dur="5s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Arms with movement -->
              <ellipse cx="82" cy="135" rx="5" ry="18" fill="#ffc4e1">
                <animate attributeName="cy" values="135;137;135" dur="4s" repeatCount="indefinite"/>
                <animate attributeName="ry" values="18;20;18" dur="4s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="118" cy="135" rx="5" ry="18" fill="#ffc4e1">
                <animate attributeName="cy" values="135;133;135" dur="4s" begin="0.5s" repeatCount="indefinite"/>
                <animate attributeName="ry" values="18;16;18" dur="4s" begin="0.5s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Legs with movement -->
              <ellipse cx="92" cy="168" rx="6" ry="20" fill="#ffc4e1">
                <animate attributeName="cy" values="168;170;168" dur="3.5s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="108" cy="168" rx="6" ry="20" fill="#ffc4e1">
                <animate attributeName="cy" values="168;166;168" dur="3.5s" begin="0.3s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Eyes -->
              <circle cx="95" cy="88" r="2" fill="#444">
                <animate attributeName="r" values="2;0.5;2" dur="5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="105" cy="88" r="2" fill="#444">
                <animate attributeName="r" values="2;0.5;2" dur="5s" repeatCount="indefinite"/>
              </circle>
              <circle cx="97" cy="92" r="3" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="3;4.5;3" dur="0.65s" repeatCount="indefinite"/>
              </circle>
            </g>
          ` : key === 'doppler' ? `
            <!-- Doppler - blood flow visualization with animated gradient -->
            <g class="doppler-baby">
              <circle cx="100" cy="85" r="28" fill="#ffb3d9"/>
              <ellipse cx="100" cy="140" rx="26" ry="45" fill="#ffb3d9"/>
              <ellipse cx="75" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
              <ellipse cx="125" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
              <ellipse cx="88" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <ellipse cx="112" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <!-- Umbilical cord with blood flow -->
              <path d="M 100 140 Q 90 160 85 180" fill="none" stroke="url(#bloodFlow)" stroke-width="4" opacity="0.8">
                <animate attributeName="stroke-width" values="4;5;4" dur="1.5s" repeatCount="indefinite"/>
              </path>
              <path d="M 100 140 Q 110 160 115 180" fill="none" stroke="url(#bloodFlow)" stroke-width="4" opacity="0.8">
                <animate attributeName="stroke-width" values="4;5;4" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>
              </path>
              <!-- Placenta indicator -->
              <circle cx="100" cy="190" r="15" fill="#ff6b9d" opacity="0.3">
                <animate attributeName="opacity" values="0.3;0.5;0.3" dur="2s" repeatCount="indefinite"/>
              </circle>
              <circle cx="98" cy="88" r="4" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="4;5.5;4" dur="0.6s" repeatCount="indefinite"/>
              </circle>
            </g>
          ` : key === 'threedFourd' ? `
            <!-- 3D/4D - detailed baby with thumb sucking -->
            <g class="threed-baby">
              <circle cx="100" cy="85" r="28" fill="#ffb3d9">
                <animate attributeName="cy" values="85;83;85" dur="6s" repeatCount="indefinite"/>
              </circle>
              <ellipse cx="100" cy="140" rx="26" ry="45" fill="#ffb3d9">
                <animate attributeName="cy" values="140;138;140" dur="6s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Left arm with thumb to mouth -->
              <ellipse cx="75" cy="135" rx="7" ry="22" fill="#ffc4e1">
                <animate attributeName="cx" values="75;80;75" dur="8s" repeatCount="indefinite"/>
                <animate attributeName="cy" values="135;110;135" dur="8s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Right arm -->
              <ellipse cx="125" cy="135" rx="7" ry="22" fill="#ffc4e1">
                <animate attributeName="cy" values="135;137;135" dur="4s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Legs -->
              <ellipse cx="88" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <ellipse cx="112" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <!-- Facial features -->
              <circle cx="93" cy="83" r="2.5" fill="#444"/>
              <circle cx="107" cy="83" r="2.5" fill="#444"/>
              <path d="M 95 91 Q 100 93 105 91" fill="none" stroke="#444" stroke-width="1.5"/>
              <!-- Cheeks -->
              <circle cx="88" cy="88" r="5" fill="#ffc4e1" opacity="0.6"/>
              <circle cx="112" cy="88" r="5" fill="#ffc4e1" opacity="0.6"/>
              <circle cx="98" cy="88" r="4" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="4;5.5;4" dur="0.6s" repeatCount="indefinite"/>
              </circle>
              <!-- Sparkle effect for 3D/4D -->
              <circle cx="70" cy="70" r="2" fill="#fff" opacity="0">
                <animate attributeName="opacity" values="0;0.8;0" dur="3s" repeatCount="indefinite"/>
              </circle>
              <circle cx="130" cy="90" r="2" fill="#fff" opacity="0">
                <animate attributeName="opacity" values="0;0.8;0" dur="3s" begin="1s" repeatCount="indefinite"/>
              </circle>
            </g>
          ` : key === 'bpp' ? `
            <!-- BPP - all movements visible -->
            <g class="bpp-baby">
              <circle cx="100" cy="85" r="28" fill="#ffb3d9">
                <animate attributeName="cy" values="85;82;85" dur="3s" repeatCount="indefinite"/>
              </circle>
              <ellipse cx="100" cy="140" rx="26" ry="45" fill="#ffb3d9">
                <animate attributeName="ry" values="45;46;45" dur="3s" repeatCount="indefinite"/>
              </ellipse>
              <!-- All limbs moving independently -->
              <ellipse cx="75" cy="135" rx="7" ry="22" fill="#ffc4e1">
                <animate attributeName="cy" values="135;138;135" dur="2.5s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="125" cy="135" rx="7" ry="22" fill="#ffc4e1">
                <animate attributeName="cy" values="135;132;135" dur="2.5s" begin="0.4s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="88" cy="180" rx="8" ry="25" fill="#ffc4e1">
                <animate attributeName="cy" values="180;183;180" dur="3s" repeatCount="indefinite"/>
              </ellipse>
              <ellipse cx="112" cy="180" rx="8" ry="25" fill="#ffc4e1">
                <animate attributeName="cy" values="180;177;180" dur="3s" begin="0.6s" repeatCount="indefinite"/>
              </ellipse>
              <circle cx="93" cy="83" r="2.5" fill="#444"/>
              <circle cx="107" cy="83" r="2.5" fill="#444"/>
              <path d="M 95 91 Q 100 94 105 91" fill="none" stroke="#444" stroke-width="1.5"/>
              <circle cx="98" cy="88" r="4" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="4;5.5;4" dur="0.6s" repeatCount="indefinite"/>
              </circle>
              <!-- Activity indicators -->
              <text x="50" y="210" font-size="10" fill="#4fc3f7" opacity="0.8">
                <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" repeatCount="indefinite"/>
                 Breathing
              </text>
              <text x="120" y="210" font-size="10" fill="#4fc3f7" opacity="0.8">
                <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" begin="0.5s" repeatCount="indefinite"/>
                 Movement
              </text>
            </g>
          ` : key === 'nst' ? `
            <!-- NST - heart rate monitor display -->
            <g class="nst-baby">
              <circle cx="100" cy="85" r="28" fill="#ffb3d9"/>
              <ellipse cx="100" cy="140" rx="26" ry="45" fill="#ffb3d9"/>
              <ellipse cx="75" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
              <ellipse cx="125" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
              <ellipse cx="88" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <ellipse cx="112" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
              <circle cx="93" cy="83" r="2.5" fill="#444"/>
              <circle cx="107" cy="83" r="2.5" fill="#444"/>
              <path d="M 95 91 Q 100 94 105 91" fill="none" stroke="#444" stroke-width="1.5"/>
              <circle cx="98" cy="88" r="4" fill="#ff4081" class="heartbeat-dot">
                <animate attributeName="r" values="4;6;4" dur="0.5s" repeatCount="indefinite"/>
              </circle>
              <!-- Heart rate monitor waveform -->
              <path d="M 30 220 L 35 220 L 37 215 L 39 225 L 41 220 L 170 220" stroke="#00ff00" stroke-width="2" fill="none" opacity="0.8">
                <animateTransform attributeName="transform" type="translate" values="0,0; -140,0" dur="3s" repeatCount="indefinite"/>
              </path>
              <!-- Heart rate number -->
              <text x="150" y="215" font-size="12" fill="#00ff00" font-weight="bold" opacity="0.9">
                <animate attributeName="opacity" values="0.9;1;0.9" dur="0.5s" repeatCount="indefinite"/>
                145 bpm
              </text>
            </g>
          ` : `
            <!-- 32-week baby - fully formed, curled up -->
            <circle cx="100" cy="85" r="28" fill="#ffb3d9"/>
            <ellipse cx="100" cy="140" rx="26" ry="45" fill="#ffb3d9"/>
            <ellipse cx="75" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
            <ellipse cx="125" cy="135" rx="7" ry="22" fill="#ffc4e1"/>
            <ellipse cx="88" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
            <ellipse cx="112" cy="180" rx="8" ry="25" fill="#ffc4e1"/>
            <circle cx="93" cy="83" r="2.5" fill="#444"/>
            <circle cx="107" cy="83" r="2.5" fill="#444"/>
            <path d="M 95 91 Q 100 94 105 91" fill="none" stroke="#444" stroke-width="1.5"/>
            <circle cx="98" cy="88" r="4" fill="#ff4081" class="heartbeat-dot"/>
          `}
        </svg>
      </div>
    `;
    
    const modalContent = `
      <div class="scan-modal-content">
        <div class="scan-visual-section">
          ${babyIllustration}
          <div class="baby-stats">
            ${s.type ? `<div class="stat-badge scan-type-badge scan-type-${s.type.toLowerCase().replace(/\//g, '')}">
              <span class="stat-icon"></span>
              <span class="stat-label"><strong>${s.type}</strong></span>
            </div>` : ''}
            <div class="stat-badge">
              <span class="stat-icon"></span>
              <span class="stat-label">Length: <strong>${s.babyLength}</strong></span>
            </div>
            <div class="stat-badge">
              <span class="stat-icon"></span>
              <span class="stat-label">Size: <strong>${s.babySize}</strong></span>
            </div>
            <div class="stat-badge">
              <span class="stat-icon"></span>
              <span class="stat-label">Week: <strong>${s.weeks}</strong></span>
            </div>
          </div>
        </div>
        
        <div class="scan-info-section">
          <h4 class="scan-timing">When: ${s.when}</h4>
          
          <div class="scan-checklist">
            <h5>What We Check:</h5>
            <ul>
              ${s.lines.map(line => `<li><span class="check-mark"></span>${line}</li>`).join('')}
            </ul>
          </div>
          
          <div class="development-insight">
            <div class="insight-icon-small"></div>
            <div>
              <h5>Your Baby at Week ${s.weeks}</h5>
              <p>${s.details}</p>
            </div>
          </div>
          
          <div class="scan-footer-tip">
            <strong> Tip:</strong> ${
              key === 'dating' ? 'Bring a list of questions about early pregnancy. This scan will give you your official due date!' :
              key === 'nt' ? 'This is a screening, not diagnostic. Results are combined with blood tests for risk assessment.' :
              key === 'anatomy' ? 'This scan takes 30-45 minutes. Full bladder NOT needed. Bring your partner/support person!' :
              key === 'doppler' ? 'Doppler shows blood flow in color. Red = toward probe, blue = away. Helps assess placental function.' :
              key === 'threedFourd' ? '3D/4D scans work best 24-32 weeks when baby has fat but still has room to move. Drink water before!' :
              key === 'bpp' ? 'BPP combines ultrasound with heart monitoring. May take 30+ minutes to observe all 5 components.' :
              key === 'nst' ? 'NST is painlessjust two belts on your belly. Try drinking cold juice 30 min before to wake baby up!' :
              'These scans track growth. If baby is measuring small or large, your provider may adjust care or schedule more scans.'
            }
          </div>
        </div>
      </div>
    `;
    
    openModal(
      s.title,
      modalContent,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // Due-this-week drill
  ANC.runDueThisWeek = () => {
    const w = clamp(Number($("#drillWeek")?.value ?? 12), 1, 40);
    const items = GUIDE.dueThisWeek(w);
    safeHTML("drillOutput", `<strong>Week ${w}:</strong><ul>${items.map(i => `<li>${i}</li>`).join("")}</ul>`);
  };

  ANC.quizDueThisWeek = () => {
    const w = clamp(Number($("#drillWeek")?.value ?? 12), 1, 40);
    const items = GUIDE.dueThisWeek(w);
    const correct = items[Math.floor(Math.random() * items.length)];
    const decoys = [
      "GBS swab window (3537w)",
      "Dating scan window (610w)",
      "Anatomy scan window (1822w)",
      "Glucose screening window (2428w)",
      "Tdap window (2736w)"
    ].filter(x => x !== correct);

    const opts = [correct, decoys[0], decoys[1]].sort(() => Math.random() - 0.5);
    openModal(
      "Quiz: Whats due this week?",
      `<p><strong>Week ${w}</strong>  choose the most likely due item:</p>
       <div class="pill-grid">
         ${opts.map(o => `<button class="pill-btn" type="button" onclick="ANC._answerDueQuiz(${JSON.stringify(o)}, ${JSON.stringify(correct)})">${o}</button>`).join("")}
       </div>
       <div class="modal-output" id="dueQuizOut">Pick one.</div>`,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  ANC._answerDueQuiz = (pick, correct) => {
    const out = $("#dueQuizOut");
    if (!out) return;
    out.innerHTML = pick === correct
      ? `<span class="pill critical">Correct</span> Memory anchored.`
      : `<span class="pill warn">Not quite</span> Correct: ${correct}`;
  };

  // Vaccines panel
  const VAX = {
    tdap: { 
      title: "Tdap Vaccine",
      subtitle: "Tetanus, Diphtheria, and Pertussis (Whooping Cough)",
      icon: "",
      when: "Weeks 2736", 
      badge: "Strongly Recommended",
      color: "#66bb6a",
      keyFacts: [
        { icon: "", label: "Primary Protection", value: "Whooping cough for newborns" },
        { icon: "", label: "Best Timing", value: "27-36 weeks of pregnancy" },
        { icon: "", label: "Protection Duration", value: "First 2-3 months of life" },
        { icon: "", label: "Frequency", value: "Every pregnancy" }
      ],
      whyImportant: "Whooping cough (pertussis) is a highly contagious respiratory disease that can be deadly for newborns. Babies cannot receive their first pertussis vaccine until they're 2 months old, leaving them extremely vulnerable. By getting vaccinated during pregnancy, you pass protective antibodies through the placenta, giving your baby crucial immunity during their most vulnerable weeks.",
      howItWorks: [
        "Your immune system produces antibodies against tetanus, diphtheria, and pertussis",
        "These IgG antibodies actively cross the placenta during the third trimester",
        "Baby is born with maternal antibodies circulating in their bloodstream",
        "Protection peaks immediately after birth and gradually declines over 2-3 months",
        "This shields baby until they can start their own vaccination series at 2 months"
      ],
      benefits: [
        "Reduces infant whooping cough by 78% in first 2 months",
        "Prevents severe complications: apnea (stopping breathing), pneumonia, seizures",
        "Protects mother from tetanus and diphtheria",
        "Most effective when given between 27-36 weeks",
        "Safe - decades of data show no increased pregnancy complications"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm, mild fever, fatigue (1-2 days)" },
        { severity: "Rare", effects: "Severe allergic reaction (very rare, treatable)" },
        { severity: "Note", effects: "Side effects in mother do not affect baby" }
      ],
      myths: [
        {
          myth: "I got Tdap before, I don't need it again",
          truth: "Immunity wanes over time. You need Tdap with EVERY pregnancy to protect each new baby."
        },
        {
          myth: "It's too close to delivery, it won't work",
          truth: "Even at 36 weeks, antibodies transfer quickly. Some protection is better than none."
        },
        {
          myth: "I can wait until after birth",
          truth: "Postpartum vaccination doesn't protect the baby - they need YOUR antibodies during pregnancy."
        }
      ],
      timeline: [
        { week: "27-36", event: "Get Tdap vaccine", icon: "" },
        { week: "28-36", event: "Peak antibody production", icon: "" },
        { week: "32-40", event: "Maximum transfer to baby", icon: "" },
        { week: "Birth", event: "Baby born with protection", icon: "" },
        { week: "0-8 weeks", event: "Maternal antibodies protect baby", icon: "" },
        { week: "8 weeks", event: "Baby gets first DTaP vaccine", icon: "" }
      ],
      resources: [
        { text: "CDC Pregnancy Tdap Guidelines", icon: "" },
        { text: "Whooping Cough Statistics", icon: "" },
        { text: "Vaccine Safety Studies", icon: "" }
      ]
    },
    flu: { 
      title: "Flu Vaccine",
      subtitle: "Influenza (Seasonal Flu Shot)",
      icon: "",
      when: "Any trimester",
      badge: "Strongly Recommended",
      color: "#42a5f5",
      keyFacts: [
        { icon: "", label: "Protection", value: "Mother and baby from flu" },
        { icon: "", label: "Timing", value: "Any time during pregnancy" },
        { icon: "", label: "Baby Protection", value: "First 6 months of life" },
        { icon: "", label: "Season", value: "October through March" }
      ],
      whyImportant: "Pregnancy dramatically changes your immune system, heart, and lungs, making you much more susceptible to severe flu complications. Pregnant women with flu are more likely to be hospitalized and can develop life-threatening complications like pneumonia. The flu vaccine protects both you and your baby, who cannot be vaccinated until 6 months old.",
      howItWorks: [
        "Inactivated (killed) flu virus triggers your immune response safely",
        "Your body produces antibodies specific to this year's flu strains",
        "Antibodies cross the placenta and protect your baby",
        "Baby is born with flu antibodies that last 6+ months",
        "Protection through breastfeeding provides additional immunity"
      ],
      benefits: [
        "Reduces flu-related hospitalizations during pregnancy by 40%",
        "Decreases risk of preterm birth due to flu infection",
        "Reduces infant flu hospitalizations by 72% in first 6 months",
        "Protects against serious flu complications: pneumonia, heart problems",
        "Can be given at the same time as Tdap or COVID-19 vaccines"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm (50% of people), mild aches (10-20%)" },
        { severity: "Rare", effects: "Low fever lasting less than 24 hours" },
        { severity: "Very Rare", effects: "Severe allergic reaction (1 in 1 million doses)" }
      ],
      myths: [
        {
          myth: "The flu shot can give me the flu",
          truth: "Impossible. The vaccine contains killed virus that cannot cause infection."
        },
        {
          myth: "I'm healthy, I don't need it",
          truth: "Pregnancy itself makes you high-risk, regardless of your health history."
        },
        {
          myth: "I got it last year, I'm still protected",
          truth: "Flu strains change yearly. Last year's vaccine won't protect against this year's strains."
        }
      ],
      timeline: [
        { week: "Anytime", event: "Get flu vaccine", icon: "" },
        { week: "2 weeks", event: "Peak immunity develops", icon: "" },
        { week: "Throughout", event: "Protection during pregnancy", icon: "" },
        { week: "Birth", event: "Baby receives antibodies", icon: "" },
        { week: "0-6 months", event: "Baby protected by maternal antibodies", icon: "" },
        { week: "6 months", event: "Baby can get own flu vaccine", icon: "" }
      ],
      resources: [
        { text: "CDC Flu & Pregnancy Information", icon: "" },
        { text: "Flu Vaccine Safety Data", icon: "" },
        { text: "Pregnancy Flu Complications", icon: "" }
      ]
    },
    covid: { 
      title: "COVID-19 Vaccine",
      subtitle: "mRNA COVID-19 Vaccination",
      icon: "",
      when: "Any trimester",
      badge: "Recommended",
      color: "#7e57c2",
      keyFacts: [
        { icon: "", label: "Protection", value: "Severe COVID-19 illness" },
        { icon: "", label: "Timing", value: "Any trimester, as soon as eligible" },
        { icon: "", label: "Baby Protection", value: "Antibodies via placenta & breast milk" },
        { icon: "", label: "Type", value: "mRNA (Pfizer/Moderna) preferred" }
      ],
      whyImportant: "COVID-19 infection during pregnancy significantly increases your risk of severe illness, ICU admission, preterm birth, and stillbirth. Pregnant people are more likely to need life support and have worse outcomes. Vaccination is the best way to protect yourself and your baby from these serious risks.",
      howItWorks: [
        "mRNA teaches your cells to make a harmless spike protein piece",
        "Your immune system recognizes it as foreign and creates antibodies",
        "These antibodies fight the real COVID-19 virus if you're exposed",
        "Antibodies cross the placenta, protecting your baby",
        "No live virus involved - cannot cause COVID-19 infection"
      ],
      benefits: [
        "61% reduction in COVID-19 hospitalization during pregnancy",
        "Dramatically reduces risk of severe illness, ICU admission, ventilation",
        "Decreases risk of preterm birth and stillbirth from COVID-19",
        "Passes antibodies to baby, protecting them in first months",
        "Safe - extensive data from hundreds of thousands of pregnancies"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm, fatigue, headache, muscle aches for 1-2 days" },
        { severity: "Less Common", effects: "Low fever, chills (more common after 2nd dose)" },
        { severity: "Rare", effects: "Severe allergic reaction (very rare, occurs within minutes, treatable)" }
      ],
      myths: [
        {
          myth: "COVID vaccines cause miscarriage",
          truth: "False. Multiple large studies show no increased risk of miscarriage, stillbirth, or birth defects."
        },
        {
          myth: "COVID vaccines affect fertility",
          truth: "No evidence of this. Many vaccinated people have healthy pregnancies and babies."
        },
        {
          myth: "Natural immunity is better than vaccine",
          truth: "COVID-19 infection during pregnancy is far more dangerous than vaccination."
        }
      ],
      timeline: [
        { week: "Anytime", event: "First dose", icon: "" },
        { week: "3-8 weeks", event: "Second dose (if needed)", icon: "" },
        { week: "2 weeks after", event: "Peak immunity", icon: "" },
        { week: "Throughout", event: "Protection during pregnancy", icon: "" },
        { week: "Birth", event: "Antibodies present in baby", icon: "" },
        { week: "0-6 months", event: "Baby has maternal antibodies", icon: "" }
      ],
      resources: [
        { text: "CDC COVID-19 Pregnancy Data", icon: "" },
        { text: "Vaccine Safety Monitoring", icon: "" },
        { text: "Pregnancy Registry Studies", icon: "" }
      ]
    },
    hepb: {
      title: "Hepatitis B Vaccine",
      subtitle: "Protection Against Liver Infection",
      icon: "",
      when: "If at risk",
      badge: "Recommended for High-Risk",
      color: "#ffa726",
      keyFacts: [
        { icon: "", label: "Protection", value: "Serious liver infection" },
        { icon: "", label: "Timing", value: "3-dose series over 6 months" },
        { icon: "", label: "Risk Factors", value: "Healthcare, travel, multiple partners" },
        { icon: "", label: "Newborn Risk", value: "90% become chronically infected if exposed" }
      ],
      whyImportant: "Hepatitis B is a serious liver infection that can become chronic, leading to liver damage, cirrhosis, liver cancer, and even death. Newborns infected at birth have a 90% chance of developing chronic infection. All pregnant women are tested for hepatitis B to protect their babies.",
      howItWorks: [
        "Vaccine contains hepatitis B surface protein (no live virus)",
        "Your immune system learns to recognize and fight hepatitis B",
        "Given as 3-dose series: 0, 1 month, and 6 months",
        "Can safely start or continue the series during pregnancy",
        "Provides long-lasting (possibly lifelong) immunity"
      ],
      benefits: [
        "Prevents acute hepatitis B infection during pregnancy",
        "Protects against chronic liver disease and liver cancer",
        "Safe during pregnancy - inactivated vaccine",
        "If baby is born to infected mother, immediate treatment is very effective",
        "Protects healthcare workers and those in high-risk situations"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm (20-30%), mild fatigue" },
        { severity: "Uncommon", effects: "Mild fever, headache" },
        { severity: "Rare", effects: "Severe allergic reaction (extremely rare)" }
      ],
      myths: [
        {
          myth: "Only drug users need this vaccine",
          truth: "Many people are at risk: healthcare workers, travelers, partners of infected individuals."
        },
        {
          myth: "I should wait until after pregnancy",
          truth: "If you're at risk, getting vaccinated during pregnancy is safe and important."
        }
      ],
      timeline: [
        { week: "Today", event: "Dose 1 (if at risk)", icon: "" },
        { week: "1 month", event: "Dose 2", icon: "" },
        { week: "6 months", event: "Dose 3", icon: "" },
        { week: "Birth", event: "Baby tested & treated if mother positive", icon: "" },
        { week: "After", event: "Long-term immunity", icon: "" }
      ],
      resources: [
        { text: "CDC Hepatitis B Information", icon: "" },
        { text: "Pregnancy Testing Guidelines", icon: "" },
        { text: "Newborn Treatment Protocols", icon: "" }
      ]
    },
    mmr: {
      title: "MMR Vaccine",
      subtitle: "Measles, Mumps, and Rubella",
      icon: "",
      when: "Avoid - Get before or after pregnancy",
      badge: "Not Safe During Pregnancy",
      color: "#ef5350",
      keyFacts: [
        { icon: "", label: "Pregnancy", value: "Live vaccine - NOT safe during pregnancy" },
        { icon: "", label: "Wait Time", value: "28 days after vaccine before conceiving" },
        { icon: "", label: "If Not Immune", value: "Vaccinate immediately after delivery" },
        { icon: "", label: "Rubella Risk", value: "Can cause severe birth defects" }
      ],
      whyImportant: "While the MMR vaccine itself cannot be given during pregnancy, immunity to these diseases - especially rubella - is crucial. Rubella (German measles) infection during pregnancy can cause miscarriage, stillbirth, or severe birth defects including deafness, heart defects, and intellectual disabilities (Congenital Rubella Syndrome).",
      howItWorks: [
        "Live attenuated (weakened) virus vaccine",
        "Cannot be given during pregnancy due to theoretical risk",
        "Immunity checked via blood test in early pregnancy",
        "If not immune, vaccinate immediately postpartum (even if breastfeeding)",
        "Provides lifelong immunity against all three diseases"
      ],
      risks: [
        "Measles during pregnancy: increased risk of miscarriage, preterm birth",
        "Mumps during pregnancy: slight increased risk of miscarriage in first trimester",
        "Rubella during pregnancy: 85% risk of birth defects if infected in first trimester",
        "Most women are already immune from childhood vaccination",
        "Blood test during pregnancy checks your immune status"
      ],
      sideEffects: [
        { severity: "Common (postpartum)", effects: "Sore arm, mild rash, low fever" },
        { severity: "Uncommon", effects: "Temporary joint pain (more common in women)" },
        { severity: "Rare", effects: "Low platelet count (temporary), severe allergic reaction" }
      ],
      myths: [
        {
          myth: "If I got MMR while unknowingly pregnant, my baby will have defects",
          truth: "Decades of data show no confirmed cases of birth defects from accidental vaccination during pregnancy."
        },
        {
          myth: "I can't breastfeed after MMR",
          truth: "False. MMR is safe while breastfeeding and protects your future pregnancies."
        }
      ],
      timeline: [
        { week: "Before pregnancy", event: "Check immunity & vaccinate if needed", icon: "" },
        { week: "Early pregnancy", event: "Blood test checks immunity status", icon: "" },
        { week: "If not immune", event: "Avoid exposure to measles/rubella", icon: "" },
        { week: "Delivery", event: "Vaccinate immediately after birth", icon: "" },
        { week: "28 days after", event: "Protected for future pregnancies", icon: "" }
      ],
      resources: [
        { text: "Rubella & Pregnancy Information", icon: "" },
        { text: "Postpartum Vaccination Guidelines", icon: "" },
        { text: "Congenital Rubella Syndrome Facts", icon: "" }
      ]
    },
    varicella: {
      title: "Varicella Vaccine",
      subtitle: "Chickenpox Prevention",
      icon: "",
      when: "Avoid - Get before or after pregnancy",
      badge: "Not Safe During Pregnancy",
      color: "#ef5350",
      keyFacts: [
        { icon: "", label: "Pregnancy", value: "Live vaccine - NOT safe during pregnancy" },
        { icon: "", label: "Wait Time", value: "4 weeks after dose 2 before conceiving" },
        { icon: "", label: "Doses", value: "2-dose series, 4-8 weeks apart" },
        { icon: "", label: "Infection Risk", value: "Can cause birth defects & maternal pneumonia" }
      ],
      whyImportant: "While most adults are immune to chickenpox (from childhood infection or vaccination), those who aren't face serious risks during pregnancy. Chickenpox infection during pregnancy can cause maternal pneumonia (very dangerous), birth defects (if infected in first 20 weeks), or severe infection in newborns if mother gets chickenpox just before or after delivery.",
      howItWorks: [
        "Live attenuated varicella-zoster virus vaccine",
        "Cannot be given during pregnancy",
        "Two doses required, 4-8 weeks apart",
        "If not immune, vaccinate immediately after delivery",
        "Provides long-lasting immunity (may need booster decades later)"
      ],
      risks: [
        "Chickenpox in early pregnancy (< 20 weeks): 0.5-2% risk of congenital varicella syndrome",
        "Birth defects can include limb abnormalities, scarring, eye problems, neurological issues",
        "Maternal chickenpox: 10-20% risk of pneumonia (very serious)",
        "Chickenpox at delivery: baby at risk for severe, sometimes fatal infection",
        "Most adults (85-95%) are already immune"
      ],
      sideEffects: [
        { severity: "Common (postpartum)", effects: "Sore arm, mild rash at injection site" },
        { severity: "Uncommon", effects: "Mild chickenpox-like rash (5-10% of people)" },
        { severity: "Rare", effects: "Fever, more extensive rash, severe allergic reaction" }
      ],
      myths: [
        {
          myth: "I had chickenpox as a child, I don't need the vaccine",
          truth: "True! If you had chickenpox, you're immune. Blood test can confirm if unsure."
        },
        {
          myth: "I can't be around my recently vaccinated child",
          truth: "Very low risk. Only avoid if you're immunocompromised and they develop a rash."
        }
      ],
      timeline: [
        { week: "Before pregnancy", event: "Check immunity & vaccinate if needed", icon: "" },
        { week: "4-8 weeks", event: "Second dose", icon: "" },
        { week: "4 weeks after", event: "Can safely conceive", icon: "" },
        { week: "Early pregnancy", event: "Immunity checked if unsure", icon: "" },
        { week: "If not immune", event: "Avoid exposure during pregnancy", icon: "" },
        { week: "After delivery", event: "Get vaccinated immediately", icon: "" }
      ],
      resources: [
        { text: "Varicella & Pregnancy Guidelines", icon: "" },
        { text: "Chickenpox Complications in Pregnancy", icon: "" },
        { text: "Postpartum Vaccination Schedule", icon: "" }
      ]
    },
    pneumo: {
      title: "Pneumococcal Vaccine",
      subtitle: "Protection Against Pneumonia & Serious Infections",
      icon: "",
      when: "If at risk",
      badge: "Recommended for High-Risk",
      color: "#26c6da",
      keyFacts: [
        { icon: "", label: "Risk Factors", value: "Asthma, diabetes, heart/lung disease" },
        { icon: "", label: "Protection", value: "Pneumonia, meningitis, bloodstream infections" },
        { icon: "", label: "Types", value: "PCV13 and PPSV23" },
        { icon: "", label: "Timing", value: "Can be given during pregnancy if at risk" }
      ],
      whyImportant: "Pneumococcal bacteria cause serious infections including pneumonia (lung infection), meningitis (brain/spinal cord infection), and bacteremia (bloodstream infection). If you have certain chronic conditions, you're at higher risk for these life-threatening infections, especially during pregnancy when your immune system is altered.",
      howItWorks: [
        "Inactivated vaccine - safe during pregnancy",
        "Contains polysaccharides from pneumococcal bacteria",
        "Two types: PCV13 (13 strains) and PPSV23 (23 strains)",
        "Your provider recommends which type(s) you need based on risk factors",
        "Provides several years of protection"
      ],
      benefits: [
        "Prevents serious pneumococcal infections",
        "Reduces risk of pneumonia requiring hospitalization",
        "Protects against antibiotic-resistant strains",
        "Especially important if you have sickle cell disease, diabetes, asthma",
        "Safe during pregnancy - no live organisms"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm (50-70%), fatigue, mild headache" },
        { severity: "Uncommon", effects: "Muscle aches, low fever" },
        { severity: "Rare", effects: "Severe local reaction, allergic reaction (very rare)" }
      ],
      riskFactors: [
        "Chronic lung disease (COPD, asthma)",
        "Heart disease",
        "Diabetes",
        "Sickle cell disease or other blood disorders",
        "HIV or immunocompromised conditions",
        "Chronic kidney disease",
        "Liver disease",
        "Smokers"
      ],
      timeline: [
        { week: "If at risk", event: "Discuss with provider", icon: "" },
        { week: "Anytime", event: "Get vaccine if recommended", icon: "" },
        { week: "2 weeks", event: "Immunity develops", icon: "" },
        { week: "Throughout", event: "Protected during pregnancy", icon: "" },
        { week: "5+ years", event: "May need booster (ask provider)", icon: "" }
      ],
      resources: [
        { text: "CDC Pneumococcal Vaccination", icon: "" },
        { text: "High-Risk Conditions Guide", icon: "" },
        { text: "Pregnancy & Chronic Illness", icon: "" }
      ]
    },
    meningococcal: {
      title: "Meningococcal Vaccine",
      subtitle: "Protection Against Bacterial Meningitis",
      icon: "",
      when: "If at risk",
      badge: "Recommended for High-Risk",
      color: "#ab47bc",
      keyFacts: [
        { icon: "", label: "Travel Risk", value: "Sub-Saharan Africa, Hajj pilgrimage" },
        { icon: "", label: "Other Risk", value: "College dorms, military, immune conditions" },
        { icon: "", label: "Types", value: "MenACWY and MenB" },
        { icon: "", label: "Timing", value: "If benefit outweighs risk" }
      ],
      whyImportant: "Meningococcal disease causes devastating infections of the brain and spinal cord (meningitis) and bloodstream (septicemia). It can kill within hours and survivors often have permanent disabilities (limb amputation, deafness, brain damage). While rare in the general population, risk is much higher in certain situations, especially travel to endemic regions.",
      howItWorks: [
        "Inactivated vaccine - safe during pregnancy if needed",
        "MenACWY covers serogroups A, C, W, and Y",
        "MenB covers serogroup B (separate vaccine)",
        "Provides protection within 2 weeks",
        "Duration of protection varies by type"
      ],
      benefits: [
        "Prevents life-threatening meningitis and septicemia",
        "Critical if traveling to high-risk areas during pregnancy",
        "Protects those with certain immune conditions (complement deficiencies)",
        "Required for Hajj pilgrimage (Saudi Arabia)",
        "Can prevent outbreaks in close-contact settings"
      ],
      sideEffects: [
        { severity: "Common", effects: "Sore arm (50%), fatigue, headache" },
        { severity: "Uncommon", effects: "Muscle pain, mild fever, nausea" },
        { severity: "Rare", effects: "Severe allergic reaction (very rare)" }
      ],
      riskFactors: [
        "Travel to meningitis belt in Africa (sub-Saharan)",
        "Hajj or Umrah pilgrimage to Mecca",
        "Living in military barracks or college dorms",
        "Complement component deficiency (immune condition)",
        "Damaged or removed spleen",
        "HIV infection",
        "Laboratory workers exposed to bacteria"
      ],
      timeline: [
        { week: "If traveling", event: "Vaccinate 2+ weeks before travel", icon: "" },
        { week: "2 weeks", event: "Protection develops", icon: "" },
        { week: "Throughout", event: "Protected during pregnancy & travel", icon: "" },
        { week: "3-5 years", event: "Booster if continued risk (MenACWY)", icon: "" },
        { week: "MenB", event: "May need booster sooner (1-2 years)", icon: "" }
      ],
      resources: [
        { text: "CDC Meningococcal Information", icon: "" },
        { text: "Travel Health Notices", icon: "" },
        { text: "Hajj Pilgrimage Requirements", icon: "" }
      ]
    },
    avoid: { 
      title: "Live Vaccines to Avoid",
      subtitle: "Vaccines Not Recommended During Pregnancy",
      icon: "",
      when: "Avoid during pregnancy",
      badge: "Not Safe During Pregnancy",
      color: "#ef5350",
      keyFacts: [
        { icon: "", label: "Risk", value: "Theoretical risk to developing baby" },
        { icon: "", label: "Alternative", value: "Inactivated versions often available" },
        { icon: "", label: "Timing", value: "Vaccinate before pregnancy or after delivery" },
        { icon: "", label: "Wait Time", value: "4 weeks after vaccination before conceiving" }
      ],
      whyImportant: "Live vaccines contain weakened (attenuated) versions of viruses or bacteria that can replicate in your body. While they're safe for most people, there's a theoretical risk they could harm a developing baby. However, most vaccines recommended during pregnancy are NOT live and are completely safe. Understanding which vaccines to avoid helps you plan appropriately.",
      avoidList: [
        {
          name: "MMR (Measles, Mumps, Rubella)",
          why: "Live virus - risk of rubella infection in fetus",
          alternative: "Check immunity, vaccinate postpartum if needed"
        },
        {
          name: "Varicella (Chickenpox)",
          why: "Live virus - theoretical risk to fetus",
          alternative: "Vaccinate postpartum if not immune"
        },
        {
          name: "Nasal Flu Vaccine (FluMist)",
          why: "Live attenuated virus",
          alternative: "Use injectable flu shot instead (inactivated)"
        },
        {
          name: "Yellow Fever",
          why: "Live virus vaccine",
          alternative: "Delay travel if possible; only if travel unavoidable to endemic area"
        },
        {
          name: "BCG (Tuberculosis)",
          why: "Live bacterial vaccine",
          alternative: "Not routinely given in US; avoid during pregnancy"
        },
        {
          name: "Oral Typhoid",
          why: "Live bacterial vaccine",
          alternative: "Injectable typhoid vaccine is inactivated (safer option)"
        },
        {
          name: "Oral Polio (OPV)",
          why: "Live virus",
          alternative: "Injectable polio vaccine (IPV) is inactivated (used in US)"
        },
        {
          name: "Rotavirus",
          why: "Live virus - for infants only",
          alternative: "Not given to adults"
        }
      ],
      safeAlternatives: [
        "Injectable (inactivated) flu vaccine - SAFE and recommended",
        "Tdap (tetanus, diphtheria, pertussis) - SAFE and strongly recommended",
        "COVID-19 mRNA vaccines - SAFE and recommended",
        "Hepatitis A and B - SAFE if at risk",
        "Pneumococcal - SAFE if at risk",
        "Meningococcal - SAFE if at risk",
        "Injectable (killed) typhoid - SAFE if traveling",
        "Injectable (IPV) polio - SAFE if needed"
      ],
      myths: [
        {
          myth: "I can't get any vaccines during pregnancy",
          truth: "False! Most vaccines are safe. Only LIVE vaccines are avoided."
        },
        {
          myth: "If I got a live vaccine while pregnant, I should terminate",
          truth: "No! Decades of data show accidental vaccination rarely causes problems. Discuss with your doctor."
        },
        {
          myth: "I should avoid vaccinated people during pregnancy",
          truth: "No need. Vaccine shedding is extremely rare and almost never causes infection."
        }
      ],
      timeline: [
        { week: "Before pregnancy", event: "Get live vaccines if needed", icon: "" },
        { week: "4 weeks", event: "Wait before conceiving", icon: "" },
        { week: "During pregnancy", event: "Avoid live vaccines", icon: "" },
        { week: "Get safe vaccines", event: "Tdap, flu, COVID-19", icon: "" },
        { week: "After delivery", event: "Safe to get any needed live vaccines", icon: "" }
      ],
      resources: [
        { text: "CDC Pregnancy Vaccination Schedule", icon: "" },
        { text: "Live vs Inactivated Vaccines", icon: "" },
        { text: "Postpartum Vaccination Guide", icon: "" }
      ]
    }
  };

  ANC.showVaccine = (key) => {
    const v = VAX[key];
    if (!v) return;

    // Create comprehensive modal content
    let modalContent = `
      <div class="vaccine-modal-content">
        <!-- Header Section -->
        <div class="vaccine-modal-header" style="background: linear-gradient(135deg, ${v.color}, ${v.color}dd); color: white; padding: 2rem; border-radius: 16px 16px 0 0; margin: -1.5rem -1.5rem 0 -1.5rem;">
          <div class="vaccine-header-icon" style="font-size: 4rem; margin-bottom: 0.5rem; text-align: center;">${v.icon}</div>
          <h2 style="text-align: center; margin-bottom: 0.3rem; font-size: 1.8rem;">${v.title}</h2>
          <p style="text-align: center; font-size: 1.1rem; opacity: 0.95;">${v.subtitle}</p>
          <div style="display: flex; justify-content: center; gap: 1rem; margin-top: 1rem; flex-wrap: wrap;">
            <span style="background: rgba(255,255,255,0.2); padding: 0.5rem 1rem; border-radius: 20px; font-weight: 600;"> ${v.when}</span>
            <span style="background: rgba(255,255,255,0.2); padding: 0.5rem 1rem; border-radius: 20px; font-weight: 600;">${v.badge}</span>
          </div>
        </div>

        <!-- Key Facts Grid -->
        <div class="vaccine-key-facts" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1.5rem 0;">
          ${v.keyFacts.map(fact => `
            <div style="background: linear-gradient(135deg, rgba(${v.color === '#66bb6a' ? '102,187,106' : v.color === '#42a5f5' ? '66,165,245' : v.color === '#7e57c2' ? '126,87,194' : v.color === '#ffa726' ? '255,167,38' : v.color === '#ef5350' ? '239,83,80' : v.color === '#26c6da' ? '38,198,218' : '171,71,188'},0.1), rgba(255,255,255,0.9)); padding: 1.2rem; border-radius: 12px; text-align: center; border: 2px solid ${v.color}20;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">${fact.icon}</div>
              <div style="font-size: 0.85rem; color: var(--text-soft); font-weight: 600; margin-bottom: 0.3rem;">${fact.label}</div>
              <div style="font-size: 0.95rem; color: var(--text-main); font-weight: 700;">${fact.value}</div>
            </div>
          `).join('')}
        </div>

        <!-- Why Important -->
        <div class="vaccine-section" style="margin: 1.5rem 0;">
          <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
            <span style="font-size: 1.5rem;"></span> Why This Matters
          </h3>
          <p style="line-height: 1.8; color: var(--text-main); background: rgba(${v.color === '#66bb6a' ? '102,187,106' : v.color === '#42a5f5' ? '66,165,245' : v.color === '#7e57c2' ? '126,87,194' : v.color === '#ffa726' ? '255,167,38' : v.color === '#ef5350' ? '239,83,80' : v.color === '#26c6da' ? '38,198,218' : '171,71,188'},0.05); padding: 1.2rem; border-radius: 12px; border-left: 4px solid ${v.color};">
            ${v.whyImportant}
          </p>
        </div>

        ${v.howItWorks ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> How It Works
            </h3>
            <ol style="line-height: 2; color: var(--text-main); padding-left: 1.5rem;">
              ${v.howItWorks.map(step => `<li style="margin-bottom: 0.5rem;">${step}</li>`).join('')}
            </ol>
          </div>
        ` : ''}

        ${v.benefits ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Key Benefits
            </h3>
            <ul style="line-height: 2; color: var(--text-main); padding-left: 1.5rem;">
              ${v.benefits.map(benefit => `<li style="margin-bottom: 0.5rem;">${benefit}</li>`).join('')}
            </ul>
          </div>
        ` : ''}

        ${v.risks ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Risks If Not Vaccinated
            </h3>
            <ul style="line-height: 2; color: var(--text-main); padding-left: 1.5rem;">
              ${v.risks.map(risk => `<li style="margin-bottom: 0.5rem;">${risk}</li>`).join('')}
            </ul>
          </div>
        ` : ''}

        ${v.avoidList ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Live Vaccines to Avoid
            </h3>
            <div style="display: grid; gap: 1rem;">
              ${v.avoidList.map(item => `
                <div style="background: rgba(239,83,80,0.05); padding: 1rem; border-radius: 12px; border-left: 4px solid #ef5350;">
                  <h4 style="color: var(--text-main); margin-bottom: 0.5rem; font-size: 1.05rem;">${item.name}</h4>
                  <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 0.5rem;"><strong>Why avoid:</strong> ${item.why}</p>
                  <p style="color: #66bb6a; font-size: 0.9rem;"><strong>Alternative:</strong> ${item.alternative}</p>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}

        ${v.safeAlternatives ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: #66bb6a; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Safe Vaccines During Pregnancy
            </h3>
            <div style="background: rgba(102,187,106,0.1); padding: 1.2rem; border-radius: 12px; border: 2px solid #66bb6a;">
              <ul style="line-height: 2; color: var(--text-main); padding-left: 1.5rem; margin: 0;">
                ${v.safeAlternatives.map(alt => `<li style="margin-bottom: 0.5rem;">${alt}</li>`).join('')}
              </ul>
            </div>
          </div>
        ` : ''}

        ${v.riskFactors ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Who Should Get This Vaccine
            </h3>
            <div style="background: rgba(255,167,38,0.1); padding: 1.2rem; border-radius: 12px;">
              <ul style="line-height: 2; color: var(--text-main); padding-left: 1.5rem; margin: 0;">
                ${v.riskFactors.map(factor => `<li style="margin-bottom: 0.5rem;">${factor}</li>`).join('')}
              </ul>
            </div>
          </div>
        ` : ''}

        ${v.sideEffects ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Possible Side Effects
            </h3>
            <div style="display: grid; gap: 0.8rem;">
              ${v.sideEffects.map(se => `
                <div style="background: white; padding: 1rem; border-radius: 10px; border: 2px solid ${se.severity === 'Common' || se.severity === 'Common (postpartum)' ? '#66bb6a' : se.severity.includes('Rare') ? '#ffa726' : '#42a5f5'};">
                  <div style="font-weight: 700; color: ${se.severity === 'Common' || se.severity === 'Common (postpartum)' ? '#66bb6a' : se.severity.includes('Rare') ? '#ffa726' : '#42a5f5'}; margin-bottom: 0.3rem;">${se.severity}</div>
                  <div style="color: var(--text-soft); font-size: 0.95rem;">${se.effects}</div>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}

        ${v.myths ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Common Myths vs Facts
            </h3>
            <div style="display: grid; gap: 1rem;">
              ${v.myths.map(myth => `
                <div style="background: linear-gradient(135deg, rgba(239,83,80,0.05), rgba(102,187,106,0.05)); padding: 1.2rem; border-radius: 12px; border: 2px solid rgba(${v.color === '#ef5350' ? '239,83,80' : '102,187,106'},0.2);">
                  <div style="display: flex; align-items: start; gap: 0.8rem; margin-bottom: 0.8rem;">
                    <span style="font-size: 1.5rem; flex-shrink: 0;"></span>
                    <div>
                      <div style="font-weight: 700; color: #ef5350; margin-bottom: 0.3rem;">MYTH</div>
                      <div style="color: var(--text-main);">${myth.myth}</div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: start; gap: 0.8rem;">
                    <span style="font-size: 1.5rem; flex-shrink: 0;"></span>
                    <div>
                      <div style="font-weight: 700; color: #66bb6a; margin-bottom: 0.3rem;">TRUTH</div>
                      <div style="color: var(--text-main);">${myth.truth}</div>
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}

        ${v.timeline ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Timeline
            </h3>
            <div style="position: relative; padding-left: 2.5rem;">
              <div style="position: absolute; left: 0.75rem; top: 0; bottom: 0; width: 3px; background: linear-gradient(180deg, ${v.color} 0%, ${v.color}80 100%);"></div>
              ${v.timeline.map((t, i) => `
                <div style="position: relative; margin-bottom: 1.5rem;">
                  <div style="position: absolute; left: -1.9rem; top: 0.3rem; width: 30px; height: 30px; background: ${v.color}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; box-shadow: 0 2px 8px ${v.color}40;">${t.icon}</div>
                  <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border-left: 3px solid ${v.color};">
                    <div style="font-weight: 700; color: ${v.color}; margin-bottom: 0.3rem;">${t.week}</div>
                    <div style="color: var(--text-main);">${t.event}</div>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}

        ${v.resources ? `
          <div class="vaccine-section" style="margin: 1.5rem 0;">
            <h3 style="color: ${v.color}; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <span style="font-size: 1.5rem;"></span> Additional Resources
            </h3>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
              ${v.resources.map(res => `
                <div style="background: white; padding: 1rem 1.5rem; border-radius: 12px; border: 2px solid ${v.color}20; display: flex; align-items: center; gap: 0.8rem; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 20px rgba(0,0,0,0.12)'" onmouseout="this.style.transform=''; this.style.boxShadow=''">
                  <span style="font-size: 1.5rem;">${res.icon}</span>
                  <span style="color: ${v.color}; font-weight: 600;">${res.text}</span>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}

        <!-- Disclaimer -->
        <div style="margin-top: 2rem; padding: 1.2rem; background: rgba(236,64,122,0.05); border-radius: 12px; border: 2px solid rgba(236,64,122,0.15);">
          <p style="font-size: 0.9rem; color: var(--text-soft); line-height: 1.7; margin: 0;">
            <strong style="color: var(--text-main);">Important:</strong> This information is for educational purposes only. 
            Always consult your healthcare provider about which vaccines you need based on your individual health status, 
            risk factors, and pregnancy stage. Your provider will help you make the best decisions for you and your baby.
          </p>
        </div>
      </div>
    `;

    openModal(
      "", // Empty title since we have custom header
      modalContent,
      `<button class="mini-btn" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // ==========================================
  // 3D ANTIBODY TRANSFER ANIMATION
  // ==========================================
  
  let antibodyAnimationState = {
    scene: null,
    camera: null,
    renderer: null,
    antibodies: [],
    mother: null,
    placenta: null,
    baby: null,
    isPlaying: false,
    animationFrame: null,
    currentStep: 0,
    progress: 0,
    particles: []
  };

  // Initialize 3D Scene
  function initAntibodyAnimation() {
    const canvas = document.getElementById('antibodyCanvas');
    if (!canvas) return;

    // Check if THREE is available from CDN
    if (typeof THREE === 'undefined') {
      console.log('Three.js not loaded, using canvas fallback');
      initCanvasFallback();
      return;
    }

    const width = canvas.clientWidth;
    const height = canvas.clientHeight;

    // Scene setup
    antibodyAnimationState.scene = new THREE.Scene();
    antibodyAnimationState.scene.background = null; // Transparent

    // Camera
    antibodyAnimationState.camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000);
    antibodyAnimationState.camera.position.set(0, 0, 15);
    antibodyAnimationState.camera.lookAt(0, 0, 0);

    // Renderer
    antibodyAnimationState.renderer = new THREE.WebGLRenderer({ 
      canvas: canvas, 
      alpha: true,
      antialias: true 
    });
    antibodyAnimationState.renderer.setSize(width, height);
    antibodyAnimationState.renderer.setPixelRatio(window.devicePixelRatio);

    // Lighting
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    antibodyAnimationState.scene.add(ambientLight);

    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(5, 5, 5);
    antibodyAnimationState.scene.add(directionalLight);

    // Create Mother (large sphere on left)
    const motherGeometry = new THREE.SphereGeometry(2, 32, 32);
    const motherMaterial = new THREE.MeshPhongMaterial({ 
      color: 0xec407a,
      transparent: true,
      opacity: 0.3,
      shininess: 30
    });
    antibodyAnimationState.mother = new THREE.Mesh(motherGeometry, motherMaterial);
    antibodyAnimationState.mother.position.set(-5, 0, 0);
    antibodyAnimationState.scene.add(antibodyAnimationState.mother);

    // Create Placenta (torus in center)
    const placentaGeometry = new THREE.TorusGeometry(1.5, 0.5, 16, 100);
    const placentaMaterial = new THREE.MeshPhongMaterial({ 
      color: 0xd81b60,
      transparent: true,
      opacity: 0.4
    });
    antibodyAnimationState.placenta = new THREE.Mesh(placentaGeometry, placentaMaterial);
    antibodyAnimationState.placenta.position.set(0, 0, 0);
    antibodyAnimationState.placenta.rotation.x = Math.PI / 2;
    antibodyAnimationState.scene.add(antibodyAnimationState.placenta);

    // Create Baby (small sphere on right)
    const babyGeometry = new THREE.SphereGeometry(1.2, 32, 32);
    const babyMaterial = new THREE.MeshPhongMaterial({ 
      color: 0x7e57c2,
      transparent: true,
      opacity: 0.3,
      shininess: 30
    });
    antibodyAnimationState.baby = new THREE.Mesh(babyGeometry, babyMaterial);
    antibodyAnimationState.baby.position.set(5, 0, 0);
    antibodyAnimationState.scene.add(antibodyAnimationState.baby);

    // Create initial antibodies
    createAntibodies();

    // Create connection lines
    createConnections();

    // Create floating particles
    createBackgroundParticles();

    // Handle resize
    window.addEventListener('resize', onAntibodyCanvasResize);

    // Start render loop
    renderAntibodyScene();
  }

  function createAntibodies() {
    const antibodyGeometry = new THREE.SphereGeometry(0.15, 16, 16);
    const antibodyMaterial = new THREE.MeshPhongMaterial({ 
      color: 0x4caf50,
      emissive: 0x2e7d32,
      emissiveIntensity: 0.5,
      shininess: 100
    });

    // Create 20 antibodies
    for (let i = 0; i < 20; i++) {
      const antibody = new THREE.Mesh(antibodyGeometry, antibodyMaterial);
      
      // Start near mother
      const angle = (i / 20) * Math.PI * 2;
      const radius = 2.5;
      antibody.position.set(
        -5 + Math.cos(angle) * radius,
        Math.sin(angle) * radius,
        Math.sin(angle * 2) * 0.5
      );
      
      antibody.userData = {
        startPos: antibody.position.clone(),
        targetPos: new THREE.Vector3(5, 0, 0), // Baby position
        progress: i * 0.05, // Stagger animation
        speed: 0.02 + Math.random() * 0.01
      };
      
      antibodyAnimationState.antibodies.push(antibody);
      antibodyAnimationState.scene.add(antibody);
    }
  }

  function createConnections() {
    // Mother to Placenta connection
    const points1 = [];
    for (let i = 0; i <= 20; i++) {
      const t = i / 20;
      const x = -5 + (5) * t;
      const y = Math.sin(t * Math.PI) * 0.5;
      points1.push(new THREE.Vector3(x, y, 0));
    }
    const geometry1 = new THREE.BufferGeometry().setFromPoints(points1);
    const material1 = new THREE.LineBasicMaterial({ 
      color: 0xec407a, 
      transparent: true, 
      opacity: 0.3 
    });
    const line1 = new THREE.Line(geometry1, material1);
    antibodyAnimationState.scene.add(line1);

    // Placenta to Baby connection
    const points2 = [];
    for (let i = 0; i <= 20; i++) {
      const t = i / 20;
      const x = 0 + (5) * t;
      const y = Math.sin(t * Math.PI) * 0.5;
      points2.push(new THREE.Vector3(x, y, 0));
    }
    const geometry2 = new THREE.BufferGeometry().setFromPoints(points2);
    const material2 = new THREE.LineBasicMaterial({ 
      color: 0x7e57c2, 
      transparent: true, 
      opacity: 0.3 
    });
    const line2 = new THREE.Line(geometry2, material2);
    antibodyAnimationState.scene.add(line2);
  }

  function createBackgroundParticles() {
    const particleGeometry = new THREE.BufferGeometry();
    const particleCount = 100;
    const positions = new Float32Array(particleCount * 3);

    for (let i = 0; i < particleCount * 3; i += 3) {
      positions[i] = (Math.random() - 0.5) * 20;
      positions[i + 1] = (Math.random() - 0.5) * 10;
      positions[i + 2] = (Math.random() - 0.5) * 10;
    }

    particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    
    const particleMaterial = new THREE.PointsMaterial({
      color: 0xec407a,
      size: 0.05,
      transparent: true,
      opacity: 0.4
    });

    const particles = new THREE.Points(particleGeometry, particleMaterial);
    antibodyAnimationState.scene.add(particles);
    antibodyAnimationState.particles.push(particles);
  }

  function renderAntibodyScene() {
    if (!antibodyAnimationState.renderer) return;

    antibodyAnimationState.animationFrame = requestAnimationFrame(renderAntibodyScene);

    // Rotate placenta
    if (antibodyAnimationState.placenta) {
      antibodyAnimationState.placenta.rotation.z += 0.005;
    }

    // Gentle rotation of mother and baby
    if (antibodyAnimationState.mother) {
      antibodyAnimationState.mother.rotation.y += 0.002;
    }
    if (antibodyAnimationState.baby) {
      antibodyAnimationState.baby.rotation.y += 0.003;
    }

    // Animate particles
    antibodyAnimationState.particles.forEach(p => {
      p.rotation.y += 0.001;
    });

    // Animate antibodies if playing
    if (antibodyAnimationState.isPlaying) {
      animateAntibodyMovement();
    }

    antibodyAnimationState.renderer.render(
      antibodyAnimationState.scene, 
      antibodyAnimationState.camera
    );
  }

  function animateAntibodyMovement() {
    antibodyAnimationState.progress += 0.005;
    
    if (antibodyAnimationState.progress > 1) {
      antibodyAnimationState.progress = 0;
      antibodyAnimationState.currentStep = (antibodyAnimationState.currentStep + 1) % 4;
      updateStepDisplay(antibodyAnimationState.currentStep);
    }

    // Update timeline marker
    const marker = document.getElementById('timelineMarker');
    if (marker) {
      marker.style.left = (antibodyAnimationState.progress * 100) + '%';
    }

    antibodyAnimationState.antibodies.forEach((antibody, i) => {
      const data = antibody.userData;
      data.progress += data.speed;

      if (data.progress > 1) {
        data.progress = 0;
      }

      // Calculate position along path
      const t = data.progress;
      const startX = -5;
      const endX = 5;
      const midX = 0;

      // Three-phase movement: Mother -> Placenta -> Baby
      let x, y, z;
      
      if (t < 0.5) {
        // Mother to Placenta
        const localT = t / 0.5;
        x = startX + (midX - startX) * localT;
        y = Math.sin(localT * Math.PI) * 1.5;
        z = Math.cos(i * 0.5) * 0.3;
      } else {
        // Placenta to Baby
        const localT = (t - 0.5) / 0.5;
        x = midX + (endX - midX) * localT;
        y = Math.sin(localT * Math.PI) * 1.5;
        z = Math.sin(i * 0.5) * 0.3;
      }

      antibody.position.set(x, y, z);

      // Scale pulse effect
      const scale = 1 + Math.sin(t * Math.PI * 4) * 0.2;
      antibody.scale.set(scale, scale, scale);
    });
  }

  function updateStepDisplay(step) {
    // Hide all steps
    for (let i = 1; i <= 4; i++) {
      const el = document.getElementById(`step${i}`);
      if (el) el.style.display = 'none';
    }
    
    // Show current step
    const current = document.getElementById(`step${step + 1}`);
    if (current) current.style.display = 'block';
  }

  function onAntibodyCanvasResize() {
    if (!antibodyAnimationState.camera || !antibodyAnimationState.renderer) return;
    
    const canvas = document.getElementById('antibodyCanvas');
    if (!canvas) return;

    const width = canvas.clientWidth;
    const height = canvas.clientHeight;

    antibodyAnimationState.camera.aspect = width / height;
    antibodyAnimationState.camera.updateProjectionMatrix();
    antibodyAnimationState.renderer.setSize(width, height);
  }

  // Canvas fallback for when Three.js is not available
  function initCanvasFallback() {
    const canvas = document.getElementById('antibodyCanvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;

    let fallbackAntibodies = [];
    for (let i = 0; i < 15; i++) {
      fallbackAntibodies.push({
        x: 50,
        y: canvas.height / 2 + (Math.random() - 0.5) * 100,
        targetX: canvas.width - 50,
        progress: i * 0.05,
        speed: 0.01
      });
    }

    function drawFallback() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw mother
      ctx.fillStyle = 'rgba(236, 64, 122, 0.3)';
      ctx.beginPath();
      ctx.arc(50, canvas.height / 2, 60, 0, Math.PI * 2);
      ctx.fill();
      ctx.strokeStyle = 'rgba(236, 64, 122, 0.6)';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Draw placenta
      ctx.fillStyle = 'rgba(216, 27, 96, 0.3)';
      ctx.beginPath();
      ctx.arc(canvas.width / 2, canvas.height / 2, 50, 0, Math.PI * 2);
      ctx.fill();
      ctx.strokeStyle = 'rgba(216, 27, 96, 0.6)';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Draw baby
      ctx.fillStyle = 'rgba(126, 87, 194, 0.3)';
      ctx.beginPath();
      ctx.arc(canvas.width - 50, canvas.height / 2, 40, 0, Math.PI * 2);
      ctx.fill();
      ctx.strokeStyle = 'rgba(126, 87, 194, 0.6)';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Draw antibodies
      fallbackAntibodies.forEach(ab => {
        if (antibodyAnimationState.isPlaying) {
          ab.progress += ab.speed;
          if (ab.progress > 1) ab.progress = 0;
        }

        ab.x = 50 + (ab.targetX - 50) * ab.progress;
        
        ctx.fillStyle = '#4caf50';
        ctx.beginPath();
        ctx.arc(ab.x, ab.y, 8, 0, Math.PI * 2);
        ctx.fill();
        
        // Glow effect
        ctx.shadowBlur = 10;
        ctx.shadowColor = '#4caf50';
        ctx.fill();
        ctx.shadowBlur = 0;
      });

      requestAnimationFrame(drawFallback);
    }

    drawFallback();
  }

  // Control functions
  ANC.playAntibodyAnimation = () => {
    antibodyAnimationState.isPlaying = true;
    document.getElementById('playBtn').style.display = 'none';
    document.getElementById('pauseBtn').style.display = 'inline-flex';
  };

  ANC.pauseAntibodyAnimation = () => {
    antibodyAnimationState.isPlaying = false;
    document.getElementById('playBtn').style.display = 'inline-flex';
    document.getElementById('pauseBtn').style.display = 'none';
  };

  ANC.resetAntibodyAnimation = () => {
    antibodyAnimationState.progress = 0;
    antibodyAnimationState.currentStep = 0;
    antibodyAnimationState.isPlaying = false;
    
    document.getElementById('playBtn').style.display = 'inline-flex';
    document.getElementById('pauseBtn').style.display = 'none';
    
    const marker = document.getElementById('timelineMarker');
    if (marker) marker.style.left = '0%';
    
    // Hide all steps
    for (let i = 1; i <= 4; i++) {
      const el = document.getElementById(`step${i}`);
      if (el) el.style.display = 'none';
    }

    // Reset antibodies to start position
    if (antibodyAnimationState.antibodies.length > 0) {
      antibodyAnimationState.antibodies.forEach(ab => {
        if (ab.userData) {
          ab.userData.progress = 0;
        }
      });
    }
  };

  // Show detailed information modal
  ANC.showAntibodyDetails = () => {
    openModal(
      " How Antibody Transfer Works",
      `
        <div style="max-height: 500px; overflow-y: auto;">
          <h4 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.8rem;">The Science of Vertical Transfer</h4>
          <p style="line-height: 1.8; margin-bottom: 1rem;">
            When a pregnant woman receives a vaccine, her immune system produces antibodies (proteins that fight infection). 
            These antibodies, specifically IgG antibodies, can cross the placenta and provide passive immunity to the developing baby.
          </p>

          <h4 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.8rem;">The Process - Step by Step</h4>
          
          <div style="background: rgba(236,64,122,0.05); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
            <h5 style="color: var(--text-main); margin-bottom: 0.5rem;">1. Vaccination (Mother)</h5>
            <p style="color: var(--text-soft); line-height: 1.7;">
              The mother receives a vaccine (like Tdap or flu). The vaccine contains antigens (harmless pieces of the disease-causing organism) 
              that trigger the immune system without causing illness.
            </p>
          </div>

          <div style="background: rgba(236,64,122,0.05); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
            <h5 style="color: var(--text-main); margin-bottom: 0.5rem;">2. Antibody Production (2-3 weeks)</h5>
            <p style="color: var(--text-soft); line-height: 1.7;">
              The mother's B cells (immune cells) recognize these antigens and begin producing specific antibodies. 
              Peak antibody levels are usually reached 2-3 weeks after vaccination.
            </p>
          </div>

          <div style="background: rgba(236,64,122,0.05); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
            <h5 style="color: var(--text-main); margin-bottom: 0.5rem;">3. Placental Transfer (Third Trimester)</h5>
            <p style="color: var(--text-soft); line-height: 1.7;">
              <strong>Active Transport:</strong> The placenta has special receptors (FcRn receptors) that actively transport IgG antibodies 
              from the mother's bloodstream across the placental barrier into the baby's bloodstream. This is most efficient in the third trimester.
            </p>
            <p style="color: var(--text-soft); line-height: 1.7; margin-top: 0.5rem;">
              <strong>Why IgG?</strong> Only IgG antibodies can efficiently cross the placenta. Other antibody types (IgA, IgM, IgE) are too large 
              or don't have the right structure.
            </p>
          </div>

          <div style="background: rgba(236,64,122,0.05); padding: 1rem; border-radius: 12px; margin-bottom: 1rem;">
            <h5 style="color: var(--text-main); margin-bottom: 0.5rem;">4. Baby Protected (Birth to 6 months)</h5>
            <p style="color: var(--text-soft); line-height: 1.7;">
              The baby is born with these maternal antibodies circulating in their bloodstream. This provides "passive immunity" - 
              protection against diseases without the baby's own immune system having to do the work.
            </p>
            <p style="color: var(--text-soft); line-height: 1.7; margin-top: 0.5rem;">
              These antibodies gradually decrease over 3-6 months, which is why babies need their own vaccines starting at 2 months of age.
            </p>
          </div>

          <h4 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.8rem;">Why Timing Matters</h4>
          <ul style="line-height: 2; color: var(--text-soft); margin-left: 1.5rem;">
            <li><strong>Tdap (27-36 weeks):</strong> Given in third trimester when placental transfer is most efficient. 
            Protects newborn from whooping cough (pertussis) in the first months when they're most vulnerable.</li>
            <li><strong>Flu vaccine (any trimester):</strong> Can be given earlier because pregnancy itself increases flu risk. 
            Earlier vaccination still provides antibodies that transfer in third trimester.</li>
          </ul>

          <h4 style="color: var(--primary); margin-top: 1.5rem; margin-bottom: 0.8rem;">The Benefits</h4>
          <div style="background: rgba(76,175,80,0.1); padding: 1rem; border-radius: 12px; margin-top: 1rem;">
            <ul style="line-height: 2; color: var(--text-soft); margin-left: 1.5rem;">
              <li>Protects both mother and baby during pregnancy</li>
              <li>Provides critical immunity to newborn before they can receive their own vaccines</li>
              <li>Studies show babies born to vaccinated mothers have significantly fewer infections</li>
              <li>Particularly important for diseases most dangerous in first months (whooping cough, flu)</li>
            </ul>
          </div>

          <p style="margin-top: 1.5rem; padding: 1rem; background: rgba(236,64,122,0.08); border-radius: 12px; 
                    color: var(--text-soft); text-align: center; font-size: 0.9rem;">
             <strong>Remember:</strong> This is passive immunity - temporary but crucial protection. 
            Baby will need their own vaccinations starting at 2 months to develop active, long-term immunity.
          </p>
        </div>
      `,
      `<button class="mini-btn" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // Initialize antibody animation when page loads
  function initAntibodyVisualization() {
    if (document.getElementById('antibodyCanvas')) {
      // Small delay to ensure canvas is rendered
      setTimeout(() => {
        initAntibodyAnimation();
      }, 500);
    }
  }

  // ==========================================
  // END ANTIBODY TRANSFER ANIMATION
  // ==========================================

  // Nutrition
  const FOOD_DB = {
    spinach: { folic: 120, iron: 3, calcium: 100, protein: 3 },
    milk: { folic: 12, iron: 0, calcium: 300, protein: 8 },
    eggs: { folic: 25, iron: 1, calcium: 28, protein: 6 },
    lentils: { folic: 180, iron: 3, calcium: 20, protein: 9 },
    orangejuice: { folic: 40, iron: 0, calcium: 200, protein: 1 },
    salmon: { folic: 20, iron: 0.5, calcium: 15, protein: 22 }
  };

  const NUTRIENT_TARGETS = { folic: 600, iron: 27, calcium: 1000, protein: 71 };

  function updateNutritionUI() {
    const n = state.nutrients;
    const pct = (k) => clamp(Math.round((n[k] / NUTRIENT_TARGETS[k]) * 100), 0, 100);
    const setProg = (id, v) => { const el = $("#" + id); if (el) el.style.width = `${v}%`; };

    safeText("folicAmount", Math.round(n.folic));
    safeText("ironAmount", Math.round(n.iron));
    safeText("calciumAmount", Math.round(n.calcium));
    safeText("proteinAmount", Math.round(n.protein));

    setProg("folicProgress", pct("folic"));
    setProg("ironProgress", pct("iron"));
    setProg("calciumProgress", pct("calcium"));
    setProg("proteinProgress", pct("protein"));

    const score = Math.round((pct("folic") + pct("iron") + pct("calcium") + pct("protein")) / 4);
    safeText("nutritionScoreValue", `${score}%`);

    const circle = $("#nutritionScoreCircle");
    if (circle) {
      const r = 50;
      const c = 2 * Math.PI * r;
      const off = c * (1 - score / 100);
      circle.style.strokeDasharray = String(c);
      circle.style.strokeDashoffset = String(off);
    }

    const fb = $("#nutritionFeedback");
    if (fb) {
      fb.textContent =
        score >= 85 ? "Excellent balance  keep it consistent." :
        score >= 65 ? "Strong foundation  add one more nutrient boost." :
        score >= 40 ? "Good start  build calcium/protein and iron." :
        "Start adding foods to see your score!";
    }
  }

  ANC.addFood = (foodKey) => {
    const f = FOOD_DB[foodKey];
    if (!f) return;
    state.foods.push(foodKey);
    state.nutrients.folic += f.folic;
    state.nutrients.iron += f.iron;
    state.nutrients.calcium += f.calcium;
    state.nutrients.protein += f.protein;
    updateNutritionUI();
    saveState();
  };

  ANC.resetNutrients = () => {
    state.foods = [];
    state.nutrients = { folic: 0, iron: 0, calcium: 0, protein: 0 };
    updateNutritionUI();
    saveState();
  };

  ANC.nutritionRecallQuiz = () => {
    openModal(
      "Nutrition Recall Quiz",
      `<p><strong>Which one best boosts calcium + protein?</strong></p>
       <div class="pill-grid">
         <button class="pill-btn" type="button" onclick="ANC._nutQuiz('milk')">Milk</button>
         <button class="pill-btn" type="button" onclick="ANC._nutQuiz('spinach')">Spinach</button>
         <button class="pill-btn" type="button" onclick="ANC._nutQuiz('orangejuice')">Fortified OJ</button>
       </div>
       <div class="modal-output" id="nutQuizOut">Pick one.</div>`,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  ANC._nutQuiz = (pick) => {
    const out = $("#nutQuizOut");
    if (!out) return;
    out.innerHTML = pick === "milk"
      ? `<span class="pill critical">Correct</span> Milk is a strong calcium+protein option.`
      : `<span class="pill warn">Try again</span> Think bone nutrient + building blocks.`;
  };

  // Discomfort lab
  const DISCOMFORTS = {
    nausea: ["Small frequent meals", "Hydrate", "Discuss meds if severe"],
    heartburn: ["Smaller meals", "Elevate head", "Ask about safe antacids"],
    constipation: ["Fiber + fluids", "Gentle walking", "Discuss safe options if needed"],
    backpain: ["Support pillow", "Prenatal stretches", "Physio if persistent"],
    legcramps: ["Calf stretches", "Hydration", "Discuss magnesium if appropriate"],
    swelling: ["Elevate legs", "Hydrate", "Seek care if sudden face/hands swelling"],
    sleep: ["Side-sleep support", "Routine wind-down", "Discuss insomnia if severe"]
  };

  ANC.showDiscomfort = (key) => {
    const tips = DISCOMFORTS[key];
    if (!tips) return;
    safeHTML("discomfortOutput", `
      <h4>${key.toUpperCase()}</h4>
      <ul>${tips.map(t => `<li>${t}</li>`).join("")}</ul>
      <p class="muted">If severe/persistent or with warning signs, seek advice. </p>
    `);
  };

  // Red flag game
  const REDFLAG_Q = [
    { s: "Severe headache + vision changes", red: true },
    { s: "Mild nausea in early pregnancy", red: false },
    { s: "Bleeding", red: true },
    { s: "Occasional heartburn", red: false },
    { s: "Reduced fetal movement after 28 weeks", red: true }
  ];

  ANC.startRedFlagGame = () => {
    state.redFlag.active = true;
    state.redFlag.score = 0;
    nextRedFlagQ();
  };

  function nextRedFlagQ() {
    const host = $("#redFlagGame");
    if (!host) return;
    const q = REDFLAG_Q[Math.floor(Math.random() * REDFLAG_Q.length)];
    state.redFlag.q = q;

    host.innerHTML = `
      <div class="rfg-card">
        <div class="chip">Score ${state.redFlag.score}</div>
        <p><strong>${q.s}</strong></p>
        <div class="row">
          <button class="mini-btn" type="button" onclick="ANC._answerRedFlag(true)">Red flag</button>
          <button class="mini-btn outline" type="button" onclick="ANC._answerRedFlag(false)">Usually normal</button>
        </div>
        <p class="muted">Education-only.</p>
      </div>
    `;
    saveState();
  }

  ANC._answerRedFlag = (isRed) => {
    const q = state.redFlag.q;
    const host = $("#redFlagGame");
    if (!q || !host) return;
    const ok = !!isRed === !!q.red;
    state.redFlag.score += ok ? 1 : 0;

    host.innerHTML = `
      <div class="rfg-card">
        <div class="chip">${ok ? "Correct" : "Not quite"}</div>
        <p><strong>${q.s}</strong></p>
        <p>${q.red ? "This is a warning signseek advice promptly." : "Often commonmonitor and discuss if persistent."}</p>
        <button class="mini-btn" type="button" onclick="ANC._nextRedFlag()">Next</button>
      </div>
    `;
    saveState();
  };

  ANC._nextRedFlag = () => nextRedFlagQ();

  // Triage
  const TRIAGE = {
    bleeding: { level: "EMERGENCY", what: "Bleeding can be serious.", doNow: ["Seek urgent care", "If heavy: emergency services"] },
    movement: { level: "EMERGENCY", what: "Reduced movement after 28w needs assessment.", doNow: ["Try kick count", "Seek urgent advice if reduced persists"] },
    fever: { level: "URGENT", what: "Fever >100.4F may indicate infection.", doNow: ["Hydrate", "Contact clinician promptly"] },
    swelling: { level: "URGENT", what: "Sudden swelling can be a warning sign.", doNow: ["Check BP if possible", "Seek urgent advice"] },
    nausea: { level: "MONITOR", what: "Persistent vomiting can dehydrate.", doNow: ["Small sips", "Seek advice if cant keep fluids"] },
    headache: { level: "EMERGENCY", what: "Severe headache + vision changes can be preeclampsia warning.", doNow: ["Urgent assessment", "Dont delay"] }
  };

  ANC.openScenario = (key) => {
    const s = TRIAGE[key];
    const out = $("#triageOutput");
    if (!out || !s) return;

    out.innerHTML = `
      <div class="triage-panel ${s.level.toLowerCase()}">
        <div class="chip">${s.level}</div>
        <h3>${key.toUpperCase()}</h3>
        <p>${s.what}</p>
        <h4>Do now</h4>
        <ul>${s.doNow.map(x => `<li>${x}</li>`).join("")}</ul>
        <div class="row">
          <button class="mini-btn" type="button" onclick="ANC.triageQuiz()">Quiz mode</button>
          <button class="mini-btn outline" type="button" onclick="ANC.randomScenario()">Random</button>
        </div>
        <p class="muted">Education-only.</p>
      </div>
    `;
  };

  ANC.randomScenario = () => {
    const keys = Object.keys(TRIAGE);
    const pick = keys[Math.floor(Math.random() * keys.length)];
    ANC.openScenario(pick);
  };

  ANC.triageQuiz = () => {
    const keys = Object.keys(TRIAGE);
    const pick = keys[Math.floor(Math.random() * keys.length)];
    const s = TRIAGE[pick];

    const levels = ["EMERGENCY", "URGENT", "MONITOR"];
    const opts = [s.level, ...levels.filter(x => x !== s.level)].sort(() => Math.random() - 0.5);

    openModal(
      "Triage Quiz",
      `<p>Scenario: <strong>${pick}</strong></p>
       <p>${s.what}</p>
       <p><strong>Pick urgency level:</strong></p>
       <div class="pill-grid">
         ${opts.map(o => `<button class="pill-btn" type="button" onclick="ANC._answerTriage(${JSON.stringify(o)}, ${JSON.stringify(s.level)})">${o}</button>`).join("")}
       </div>
       <div class="modal-output" id="triageQuizOut">Choose one.</div>`,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  ANC._answerTriage = (pick, correct) => {
    const out = $("#triageQuizOut");
    if (!out) return;
    out.innerHTML = pick === correct
      ? `<span class="pill critical">Correct</span> Safe urgency choice.`
      : `<span class="pill warn">Not quite</span> Correct: ${correct}`;
  };

  // Kick counter
  function renderKickHistory() {
    const host = $("#kickHistoryList");
    if (!host) return;

    const sessions = state.kick.sessions || [];
    if (!sessions.length) {
      host.innerHTML = `<p class="no-data">No sessions recorded yet</p>`;
      return;
    }

    host.innerHTML = sessions.slice().reverse().slice(0, 8).map(s => `
      <div class="history-item">
        <div class="hi-top">
          <strong>${s.date}</strong>
          <span class="pill ${s.metGoal ? "critical" : "warn"}">${s.metGoal ? "met goal" : "followup"}</span>
        </div>
        <div class="hi-sub">Week ${s.week}  ${s.count} moves  ${s.time}</div>
      </div>
    `).join("");
  }

  function setKickUI() {
    safeText("kickCount", String(state.kick.count || 0));
    safeText("kickTimer", state.kick.running ? fmtTime(Date.now() - state.kick.startAt) : "00:00");
    const resetBtn = $("#resetKickBtn");
    if (resetBtn) resetBtn.disabled = !state.kick.running && (state.kick.count === 0);
  }

  ANC.startKickCounter = () => {
    if (state.week < 28) {
      openModal(
        "Kick Counter (Locked)",
        `<p>Kick counting practice typically starts around <strong>28 weeks</strong>.</p>
         <p>Move the body-map week slider to 28+ to practice.</p>`,
        `<button class="mini-btn" type="button" onclick="ANC.closeModal()">OK</button>`
      );
      return;
    }

    if (state.kick.running) return;

    state.kick.running = true;
    state.kick.startAt = Date.now();
    state.kick.count = 0;

    const resetBtn = $("#resetKickBtn");
    if (resetBtn) resetBtn.disabled = false;

    state.kick.timerId = setInterval(() => setKickUI(), 300);
    setKickUI();
    saveState();
  };

  ANC.resetKickCounter = () => {
    if (state.kick.timerId) clearInterval(state.kick.timerId);
    state.kick.timerId = null;
    state.kick.running = false;
    state.kick.count = 0;
    state.kick.startAt = 0;

    const resetBtn = $("#resetKickBtn");
    if (resetBtn) resetBtn.disabled = true;

    setKickUI();
    saveState();
  };

  ANC.recordKick = () => {
    if (!state.kick.running) {
      ANC.startKickCounter();
      if (!state.kick.running) return;
    }

    state.kick.count += 1;
    setKickUI();

    if (state.kick.count >= 10) {
      const elapsed = Date.now() - state.kick.startAt;
      const metGoal = elapsed <= (2 * 60 * 60 * 1000);

      const session = {
        date: todayISO(),
        week: state.week,
        count: state.kick.count,
        time: fmtTime(elapsed),
        metGoal
      };

      state.kick.sessions.push(session);
      state.kick.sessions = state.kick.sessions.slice(-40);
      renderKickHistory();

      openModal(
        metGoal ? "Goal met!" : "Session logged",
        `<p><strong>${session.count} movements</strong> in <strong>${session.time}</strong></p>
         <p>${metGoal ? "You met the common learning goal (10 in 2 hours)." : "If movements feel reduced, seek advice."}</p>
         <p class="muted">Education-only.</p>`,
        `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Close</button>
         <button class="mini-btn outline" type="button" onclick="ANC.resetKickCounter();ANC.closeModal()">Reset</button>`
      );

      if (state.kick.timerId) clearInterval(state.kick.timerId);
      state.kick.timerId = null;
      state.kick.running = false;

      const resetBtn = $("#resetKickBtn");
      if (resetBtn) resetBtn.disabled = false;

      saveState();
    }
  };

  // ==========================================
  // BIRTH PLAN V2 - REVOLUTIONARY INTERACTIVE UI
  // ==========================================
  
  const BIRTH_PLAN_DATA = {
    labor: {
      title: "Labor Environment & Support",
      icon: "",
      preferences: [
        { 
          id: "move-freely", 
          icon: "", 
          title: "Move Freely During Labor",
          desc: "Walk, change positions as needed",
          info: "Movement can help labor progress and manage pain naturally"
        },
        { 
          id: "dim-lights", 
          icon: "", 
          title: "Dim Lights & Calming Music",
          desc: "Create a peaceful atmosphere",
          info: "Reduces stress hormones and helps you focus inward"
        },
        { 
          id: "water-therapy", 
          icon: "", 
          title: "Water Therapy/Shower",
          desc: "Use water for comfort during labor",
          info: "Warm water can ease pain and help you relax"
        },
        { 
          id: "minimal-interruptions", 
          icon: "", 
          title: "Minimal Interruptions",
          desc: "Limit visitors and checks when possible",
          info: "Privacy helps maintain focus and oxytocin flow"
        },
        { 
          id: "birth-partner", 
          icon: "", 
          title: "Continuous Partner Support",
          desc: "Have your support person always present",
          info: "Studies show continuous support reduces interventions"
        },
        { 
          id: "photography", 
          icon: "", 
          title: "Photography/Video Welcome",
          desc: "Capture precious moments",
          info: "Some hospitals have policies - ask ahead"
        }
      ],
      sliders: [
        {
          id: "room-temp",
          label: "Preferred Room Temperature",
          min: 18,
          max: 26,
          default: 22,
          unit: "C",
          emoji: ""
        }
      ]
    },
    pain: {
      title: "Pain Management Preferences",
      icon: "",
      preferences: [
        { 
          id: "try-natural-first", 
          icon: "", 
          title: "Try Natural Methods First",
          desc: "Breathing, positions, massage",
          info: "Give yourself time before medical options"
        },
        { 
          id: "open-epidural", 
          icon: "", 
          title: "Open to Epidural",
          desc: "Pain relief through spinal medication",
          info: "Very effective - can be given anytime during labor"
        },
        { 
          id: "nitrous-oxide", 
          icon: "", 
          title: "Consider Nitrous Oxide (Gas)",
          desc: "Inhaled pain relief you control",
          info: "Takes edge off, doesn't eliminate pain completely"
        },
        { 
          id: "discuss-options", 
          icon: "", 
          title: "Discuss All Options on Arrival",
          desc: "Review what's available at your facility",
          info: "Good to know your full menu of choices"
        },
        { 
          id: "iv-pain-med", 
          icon: "", 
          title: "IV Pain Medication if Needed",
          desc: "Systemic pain relief through IV",
          info: "Can make you drowsy but helps take the edge off"
        },
        { 
          id: "tens-unit", 
          icon: "", 
          title: "TENS Unit for Early Labor",
          desc: "Electrical nerve stimulation",
          info: "Some women find it helpful in early labor"
        }
      ],
      sliders: [
        {
          id: "pain-tolerance",
          label: "Natural Pain Management Commitment",
          min: 1,
          max: 10,
          default: 5,
          unit: "",
          emoji: "",
          labels: ["Flexible", "Very Committed"]
        }
      ]
    },
    delivery: {
      title: "Delivery & First Moments",
      icon: "",
      preferences: [
        { 
          id: "skin-to-skin", 
          icon: "", 
          title: "Immediate Skin-to-Skin",
          desc: "Baby placed directly on your chest",
          info: "Helps bonding, warmth, and breastfeeding initiation"
        },
        { 
          id: "delayed-cord", 
          icon: "", 
          title: "Delayed Cord Clamping",
          desc: "Wait 1-3 minutes before cutting",
          info: "Allows extra blood transfer - recommended by WHO"
        },
        { 
          id: "partner-cuts-cord", 
          icon: "", 
          title: "Partner Cuts Umbilical Cord",
          desc: "Include partner in this moment",
          info: "A special way to welcome baby together"
        },
        { 
          id: "explain-procedures", 
          icon: "", 
          title: "Explain Before Procedures",
          desc: "Keep me informed of interventions",
          info: "Helps you feel in control and involved"
        },
        { 
          id: "mirror-birth", 
          icon: "", 
          title: "Mirror to Watch Birth",
          desc: "See baby crowning",
          info: "Can be incredibly motivating"
        },
        { 
          id: "quiet-atmosphere", 
          icon: "", 
          title: "Calm, Quiet Atmosphere",
          desc: "Gentle welcome for baby",
          info: "Reduce bright lights and loud noises"
        },
        { 
          id: "golden-hour", 
          icon: "", 
          title: "Protected Golden Hour",
          desc: "Uninterrupted bonding time",
          info: "Delay non-urgent procedures for 1 hour"
        }
      ],
      sliders: []
    },
    postpartum: {
      title: "After Birth Care",
      icon: "",
      preferences: [
        { 
          id: "breastfeeding-support", 
          icon: "", 
          title: "Lactation Consultant Support",
          desc: "Help with first feeds",
          info: "Establishes good latch and positioning early"
        },
        { 
          id: "rooming-in", 
          icon: "", 
          title: "Baby Rooms In with Me",
          desc: "Keep baby in room 24/7",
          info: "Helps establish feeding and bonding"
        },
        { 
          id: "quiet-recovery", 
          icon: "", 
          title: "Quiet Recovery Time",
          desc: "Limit visitors initially",
          info: "Rest is crucial for healing and milk supply"
        },
        { 
          id: "visitor-limits", 
          icon: "", 
          title: "Strict Visitor Limits",
          desc: "Only immediate family at first",
          info: "Protects your recovery and baby's health"
        },
        { 
          id: "mood-screening", 
          icon: "", 
          title: "Postpartum Mood Screening",
          desc: "Check-ins for emotional wellbeing",
          info: "Early detection of postpartum depression is key"
        },
        { 
          id: "pain-management", 
          icon: "", 
          title: "Stay on Top of Pain Relief",
          desc: "Regular pain medication schedule",
          info: "Easier to prevent pain than treat severe pain"
        },
        { 
          id: "discharge-prep", 
          icon: "", 
          title: "Detailed Discharge Education",
          desc: "Learn warning signs and baby care",
          info: "Knowledge reduces anxiety at home"
        }
      ],
      sliders: [
        {
          id: "visitor-frequency",
          label: "Visitor Frequency Preference",
          min: 1,
          max: 10,
          default: 5,
          unit: "",
          emoji: "",
          labels: ["Very Private", "Open to Guests"]
        }
      ]
    }
  };

  // State management
  if (!state.birthPlanV2) {
    state.birthPlanV2 = {
      labor: { preferences: [], sliders: {} },
      pain: { preferences: [], sliders: {} },
      delivery: { preferences: [], sliders: {} },
      postpartum: { preferences: [], sliders: {} }
    };
  }

  let currentBirthStage = "labor";
  let previewExpanded = false;

  // Main render function for birth stage
  function renderBirthStage(stage) {
    const container = $("#birthStageContent");
    if (!container) return;

    currentBirthStage = stage;
    const data = BIRTH_PLAN_DATA[stage];
    const selectedPrefs = new Set(state.birthPlanV2[stage].preferences || []);

    // Update navigation buttons
    $$(".journey-stage-btn").forEach(btn => {
      btn.classList.toggle("active", btn.dataset.stage === stage);
    });

    // Build preferences HTML
    const prefsHTML = data.preferences.map(pref => `
      <div class="preference-card ${selectedPrefs.has(pref.id) ? 'selected' : ''}" 
           onclick="ANC._toggleBirthPreference('${stage}', '${pref.id}')">
        <div class="card-icon">${pref.icon}</div>
        <div class="card-title">${pref.title}</div>
        <div class="card-desc">${pref.desc}</div>
        <div class="card-info-badge" onclick="event.stopPropagation(); ANC._showPreferenceInfo('${stage}', '${pref.id}')" title="Learn more"></div>
      </div>
    `).join('');

    // Build sliders HTML
    const slidersHTML = data.sliders.map(slider => {
      const currentValue = state.birthPlanV2[stage].sliders[slider.id] || slider.default;
      return `
        <div class="slider-preference">
          <div class="slider-header">
            <div class="slider-title">${slider.emoji} ${slider.label}</div>
            <div class="slider-value" id="slider-${slider.id}-value">${currentValue}${slider.unit}</div>
          </div>
          <input 
            type="range" 
            class="custom-slider" 
            id="slider-${slider.id}"
            min="${slider.min}" 
            max="${slider.max}" 
            value="${currentValue}"
            oninput="ANC._updateSliderValue('${stage}', '${slider.id}', this.value, '${slider.unit}')"
          />
          ${slider.labels ? `
            <div class="slider-labels">
              <span>${slider.labels[0]}</span>
              <span>${slider.labels[1]}</span>
            </div>
          ` : ''}
        </div>
      `;
    }).join('');

    container.innerHTML = `
      <div class="stage-content-header">
        <h2 class="stage-content-title">
          <span>${data.icon}</span>
          ${data.title}
        </h2>
        <p class="stage-content-desc">
          Select all preferences that resonate with you. You can always change these later.
        </p>
      </div>
      
      <div class="preference-cards-grid">
        ${prefsHTML}
      </div>
      
      ${slidersHTML}
    `;

    updateBirthPlanPreview();
    updateProgressRing();
    saveState();
  }

  // Toggle preference
  ANC._toggleBirthPreference = (stage, prefId) => {
    const arr = state.birthPlanV2[stage].preferences || (state.birthPlanV2[stage].preferences = []);
    const idx = arr.indexOf(prefId);
    
    if (idx >= 0) {
      arr.splice(idx, 1);
    } else {
      arr.push(prefId);
    }
    
    renderBirthStage(stage);
  };

  // Update slider value
  ANC._updateSliderValue = (stage, sliderId, value, unit) => {
    const valueDisplay = $(`#slider-${sliderId}-value`);
    if (valueDisplay) {
      valueDisplay.textContent = value + unit;
    }
    
    if (!state.birthPlanV2[stage].sliders) {
      state.birthPlanV2[stage].sliders = {};
    }
    state.birthPlanV2[stage].sliders[sliderId] = parseInt(value);
    
    updateBirthPlanPreview();
    saveState();
  };

  // Show preference info modal
  ANC._showPreferenceInfo = (stage, prefId) => {
    const data = BIRTH_PLAN_DATA[stage];
    const pref = data.preferences.find(p => p.id === prefId);
    
    if (pref) {
      openModal(
        pref.title,
        `
          <div style="text-align: center; margin-bottom: 1.5rem;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">${pref.icon}</div>
            <p style="font-size: 1.1rem; color: var(--text-main); line-height: 1.7; margin-bottom: 1rem;">
              ${pref.desc}
            </p>
            <div style="background: rgba(236,64,122,0.08); padding: 1rem; border-radius: 12px;">
              <p style="color: var(--text-soft); line-height: 1.7;">
                <strong>Why this matters:</strong><br/>
                ${pref.info}
              </p>
            </div>
          </div>
        `,
        `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Got it!</button>`
      );
    }
  };

  // Update preview panel
  function updateBirthPlanPreview() {
    const moodBoard = $("#previewMoodBoard");
    const selectionsList = $("#previewSelectionsList");
    const totalSelectionsEl = $("#totalSelections");
    
    if (!moodBoard || !selectionsList) return;

    // Collect all selections
    let totalCount = 0;
    let allEmojis = [];
    let htmlByCategory = [];

    ["labor", "pain", "delivery", "postpartum"].forEach(stage => {
      const stageData = BIRTH_PLAN_DATA[stage];
      const selectedIds = state.birthPlanV2[stage].preferences || [];
      
      if (selectedIds.length > 0) {
        const items = selectedIds.map(id => {
          const pref = stageData.preferences.find(p => p.id === id);
          if (pref) {
            allEmojis.push(pref.icon);
            totalCount++;
            return `
              <div class="preview-item">
                <span class="preview-item-icon">${pref.icon}</span>
                <span>${pref.title}</span>
              </div>
            `;
          }
          return '';
        }).join('');

        htmlByCategory.push(`
          <div class="preview-category">
            <div class="preview-category-title">
              ${stageData.icon} ${stageData.title}
            </div>
            ${items}
          </div>
        `);
      }
    });

    // Update mood board
    if (allEmojis.length > 0) {
      moodBoard.innerHTML = `
        <div class="mood-board-items">
          ${allEmojis.map(emoji => `<span class="mood-item">${emoji}</span>`).join('')}
        </div>
      `;
    } else {
      moodBoard.innerHTML = `
        <div class="mood-board-empty">
          <div class="empty-icon"></div>
          <p>Start selecting to build your birth vision</p>
        </div>
      `;
    }

    // Update selections list
    if (htmlByCategory.length > 0) {
      selectionsList.innerHTML = htmlByCategory.join('');
    } else {
      selectionsList.innerHTML = '';
    }

    // Update total count
    if (totalSelectionsEl) {
      totalSelectionsEl.textContent = totalCount;
    }

    // Update completed stages count
    const completedStagesEl = $("#completedStages");
    if (completedStagesEl) {
      let completedCount = 0;
      ["labor", "pain", "delivery", "postpartum"].forEach(stage => {
        const prefs = state.birthPlanV2[stage].preferences || [];
        if (prefs.length > 0) {
          completedCount++;
          // Show checkmark on completed stages
          const checkEl = $(`#check${stage.charAt(0).toUpperCase() + stage.slice(1)}`);
          if (checkEl) checkEl.classList.add("visible");
        } else {
          const checkEl = $(`#check${stage.charAt(0).toUpperCase() + stage.slice(1)}`);
          if (checkEl) checkEl.classList.remove("visible");
        }
      });
      completedStagesEl.textContent = completedCount;
    }
  }

  // Update progress ring
  function updateProgressRing() {
    const circle = $("#birthProgressCircle");
    const percentageEl = $("#birthProgressPercentage");
    
    if (!circle || !percentageEl) return;

    // Calculate total possible selections
    let totalPossible = 0;
    let totalSelected = 0;

    ["labor", "pain", "delivery", "postpartum"].forEach(stage => {
      totalPossible += BIRTH_PLAN_DATA[stage].preferences.length;
      totalSelected += (state.birthPlanV2[stage].preferences || []).length;
    });

    const percentage = Math.round((totalSelected / totalPossible) * 100);
    const circumference = 2 * Math.PI * 80; // radius is 80
    const offset = circumference - (percentage / 100) * circumference;

    circle.style.strokeDashoffset = offset;
    percentageEl.textContent = percentage + '%';
  }

  // Switch birth stage
  ANC.switchBirthStage = (stage) => {
    renderBirthStage(stage);
  };

  // Clear birth plan
  ANC.clearBirthPlanV2 = () => {
    if (confirm("Are you sure you want to start over? This will clear all your selections.")) {
      state.birthPlanV2 = {
        labor: { preferences: [], sliders: {} },
        pain: { preferences: [], sliders: {} },
        delivery: { preferences: [], sliders: {} },
        postpartum: { preferences: [], sliders: {} }
      };
      renderBirthStage(currentBirthStage);
    }
  };

  // Download birth plan
  ANC.downloadBirthPlanV2 = () => {
    const lines = [];
    lines.push("");
    lines.push("       NARI SHAKTI - BIRTH PLAN");
    lines.push("");
    lines.push("");
    lines.push(`Created: ${new Date().toLocaleDateString()}`);
    lines.push(`Current Week: ${state.week}`);
    lines.push("");

    ["labor", "pain", "delivery", "postpartum"].forEach(stage => {
      const stageData = BIRTH_PLAN_DATA[stage];
      const selectedIds = state.birthPlanV2[stage].preferences || [];
      const sliders = state.birthPlanV2[stage].sliders || {};

      lines.push("");
      lines.push(`${stageData.icon} ${stageData.title.toUpperCase()}`);
      lines.push("");
      
      if (selectedIds.length === 0 && Object.keys(sliders).length === 0) {
        lines.push("  (No preferences selected)");
      } else {
        selectedIds.forEach(id => {
          const pref = stageData.preferences.find(p => p.id === id);
          if (pref) {
            lines.push(`   ${pref.title}`);
            lines.push(`    ${pref.desc}`);
          }
        });

        if (Object.keys(sliders).length > 0) {
          lines.push("");
          Object.keys(sliders).forEach(sliderId => {
            const sliderData = stageData.sliders.find(s => s.id === sliderId);
            if (sliderData) {
              lines.push(`  ${sliderData.emoji} ${sliderData.label}: ${sliders[sliderId]}${sliderData.unit || ''}`);
            }
          });
        }
      }
      lines.push("");
    });

    lines.push("");
    lines.push("Important Notes:");
    lines.push(" This birth plan represents your preferences");
    lines.push(" Stay flexible - birth can be unpredictable");
    lines.push(" Discuss with your healthcare team");
    lines.push(" Your safety & baby's safety come first");
    lines.push("");

    downloadText("Nari_Shakti_Birth_Plan.txt", lines.join("\n"));
  };

  // Toggle preview expand (future feature)
  ANC.togglePreviewExpand = () => {
    previewExpanded = !previewExpanded;
    const icon = $("#expandIcon");
    if (icon) {
      icon.textContent = previewExpanded ? "" : "";
    }
    // Could add full-screen modal preview here
  };

  // Shareable birth plan
  ANC.shareableBirthPlan = () => {
    openModal(
      " Shareable Birth Plan",
      `
        <div style="text-align: center;">
          <p style="margin-bottom: 1.5rem; color: var(--text-soft);">
            Create a beautiful, shareable version of your birth plan to send to your partner, 
            doula, or hospital team.
          </p>
          <div style="background: linear-gradient(135deg, rgba(236,64,122,0.08), rgba(237,231,246,0.3)); 
                      padding: 2rem; border-radius: 18px; margin-bottom: 1.5rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
            <p style="color: var(--text-main); font-weight: 600;">
              Coming Soon!
            </p>
            <p style="color: var(--text-soft); font-size: 0.9rem; margin-top: 0.5rem;">
              Create beautiful PDF and image versions of your birth plan
            </p>
          </div>
          <p style="font-size: 0.9rem; color: var(--text-soft);">
            For now, use the Download button to get a text version.
          </p>
        </div>
      `,
      `<button class="mini-btn" onclick="ANC.closeModal()">Got it</button>`
    );
  };

  // Template system
  ANC.showBirthPlanTemplates = () => {
    openModal(
      " Birth Plan Templates",
      `
        <p style="margin-bottom: 1.5rem; color: var(--text-soft);">
          Start with a pre-made template and customize it to your needs.
        </p>
        
        <div style="display: grid; gap: 1rem;">
          <div class="template-option" onclick="ANC._applyTemplate('natural')" 
               style="background: rgba(76,175,80,0.1); padding: 1.5rem; border-radius: 16px; 
                      border: 2px solid rgba(76,175,80,0.2); cursor: pointer; transition: all 0.3s;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Natural Birth Focus</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem;">
              Emphasizes natural pain management, movement, and minimal interventions
            </p>
          </div>
          
          <div class="template-option" onclick="ANC._applyTemplate('flexible')"
               style="background: rgba(236,64,122,0.1); padding: 1.5rem; border-radius: 16px; 
                      border: 2px solid rgba(236,64,122,0.2); cursor: pointer; transition: all 0.3s;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Flexible & Open</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem;">
              Balanced approach - open to all options based on how labor progresses
            </p>
          </div>
          
          <div class="template-option" onclick="ANC._applyTemplate('medicated')"
               style="background: rgba(33,150,243,0.1); padding: 1.5rem; border-radius: 16px; 
                      border: 2px solid rgba(33,150,243,0.2); cursor: pointer; transition: all 0.3s;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;"></div>
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Planned Epidural</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem;">
              Focuses on comfort with epidural and medical pain management
            </p>
          </div>
        </div>
      `,
      `<button class="mini-btn outline" onclick="ANC.closeModal()">Cancel</button>`
    );
  };

  // Apply template
  ANC._applyTemplate = (templateType) => {
    const templates = {
      natural: {
        labor: ["move-freely", "dim-lights", "water-therapy", "minimal-interruptions"],
        pain: ["try-natural-first", "nitrous-oxide"],
        delivery: ["skin-to-skin", "delayed-cord", "quiet-atmosphere", "golden-hour"],
        postpartum: ["breastfeeding-support", "rooming-in", "quiet-recovery"]
      },
      flexible: {
        labor: ["move-freely", "birth-partner"],
        pain: ["try-natural-first", "open-epidural", "discuss-options"],
        delivery: ["skin-to-skin", "delayed-cord", "explain-procedures"],
        postpartum: ["breastfeeding-support", "rooming-in", "mood-screening"]
      },
      medicated: {
        labor: ["dim-lights", "birth-partner", "minimal-interruptions"],
        pain: ["open-epidural", "discuss-options", "iv-pain-med"],
        delivery: ["skin-to-skin", "delayed-cord", "explain-procedures"],
        postpartum: ["breastfeeding-support", "pain-management", "visitor-limits"]
      }
    };

    const template = templates[templateType];
    if (template) {
      Object.keys(template).forEach(stage => {
        state.birthPlanV2[stage].preferences = [...template[stage]];
      });
      renderBirthStage(currentBirthStage);
      ANC.closeModal();
    }
  };

  // Birth scenarios
  ANC.showBirthScenarios = () => {
    openModal(
      " Practice Birth Scenarios",
      `
        <p style="margin-bottom: 1.5rem; color: var(--text-soft);">
          Walk through common birth scenarios to help you prepare.
        </p>
        
        <div style="display: grid; gap: 1rem;">
          <div style="background: rgba(237,231,246,0.3); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(236,64,122,0.15);">
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Fast Labor</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 1rem;">
              Learn what happens when labor progresses quickly and how to adapt your plan.
            </p>
            <button class="mini-btn" onclick="alert('Scenario coming soon!')">Start Scenario</button>
          </div>
          
          <div style="background: rgba(237,231,246,0.3); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(236,64,122,0.15);">
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Slow Labor</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 1rem;">
              Practice decision-making when labor stalls or progresses slowly.
            </p>
            <button class="mini-btn" onclick="alert('Scenario coming soon!')">Start Scenario</button>
          </div>
          
          <div style="background: rgba(237,231,246,0.3); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(236,64,122,0.15);">
            <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Unexpected C-Section</h4>
            <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 1rem;">
              Understand what preferences still apply if cesarean becomes necessary.
            </p>
            <button class="mini-btn" onclick="alert('Scenario coming soon!')">Start Scenario</button>
          </div>
        </div>
      `,
      `<button class="mini-btn outline" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // Birth affirmations
  ANC.showBirthAffirmations = () => {
    const affirmations = [
      "My body knows how to birth my baby",
      "I trust my body's wisdom",
      "Each contraction brings me closer to my baby",
      "I am strong, capable, and prepared",
      "My baby and I are working together",
      "I welcome each wave of labor",
      "I am surrounded by love and support",
      "My body is perfectly designed for this",
      "I release fear and embrace strength",
      "I am doing an amazing job"
    ];

    openModal(
      " Birth Affirmations",
      `
        <p style="margin-bottom: 1.5rem; color: var(--text-soft); text-align: center;">
          Positive affirmations to practice during pregnancy and use during labor.
        </p>
        
        <div style="display: grid; gap: 1rem; max-height: 400px; overflow-y: auto;">
          ${affirmations.map((aff, i) => `
            <div style="background: linear-gradient(135deg, rgba(236,64,122,0.05), rgba(237,231,246,0.2)); 
                        padding: 1.2rem; border-radius: 14px; border-left: 4px solid var(--primary);">
              <p style="color: var(--text-main); font-size: 1.05rem; font-weight: 500; line-height: 1.6;">
                "${aff}"
              </p>
            </div>
          `).join('')}
        </div>
        
        <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(236,64,122,0.08); border-radius: 12px; text-align: center;">
          <p style="font-size: 0.9rem; color: var(--text-soft);">
             Tip: Practice these daily during pregnancy. Write your favorites on cards to bring to the hospital.
          </p>
        </div>
      `,
      `<button class="mini-btn" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // Partner guide
  ANC.showPartnerGuide = () => {
    openModal(
      " Partner Support Guide",
      `
        <p style="margin-bottom: 1.5rem; color: var(--text-soft);">
          Essential ways your partner can support you during labor and delivery.
        </p>
        
        <div style="display: grid; gap: 1.5rem; max-height: 400px; overflow-y: auto;">
          <div>
            <h4 style="color: var(--primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
              <span></span> Physical Support
            </h4>
            <ul style="color: var(--text-soft); line-height: 1.8; margin-left: 1.5rem;">
              <li>Apply counter-pressure to lower back</li>
              <li>Hold hands during contractions</li>
              <li>Help change positions</li>
              <li>Provide massage</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color: var(--primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
              <span></span> Emotional Support
            </h4>
            <ul style="color: var(--text-soft); line-height: 1.8; margin-left: 1.5rem;">
              <li>Offer words of encouragement</li>
              <li>Make eye contact during contractions</li>
              <li>Remind them of their strength</li>
              <li>Stay calm and positive</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color: var(--primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
              <span></span> Advocacy
            </h4>
            <ul style="color: var(--text-soft); line-height: 1.8; margin-left: 1.5rem;">
              <li>Speak up for birth plan preferences</li>
              <li>Ask questions to medical team</li>
              <li>Help make decisions</li>
              <li>Ensure needs are communicated</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color: var(--primary); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
              <span></span> Practical Tasks
            </h4>
            <ul style="color: var(--text-soft); line-height: 1.8; margin-left: 1.5rem;">
              <li>Time contractions</li>
              <li>Manage lighting and music</li>
              <li>Offer ice chips and snacks</li>
              <li>Take photos if desired</li>
            </ul>
          </div>
        </div>
      `,
      `<button class="mini-btn" onclick="ANC.closeModal()">Close</button>`
    );
  };

  // Educational info modals
  ANC.showBirthInfo = (topic) => {
    const content = {
      stages: {
        title: " Understanding Labor Stages",
        body: `
          <div style="display: grid; gap: 1.5rem;">
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Stage 1: Early & Active Labor</h4>
              <p style="color: var(--text-soft); line-height: 1.7;">
                <strong>Early Labor:</strong> Cervix dilates 0-6cm. Contractions are irregular and manageable. 
                Can last hours or days.<br/><br/>
                <strong>Active Labor:</strong> Cervix dilates 6-10cm. Contractions are stronger, closer together 
                (3-5 min apart), lasting 45-60 seconds.
              </p>
            </div>
            
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Stage 2: Pushing & Birth</h4>
              <p style="color: var(--text-soft); line-height: 1.7;">
                Cervix is fully dilated (10cm). You'll feel an urge to push with contractions. 
                Can last minutes to a few hours. Ends with baby's birth.
              </p>
            </div>
            
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Stage 3: Placenta Delivery</h4>
              <p style="color: var(--text-soft); line-height: 1.7;">
                After baby is born, you'll deliver the placenta. Usually takes 5-30 minutes 
                with a few more contractions.
              </p>
            </div>
          </div>
        `
      },
      positions: {
        title: " Labor Positions Guide",
        body: `
          <div style="display: grid; gap: 1rem;">
            <div style="background: rgba(237,231,246,0.3); padding: 1rem; border-radius: 12px;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Walking & Standing</h4>
              <p style="color: var(--text-soft); font-size: 0.95rem;">
                Uses gravity to help baby descend. Walking can help labor progress.
              </p>
            </div>
            
            <div style="background: rgba(237,231,246,0.3); padding: 1rem; border-radius: 12px;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Hands & Knees</h4>
              <p style="color: var(--text-soft); font-size: 0.95rem;">
                Reduces back pain. Helps baby rotate to optimal position.
              </p>
            </div>
            
            <div style="background: rgba(237,231,246,0.3); padding: 1rem; border-radius: 12px;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Side-Lying</h4>
              <p style="color: var(--text-soft); font-size: 0.95rem;">
                Great for resting. Reduces pressure. Good with epidural.
              </p>
            </div>
            
            <div style="background: rgba(237,231,246,0.3); padding: 1rem; border-radius: 12px;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;"> Sitting/Squatting</h4>
              <p style="color: var(--text-soft); font-size: 0.95rem;">
                Opens pelvis. Uses gravity. Can speed up delivery.
              </p>
            </div>
          </div>
          
          <p style="margin-top: 1rem; padding: 1rem; background: rgba(236,64,122,0.08); border-radius: 12px; 
                    color: var(--text-soft); font-size: 0.9rem; text-align: center;">
             Move freely between positions - listen to your body!
          </p>
        `
      },
      breathing: {
        title: " Breathing Techniques",
        body: `
          <div style="display: grid; gap: 1.5rem;">
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Slow Breathing (Early Labor)</h4>
              <p style="color: var(--text-soft); line-height: 1.7; margin-bottom: 0.5rem;">
                Breathe slowly in through nose, out through mouth. Count to 4 on inhale, 6 on exhale.
              </p>
              <div style="background: rgba(76,175,80,0.1); padding: 0.8rem; border-radius: 8px; text-align: center; 
                          font-family: monospace; color: var(--primary);">
                IN (4) - OUT (6) - IN (4) - OUT (6)
              </div>
            </div>
            
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Light Breathing (Active Labor)</h4>
              <p style="color: var(--text-soft); line-height: 1.7; margin-bottom: 0.5rem;">
                Shallow, quick breaths through mouth during peak of contractions.
              </p>
              <div style="background: rgba(236,64,122,0.1); padding: 0.8rem; border-radius: 8px; text-align: center; 
                          font-family: monospace; color: var(--primary);">
                hee-hee-hee-hoo  |  hee-hee-hee-hoo
              </div>
            </div>
            
            <div>
              <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Pushing Breath (Stage 2)</h4>
              <p style="color: var(--text-soft); line-height: 1.7;">
                Take deep breath, hold briefly, bear down gently. Release and breathe normally between contractions.
              </p>
            </div>
          </div>
          
          <p style="margin-top: 1rem; padding: 1rem; background: rgba(236,64,122,0.08); border-radius: 12px; 
                    color: var(--text-soft); font-size: 0.9rem; text-align: center;">
             Practice these daily during pregnancy so they become natural during labor!
          </p>
        `
      },
      interventions: {
        title: " Common Interventions",
        body: `
          <p style="margin-bottom: 1.5rem; color: var(--text-soft);">
            Understanding common medical interventions helps you make informed decisions.
          </p>
          
          <div style="display: grid; gap: 1rem; max-height: 350px; overflow-y: auto;">
            <div style="border-left: 4px solid var(--primary); padding-left: 1rem;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Continuous Fetal Monitoring</h4>
              <p style="color: var(--text-soft); font-size: 0.9rem; line-height: 1.6;">
                <strong>What:</strong> Monitors baby's heart rate<br/>
                <strong>When:</strong> Often routine, especially with epidural<br/>
                <strong>Ask:</strong> Can I have intermittent monitoring to move freely?
              </p>
            </div>
            
            <div style="border-left: 4px solid var(--primary); padding-left: 1rem;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Pitocin (Labor Augmentation)</h4>
              <p style="color: var(--text-soft); font-size: 0.9rem; line-height: 1.6;">
                <strong>What:</strong> Synthetic hormone to strengthen contractions<br/>
                <strong>When:</strong> Labor stalls or progresses slowly<br/>
                <strong>Ask:</strong> Can we try other methods first?
              </p>
            </div>
            
            <div style="border-left: 4px solid var(--primary); padding-left: 1rem;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Episiotomy</h4>
              <p style="color: var(--text-soft); font-size: 0.9rem; line-height: 1.6;">
                <strong>What:</strong> Surgical cut to enlarge vaginal opening<br/>
                <strong>When:</strong> Rarely needed, sometimes for baby's safety<br/>
                <strong>Ask:</strong> Is this medically necessary? Can we avoid it?
              </p>
            </div>
            
            <div style="border-left: 4px solid var(--primary); padding-left: 1rem;">
              <h4 style="color: var(--text-main); margin-bottom: 0.5rem;">Vacuum/Forceps Delivery</h4>
              <p style="color: var(--text-soft); font-size: 0.9rem; line-height: 1.6;">
                <strong>What:</strong> Instruments to help baby out during pushing<br/>
                <strong>When:</strong> Prolonged pushing or baby in distress<br/>
                <strong>Ask:</strong> What are the benefits vs. risks?
              </p>
            </div>
          </div>
          
          <p style="margin-top: 1rem; padding: 1rem; background: rgba(236,64,122,0.08); border-radius: 12px; 
                    color: var(--text-soft); font-size: 0.9rem; text-align: center;">
            Remember: It's okay to ask questions! "What are my options?" is always valid.
          </p>
        `
      }
    };

    const info = content[topic];
    if (info) {
      openModal(info.title, info.body, `<button class="mini-btn" onclick="ANC.closeModal()">Close</button>`);
    }
  };

  // Initialize birth plan on page load
  function initBirthPlanV2() {
    if ($("#birthStageContent")) {
      renderBirthStage("labor");
    }
  }

  // ==========================================
  // END BIRTH PLAN V2
  // ==========================================

  // Postpartum checklist
  function renderPostpartumChecklist() {
    const host = $("#ppChecklist");
    if (!host) return;

    const c = state.postpartumChecklist;
    host.innerHTML = `
      <label class="check-item"><input type="checkbox" ${c.hydration ? "checked" : ""} onchange="ANC._ppToggle('hydration', this.checked)"> Hydration plan</label>
      <label class="check-item"><input type="checkbox" ${c.rest ? "checked" : ""} onchange="ANC._ppToggle('rest', this.checked)"> Sleep/rest support</label>
      <label class="check-item"><input type="checkbox" ${c.mood ? "checked" : ""} onchange="ANC._ppToggle('mood', this.checked)"> Mood check / screening plan</label>
      <label class="check-item"><input type="checkbox" ${c.feeding ? "checked" : ""} onchange="ANC._ppToggle('feeding', this.checked)"> Feeding support plan</label>
      <label class="check-item"><input type="checkbox" ${c.contraception ? "checked" : ""} onchange="ANC._ppToggle('contraception', this.checked)"> Contraception discussion</label>
      <label class="check-item"><input type="checkbox" ${c.followup ? "checked" : ""} onchange="ANC._ppToggle('followup', this.checked)"> Follow-up appointment plan</label>
    `;
    saveState();
  }

  ANC._ppToggle = (k, v) => {
    state.postpartumChecklist[k] = !!v;
    saveState();
  };

  ANC.resetPostpartumChecklist = () => {
    state.postpartumChecklist = {
      hydration: false, rest: false, mood: false, feeding: false, contraception: false, followup: false
    };
    renderPostpartumChecklist();
  };

  ANC.exportPostpartumChecklist = () => {
    const c = state.postpartumChecklist;
    const lines = [
      "Nari Swasthya  Postpartum Checklist",
      `Date: ${todayISO()}`,
      "",
      `Hydration plan: ${c.hydration ? "Yes" : "No"}`,
      `Rest support: ${c.rest ? "Yes" : "No"}`,
      `Mood check: ${c.mood ? "Yes" : "No"}`,
      `Feeding support: ${c.feeding ? "Yes" : "No"}`,
      `Contraception: ${c.contraception ? "Yes" : "No"}`,
      `Follow-up appointment: ${c.followup ? "Yes" : "No"}`
    ];
    downloadText("postpartum_checklist.txt", lines.join("\n"));
  };

  ANC.buildSupportPlan = () => {
    const out = $("#supportPlanOut");
    if (!out) return;
    const c = state.postpartumChecklist;
    const items = [];
    if (c.rest) items.push("Arrange 23 hour rest windows with helper coverage.");
    if (c.feeding) items.push("Identify lactation/feeding support contact.");
    if (c.mood) items.push("Choose a trusted person for mood check-ins.");
    if (c.followup) items.push("Set a reminder for follow-up appointment scheduling.");
    if (!items.length) items.push("Select postpartum checklist items to generate a plan.");
    out.innerHTML = `<ul>${items.map(i => `<li>${i}</li>`).join("")}</ul>`;
  };

  /* ---------------------------
   * 14) Enhanced Body insights with comprehensive medical information
   * --------------------------- */
  const BODY_INSIGHTS = {
    heart: {
      title: "Heart & Cardiovascular System",
      body: `<div class="insight-detailed">
        <h4>How Your Heart Changes in Pregnancy</h4>
        <p><strong>Blood Pressure is checked at every visit</strong> because your cardiovascular system undergoes dramatic changes:</p>
        <ul>
          <li><strong>Blood volume increases 40-50%:</strong> From ~4 liters to 6+ liters by week 34</li>
          <li><strong>Heart rate increases:</strong> Normal resting heart rate goes up 10-20 beats per minute</li>
          <li><strong>Cardiac output increases 30-50%:</strong> Heart pumps more blood with each beat</li>
          <li><strong>Blood vessels relax:</strong> Hormones cause vasodilation to accommodate extra blood</li>
        </ul>
        <h4>What We Monitor</h4>
        <ul>
          <li><strong>Blood Pressure:</strong> Target <140/90. High BP (140/90) needs urgent evaluation for pre-eclampsia</li>
          <li><strong>Heart palpitations:</strong> Usually normal but report if accompanied by chest pain or dizziness</li>
          <li><strong>Swelling (edema):</strong> Mild ankle/foot swelling is normal; sudden face/hand swelling needs immediate attention</li>
        </ul>
        <h4>Warning Signs (Seek Immediate Care)</h4>
        <ul>
          <li>Chest pain or pressure</li>
          <li>Severe shortness of breath</li>
          <li>Rapid irregular heartbeat with dizziness</li>
          <li>Fainting</li>
        </ul>
        <p class="week-specific" id="heartWeekInfo"></p>
      </div>`
    },
    lungs: {
      title: "Respiratory System & Breathing",
      body: `<div class="insight-detailed">
        <h4>Breathing Changes in Pregnancy</h4>
        <p><strong>Why you might feel short of breath:</strong></p>
        <ul>
          <li><strong>Diaphragm elevation:</strong> Growing uterus pushes diaphragm up ~4 cm, reducing lung capacity</li>
          <li><strong>Increased oxygen need:</strong> You need 20% more oxygen for you and baby</li>
          <li><strong>Progesterone effect:</strong> Makes you breathe deeper and faster</li>
          <li><strong>Rib cage expansion:</strong> Chest circumference increases 5-7 cm to compensate</li>
        </ul>
        <h4>Normal vs. Concerning Shortness of Breath</h4>
        <p><strong>Normal (dyspnea of pregnancy):</strong></p>
        <ul>
          <li>Mild breathlessness with exertion or when lying flat</li>
          <li>Feeling like you can't take a deep breath</li>
          <li>Improves with rest and position changes</li>
        </ul>
        <p><strong>Call provider if you have:</strong></p>
        <ul>
          <li>Sudden severe shortness of breath</li>
          <li>Chest pain with breathing</li>
          <li>Rapid breathing at rest</li>
          <li>Bluish lips or fingertips</li>
          <li>Coughing up blood</li>
        </ul>
      </div>`
    },
    liver: {
      title: "Liver Function & Metabolism",
      body: `<div class="insight-detailed">
        <h4>Your Liver During Pregnancy</h4>
        <p><strong>The liver works harder to:</strong></p>
        <ul>
          <li>Process nutrients for both you and baby</li>
          <li>Clear hormones (estrogen, progesterone levels are 100x higher!)</li>
          <li>Produce proteins for blood clotting</li>
          <li>Manage increased metabolic demands</li>
        </ul>
        <h4>Why We Monitor Liver Function</h4>
        <p>Blood tests check liver enzymes to screen for:</p>
        <ul>
          <li><strong>Pre-eclampsia:</strong> Can affect liver, causing elevated enzymes</li>
          <li><strong>HELLP syndrome:</strong> Serious condition with Hemolysis, Elevated Liver enzymes, Low Platelets</li>
          <li><strong>Intrahepatic cholestasis:</strong> Bile flow problem causing intense itching</li>
          <li><strong>Acute fatty liver:</strong> Rare but serious third-trimester complication</li>
        </ul>
        <h4>Warning Symptoms (Report Immediately)</h4>
        <ul>
          <li>Severe upper right abdominal pain</li>
          <li>Intense itching, especially hands/feet</li>
          <li>Yellowing of skin or eyes (jaundice)</li>
          <li>Dark urine or pale stools</li>
          <li>Nausea/vomiting in later pregnancy</li>
        </ul>
      </div>`
    },
    stomach: {
      title: "Digestive System",
      body: `<div class="insight-detailed">
        <h4>Common Digestive Changes</h4>
        <p><strong>Why digestion slows:</strong></p>
        <ul>
          <li><strong>Progesterone:</strong> Relaxes smooth muscles, slowing gut movement</li>
          <li><strong>Space constraints:</strong> Growing uterus compresses stomach and intestines</li>
          <li><strong>Increased nutrient absorption:</strong> Food stays in intestines longer for maximum absorption</li>
        </ul>
        <h4>Common Issues & Solutions</h4>
        <p><strong>Heartburn/Acid reflux:</strong></p>
        <ul>
          <li>Affects 45-80% of pregnant women</li>
          <li>Caused by relaxed esophageal sphincter + uterus pressure</li>
          <li>Relief: Small frequent meals, avoid lying down after eating, elevate head while sleeping, avoid triggers (spicy, acidic, fried foods)</li>
        </ul>
        <p><strong>Constipation:</strong></p>
        <ul>
          <li>Affects up to 40% of pregnancies</li>
          <li>Relief: Increase fiber (25-30g daily), drink 8-10 glasses water, gentle exercise, prunes/prune juice</li>
        </ul>
        <p><strong>Nausea ("morning sickness"):</strong></p>
        <ul>
          <li>Affects 70-80%, usually improves by week 16</li>
          <li>Relief: Small frequent meals, ginger, vitamin B6, avoid empty stomach, eat crackers before rising</li>
        </ul>
      </div>`
    },
    uterus: {
      title: "Uterus & Baby's Home",
      body: `<div class="insight-detailed">
        <h4>Amazing Uterine Growth</h4>
        <p><strong>Size transformation:</strong></p>
        <ul>
          <li><strong>Pre-pregnancy:</strong> Small pear size (~50-70g, 7.5cm long)</li>
          <li><strong>At term:</strong> Watermelon size (~1000-1200g, 35-40cm long)</li>
          <li><strong>Volume increase:</strong> From ~10ml to 5,000ml capacity!</li>
        </ul>
        <h4>Week-by-Week Uterus Landmarks</h4>
        <ul>
          <li><strong>Week 12:</strong> Just above pubic bone, no longer entirely in pelvis</li>
          <li><strong>Week 20:</strong> At belly button level</li>
          <li><strong>Week 36:</strong> Up to bottom of rib cage</li>
          <li><strong>Week 38-40:</strong> May "drop" as baby moves into pelvis (lightening)</li>
        </ul>
        <h4>What We Monitor</h4>
        <ul>
          <li><strong>Fundal height:</strong> Distance pubic bone to uterus top (should match weeks gestation 2cm after 20 weeks)</li>
          <li><strong>Contractions:</strong> Braxton Hicks (practice contractions) are normal but regular painful contractions before 37 weeks need evaluation</li>
          <li><strong>Cervical changes:</strong> Cervix should stay long and closed until near due date</li>
        </ul>
        <h4>Anatomy Scan (18-22 weeks)</h4>
        <p>Detailed ultrasound checks baby's organs, amniotic fluid, placenta location, and uterine anatomy</p>
      </div>`
    },
    kidney: {
      title: "Kidneys & Urinary System",
      body: `<div class="insight-detailed">
        <h4>Kidney Changes in Pregnancy</h4>
        <p><strong>Your kidneys work overtime:</strong></p>
        <ul>
          <li><strong>Size increases:</strong> Kidneys grow ~1cm longer</li>
          <li><strong>Blood flow increases 50-80%:</strong> Filtering 40-50% more blood</li>
          <li><strong>GFR increases 40-65%:</strong> Glomerular filtration rate rises dramatically</li>
          <li><strong>Collecting system dilates:</strong> Ureters (tubes from kidney to bladder) widen</li>
        </ul>
        <h4>Why We Check Urine Every Visit</h4>
        <ul>
          <li><strong>Protein:</strong> Normally absent; presence + high BP = possible pre-eclampsia</li>
          <li><strong>Glucose:</strong> Small amounts can be normal but may indicate gestational diabetes</li>
          <li><strong>Bacteria/White blood cells:</strong> Screen for UTIs (urinary tract infections)</li>
          <li><strong>Ketones:</strong> May indicate dehydration or inadequate calorie intake</li>
        </ul>
        <h4>Urinary Tract Infections (UTIs)</h4>
        <p>More common in pregnancy (2-10% of women) due to urinary stasis. Untreated UTIs can lead to kidney infection and preterm labor.</p>
        <p><strong>Symptoms (report immediately):</strong></p>
        <ul>
          <li>Pain or burning with urination</li>
          <li>Frequent urgent need to urinate with little output</li>
          <li>Cloudy, strong-smelling, or bloody urine</li>
          <li>Lower abdominal or back pain</li>
          <li>Fever or chills</li>
        </ul>
      </div>`
    },
    bladder: {
      title: "Bladder & Frequent Urination",
      body: `<div class="insight-detailed">
        <h4>Why You Pee So Often</h4>
        <p><strong>Multiple factors contribute:</strong></p>
        <ul>
          <li><strong>Uterine pressure:</strong> Growing uterus presses on bladder, reducing capacity</li>
          <li><strong>Increased urine production:</strong> Kidneys filter 50% more blood = more urine</li>
          <li><strong>Hormonal effects:</strong> Relaxed bladder muscles from progesterone</li>
          <li><strong>Blood volume:</strong> Extra fluid must be processed</li>
        </ul>
        <h4>Pattern Through Pregnancy</h4>
        <ul>
          <li><strong>First trimester:</strong> Very frequent due to hormones and uterus rising from pelvis</li>
          <li><strong>Second trimester:</strong> Often improves as uterus rises above bladder</li>
          <li><strong>Third trimester:</strong> Returns as baby drops into pelvis, pressing on bladder again</li>
        </ul>
        <h4>Pelvic Floor Health</h4>
        <p><strong>Kegel exercises:</strong> Strengthen pelvic floor to reduce stress incontinence</p>
        <ul>
          <li>Squeeze muscles you'd use to stop urine flow</li>
          <li>Hold 5-10 seconds, relax 10 seconds</li>
          <li>Repeat 10-15 times, 3 times daily</li>
          <li>Do NOT practice while actually urinating</li>
        </ul>
        <h4>When Frequency is Concerning</h4>
        <p>Call provider if you have pain, burning, blood in urine, or fever with urination</p>
      </div>`
    },
    spine: {
      title: "Back & Spinal Changes",
      body: `<div class="insight-detailed">
        <h4>Why Back Pain is Common</h4>
        <p>Affects 50-70% of pregnant women due to:</p>
        <ul>
          <li><strong>Postural changes:</strong> Growing belly shifts center of gravity forward, increasing lordosis (lower back curve)</li>
          <li><strong>Hormone relaxin:</strong> Loosens ligaments and joints preparing for birth but reduces spinal stability</li>
          <li><strong>Muscle strain:</strong> Abdominal muscles stretch, back muscles work harder</li>
          <li><strong>Weight gain:</strong> Extra 25-35 lbs strains back</li>
        </ul>
        <h4>Relief Strategies</h4>
        <ul>
          <li><strong>Posture:</strong> Keep shoulders back, avoid swayback, wear supportive shoes</li>
          <li><strong>Support belt:</strong> Maternity support belt can help</li>
          <li><strong>Prenatal massage:</strong> Safe after first trimester</li>
          <li><strong>Warm compress:</strong> NOT hot, avoid heating pad on belly</li>
          <li><strong>Stretching:</strong> Gentle prenatal yoga, cat-cow stretches</li>
          <li><strong>Swimming:</strong> Water supports weight, relieves pressure</li>
          <li><strong>Sleep position:</strong> Side-lying with pillow between knees</li>
        </ul>
        <h4>When to Report Back Pain</h4>
        <ul>
          <li>Severe pain limiting movement</li>
          <li>Pain radiating down legs (sciatica)</li>
          <li>Numbness or tingling in legs</li>
          <li>Rhythmic back pain (could be contractions)</li>
        </ul>
      </div>`
    },
    blood: {
      title: "Blood Volume & Tests",
      body: `<div class="insight-detailed">
        <h4>Dramatic Blood Volume Increase</h4>
        <p><strong>Your blood supply expands 40-50%:</strong></p>
        <ul>
          <li>Pre-pregnancy: ~4 liters</li>
          <li>At term: ~6-6.5 liters</li>
          <li>Peaks around week 32-34</li>
        </ul>
        <p><strong>Why you need more blood:</strong></p>
        <ul>
          <li>Supply oxygen and nutrients to baby via placenta</li>
          <li>Support enlarging uterus and breasts</li>
          <li>Prepare for blood loss during delivery (average 500ml vaginal, 1000ml C-section)</li>
          <li>Maintain blood pressure despite dilated blood vessels</li>
        </ul>
        <h4>Key Blood Tests in Pregnancy</h4>
        <p><strong>First trimester baseline:</strong></p>
        <ul>
          <li><strong>CBC (Complete Blood Count):</strong> Checks for anemia, infection, platelet count</li>
          <li><strong>Blood type & Rh:</strong> Determines if you need RhoGAM (if Rh negative)</li>
          <li><strong>Antibody screen:</strong> Checks for antibodies that could affect baby</li>
          <li><strong>Infection screen:</strong> HIV, Hepatitis B, Syphilis, Rubella immunity</li>
        </ul>
        <p><strong>24-28 weeks:</strong></p>
        <ul>
          <li><strong>Glucose screening:</strong> Check for gestational diabetes</li>
          <li><strong>Repeat CBC:</strong> Check iron levels (anemia common mid-pregnancy)</li>
        </ul>
      </div>`
    },
    bp: {
      title: "Blood Pressure Monitoring",
      body: `<div class="insight-detailed">
        <h4>Why BP is Checked at Every Visit</h4>
        <p><strong>High blood pressure affects 6-8% of pregnancies</strong> and can be dangerous if undetected.</p>
        <h4>Types of Hypertension in Pregnancy</h4>
        <p><strong>1. Chronic hypertension:</strong></p>
        <ul>
          <li>High BP before pregnancy or before 20 weeks</li>
          <li>Requires close monitoring, may need medication adjustment</li>
        </ul>
        <p><strong>2. Gestational hypertension:</strong></p>
        <ul>
          <li>Develops after 20 weeks, no protein in urine</li>
          <li>Usually resolves after delivery</li>
          <li>Requires frequent monitoring</li>
        </ul>
        <p><strong>3. Pre-eclampsia:</strong></p>
        <ul>
          <li>High BP + protein in urine after 20 weeks</li>
          <li>Can affect multiple organs (liver, kidneys, brain, placenta)</li>
          <li>Affects 3-5% of pregnancies</li>
          <li>Only cure is delivery</li>
        </ul>
        <h4>Pre-eclampsia Warning Signs (CALL IMMEDIATELY)</h4>
        <ul>
          <li>Severe persistent headache</li>
          <li>Vision changes (blurry, spots, light sensitivity)</li>
          <li>Upper right abdominal pain</li>
          <li>Sudden severe swelling of face, hands</li>
          <li>Shortness of breath</li>
          <li>Decreased fetal movement</li>
        </ul>
      </div>`
    },
    baby: {
      title: "Baby's Growth & Development",
      body: `<div class="insight-detailed">
        <h4>Monitoring Your Baby's Growth</h4>
        <p><strong>Key milestones we track:</strong></p>
        <h4>Dating & Early Scans</h4>
        <ul>
          <li><strong>Dating scan (6-10 weeks):</strong> Confirms due date, heartbeat, location</li>
          <li><strong>NT scan (11-14 weeks):</strong> Measures nuchal translucency, screens for chromosomal abnormalities</li>
        </ul>
        <h4>Anatomy Scan (18-22 weeks)</h4>
        <p>Detailed examination of:</p>
        <ul>
          <li>Brain and skull</li>
          <li>Face and lips</li>
          <li>Spine</li>
          <li>Heart (4 chambers, major vessels)</li>
          <li>Lungs and diaphragm</li>
          <li>Stomach, kidneys, bladder</li>
          <li>Arms, legs, fingers, toes</li>
          <li>Amniotic fluid level</li>
          <li>Placenta location</li>
          <li>Umbilical cord</li>
        </ul>
        <h4>Growth Scans (28+ weeks as needed)</h4>
        <ul>
          <li><strong>Estimated fetal weight:</strong> Based on head, abdomen, femur measurements</li>
          <li><strong>Growth percentiles:</strong> Compared to average for gestational age</li>
          <li><strong>Biophysical profile:</strong> Checks movement, breathing practice, tone, amniotic fluid</li>
        </ul>
        <h4>Kick Counts (from ~28 weeks)</h4>
        <p>Common method: Feel for 10 movements in 2 hours during baby's active time. Report if pattern changes or reduced movement.</p>
      </div>`
    },
    weight: {
      title: "Weight Gain & Distribution",
      body: `<div class="insight-detailed">
        <h4>Where 25-35 Pounds Goes</h4>
        <ul>
          <li>Baby: 6-8 lbs</li>
          <li>Placenta: 1-2 lbs</li>
          <li>Amniotic fluid: 2 lbs</li>
          <li>Uterus: 2 lbs</li>
          <li>Breast tissue: 2 lbs</li>
          <li>Blood volume: 4 lbs</li>
          <li>Body fluids: 4 lbs</li>
          <li>Maternal fat stores: 7 lbs</li>
        </ul>
        <h4>Weight Gain Goals by Pre-Pregnancy BMI</h4>
        <ul>
          <li><strong>Underweight (BMI <18.5):</strong> 28-40 lbs</li>
          <li><strong>Normal (BMI 18.5-24.9):</strong> 25-35 lbs</li>
          <li><strong>Overweight (BMI 25-29.9):</strong> 15-25 lbs</li>
          <li><strong>Obese (BMI 30):</strong> 11-20 lbs</li>
        </ul>
        <p>Use the Weight Trend interpreter in Visit Simulator for detailed guidance</p>
      </div>`
    },
    placenta: {
      title: "Placenta - Baby's Life Support",
      body: `<div class="insight-detailed">
        <h4>What the Placenta Does</h4>
        <p><strong>The only organ you grow and then discard!</strong> Fully formed by week 18-20.</p>
        <p><strong>Critical functions:</strong></p>
        <ul>
          <li><strong>Oxygen & nutrients:</strong> Transfers from your blood to baby</li>
          <li><strong>Waste removal:</strong> Takes CO2 and waste from baby to you for elimination</li>
          <li><strong>Immune protection:</strong> Passes antibodies (especially IgG) to baby</li>
          <li><strong>Hormone production:</strong> Makes progesterone, estrogen, hCG, and more</li>
          <li><strong>Barrier function:</strong> Prevents most harmful substances from reaching baby</li>
        </ul>
        <h4>What We Monitor</h4>
        <ul>
          <li><strong>Location:</strong> Should be away from cervix (low-lying placenta or placenta previa needs monitoring)</li>
          <li><strong>Function:</strong> Adequate blood flow to ensure baby's growth</li>
          <li><strong>Age:</strong> Can become less efficient after 40-42 weeks</li>
        </ul>
        <h4>Placental Issues</h4>
        <p><strong>Placenta previa:</strong> Placenta covers cervix partially or completely</p>
        <p><strong>Placental abruption:</strong> Placenta separates from uterus before birth (emergency - causes bleeding)</p>
        <p><strong>Placental insufficiency:</strong> Placenta can't supply adequate oxygen/nutrients</p>
      </div>`
    },
    fluid: {
      title: "Amniotic Fluid",
      body: `<div class="insight-detailed">
        <h4>Baby's Protective Environment</h4>
        <p><strong>Amniotic fluid functions:</strong></p>
        <ul>
          <li><strong>Cushioning:</strong> Protects baby from bumps and injury</li>
          <li><strong>Temperature regulation:</strong> Maintains constant warm temperature</li>
          <li><strong>Movement space:</strong> Allows baby to move and develop muscles/bones</li>
          <li><strong>Lung development:</strong> Baby "breathes" fluid to develop lungs</li>
          <li><strong>Infection prevention:</strong> Contains antibodies</li>
          <li><strong>Umbilical cord protection:</strong> Prevents compression</li>
        </ul>
        <h4>Fluid Volume Throughout Pregnancy</h4>
        <ul>
          <li><strong>Week 20:</strong> ~400ml</li>
          <li><strong>Week 34-36:</strong> Peak at ~800-1000ml</li>
          <li><strong>Week 40:</strong> ~600-800ml (decreases slightly)</li>
          <li><strong>Post-term:</strong> Continues to decrease</li>
        </ul>
        <h4>What We Monitor</h4>
        <p><strong>AFI (Amniotic Fluid Index):</strong> Measured on ultrasound</p>
        <ul>
          <li><strong>Normal:</strong> 5-25 cm</li>
          <li><strong>Oligohydramnios (too little):</strong> <5 cm</li>
          <li><strong>Polyhydramnios (too much):</strong> >25 cm</li>
        </ul>
        <p><strong>Call immediately if:</strong> Sudden gush or trickle of clear fluid (possible rupture of membranes)</p>
      </div>`
    },
    hormones: {
      title: "Pregnancy Hormones",
      body: `<div class="insight-detailed">
        <h4>Major Hormonal Changes</h4>
        <p><strong>hCG (Human Chorionic Gonadotropin):</strong></p>
        <ul>
          <li>First hormone of pregnancy - what pregnancy tests detect</li>
          <li>Peaks at 10-12 weeks then decreases</li>
          <li>Maintains corpus luteum which produces progesterone early on</li>
          <li>Often responsible for nausea/vomiting</li>
        </ul>
        <p><strong>Progesterone:</strong></p>
        <ul>
          <li>Increases 10-fold during pregnancy</li>
          <li>Maintains uterine lining</li>
          <li>Relaxes smooth muscles (causes constipation, heartburn)</li>
          <li>Increases body temperature slightly</li>
        </ul>
        <p><strong>Estrogen:</strong></p>
        <ul>
          <li>Increases 100-fold!</li>
          <li>Stimulates uterine growth</li>
          <li>Increases blood flow to uterus</li>
          <li>Prepares breasts for lactation</li>
        </ul>
        <p><strong>Relaxin:</strong></p>
        <ul>
          <li>Loosens ligaments and joints</li>
          <li>Softens cervix preparing for delivery</li>
          <li>Can cause joint instability/back pain</li>
        </ul>
      </div>`
    },
    cervix: {
      title: "Cervix & Labor Preparation",
      body: `<div class="insight-detailed">
        <h4>The Cervix's Role</h4>
        <p><strong>Two jobs:</strong></p>
        <ul>
          <li><strong>During pregnancy:</strong> Stays long, closed, and firm to keep baby in</li>
          <li><strong>During labor:</strong> Softens, shortens (effaces), and opens (dilates) to let baby out</li>
        </ul>
        <h4>Cervical Changes We Monitor</h4>
        <p><strong>Length:</strong></p>
        <ul>
          <li>Normal: >25mm (2.5cm)</li>
          <li>Short cervix (<25mm before 24 weeks) increases preterm birth risk</li>
          <li>May require progesterone supplements or cervical cerclage (stitch)</li>
        </ul>
        <p><strong>Dilation:</strong></p>
        <ul>
          <li>Should stay closed until near term</li>
          <li>0 cm (closed)  10 cm (fully dilated) during labor</li>
        </ul>
        <p><strong>Effacement:</strong></p>
        <ul>
          <li>Cervix thins from ~3-4cm to paper-thin</li>
          <li>Measured as percentage: 0% (thick)  100% (paper-thin)</li>
        </ul>
        <h4>Late Pregnancy Changes (37+ weeks)</h4>
        <ul>
          <li><strong>Ripening:</strong> Cervix softens from hormones</li>
          <li><strong>Mucus plug loss:</strong> Thick plug may be discharged (pink/brown tinged is normal)</li>
          <li><strong>Bloody show:</strong> Small amount of blood-tinged mucus as cervix changes</li>
        </ul>
      </div>`
    },
    breasts: {
      title: "Breast Changes & Preparation for Breastfeeding",
      body: `<div class="insight-detailed">
        <h4>How Breasts Change in Pregnancy</h4>
        <p><strong>Often the first pregnancy sign!</strong> Changes begin as early as 1-2 weeks after conception.</p>
        <p><strong>Throughout pregnancy:</strong></p>
        <ul>
          <li><strong>Size increase:</strong> May grow 1-2 cup sizes due to milk gland development</li>
          <li><strong>Tenderness:</strong> Very common in first trimester, usually improves</li>
          <li><strong>Darkening areolas:</strong> Nipples and areolas become darker and larger</li>
          <li><strong>Montgomery tubercles:</strong> Small bumps on areola become prominent (they secrete oil)</li>
          <li><strong>Veins more visible:</strong> Increased blood flow shows blue veins</li>
          <li><strong>Colostrum:</strong> May leak starting mid-pregnancy (thick, yellowish pre-milk)</li>
        </ul>
        <h4>Preparing for Breastfeeding</h4>
        <p><strong>Nipple care:</strong></p>
        <ul>
          <li>Wash with water only (soap dries nipples)</li>
          <li>Air dry after shower</li>
          <li>No special toughening needed - baby's sucking does this naturally</li>
        </ul>
        <p><strong>Support:</strong></p>
        <ul>
          <li>Well-fitting supportive bra (not underwire during pregnancy)</li>
          <li>Sports bra at night if breasts feel heavy</li>
          <li>Nursing bras available from ~36 weeks</li>
        </ul>
        <h4>When to Report Breast Symptoms</h4>
        <ul>
          <li>New lump (most are benign but should be evaluated)</li>
          <li>Persistent pain in one spot</li>
          <li>Bloody nipple discharge</li>
          <li>Red, warm, painful area (could be infection)</li>
        </ul>
      </div>`
    }
  };

  ANC.openBodyInsight = (key) => {
    const data = BODY_INSIGHTS[key];
    if (!data) return;
    state.currentInsight = key;
    
    const week = state.week || 12;
    
    // Update week badge in V2 panel
    const weekBadgeV2 = $("#insightWeekBadgeV2");
    if (weekBadgeV2) weekBadgeV2.textContent = `Week ${week}`;
    
    // Icon mapping for each body part
    const iconMap = {
      heart: '', lungs: '', liver: '', stomach: '', uterus: '',
      kidney: '', bladder: '', spine: '', blood: '', bp: '',
      baby: '', weight: '', placenta: '', fluid: '', hormones: '',
      cervix: '', breasts: ''
    };
    
    // Update icon badge
    const iconBadge = $("#insightIconBadge");
    if (iconBadge) {
      const emoji = iconBadge.querySelector('.insight-emoji');
      if (emoji) emoji.textContent = iconMap[key] || '';
    }
    
    safeText("insightTitle", data.title);
    
    // Build beautiful content wrapper
    const bodyHTML = `
      <div class="insight-content-wrapper">
        ${data.body}
        
        <div class="insight-footer-note">
          <div class="note-icon"></div>
          <p><strong>Remember:</strong> This information is educational. Always consult your healthcare provider for personalized medical advice and if you have any concerns.</p>
        </div>
        
        <div class="related-topics">
          <h5>Related Topics</h5>
          <div class="topic-pills">
            ${key === 'heart' || key === 'blood' || key === 'bp' ? '<span class="topic-pill" onclick="ANC.openBodyInsight(\'bp\')">Blood Pressure</span>' : ''}
            ${key === 'uterus' || key === 'baby' || key === 'placenta' ? '<span class="topic-pill" onclick="ANC.openBodyInsight(\'baby\')">Baby Growth</span>' : ''}
            ${key === 'uterus' || key === 'cervix' ? '<span class="topic-pill" onclick="ANC.openBodyInsight(\'cervix\')">Cervix</span>' : ''}
            ${key === 'breasts' || key === 'hormones' ? '<span class="topic-pill" onclick="ANC.openBodyInsight(\'hormones\')">Hormones</span>' : ''}
          </div>
        </div>
      </div>
    `;
    
    safeHTML("insightBody", bodyHTML);
    
    // Opening animation
    const panel = $("#insightPanel");
    if (panel) {
      panel.classList.add("open");
      panel.classList.add("insight-entering");
      setTimeout(() => panel.classList.remove("insight-entering"), 400);
    }
    
    saveState();
  };

  ANC.closeInsight = () => {
    $("#insightPanel")?.classList.remove("open");
    state.currentInsight = null;
    saveState();
  };

  ANC.pinInsight = () => {
    if (!state.currentInsight) return;
    state.pinnedInsight = state.currentInsight;
    openModal("Pinned", `<p>Pinned insight: <strong>${BODY_INSIGHTS[state.pinnedInsight].title}</strong></p>`,
      `<button class="mini-btn" type="button" onclick="ANC.closeModal()">OK</button>`);
    saveState();
  };

  ANC.launchMicroQuiz = () => {
    const key = state.currentInsight || state.pinnedInsight;
    if (!key) {
      openModal("MicroQuiz", `<p>Select a hotspot first.</p>`,
        `<button class="mini-btn" type="button" onclick="ANC.closeModal()">Close</button>`);
      return;
    }
    openModal(
      "MicroQuiz",
      `<p><strong>Which week is kick counting commonly taught from?</strong></p>
       <div class="pill-grid">
         <button class="pill-btn" type="button" onclick="ANC._microQuizAns(12)">12</button>
         <button class="pill-btn" type="button" onclick="ANC._microQuizAns(20)">20</button>
         <button class="pill-btn" type="button" onclick="ANC._microQuizAns(28)">28</button>
       </div>
       <div class="modal-output" id="microQuizOut">Pick one.</div>`,
      `<button class="mini-btn outline" type="button" onclick="ANC.closeModal()">Close</button>`
    );
  };

  ANC._microQuizAns = (w) => {
    const out = $("#microQuizOut");
    if (!out) return;
    out.innerHTML = (Number(w) === 28)
      ? `<span class="pill critical">Correct</span> Kick counts commonly start ~28w.`
      : `<span class="pill warn">Try again</span> Hint: third trimester onset.`;
  };

  /* ---------------------------
   * 15) Boot + bindings
   * --------------------------- */
  function bindNonInline() {
    $("#openCommandPaletteBtn")?.addEventListener("click", openPalette);
    $("#paletteSearch")?.addEventListener("input", (e) => renderPaletteResults(e.target.value));

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        closeModal();
        closePalette();
      }
    });

    $("#modalBackdrop")?.addEventListener("click", (e) => {
      if (e.target === $("#modalBackdrop")) closeModal();
    });
  }

  function initVisitSimSlider() {
    const sim = $("#simWeek");
    if (!sim) return;

    // Force correct range from JS too (defensive)
    sim.min = "4";
    sim.max = "40";
    sim.step = "1";

    // Keep current slider value if user already moved it (avoid reset loops)
    const current = clamp(Number(sim.value || 12), 4, 40);
    sim.value = String(current);
    ANC.updateVisitSimWeek(current);
  }

  function initBodyWeekSlider() {
    const weekSlider = $("#weekSlider");
    if (!weekSlider) return;
    weekSlider.min = weekSlider.min || "1";
    weekSlider.max = weekSlider.max || "40";
    weekSlider.step = "1";
    weekSlider.value = String(clamp(Number(state.week), 1, 40));
  }

  loadState();

  // =========================================
// ENHANCED PARTICLE CANVAS ANIMATION (Depression.html style)
// =========================================
(function initEnhancedParticles() {
  const particleCanvas = document.getElementById('particleCanvas');
  if (!particleCanvas) return;
  
  const ctx = particleCanvas.getContext('2d');
  
  function resizeCanvas() {
    particleCanvas.width = particleCanvas.offsetWidth;
    particleCanvas.height = particleCanvas.offsetHeight;
  }
  
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);
  
  const particles = [];
  const particleCount = 100;
  
  class Particle {
    constructor() {
      this.x = Math.random() * particleCanvas.width;
      this.y = Math.random() * particleCanvas.height;
      this.vx = (Math.random() - 0.5) * 0.5;
      this.vy = (Math.random() - 0.5) * 0.5;
      this.radius = Math.random() * 2 + 1;
    }
    
    update() {
      this.x += this.vx;
      this.y += this.vy;
      
      if (this.x < 0 || this.x > particleCanvas.width) this.vx *= -1;
      if (this.y < 0 || this.y > particleCanvas.height) this.vy *= -1;
    }
    
    draw() {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(236, 64, 122, 0.6)';
      ctx.fill();
    }
  }
  
  for (let i = 0; i < particleCount; i++) {
    particles.push(new Particle());
  }
  
  function connectParticles() {
    for (let i = 0; i < particles.length; i++) {
      for (let j = i + 1; j < particles.length; j++) {
        const dx = particles[i].x - particles[j].x;
        const dy = particles[i].y - particles[j].y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < 100) {
          ctx.beginPath();
          ctx.strokeStyle = `rgba(236, 64, 122, ${0.2 * (1 - distance / 100)})`;
          ctx.lineWidth = 1;
          ctx.moveTo(particles[i].x, particles[i].y);
          ctx.lineTo(particles[j].x, particles[j].y);
          ctx.stroke();
        }
      }
    }
  }
  
  function animateParticles() {
    ctx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
    
    particles.forEach(particle => {
      particle.update();
      particle.draw();
    });
    
    connectParticles();
    
    requestAnimationFrame(animateParticles);
  }
  
  animateParticles();
})();



  document.addEventListener("DOMContentLoaded", () => {
    //Particles.init();
    setDailyTip();

    // Initialize hero + belly from saved week
    syncWeekUI();

    // Initialize sliders correctly
    initBodyWeekSlider();
    initVisitSimSlider(); // <-- ensures 440 and no snap-back

    // Initial stage content
    renderStage("first");

    // Initialize due-this-week drill output
    try { ANC.runDueThisWeek(); } catch {}

    // Kick history
    renderKickHistory();
    setKickUI();

    // Nutrition UI
    updateNutritionUI();

    // Birth plan V2 + postpartum planners
    initBirthPlanV2();
    renderPostpartumChecklist();

    // Initialize antibody transfer visualization
    initAntibodyVisualization();

    bindNonInline();
    saveState();
  });

  // ==========================================
  // COMMUNITY SECTION FUNCTIONS
  // ==========================================
  
  /**
   * Open success stories modal
   */
  ANC.openSuccessStories = function() {
    ANC.openModal(
      "Pregnancy Success Stories",
      `
      <div style="max-height: 400px; overflow-y: auto;">
        <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(236,64,122,0.05); border-radius: 12px;">
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Priya from Mumbai</h4>
          <p style="font-style: italic; color: var(--text-soft); line-height: 1.7;">
            "I was terrified when I first got pregnant. But with the support of this community 
            and proper antenatal care, I had a beautiful, healthy baby girl. The weekly check-ins 
            and knowing what to expect made all the difference!"
          </p>
        </div>
        
        <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(236,64,122,0.05); border-radius: 12px;">
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Anjali from Delhi</h4>
          <p style="font-style: italic; color: var(--text-soft); line-height: 1.7;">
            "From my first positive test to holding my baby, this journey taught me strength 
            I never knew I had. The community here answered all my questions and calmed my fears. 
            I'm forever grateful!"
          </p>
        </div>
        
        <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(236,64,122,0.05); border-radius: 12px;">
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Lakshmi from Bangalore</h4>
          <p style="font-style: italic; color: var(--text-soft); line-height: 1.7;">
            "Being a first-time mom was overwhelming, but having access to proper information 
            and a supportive community made it manageable. My baby boy is now 3 months old 
            and thriving!"
          </p>
        </div>
        
        <div style="margin-bottom: 2rem; padding: 1.5rem; background: rgba(236,64,122,0.05); border-radius: 12px;">
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Meera from Chennai</h4>
          <p style="font-style: italic; color: var(--text-soft); line-height: 1.7;">
            "The antenatal care checklist helped me stay organized throughout my pregnancy. 
            I never missed an important appointment or test. My delivery was smooth and my 
            baby girl is perfect!"
          </p>
        </div>
      </div>
      `,
      [
        {
          text: "Share Your Story",
          primary: true,
          cb: () => {
            alert("Feature coming soon! You'll be able to share your pregnancy journey with the community.");
            ANC.closeModal();
          }
        },
        { text: "Close", cb: () => ANC.closeModal() }
      ]
    );
  };

  /**
   * Find local support groups
   */
  ANC.findLocalGroups = function() {
    ANC.openModal(
      "Find Local Support Groups",
      `
      <div style="margin-bottom: 1.5rem;">
        <p style="margin-bottom: 1rem; color: var(--text-soft);">
          Enter your city to find antenatal care support groups, prenatal classes, 
          and pregnancy support meetups near you.
        </p>
        <input 
          type="text" 
          id="citySearchInput" 
          placeholder="Enter your city name..." 
          style="width: 100%; padding: 0.8rem; border: 2px solid #e0e0e0; border-radius: 12px; 
                 font-family: 'Manrope', sans-serif; margin-bottom: 1rem;"
        />
        <div id="localGroupResults" style="margin-top: 1rem;">
          <p style="color: var(--text-soft); text-align: center;">
            Enter your city to see available groups
          </p>
        </div>
      </div>
      `,
      [
        {
          text: "Search",
          primary: true,
          cb: () => {
            const city = document.getElementById("citySearchInput").value.trim();
            const resultsDiv = document.getElementById("localGroupResults");
            
            if (!city) {
              resultsDiv.innerHTML = '<p style="color: #d32f2f; text-align: center;">Please enter a city name</p>';
              return;
            }
            
            // Simulated search results
            resultsDiv.innerHTML = `
              <div style="padding: 1rem; background: rgba(236,64,122,0.05); border-radius: 12px; margin-bottom: 1rem;">
                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Prenatal Yoga Classes - ${city}</h4>
                <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 0.5rem;">
                  Weekly yoga sessions for expecting mothers. Tuesdays & Thursdays, 6 PM
                </p>
                <p style="color: var(--primary); font-weight: 600; font-size: 0.85rem;">Contact: +91 98765-43210</p>
              </div>
              
              <div style="padding: 1rem; background: rgba(236,64,122,0.05); border-radius: 12px; margin-bottom: 1rem;">
                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Pregnancy Support Group - ${city}</h4>
                <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 0.5rem;">
                  Monthly meetups for expecting mothers. First Saturday of each month, 4 PM
                </p>
                <p style="color: var(--primary); font-weight: 600; font-size: 0.85rem;">Contact: +91 98765-43211</p>
              </div>
              
              <div style="padding: 1rem; background: rgba(236,64,122,0.05); border-radius: 12px;">
                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Lamaze Classes - ${city}</h4>
                <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 0.5rem;">
                  Childbirth preparation classes. Weekend batches available
                </p>
                <p style="color: var(--primary); font-weight: 600; font-size: 0.85rem;">Contact: +91 98765-43212</p>
              </div>
            `;
          }
        },
        { text: "Close", cb: () => ANC.closeModal() }
      ]
    );
  };

})();

</script>
</html>
