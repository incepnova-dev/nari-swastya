<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Gestational Diabetes Journey | Nari Swasthya</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>

<style>

:root {
  --pink: #ec407a;
  --deep-pink: #d81b60;
  --primary: #ec407a;
  --primary-dark: #d81b60;
  --primary-light: #f48fb1;
  --lavender: #ede7f6;
  --bg: #faf5fb;
  --card-bg: #ffffff;
  --text-main: #212121;
  --text-soft: #555;
  --border-soft: #e0e0e0;
  --success: #66bb6a;
  --warning: #ffa726;
  --critical: #ef5350;
  --info: #4fc3f7;
}

/* Track My Levels CTA Button */
.track-levels-cta {
  margin: 3rem auto;
  max-width: 1200px;
  padding: 0 2rem;
}

.comparison-modal-content-new {
  background: white;
  border-radius: 24px;
  padding: 2rem;
  width: 90%;
  max-width: 1200px;
  max-height: 90vh;
  overflow-y: auto;
  position: relative;
}

.modal-header-modern {
  text-align: center;
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 2px solid #f0f0f0;
}

.modal-header-modern h2 {
  margin: 0 0 0.5rem 0;
  color: #ec407a;
  font-size: 2rem;
}

.modal-header-modern p {
  margin: 0;
  color: #666;
  font-size: 1.1rem;
}


.open-tracker-btn {
  width: 100%;
  padding: 2rem 2.5rem;
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 100%);
  border: none;
  border-radius: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 2rem;
  transition: all 0.3s ease;
  box-shadow: 0 8px 32px rgba(236, 64, 122, 0.3);
  position: relative;
  overflow: hidden;
}

.open-tracker-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
  pointer-events: none;
}

.open-tracker-btn:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 48px rgba(236, 64, 122, 0.4);
}

.btn-icon-lg {
  font-size: 4rem;
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
  position: relative;
  z-index: 1;
}

.btn-content {
  flex: 1;
  text-align: left;
  position: relative;
  z-index: 1;
}

.btn-content h3 {
  color: white;
  font-size: 1.8rem;
  margin: 0 0 0.5rem 0;
  font-weight: 700;
}

.btn-content p {
  color: rgba(255, 255, 255, 0.9);
  font-size: 1rem;
  margin: 0;
}

.btn-arrow {
  font-size: 2.5rem;
  color: white;
  transition: transform 0.3s ease;
  position: relative;
  z-index: 1;
}

.open-tracker-btn:hover .btn-arrow {
  transform: translateX(10px);
}

@media (max-width: 768px) {
  .open-tracker-btn {
    padding: 1.5rem;
    flex-direction: column;
    text-align: center;
    gap: 1rem;
  }
  
  .btn-content {
    text-align: center;
  }
  
  .btn-content h3 {
    font-size: 1.4rem;
  }
  
  .btn-icon-lg {
    font-size: 3rem;
  }
  
  .btn-arrow {
    display: none;
  }
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Manrope', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text-main);
  line-height: 1.6;
  overflow-x: hidden;
}

h1, h2, h3 {
  font-family: 'Playfair Display', Georgia, serif;
}

/* ===================== HEADER ===================== */
.site-header{
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(24px);
  -webkit-backdrop-filter:blur(24px);
  padding:0;
  box-shadow:0 2px 24px rgba(236,64,122,0.09);
  position:sticky;top:0;z-index:1000;
  border-bottom:1px solid rgba(236,64,122,0.08);
}
.nav-container{
  max-width:1400px;margin:0 auto;
  padding:0 1.5rem;
  display:flex;justify-content:space-between;align-items:center;
  height:64px;
}
.logo{display:flex;align-items:center;gap:.65rem;flex-shrink:0;}
.logo-icon{
  width:40px;height:40px;border-radius:12px;
  background:linear-gradient(135deg,#ec407a,#ad1457);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 4px 14px rgba(236,64,122,0.35);
  flex-shrink:0;
}
.logo-icon svg{width:22px;height:22px;fill:white;}
.logo-text{display:flex;flex-direction:column;gap:0;}
.logo-text a{
  text-decoration:none;
  font-family:'Playfair Display',serif;
  font-weight:900;font-size:1.25rem;line-height:1.1;
  background:linear-gradient(135deg,#ec407a,#ad1457);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
}
.logo-text span{
  font-size:.62rem;color:var(--text-soft);
  font-family:'Manrope',sans-serif;font-weight:500;
  letter-spacing:.1em;text-transform:uppercase;
}
.main-nav{display:flex;align-items:center;gap:.2rem;}
.nav-item{position:relative;}
.nav-link{
  display:flex;align-items:center;gap:.3rem;
  text-decoration:none;color:var(--text-main);
  font-weight:500;font-size:.875rem;
  padding:.55rem .75rem;border-radius:8px;
  transition:all .25s;white-space:nowrap;
  cursor:pointer;background:none;border:none;font-family:inherit;
}
.nav-link:hover,.nav-link.active{color:var(--deep-pink);background:rgba(236,64,122,0.06);}
.nav-link .chevron{
  font-size:.6rem;transition:transform .25s;
  color:var(--text-soft);margin-top:1px;
}
.nav-item:hover .chevron{transform:rotate(180deg);}
.nav-dropdown{
  position:absolute;top:calc(100% + 8px);left:50%;
  transform:translateX(-50%) translateY(-6px);
  min-width:220px;
  background:white;
  border-radius:16px;
  box-shadow:0 16px 50px rgba(0,0,0,0.12),0 4px 16px rgba(236,64,122,0.1);
  border:1px solid rgba(236,64,122,0.1);
  padding:.5rem;
  opacity:0;pointer-events:none;
  transition:all .25s cubic-bezier(.23,1.01,.32,1);
  z-index:200;
}
.nav-dropdown::before{
  content:'';position:absolute;top:-6px;left:50%;transform:translateX(-50%);
  border:6px solid transparent;border-bottom-color:white;
  border-top:none;filter:drop-shadow(0 -2px 4px rgba(0,0,0,0.06));
}
.nav-item:hover .nav-dropdown,.nav-item:focus-within .nav-dropdown{
  opacity:1;pointer-events:all;
  transform:translateX(-50%) translateY(0);
}
.dd-item{
  display:flex;align-items:center;gap:.75rem;
  padding:.65rem .9rem;border-radius:10px;
  text-decoration:none;color:var(--text-main);
  font-size:.85rem;font-weight:500;
  transition:all .2s;
}
.dd-item:hover{background:rgba(236,64,122,0.07);color:var(--deep-pink);padding-left:1.1rem;}
.dd-icon{
  width:28px;height:28px;border-radius:8px;
  display:flex;align-items:center;justify-content:center;
  font-size:.8rem;flex-shrink:0;
}
.dd-sep{height:1px;background:var(--border-soft);margin:.3rem .5rem;}
.nav-actions{display:flex;gap:.6rem;align-items:center;}
.btn-nav{
  padding:.46rem 1.1rem;border-radius:50px;text-decoration:none;
  font-weight:600;font-size:.82rem;transition:all .3s;border:none;cursor:pointer;
  font-family:inherit;display:inline-flex;align-items:center;gap:.4rem;
}
.btn-nav.outline{
  background:linear-gradient(135deg,#ec407a,#ad1457);
  color:#fff;box-shadow:0 4px 15px rgba(236,64,122,0.3);border:none;
}
.btn-nav.outline:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(236,64,122,0.4);color:#fff;}
.btn-nav.primary{
  border:1.5px solid var(--deep-pink);
  color:var(--deep-pink);background:#fff;box-shadow:none;
}
.btn-nav.primary:hover{background:rgba(236,64,122,0.05);border-color:var(--deep-pink);}
.hamburger{
  display:none;width:38px;height:38px;border-radius:10px;
  background:none;border:1.5px solid var(--border-soft);
  align-items:center;justify-content:center;cursor:pointer;
  flex-direction:column;gap:4px;padding:8px;
}
.hamburger span{display:block;height:2px;background:var(--text-main);border-radius:2px;transition:all .3s;}
.mobile-menu{
  display:none;position:fixed;inset:0;top:64px;
  background:rgba(255,255,255,0.98);backdrop-filter:blur(20px);
  z-index:999;padding:1.5rem;overflow-y:auto;
}
.mobile-menu.open{display:block;}
/* Flyout sub-menus */
.dd-has-flyout{position:relative;cursor:pointer;}
.dd-has-flyout .dd-flyout-arrow{font-size:.55rem;color:var(--text-soft);margin-left:auto;transition:transform .2s;}
.dd-flyout{
  position:absolute;left:calc(100% + 6px);top:0;
  min-width:230px;
  background:white;
  border-radius:14px;
  box-shadow:0 16px 50px rgba(0,0,0,0.12),0 4px 16px rgba(236,64,122,0.1);
  border:1px solid rgba(236,64,122,0.1);
  padding:.4rem;
  opacity:0;pointer-events:none;
  transition:all .22s cubic-bezier(.23,1.01,.32,1);
  z-index:300;
  transform:translateX(-4px);
}
.dd-has-flyout:hover .dd-flyout{opacity:1;pointer-events:all;transform:translateX(0);}
.dd-has-flyout:hover .dd-flyout-arrow{transform:rotate(90deg);color:var(--deep-pink);}
.dd-has-flyout:hover{background:rgba(236,64,122,0.07);color:var(--deep-pink);border-radius:10px;}
.mm-link{
  display:flex;align-items:center;gap:.75rem;
  padding:.85rem 1rem;border-radius:12px;
  text-decoration:none;color:var(--text-main);
  font-weight:500;font-size:1rem;
  transition:all .2s;border-bottom:1px solid var(--border-soft);
}
.mm-link:hover{color:var(--deep-pink);background:rgba(236,64,122,0.05);}
.mm-section{font-size:.72rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.1em;padding:.6rem 1rem .3rem;}
@media(max-width:1060px){.main-nav{display:none;}.hamburger{display:flex;}}
/* Scoped below to nav-actions only — original global rule removed:
   @media(max-width:600px){.btn-nav.outline{display:none;}} */

/* ================================
   PAGE SHELL
   ================================ */
.page-shell {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 2rem;
}

/* ================================
   HERO SECTION
   ================================ */
.hero {
  position: relative;  /* Add this */
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 4rem;
  align-items: center;
  padding: 4rem 0;
  min-height: 85vh;
}

.hero-content {
  animation: slideInLeft 0.8s ease;
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-50px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: linear-gradient(135deg, rgba(255,107,157,0.1), rgba(168,230,207,0.1));
  padding: 0.6rem 1.2rem;
  border-radius: 50px;
  border: 2px solid rgba(255,107,157,0.2);
  margin-bottom: 1.5rem;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

.badge-icon {
  font-size: 1.5rem;
}

.badge-text {
  font-weight: 600;
  color: var(--primary-dark);
  font-size: 0.9rem;
}


/* ---------- ULTRASOUND 3D/4D STAGE ---------- */
.ultra-stage {
  --tiltX: 0deg;
  --tiltY: 0deg;
  --breathe: 1;
  --kick: 0.4;
  --turn: 0.4;
  --wobble: 0.4;
  --hb: 1;
  --push: 0;
  perspective: 900px;
}

.ultra-frame{
  position: relative;
  width: min(520px, 92vw);
  margin: 0 auto;
  padding: 14px 14px 12px;
  border-radius: 22px;
  background: radial-gradient(1200px 600px at 30% 20%, rgba(255,160,210,.35), transparent 60%),
              linear-gradient(135deg, rgba(255,255,255,.12), rgba(0,0,0,.25));
  box-shadow:
    0 18px 50px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.18);
  transform-style: preserve-3d;
}

.baby-svg{
  width: 100%;
  height: auto;
  display: block;
  border-radius: 18px;
  transform: rotateX(var(--tiltX)) rotateY(var(--tiltY)) translateZ(0);
  transform-style: preserve-3d;
  transition: transform 120ms ease;
  will-change: transform;
}

/* HUD */
.ultra-hud{
  position:absolute;
  top: 18px;
  left: 18px;
  right: 18px;
  display:flex;
  justify-content: space-between;
  gap: 12px;
  pointer-events:none;
  transform: translateZ(30px);
}

.hud-left, .hud-right{ display:flex; gap:8px; flex-wrap:wrap; }
.hud-pill{
  font: 600 11px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  letter-spacing: .4px;
  color: rgba(255,255,255,.82);
  padding: 8px 10px;
  border-radius: 999px;
  background: rgba(0,0,0,.32);
  border: 1px solid rgba(255,255,255,.14);
  backdrop-filter: blur(6px);
}

.hud-bar{
  display:inline-block;
  width: 46px;
  height: 7px;
  margin-left: 6px;
  border-radius: 999px;
  background: rgba(255,255,255,.14);
  overflow:hidden;
  vertical-align: middle;
}
.hud-bar i{
  display:block;
  height:100%;
  width: 62%;
  background: linear-gradient(90deg, rgba(255,255,255,.22), rgba(255,160,210,.85));
  animation: hudWobble 2.8s ease-in-out infinite;
}
@keyframes hudWobble{
  0%,100%{ transform: translateX(-6%); opacity: .9; }
  50%{ transform: translateX(10%); opacity: 1; }
}

.ultra-caption{
  margin-top: 10px;
  color: rgba(255,255,255,.78);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  transform: translateZ(20px);
}
.cap-title{ font-weight: 700; font-size: 13px; }
.cap-sub{ font-weight: 500; font-size: 11.5px; opacity: .85; margin-top: 3px; }

/* Scan sweep */
.scan-sweep{
  opacity: .8;
  animation: sweep 3.8s linear infinite;
  mix-blend-mode: screen;
}
@keyframes sweep{
  0%{ transform: translateY(18px); opacity: .25; }
  40%{ opacity: .10; }
  100%{ transform: translateY(252px); opacity: .25; }
}

/* Scene “float” + wobble */
.scene{
  transform-origin: 120px 150px;
  animation: sceneWobble calc(7s / var(--wobble)) ease-in-out infinite;
}
@keyframes sceneWobble{
  0%,100%{ transform: translateY(0px) rotate(-0.4deg); }
  50%{ transform: translateY(-2.8px) rotate(0.6deg); }
}

/* Heartbeat pulse */
.hb{
  transform-origin: center;
  animation: hbPulse calc(0.75s / var(--hb)) ease-in-out infinite;
  filter: drop-shadow(0 0 6px rgba(255,47,122,.45));
}
@keyframes hbPulse{
  0%,100%{ r: 3.2; opacity: .85; }
  50%{ r: 5.2; opacity: 1; }
}

/* Breathing (torso expands slightly) */
.fetus .torso,
.fetus-body{
  transform-origin: 120px 165px;
  animation: breathe calc(4.8s / var(--breathe)) ease-in-out infinite;
}
@keyframes breathe{
  0%,100%{ transform: scale(1); }
  50%{ transform: scale(1.03, 1.05); }
}

/* Kicks / limb motion */
.arm, .leg{
  animation: limb calc(3.4s / max(var(--kick), 0.15)) ease-in-out infinite;
  transform-origin: center;
}
.arm.arm-R{ animation-delay: .4s; }
.leg.leg-R{ animation-delay: .25s; }
@keyframes limb{
  0%,100%{ transform: translate(0,0) rotate(0deg); opacity: .95; }
  30%{ transform: translate(1px,-2px) rotate(-5deg); }
  60%{ transform: translate(-1px,2px) rotate(7deg); }
}

/* Head turn illusion */
.fetus circle:first-child{
  transform-origin: 120px 100px;
  animation: headTurn calc(5.8s / max(var(--turn), 0.15)) ease-in-out infinite;
}
@keyframes headTurn{
  0%,100%{ transform: translateX(0px) scaleX(1); }
  50%{ transform: translateX(2px) scaleX(0.96); }
}

/* 4D sparkles */
.fetus-4d .sparkles circle:nth-child(1){ animation: sparkle 3.2s ease-in-out infinite; }
.fetus-4d .sparkles circle:nth-child(2){ animation: sparkle 3.2s ease-in-out infinite .9s; }
.fetus-4d .sparkles circle:nth-child(3){ animation: sparkle 3.2s ease-in-out infinite 1.6s; }
@keyframes sparkle{
  0%,100%{ opacity: 0; transform: scale(1); }
  35%{ opacity: .85; transform: scale(1.6); }
  55%{ opacity: .25; transform: scale(1.1); }
}

/* 40-week “trying to come out” push */
.fetus-late.term40{
  transform-origin: 120px 200px;
  animation: termDescent 3.6s ease-in-out infinite;
}
@keyframes termDescent{
  0%,100%{ transform: translateY(0px) rotate(0deg); }
  35%{ transform: translateY(6px) rotate(1.5deg); }
  55%{ transform: translateY(10px) rotate(-1.2deg); }
  70%{ transform: translateY(4px) rotate(0.8deg); }
}

.push-layer .contraction{
  animation: contractionWave calc(2.6s / max(var(--push), 0.25)) ease-in-out infinite;
}
.push-layer .contraction:nth-child(2){ animation-delay: .4s; }
@keyframes contractionWave{
  0%,100%{ stroke-opacity: .14; transform: translateY(0px); }
  50%{ stroke-opacity: .55; transform: translateY(-3px); }
}


.hero h1 {
  font-size: clamp(2.2rem, 5vw, 4rem);
  font-weight: 800;
  line-height: 1.1;
  margin-bottom: 1.5rem;
  background: linear-gradient(135deg, #212121 0%, #555 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero h1,
.hero-title-3d {
  font-size: clamp(2.2rem, 5vw, 4rem);
  font-weight: 800;
  line-height: 1.1;
  margin-bottom: 1.5rem;
  background: linear-gradient(135deg, #212121 0%, #555 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.title-emphasis {
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 50%, #ad1457 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  display: inline-block;
  animation: title-shimmer 3s ease-in-out infinite;
  filter: drop-shadow(0 2px 8px rgba(236, 64, 122, 0.3));
}

@keyframes title-shimmer {
  0%, 100% { 
    filter: brightness(1) drop-shadow(0 2px 8px rgba(236, 64, 122, 0.3)); 
  }
  50% { 
    filter: brightness(1.3) drop-shadow(0 4px 16px rgba(236, 64, 122, 0.5)); 
  }
}

.section-subtitle-enhanced {
  font-size: 1.2rem;
  color: var(--text-main);
  max-width: 800px;
  margin: 0 auto 2rem;
  line-height: 1.8;
  text-align: center;
  padding: 1.5rem 2rem;
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.05), rgba(168, 230, 207, 0.05));
  border-radius: 20px;
  border: 2px solid rgba(236, 64, 122, 0.15);
  position: relative;
  animation: subtitle-glow 3s ease-in-out infinite;
}

.section-subtitle-enhanced strong {
  color: var(--primary);
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.subtitle-icon {
  font-size: 1.3rem;
  display: inline-block;
  animation: icon-twinkle 2s ease-in-out infinite;
}

@keyframes subtitle-glow {
  0%, 100% { 
    box-shadow: 0 4px 20px rgba(236, 64, 122, 0.1);
  }
  50% { 
    box-shadow: 0 8px 30px rgba(236, 64, 122, 0.2);
  }
}

@keyframes icon-twinkle {
  0%, 100% { 
    opacity: 1;
    transform: scale(1);
  }
  50% { 
    opacity: 0.6;
    transform: scale(1.2);
  }
}

/* ================================
   PROMINENT SECTION HEADERS
   ================================ */
.header-badge-prominent {
  display: inline-flex;
  align-items: center;
  gap: 0.8rem;
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.1), rgba(168, 230, 207, 0.15));
  padding: 0.8rem 1.8rem;
  border-radius: 50px;
  border: 2px solid rgba(236, 64, 122, 0.3);
  margin-bottom: 2rem;
  box-shadow: 0 4px 20px rgba(236, 64, 122, 0.15);
  animation: badge-float-prominent 3s ease-in-out infinite;
  position: relative;
  overflow: hidden;
}

.header-badge-prominent::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  animation: badge-shine 3s infinite;
}

@keyframes badge-shine {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

@keyframes badge-float-prominent {
  0%, 100% { 
    transform: translateY(0px);
    box-shadow: 0 4px 20px rgba(236, 64, 122, 0.15);
  }
  50% { 
    transform: translateY(-8px);
    box-shadow: 0 8px 30px rgba(236, 64, 122, 0.25);
  }
}

.header-badge-prominent .badge-text {
  font-size: 1rem;
  font-weight: 700;
  color: var(--primary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  position: relative;
  z-index: 1;
}

.section-title-prominent {
  font-size: clamp(2.5rem, 5vw, 3.8rem);
  font-weight: 900;
  line-height: 1.1;
  margin-bottom: 1.5rem;
  background: linear-gradient(135deg, #212121 0%, #555 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  position: relative;
  display: inline-block;
}

.title-highlight {
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 40%, #ad1457 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  display: inline-block;
  animation: title-shimmer-prominent 3s ease-in-out infinite;
  filter: drop-shadow(0 3px 10px rgba(236, 64, 122, 0.4));
  position: relative;
}

@keyframes title-shimmer-prominent {
  0%, 100% { 
    filter: brightness(1) drop-shadow(0 3px 10px rgba(236, 64, 122, 0.4)); 
    transform: scale(1);
  }
  50% { 
    filter: brightness(1.4) drop-shadow(0 5px 20px rgba(236, 64, 122, 0.6)); 
    transform: scale(1.02);
  }
}

.section-subtitle-prominent {
  font-size: 1.25rem;
  color: var(--text-main);
  max-width: 850px;
  margin: 0 auto 2.5rem;
  line-height: 1.9;
  text-align: center;
  padding: 2rem 2.5rem;
  background: linear-gradient(135deg, 
    rgba(236, 64, 122, 0.03), 
    rgba(168, 230, 207, 0.05), 
    rgba(236, 64, 122, 0.03));
  border-radius: 24px;
  border: 2px solid rgba(236, 64, 122, 0.12);
  box-shadow: 
    0 8px 30px rgba(236, 64, 122, 0.08),
    inset 0 2px 0 rgba(255, 255, 255, 0.8);
  position: relative;
  animation: subtitle-glow-prominent 4s ease-in-out infinite;
  backdrop-filter: blur(10px);
}

.section-subtitle-prominent strong {
  color: var(--primary);
  font-weight: 800;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  position: relative;
  padding: 0 0.3rem;
}

.section-subtitle-prominent strong::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--primary), transparent);
  animation: underline-pulse 2s ease-in-out infinite;
}

@keyframes underline-pulse {
  0%, 100% { 
    opacity: 0.3;
    transform: scaleX(0.8);
  }
  50% { 
    opacity: 1;
    transform: scaleX(1);
  }
}

.subtitle-sparkle {
  font-size: 1.4rem;
  display: inline-block;
  animation: sparkle-twinkle 2.5s ease-in-out infinite;
  margin: 0 0.3rem;
}

@keyframes sparkle-twinkle {
  0%, 100% { 
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
  25% { 
    opacity: 0.5;
    transform: scale(1.3) rotate(-15deg);
  }
  50% { 
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
  75% { 
    opacity: 0.5;
    transform: scale(1.3) rotate(15deg);
  }
}

@keyframes subtitle-glow-prominent {
  0%, 100% { 
    box-shadow: 
      0 8px 30px rgba(236, 64, 122, 0.08),
      inset 0 2px 0 rgba(255, 255, 255, 0.8);
    border-color: rgba(236, 64, 122, 0.12);
  }
  50% { 
    box-shadow: 
      0 12px 40px rgba(236, 64, 122, 0.15),
      inset 0 2px 0 rgba(255, 255, 255, 1);
    border-color: rgba(236, 64, 122, 0.25);
  }
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .section-title-prominent {
    font-size: 2rem;
  }
  
  .section-subtitle-prominent {
    font-size: 1.1rem;
    padding: 1.5rem 1.5rem;
  }
  
  .header-badge-prominent {
    padding: 0.6rem 1.2rem;
  }
}



.hero-subtitle {
  font-size: 1.2rem;
  color: var(--text-soft);
  margin-bottom: 2.5rem;
  line-height: 1.8;
}

.hero-stats {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 2rem;
  margin-bottom: 2.5rem;
}

.stat-item {
  text-align: center;
  padding: 1.5rem;
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  transition: transform 0.3s, box-shadow 0.3s;
  border: 2px solid transparent;
}

.stat-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(255,107,157,0.2);
  border-color: var(--primary-light);
}

.stat-number {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
  margin-bottom: 0.5rem;
}

.stat-label {
  display: block;
  font-size: 0.9rem;
  color: var(--text-soft);
  font-weight: 500;
}

.hero-cta-row {
  display: flex;
  gap: 1rem;
}

.btn-primary, .btn-secondary {
  padding: 1rem 2rem;
  border-radius: 50px;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s;
  border: none;
  font-family: 'Manrope', sans-serif;
}

.btn-primary {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem 2.5rem;
  background: linear-gradient(135deg, var(--deep-pink), #f06292);
  color: white;
  border-radius: 50px;
  font-weight: 700;
  font-size: 1.1rem;
  box-shadow: 0 10px 25px rgba(216, 27, 96, 0.3);
  transition: all 0.3s ease;
  animation: float-btn 3s ease-in-out infinite;
  cursor: pointer;
  border: none;
  font-family: 'Manrope', sans-serif;
}

.btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 35px rgba(216, 27, 96, 0.4);
}

@keyframes float-btn {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}


.btn-secondary {
  background: white;
  color: var(--primary);
  border: 2px solid var(--primary);
}

.btn-secondary:hover {
  background: var(--primary);
  color: white;
}

/* ================================
   HERO VISUAL 3D
   ================================ */
.hero-visual-3d {
  position: relative;
  animation: slideInRight 0.8s ease;
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(50px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.pregnancy-3d-container {
  position: relative;
  width: 100%;
  height: 500px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pregnancy-core {
  position: relative;
  width: 450px;
  height: 450px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.mother-silhouette {
  position: relative;
  z-index: 2;
}

.mother-icon {
  width: 200px;
  height: 300px;
  filter: drop-shadow(0 10px 30px rgba(255,107,157,0.3));
  animation: breathe 4s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}


/* Detailed Woman SVG Styles */
.mother-icon-detailed {
  filter: drop-shadow(0 10px 30px rgba(255,107,157,0.3));
  animation: breathe 4s ease-in-out infinite;
}

.body-part-skin {
  transition: fill 0.3s ease;
}

.body-part-hair {
  transition: fill 0.3s ease;
}

.body-part-dress,
.body-part-belly,
.body-part-skirt {
  transition: fill 0.3s ease, stroke 0.3s ease;
}

.body-part-hands,
.body-part-feet {
  transition: fill 0.3s ease;
}

/* Simulation Organ Glow Effects */
.sim-organ-glow {
  transition: opacity 0.5s ease;
}


.pulse-ring {
  position: absolute;
  border-radius: 50%;
  animation: pulse-3d 4s ease-out infinite;
  border: 4px solid var(--primary-light);
  box-shadow: 
    0 0 20px rgba(236, 64, 122, 0.3),
    0 10px 40px rgba(0, 0, 0, 0.2);
  transform-style: preserve-3d;
  transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes pulse-3d {
  0% {
    transform: scale(0.7) translateZ(0);
    opacity: 0;
  }
  50% {
    transform: scale(1) translateZ(50px);
    opacity: 0.6;
  }
  100% {
    transform: scale(1.3) translateZ(0);
    opacity: 0;
  }
}

/* Highlight animation for clicked cards */
@keyframes highlight-pulse {
  0%, 100% { 
    box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
    transform: scale(1);
  }
  50% { 
    box-shadow: 0 8px 40px rgba(236, 64, 122, 0.4); 
    transform: scale(1.02);
  }
}

.highlight-pulse {
  animation: highlight-pulse 1s ease-in-out 2;
}


.pulse-ring:hover {
  animation-play-state: paused;
  border-width: 6px;
  box-shadow: 
    0 0 40px rgba(236, 64, 122, 0.6),
    inset 0 0 30px rgba(236, 64, 122, 0.2);
}

.ring-1 {
  width: 180px;
  height: 180px;
  animation-delay: 0s;
  background: linear-gradient(white, white) padding-box,
              linear-gradient(135deg, #ff6b9d, #ffc3a0) border-box;
}

.ring-2 {
  width: 280px;
  height: 280px;
  animation-delay: 1.3s;
  background: linear-gradient(white, white) padding-box,
              linear-gradient(135deg, #ec407a, #f48fb1) border-box;
}

.ring-3 {
  width: 380px;
  height: 380px;
  animation-delay: 2.6s;
  background: linear-gradient(white, white) padding-box,
              linear-gradient(135deg, #d81b60, #ec407a) border-box;
}

/* Enhanced pulse animation with smooth transitions */
@keyframes pulse {
  0% {
    transform: scale(0.7);
    opacity: 0;
    filter: blur(0px);
  }
  20% {
    opacity: 0.8;
  }
  50% {
    opacity: 0.6;
    filter: blur(2px);
  }
  80% {
    opacity: 0.3;
  }
  100% {
    transform: scale(1.3);
    opacity: 0;
    filter: blur(4px);
  }
}

/* Add a rotate animation on hover */
@keyframes rotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.pulse-ring:hover {
  animation: pulse 4s ease-out infinite, rotate 20s linear infinite;
}

@keyframes wave-pulse {
  0% {
    transform: scale(0.7) translateY(0);
    opacity: 0;
  }
  25% {
    transform: scale(0.85) translateY(-10px);
    opacity: 0.6;
  }
  50% {
    transform: scale(1) translateY(-5px);
    opacity: 0.8;
  }
  75% {
    transform: scale(1.15) translateY(5px);
    opacity: 0.4;
  }
  100% {
    transform: scale(1.3) translateY(0);
    opacity: 0;
  }
}

@keyframes rainbow-glow {
  0% {
    border-color: #ff6b9d;
    box-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
  }
  25% {
    border-color: #f48fb1;
    box-shadow: 0 0 20px rgba(244, 143, 177, 0.5);
  }
  50% {
    border-color: #a8e6cf;
    box-shadow: 0 0 20px rgba(168, 230, 207, 0.5);
  }
  75% {
    border-color: #ffc3a0;
    box-shadow: 0 0 20px rgba(255, 195, 160, 0.5);
  }
  100% {
    border-color: #ff6b9d;
    box-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
  }
}

.pulse-ring {
  animation: pulse 4s ease-out infinite, rainbow-glow 8s linear infinite;
}


/* Apply to rings */
.pulse-ring {
  animation: wave-pulse 4s ease-out infinite;
}



/* Center Glow Effect - Replaces the human body */
.center-glow {
  position: absolute;
  width: 100px;
  height: 100px;
  border-radius: 50%;
  background: radial-gradient(
    circle at center,
    rgba(236, 64, 122, 0.8) 0%,
    rgba(236, 64, 122, 0.4) 40%,
    rgba(236, 64, 122, 0.1) 70%,
    transparent 100%
  );
  box-shadow: 
    0 0 60px rgba(236, 64, 122, 0.6),
    0 0 100px rgba(236, 64, 122, 0.4),
    inset 0 0 40px rgba(255, 255, 255, 0.3);
  animation: glow 3s ease-in-out infinite;
  z-index: 1;
  pointer-events: none;
}

@keyframes glow {
  0%, 100% {
    transform: scale(1);
    opacity: 0.8;
    box-shadow: 
      0 0 60px rgba(236, 64, 122, 0.6),
      0 0 100px rgba(236, 64, 122, 0.4),
      inset 0 0 40px rgba(255, 255, 255, 0.3);
  }
  50% {
    transform: scale(1.2);
    opacity: 1;
    box-shadow: 
      0 0 80px rgba(236, 64, 122, 0.8),
      0 0 120px rgba(236, 64, 122, 0.6),
      inset 0 0 50px rgba(255, 255, 255, 0.5);
  }
}

/* Add particle effect around center glow */
.center-glow::before,
.center-glow::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  top: 0;
  left: 0;
  background: radial-gradient(
    circle at center,
    rgba(236, 64, 122, 0.3) 0%,
    transparent 70%
  );
  animation: particle-float 4s ease-in-out infinite;
}

.center-glow::after {
  animation-delay: 2s;
  animation-direction: reverse;
}

@keyframes particle-float {
  0%, 100% {
    transform: scale(0.8) translateY(0);
    opacity: 0;
  }
  50% {
    transform: scale(1.5) translateY(-20px);
    opacity: 0.5;
  }
}


.health-icon {
  position: absolute;
  background: white;
  padding: 1.2rem 1.5rem;
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(236, 64, 122, 0.25);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  z-index: 3;
  border: 2px solid rgba(236, 64, 122, 0.15);
  transition: all 0.4s ease;
  cursor: pointer;
}

.health-icon:hover {
  transform: scale(1.1) !important;
  box-shadow: 0 15px 40px rgba(236, 64, 122, 0.35);
  border-color: var(--primary);
}
.icon-inner {
  font-size: 2rem;
}

.icon-label {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-soft);
  white-space: nowrap;
}

.icon-1 {
  animation: orbit1 15s ease-in-out infinite;
}

.icon-2 {
  animation: orbit2 18s ease-in-out infinite;
}

.icon-3 {
  animation: orbit3 20s ease-in-out infinite;
}

.icon-4 {
  animation: orbit4 22s ease-in-out infinite;
}

.icon-5 {
  animation: orbit5 17s ease-in-out infinite;
}


/* Position icons along the radiating circle boundaries */
/* Position icons along the radiating circle boundaries - avoiding bottom center */
@keyframes orbit1 {
  0%, 100% { 
    transform: translate(-190px, 0px) rotate(0deg);  /* Left */
  }
  25% { 
    transform: translate(-195px, -10px) rotate(3deg); 
  }
  50% { 
    transform: translate(-190px, 0px) rotate(0deg); 
  }
  75% { 
    transform: translate(-185px, 10px) rotate(-3deg); 
  }
}

@keyframes orbit2 {
  0%, 100% { 
    transform: translate(-134px, -134px) rotate(0deg);  /* Top Left */
  }
  25% { 
    transform: translate(-139px, -139px) rotate(-3deg); 
  }
  50% { 
    transform: translate(-134px, -134px) rotate(0deg); 
  }
  75% { 
    transform: translate(-129px, -129px) rotate(3deg); 
  }
}

@keyframes orbit3 {
  0%, 100% { 
    transform: translate(134px, -134px) rotate(0deg);  /* Top Right */
  }
  25% { 
    transform: translate(139px, -139px) rotate(3deg); 
  }
  50% { 
    transform: translate(134px, -134px) rotate(0deg); 
  }
  75% { 
    transform: translate(129px, -129px) rotate(-3deg); 
  }
}

@keyframes orbit4 {
  0%, 100% { 
    transform: translate(190px, 0px) rotate(0deg);  /* Right */
  }
  25% { 
    transform: translate(195px, 10px) rotate(-3deg); 
  }
  50% { 
    transform: translate(190px, 0px) rotate(0deg); 
  }
  75% { 
    transform: translate(185px, -10px) rotate(3deg); 
  }
}

@keyframes orbit5 {
  0%, 100% { 
    transform: translate(-134px, 134px) rotate(0deg);  /* Bottom Left */
  }
  25% { 
    transform: translate(-139px, 139px) rotate(3deg); 
  }
  50% { 
    transform: translate(-134px, 134px) rotate(0deg); 
  }
  75% { 
    transform: translate(-129px, 129px) rotate(-3deg); 
  }
}

/* ================================
   DAILY TIP SECTION
   ================================ */
.daily-tip {
  max-width: 900px;
  margin: 2rem auto;
  padding: 1.5rem 2rem;
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
  border-radius: 16px;
  border-left: 6px solid #ffa726;
  display: flex;
  align-items: center;
  gap: 1.5rem;
  box-shadow: 0 4px 15px rgba(255, 167, 38, 0.2);
  animation: slideInFromTop 0.6s ease;
}

@keyframes slideInFromTop {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.tip-icon {
  font-size: 2.5rem;
  flex-shrink: 0;
  animation: pulse-tip 2s ease-in-out infinite;
}

@keyframes pulse-tip {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.daily-tip p {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: #f57c00;
  line-height: 1.6;
}


.glucose-meter {
  position: absolute;
  bottom: 20px;
  right: 30px;  /* Move to right side instead of center */
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.15);
  width: 200px;
  text-align: center;
  z-index: 4;
}

.meter-reading {
  margin-bottom: 0.5rem;
}

.reading-value {
  font-size: 2.5rem;
  font-weight: 800;
  color: var(--success);
  font-family: 'Playfair Display', serif;
}

.reading-unit {
  font-size: 0.9rem;
  color: var(--text-soft);
  margin-left: 0.3rem;
}

.meter-status {
  font-size: 0.8rem;
  font-weight: 600;
  padding: 0.3rem 0.8rem;
  border-radius: 50px;
  margin-bottom: 0.8rem;
  display: inline-block;
}

.status-normal {
  background: rgba(16, 172, 132, 0.1);
  color: var(--success);
}

.meter-bar {
  width: 100%;
  height: 8px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
}

.meter-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--success), var(--secondary));
  width: 35%;
  border-radius: 10px;
  animation: fillMeter 2s ease-in-out;
}

@keyframes fillMeter {
  from { width: 0%; }
  to { width: 35%; }
}

.hero-info-box {
  margin-top: 2rem;
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.1);
  border-left: 5px solid var(--primary);
}

.info-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: rgba(255,107,157,0.1);
  padding: 0.5rem 1rem;
  border-radius: 50px;
  margin-bottom: 1rem;
}

.info-title {
  font-size: 1.5rem;
  margin-bottom: 0.8rem;
  color: var(--primary-dark);
}

.info-text {
  color: var(--text-soft);
  line-height: 1.7;
}

/* ================================
   JOURNEY TIMELINE
   ================================ */
.journey-section {
  padding: 3rem 0;
  background: linear-gradient(135deg, rgba(236,64,122,0.05), rgba(237,231,246,0.05));
  border-radius: 30px;
  margin: 2rem 0;
}

.section-header {
  text-align: center;
  margin-bottom: 4rem;
}

.header-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: white;
  padding: 0.6rem 1.2rem;
  border-radius: 50px;
  border: 2px solid var(--primary-light);
  margin-bottom: 1.5rem;
}

.badge-pulse {
  width: 10px;
  height: 10px;
  background: var(--primary);
  border-radius: 50%;
  animation: pulse-dot 2s ease-in-out infinite;
}

@keyframes pulse-dot {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.3); }
}

.section-title {
  font-size: 3rem;
  margin-bottom: 1rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.section-subtitle {
  font-size: 1.1rem;
  color: var(--text-soft);
  max-width: 700px;
  margin: 0 auto;
  line-height: 1.7;
}

.timeline-container {
  position: relative;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 2rem;
  padding: 2rem 0;
}

.timeline-rail {
  position: absolute;
  top: 50%;
  left: 10%;
  right: 10%;
  height: 4px;
  background: linear-gradient(90deg, var(--primary-light), var(--secondary));
  transform: translateY(-50%);
  z-index: 0;
}

.timeline-stage {
  position: relative;
  text-align: center;
  cursor: pointer;
  transition: transform 0.3s;
  z-index: 1;
}

.timeline-stage:hover {
  transform: scale(1.05);
}

.stage-marker {
  position: relative;
  width: 80px;
  height: 80px;
  margin: 0 auto 1.5rem;
}

.marker-dot {
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg, #ff6b9d 0%, #ec407a 50%, #d81b60 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5rem;  /* Increased from 2rem */
  font-weight: 900;  /* Increased from 800 */
  color: white;
  box-shadow: 
    0 8px 25px rgba(255, 107, 157, 0.4),
    0 0 0 4px rgba(255, 107, 157, 0.2),
    inset 0 2px 0 rgba(255, 255, 255, 0.3);
  transition: all 0.3s;
  font-family: 'Playfair Display', serif;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  position: relative;
  overflow: hidden;
}

/* Add shimmer effect to numbers */
.marker-dot::before {
  content: '';
  position: absolute;
  inset: -50%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  animation: number-shine 3s infinite;
}

@keyframes number-shine {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

.timeline-stage:hover .marker-dot {
  box-shadow: 
    0 12px 35px rgba(255, 107, 157, 0.5),
    0 0 0 6px rgba(255, 107, 157, 0.3),
    inset 0 2px 0 rgba(255, 255, 255, 0.5);
  transform: scale(1.15) rotate(5deg);
}



/* Individual bright colors for each trimester */
.timeline-stage:nth-child(1) .marker-dot {
  background: linear-gradient(135deg, #4caf50 0%, #66bb6a 50%, #81c784 100%);
  box-shadow: 0 8px 25px rgba(76, 175, 106, 0.4), 0 0 0 4px rgba(76, 175, 106, 0.2);
}

.timeline-stage:nth-child(2) .marker-dot {
  background: linear-gradient(135deg, #ff9800 0%, #ffa726 50%, #ffb74d 100%);
  box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4), 0 0 0 4px rgba(255, 152, 0, 0.2);
}

.timeline-stage:nth-child(3) .marker-dot {
  background: linear-gradient(135deg, #9c27b0 0%, #ab47bc 50%, #ba68c8 100%);
  box-shadow: 0 8px 25px rgba(156, 39, 176, 0.4), 0 0 0 4px rgba(156, 39, 176, 0.2);
}

.timeline-stage:nth-child(4) .marker-dot {
  background: linear-gradient(135deg, #2196f3 0%, #42a5f5 50%, #64b5f6 100%);
  box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4), 0 0 0 4px rgba(33, 150, 243, 0.2);
}

.timeline-stage:hover .marker-dot {
  transform: scale(1.15) rotate(5deg);
}


.timeline-stage:hover .marker-dot {
  box-shadow: 0 12px 35px rgba(255,107,157,0.4);
  transform: scale(1.1);
}

.marker-pulse {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: 3px solid var(--primary);
  border-radius: 50%;
  animation: pulse-marker 2s ease-out infinite;
}

@keyframes pulse-marker {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  100% {
    transform: scale(1.3);
    opacity: 0;
  }
}

.stage-content {
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  transition: all 0.3s;
}

.timeline-stage:hover .stage-content {
  box-shadow: 0 8px 30px rgba(255,107,157,0.2);
  border: 2px solid var(--primary-light);
}

.stage-title {
  font-size: 1.3rem;
  margin-bottom: 0.5rem;
  color: var(--primary-dark);
}

.stage-weeks {
  font-size: 0.9rem;
  color: var(--text-soft);
  font-weight: 600;
  margin-bottom: 0.8rem;
}

.stage-desc {
  font-size: 0.95rem;
  color: var(--text-soft);
  line-height: 1.5;
  margin-bottom: 1rem;
}

.stage-icon {
  font-size: 3rem;
  opacity: 0.3;
}

/* ================================
   TOPICS EXPLORER
   ================================ */
.topics-explorer {
  padding: 3rem 0;
  margin: 2rem 0;
}

.topics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 2rem;
}

.topic-card {
  background: white;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
}

.topic-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.15);
  border-color: var(--primary-light);
}

.topic-header {
  position: relative;
  padding: 2rem;
  color: white;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.topic-icon {
  font-size: 3rem;
  filter: drop-shadow(0 4px 10px rgba(0,0,0,0.2));
}

.topic-number {
  font-size: 3rem;
  font-weight: 800;
  opacity: 0.3;
  font-family: 'Playfair Display', serif;
}

.topic-body {
  padding: 1.5rem 2rem;
}

.topic-title {
  font-size: 1.4rem;
  margin-bottom: 0.8rem;
  color: var(--text-main);
  line-height: 1.3;
}

.topic-preview {
  font-size: 0.95rem;
  color: var(--text-soft);
  line-height: 1.6;
  margin-bottom: 1rem;
}

.topic-tags {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.tag {
  background: rgba(255,107,157,0.1);
  color: var(--primary-dark);
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
}

.topic-footer {
  padding: 1rem 2rem;
  border-top: 1px solid #f0f0f0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.read-time {
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 500;
}

.topic-arrow {
  font-size: 1.5rem;
  color: var(--primary);
  transition: transform 0.3s;
}

.topic-card:hover .topic-arrow {
  transform: translateX(5px);
}

/* ================================
   TRACKER SECTION
   ================================ */
.tracker-section {
  padding: 3rem 0;
  background: white;
  border-radius: 30px;
  margin: 2rem 0;
}

/* Simulation Controls */
.simulation-controls {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin: 3rem 0 2rem;
  flex-wrap: wrap;
}

.sim-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  padding: 1.5rem 2rem;
  background: white;
  border: 3px solid #e0e0e0;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.3s;
  font-family: 'Manrope', sans-serif;
}

.sim-btn:hover {
  border-color: var(--primary);
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(255,107,157,0.2);
}

.sim-btn.active {
  border-color: var(--primary);
  background: linear-gradient(135deg, rgba(255,107,157,0.1), rgba(168,230,207,0.1));
  box-shadow: 0 4px 15px rgba(255,107,157,0.2);
}

.sim-icon {
  font-size: 2rem;
}

.sim-label {
  font-weight: 600;
  color: var(--text-main);
  font-size: 0.95rem;
}

/* Simulation Dashboard */
.simulation-dashboard {
  display: grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap: 2rem;
  margin-top: 2rem;
}

/* Body Simulation Container */
.body-simulation-container {
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  padding: 2rem;
  border-radius: 20px;
  position: relative;
}

.sim-body-visual {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 600px; /* ADD THIS */
}

#bodySimulationSvg {
  max-width: 400px;
  width: 100%;
  height: auto;
}

/* Particle System */
.particle-system {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 5;
}

.sim-particle {
  position: absolute;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  animation: particleFloat 4s ease-in-out infinite;
}

.glucose-particle {
  background: radial-gradient(circle, #ffd93d, #f5a623);
  box-shadow: 0 0 15px rgba(255, 217, 61, 0.6);
  animation: particleFloat 3s ease-in-out infinite, particleGlow 2s ease-in-out infinite;
}

.insulin-particle {
  background: radial-gradient(circle, #4facfe, #00f2fe);
  box-shadow: 0 0 15px rgba(79, 172, 254, 0.6);
  animation: particleFloat 4s ease-in-out infinite 0.5s, particleGlow 2s ease-in-out infinite 0.5s;
}

@keyframes particleFloat {
  0%, 100% { transform: translate(0, 0) scale(1); }
  25% { transform: translate(10px, -15px) scale(1.1); }
  50% { transform: translate(-5px, -25px) scale(0.9); }
  75% { transform: translate(-10px, -10px) scale(1.05); }
}

@keyframes particleGlow {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

/* Organ Labels */
.organ-labels {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  pointer-events: none;
}

.organ-label {
  position: absolute;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: white;
  padding: 0.6rem 1rem;
  border-radius: 12px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
  border: 2px solid var(--primary-light);
  animation: labelPulse 3s ease-in-out infinite;
}

@keyframes labelPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.label-dot {
  width: 10px;
  height: 10px;
  background: var(--primary);
  border-radius: 50%;
  animation: dotPulse 1.5s ease-in-out infinite;
}

@keyframes dotPulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.4); opacity: 0.7; }
}

.label-text {
  display: flex;
  flex-direction: column;
}

.label-text strong {
  font-size: 0.85rem;
  color: var(--text-main);
}

.label-status {
  font-size: 0.75rem;
  color: var(--text-soft);
  font-weight: 600;
}

/* Scenario Description */
.scenario-description {
  margin-bottom: 1.5rem;  /* Changed from margin-top */
  background: white;
  padding: 1.5rem;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  border-left: 4px solid var(--primary);  /* Add accent */
}

.scenario-description h4 {
  font-size: 1.3rem;
  color: var(--primary-dark);
  margin-bottom: 0.8rem;
  font-weight: 700;
}

.scenario-description p {
  color: var(--text-main);  /* Changed from text-soft for better readability */
  line-height: 1.7;
  font-size: 1rem;
}


/* Metrics Dashboard */
.metrics-dashboard {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.metric-card {
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  border: 2px solid transparent;
  transition: all 0.3s;
}

.metric-card:hover {
  border-color: var(--primary-light);
  box-shadow: 0 8px 30px rgba(255,107,157,0.15);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.card-header h3 {
  font-size: 1.1rem;
  color: var(--text-main);
}

.live-indicator {
  display: flex;
  align-items: center;
  gap: 0.4rem;
  font-size: 0.75rem;
  font-weight: 700;
  color: #10ac84;
}

.live-dot {
  width: 8px;
  height: 8px;
  background: #10ac84;
  border-radius: 50%;
  animation: livePulse 1.5s ease-in-out infinite;
}

@keyframes livePulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.3); }
}

/* Glucose Display */
.glucose-display {
  text-align: center;
  margin-bottom: 1rem;
}

.glucose-reading {
  display: flex;
  align-items: baseline;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.glucose-reading .reading-value {
  font-size: 3rem;
  font-weight: 800;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.glucose-reading .reading-unit {
  font-size: 1.1rem;
  color: var(--text-soft);
}

.glucose-status {
  display: inline-block;
  padding: 0.4rem 1rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  background: rgba(16, 172, 132, 0.1);
  color: var(--success);
}

#glucoseTrendChart {
  width: 100%;
  height: auto;
}

/* Hormone Meters */
.hormones-card {
  background: linear-gradient(135deg, rgba(255,107,157,0.05), rgba(168,230,207,0.05));
}

.hormone-meter {
  display: flex;
  flex-direction: column;
  gap: 1.2rem;
}

.hormone-item {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.hormone-label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.hormone-icon {
  font-size: 1.2rem;
}

.hormone-name {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-main);
}

.hormone-bar-container {
  position: relative;
  width: 100%;
  height: 12px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
}

.hormone-bar {
  height: 100%;
  border-radius: 10px;
  transition: width 0.8s ease;
  position: relative;
  overflow: hidden;
}

.hormone-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.hormone-value {
  position: absolute;
  right: 0.5rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--text-main);
}

/* Resistance Gauge */
.resistance-card {
  text-align: center;
}

.resistance-gauge {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem 0;
}

#resistanceGauge {
  width: 100%;
  max-width: 200px;
  height: auto;
}

.gauge-value {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -20%);
  font-size: 2.5rem;
  font-weight: 800;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.gauge-label {
  margin-top: 0.5rem;
  padding: 0.4rem 1rem;
  border-radius: 20px;
  font-size: 0.9rem;
  font-weight: 600;
  background: rgba(255,107,157,0.1);
  color: var(--primary-dark);
}

/* Parameters Panel */
.parameters-panel {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* Quick Stats */
.quick-stats {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.stat-box {
  display: flex;
  align-items: center;
  gap: 1rem;
  background: white;
  padding: 1.2rem;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  transition: all 0.3s;
}

.stat-box:hover {
  transform: translateX(5px);
  box-shadow: 0 6px 20px rgba(255,107,157,0.15);
}

.stat-box .stat-icon {
  font-size: 2rem;
  background: linear-gradient(135deg, rgba(255,107,157,0.1), rgba(168,230,207,0.1));
  padding: 0.8rem;
  border-radius: 12px;
}

.stat-content {
  flex: 1;
}

.stat-label {
  font-size: 0.8rem;
  color: var(--text-soft);
  margin-bottom: 0.3rem;
  font-weight: 600;
}

.stat-value {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-main);
}

/* Systems Status */
.systems-status {
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.systems-status h4 {
  font-size: 1.1rem;
  margin-bottom: 1.2rem;
  color: var(--text-main);
}

.system-item {
  margin-bottom: 1.2rem;
}

.system-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.system-name {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-main);
}

.system-status {
  font-size: 0.75rem;
  font-weight: 700;
  padding: 0.3rem 0.7rem;
  border-radius: 12px;
}

.status-good {
  background: rgba(16, 172, 132, 0.1);
  color: var(--success);
}

.status-warning {
  background: rgba(243, 156, 18, 0.1);
  color: #f39c12;
}

.system-bar {
  width: 100%;
  height: 8px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
}

.system-fill {
  height: 100%;
  border-radius: 10px;
  transition: width 0.8s ease;
}

/* Time Tracker */
.time-tracker {
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.time-tracker h4 {
  font-size: 1.1rem;
  margin-bottom: 1rem;
  color: var(--text-main);
}

.time-display {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
}

.time-icon {
  font-size: 2rem;
}

.time-info {
  flex: 1;
}

.time-elapsed {
  font-size: 1.8rem;
  font-weight: 800;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.time-label {
  font-size: 0.8rem;
  color: var(--text-soft);
  font-weight: 600;
}

.time-events {
  margin-top: 1rem;
}

.event-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  padding: 0.8rem;
  background: rgba(255,107,157,0.05);
  border-radius: 12px;
}

.event-dot {
  width: 8px;
  height: 8px;
  background: var(--primary);
  border-radius: 50%;
  flex-shrink: 0;
}

.event-text {
  font-size: 0.9rem;
  color: var(--text-main);
  font-weight: 600;
}

/* Simulation Legend */
.simulation-legend {
  background: white;
  padding: 1.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.simulation-legend h4 {
  font-size: 1.1rem;
  margin-bottom: 1rem;
  color: var(--text-main);
}

.legend-items {
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-soft);
}

.legend-color {
  width: 20px;
  height: 20px;
  border-radius: 6px;
  flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

/* Tracker Tools Row */
.tracker-tools-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 3rem;
}

.tracker-container {
  display: grid;
  grid-template-columns: 1.5fr 1fr;
  gap: 3rem;
  margin-top: 3rem;
}

.tracker-visual {
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  padding: 2rem;
  border-radius: 20px;
}

.glucose-chart {
  background: white;
  padding: 2rem;
  border-radius: 16px;
  margin-bottom: 2rem;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.target-ranges h3 {
  margin-bottom: 1.5rem;
  color: var(--text-main);
  font-size: 1.3rem;
}

.range-item {
  background: white;
  padding: 1.5rem;
  border-radius: 16px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.range-label {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  margin-bottom: 0.8rem;
}

.range-icon {
  font-size: 1.5rem;
}

.range-name {
  font-weight: 600;
  color: var(--text-main);
  font-size: 1rem;
}

.range-value {
  display: flex;
  align-items: baseline;
  gap: 0.5rem;
  margin-bottom: 0.8rem;
}

.target-number {
  font-size: 2rem;
  font-weight: 800;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.target-unit {
  font-size: 0.9rem;
  color: var(--text-soft);
}

.range-bar {
  width: 100%;
  height: 10px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
}

.range-fill {
  height: 100%;
  border-radius: 10px;
  animation: fillRange 1.5s ease-in-out;
}

@keyframes fillRange {
  from { width: 0%; }
}

.tracker-tools {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.tool-card {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  transition: all 0.3s;
  border: 2px solid transparent;
}

.tool-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(255,107,157,0.2);
  border-color: var(--primary-light);
}

.tool-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.tool-card h3 {
  font-size: 1.3rem;
  margin-bottom: 0.8rem;
  color: var(--primary-dark);
}

.tool-card p {
  color: var(--text-soft);
  margin-bottom: 1.5rem;
  line-height: 1.6;
}

.tool-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  width: 100%;
}

.tool-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255,107,157,0.3);
}

/* ================================
   MEAL PLANNER
   ================================ */
.meal-planner-section {
  padding: 3rem 0;
  margin: 2rem 0;
}

.meal-planner-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 3rem;
  margin-top: 3rem;
}

.plate-builder {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.virtual-plate {
  width: min(350px, 90vw);
  height: min(350px, 90vw);
  margin: 0 auto 2rem;
  border-radius: 50%;
  border: 10px solid #f0f0f0;
  display: grid;
  grid-template-areas:
    "veggies veggies"
    "protein carbs";
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.plate-section {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  transition: all 0.3s;
}

.plate-section:hover {
  transform: scale(1.05);
}

.vegetables {
  grid-area: veggies;
  background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
}

.protein {
  grid-area: protein;
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
}

.carbs {
  grid-area: carbs;
  background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);
}

.section-label {
  color: white;
  font-weight: 700;
  text-align: center;
  font-size: 1.1rem;
  text-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.plate-info {
  text-align: center;
}

.plate-info h3 {
  font-size: 1.5rem;
  margin-bottom: 0.8rem;
  color: var(--primary-dark);
}

.plate-info p {
  color: var(--text-soft);
  margin-bottom: 1.5rem;
}

.nutrition-summary {
  display: flex;
  justify-content: space-around;
  gap: 1rem;
}

.nutrition-item {
  text-align: center;
  padding: 1rem;
  background: linear-gradient(135deg, rgba(255,107,157,0.05), rgba(168,230,207,0.05));
  border-radius: 12px;
  flex: 1;
}

.nutrition-label {
  display: block;
  font-size: 0.85rem;
  color: var(--text-soft);
  margin-bottom: 0.5rem;
  font-weight: 600;
}

.nutrition-value {
  display: block;
  font-size: 1.2rem;
  font-weight: 800;
  color: var(--success);
}

.food-selector {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.food-category {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.category-title {
  font-size: 1.3rem;
  margin-bottom: 1.5rem;
  color: var(--text-main);
}

.food-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
}

.food-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
}

.food-item.good {
  background: rgba(16, 172, 132, 0.05);
}

.food-item.good:hover {
  background: rgba(16, 172, 132, 0.1);
  border-color: var(--success);
  transform: translateY(-3px);
}

.food-item.avoid {
  background: rgba(238, 90, 111, 0.05);
}

.food-item.avoid:hover {
  background: rgba(238, 90, 111, 0.1);
  border-color: var(--warning);
  transform: translateY(-3px);
}

.food-icon {
  font-size: 2rem;
}

.food-name {
  font-size: 0.85rem;
  font-weight: 600;
  text-align: center;
  color: var(--text-main);
}

/* ================================
   COMMUNITY SECTION
   ================================ */
.community-section {
  padding: 3rem 0;
  background: linear-gradient(135deg, rgba(237,231,246,0.1), rgba(236,64,122,0.1));
  border-radius: 30px;
  margin: 2rem 0;
}

.community-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2rem;
  margin-top: 3rem;
}

.community-card {
  background: white;
  padding: 2.5rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  text-align: center;
  transition: all 0.3s;
  border: 2px solid transparent;
}

.community-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 40px rgba(255,107,157,0.2);
  border-color: var(--primary-light);
}

.card-icon {
  font-size: 4rem;
  margin-bottom: 1.5rem;
}

.community-card h3 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
  color: var(--primary-dark);
}

.community-card p {
  color: var(--text-soft);
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.community-stats {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.stat {
  background: rgba(255,107,157,0.1);
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--primary-dark);
}

.community-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  width: 100%;
}

.community-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255,107,157,0.3);
}

/* ================================
   RESOURCES SECTION
   ================================ */
.resources-section {
  padding: 3rem 0;
  margin: 2rem 0;
}

.resources-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 2rem;
  margin-top: 3rem;
}

.resource-card {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  text-align: center;
  transition: all 0.3s;
  border: 2px solid transparent;
}

.resource-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(255,107,157,0.2);
  border-color: var(--primary-light);
}

.resource-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.resource-card h3 {
  font-size: 1.2rem;
  margin-bottom: 0.8rem;
  color: var(--text-main);
}

.resource-card p {
  color: var(--text-soft);
  margin-bottom: 1.5rem;
  font-size: 0.9rem;
}

.download-btn {
  padding: 0.7rem 1.3rem;
  background: white;
  color: var(--primary);
  border: 2px solid var(--primary);
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  width: 100%;
}

.download-btn:hover {
  background: var(--primary);
  color: white;
}

/* ================================
   TOPIC PANEL (Side Panel)
   ================================ */
.topic-panel {
  position: fixed;
  top: 0;
  right: -100%;
  width: 90%;
  max-width: 800px;
  height: 100vh;
  background: white;
  box-shadow: -10px 0 50px rgba(0,0,0,0.2);
  z-index: 10000;
  transition: right 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  overflow-y: auto;
}

.topic-panel.active {
  right: 0;
}

.close-panel {
  position: absolute;
  top: 2rem;
  right: 2rem;
  width: 50px;
  height: 50px;
  background: rgba(255,107,157,0.1);
  border: none;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.3s;
  color: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.close-panel:hover {
  background: var(--primary);
  color: white;
  transform: rotate(90deg);
}

.panel-scroll {
  padding: 3rem 2.5rem;
}

.panel-header {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  padding: 3rem 2.5rem 2rem;
  margin: -3rem -2.5rem 2rem;
  display: flex;
  align-items: center;
  gap: 2rem;
  position: sticky;
  top: 0;
  z-index: 5;
}

.panel-icon {
  font-size: 4rem;
  filter: drop-shadow(0 4px 10px rgba(0,0,0,0.3));
}

.panel-title-block h2 {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.panel-title-block p {
  font-size: 1rem;
  opacity: 0.9;
}

.panel-content {
  font-size: 1.05rem;
  line-height: 1.8;
  color: var(--text-main);
}

.panel-content h3 {
  font-size: 1.8rem;
  margin: 2rem 0 1rem;
  color: var(--primary-dark);
}

.panel-content h4 {
  font-size: 1.4rem;
  margin: 1.5rem 0 0.8rem;
  color: var(--primary);
}

.panel-content p {
  margin-bottom: 1.2rem;
  color: var(--text-soft);
}

.panel-content ul, .panel-content ol {
  margin-bottom: 1.5rem;
  padding-left: 2rem;
}

.panel-content li {
  margin-bottom: 0.8rem;
  color: var(--text-soft);
  line-height: 1.7;
}

.panel-content strong {
  color: var(--text-main);
  font-weight: 700;
}

.backdrop {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
  backdrop-filter: blur(5px);
}

.backdrop.active {
  opacity: 1;
  pointer-events: all;
}

/* ================================
   QUIZ MODAL
   ================================ */
.quiz-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 11000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
  backdrop-filter: blur(10px);
}

.quiz-modal.active {
  opacity: 1;
  pointer-events: all;
}

.quiz-container {
  background: white;
  width: 90%;
  max-width: 700px;
  max-height: 85vh;
  overflow-y: auto;
  border-radius: 30px;
  padding: 3rem;
  position: relative;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: modalSlideUp 0.4s ease;
}

@keyframes modalSlideUp {
  from {
    transform: translateY(50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.close-quiz {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  width: 40px;
  height: 40px;
  background: rgba(255,107,157,0.1);
  border: none;
  border-radius: 50%;
  font-size: 1.3rem;
  cursor: pointer;
  transition: all 0.3s;
  color: var(--primary);
}

.close-quiz:hover {
  background: var(--primary);
  color: white;
  transform: rotate(90deg);
}

.quiz-container h2 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  color: var(--primary-dark);
}

.quiz-intro {
  font-size: 1.1rem;
  color: var(--text-soft);
  margin-bottom: 2rem;
}

/* ================================
   RESPONSIVE DESIGN
   ================================ */
@media (max-width: 1024px) {
  .hero {
    grid-template-columns: 1fr;
    gap: 3rem;
  }

  /* Visual section stacks above text content on tablets */
  .hero-visual-3d {
    order: -1;
    overflow: hidden;
  }

  .pregnancy-3d-container {
    overflow: hidden;
  }

  .hero h1 {
    font-size: 2.8rem;
  }

  .timeline-container {
    grid-template-columns: repeat(2, 1fr);
  }

  .topics-grid {
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }

  .tracker-container {
    grid-template-columns: 1fr;
  }

  .simulation-dashboard {
    grid-template-columns: 1fr;
  }

  .meal-planner-container {
    grid-template-columns: 1fr;
  }

  .food-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .page-shell {
    padding: 0 1rem;
  }

  .hero h1 {
    font-size: 2.2rem;
  }

  .hero-stats {
    grid-template-columns: 1fr;
  }

  .section-title {
    font-size: 2.2rem;
  }

  .timeline-container {
    grid-template-columns: 1fr;
  }

  .timeline-rail {
    display: none;
  }

  .topics-grid {
    grid-template-columns: 1fr;
  }

  .community-grid {
    grid-template-columns: 1fr;
  }

  .resources-grid {
    grid-template-columns: 1fr;
  }

  .main-nav {
    display: none;
  }

  .food-grid {
    grid-template-columns: 1fr;
  }

  .topic-panel {
    width: 100%;
  }

  /* Hero CTA buttons wrap on small screens */
  .hero-cta-row {
    flex-wrap: wrap;
  }
  .hero-cta-row .btn-primary,
  .hero-cta-row .btn-secondary {
    flex: 1 1 100%;
    text-align: center;
    justify-content: center;
  }

  /* Hero visual pregnancy animation — scale down to fit mobile */
  .pregnancy-3d-container {
    height: 340px;
  }
  .pregnancy-core {
    width: 280px;
    height: 280px;
  }
  .pregnancy-core .pulse-ring {
    transform: scale(0.62);
  }
  .pregnancy-core .center-glow {
    transform: scale(0.62);
  }

  /* Scale down orbit animations to fit mobile viewport */
  @keyframes orbit1 {
    0%, 100% { transform: translate(-118px, 0px) rotate(0deg); }
    25%       { transform: translate(-121px, -6px) rotate(3deg); }
    50%       { transform: translate(-118px, 0px) rotate(0deg); }
    75%       { transform: translate(-115px, 6px) rotate(-3deg); }
  }
  @keyframes orbit2 {
    0%, 100% { transform: translate(-83px, -83px) rotate(0deg); }
    25%       { transform: translate(-86px, -86px) rotate(-3deg); }
    50%       { transform: translate(-83px, -83px) rotate(0deg); }
    75%       { transform: translate(-80px, -80px) rotate(3deg); }
  }
  @keyframes orbit3 {
    0%, 100% { transform: translate(83px, -83px) rotate(0deg); }
    25%       { transform: translate(86px, -86px) rotate(3deg); }
    50%       { transform: translate(83px, -83px) rotate(0deg); }
    75%       { transform: translate(80px, -80px) rotate(-3deg); }
  }
  @keyframes orbit4 {
    0%, 100% { transform: translate(118px, 0px) rotate(0deg); }
    25%       { transform: translate(121px, 6px) rotate(-3deg); }
    50%       { transform: translate(118px, 0px) rotate(0deg); }
    75%       { transform: translate(115px, -6px) rotate(3deg); }
  }
  @keyframes orbit5 {
    0%, 100% { transform: translate(-83px, 83px) rotate(0deg); }
    25%       { transform: translate(-86px, 86px) rotate(3deg); }
    50%       { transform: translate(-83px, 83px) rotate(0deg); }
    75%       { transform: translate(-80px, 80px) rotate(-3deg); }
  }

  /* Glucose meter repositioned so it doesn't overflow */
  .glucose-meter {
    right: 10px;
    bottom: 10px;
    width: 160px;
    padding: 1rem;
  }
  .reading-value {
    font-size: 2rem;
  }

  /* Health icons smaller on mobile */
  .health-icon {
    padding: 0.7rem 0.9rem;
    border-radius: 14px;
  }
  .icon-inner {
    font-size: 1.4rem;
  }
  .icon-label {
    font-size: 0.65rem;
  }

  /* Daily tip flex wrap */
  .daily-tip {
    flex-wrap: wrap;
    gap: 1rem;
  }
}

/* ================================
   PARTICLE BACKGROUND
   ================================ */
.hero-constellation-bg {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  overflow: hidden;
}

#particleCanvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0.4;
}

.gradient-morph {
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, 
              rgba(236, 64, 122, 0.12) 0%, 
              transparent 60%);
  animation: morph-pulse 8s ease-in-out infinite;
  z-index: 1;
}

@keyframes morph-pulse {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.15); }
}


/* ================================
   UTILITY ANIMATIONS
   ================================ */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.fade-in {
  animation: fadeIn 0.6s ease;
}

.slide-up {
  animation: slideUp 0.6s ease;
}


/* ================================
   INTERACTIVE TOOL CARDS
   ================================ */
.interactive-tool {
  position: relative;
  overflow: visible;
  cursor: pointer;
}

.tool-icon-animated {
  position: relative;
  display: inline-block;
  margin-bottom: 1rem;
}

.icon-main {
  font-size: 3rem;
  display: block;
}

.icon-badge {
  position: absolute;
  top: -5px;
  right: -15px;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  font-size: 0.65rem;
  padding: 0.2rem 0.5rem;
  border-radius: 10px;
  font-weight: 700;
  animation: badgePulse 2s ease-in-out infinite;
}

@keyframes badgePulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

.tool-preview {
  margin-top: 1rem;
  padding: 0.6rem;
  background: rgba(236,64,122,0.05);
  border-radius: 8px;
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 600;
}

/* ================================
   FEATURE MODALS
   ================================ */
.feature-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 11000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
  backdrop-filter: blur(10px);
}

.feature-modal.active {
  opacity: 1;
  pointer-events: all;
}

.modal-content-large {
  background: white;
  width: 90%;
  max-width: 900px;
  max-height: 90vh;
  overflow-y: auto;
  border-radius: 30px;
  position: relative;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: modalSlideUp 0.4s ease;
}

.modal-header-gradient {
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  padding: 3rem 2.5rem 2rem;
  text-align: center;
}

.modal-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.modal-header-gradient h2 {
  font-size: 2.2rem;
  margin-bottom: 0.8rem;
}

.modal-header-gradient p {
  font-size: 1.1rem;
  opacity: 0.95;
}

.modal-body {
  padding: 2.5rem;
}

.close-modal {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  width: 45px;
  height: 45px;
  background: rgba(255,255,255,0.2);
  border: none;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.3s;
  color: white;
  z-index: 10;
}

.close-modal:hover {
  background: white;
  color: #ec407a;
  transform: rotate(90deg);
}

/* Daily Log Entry */
.quick-entry-form {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  border: 2px solid #f0f0f0;
}

.entry-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.entry-field {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.entry-field label {
  font-weight: 600;
  color: var(--text-main);
  font-size: 0.9rem;
}

.glucose-input, .time-select {
  padding: 0.8rem 1rem;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  font-size: 1rem;
  font-family: 'Manrope', sans-serif;
  transition: all 0.3s;
}

.glucose-input:focus, .time-select:focus {
  outline: none;
  border-color: #ec407a;
  box-shadow: 0 0 0 3px rgba(236,64,122,0.1);
}

.unit {
  position: absolute;
  right: 1rem;
  top: 2.8rem;
  color: var(--text-soft);
  font-weight: 600;
}

.instant-feedback {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  background: rgba(102,187,106,0.1);
  border-radius: 12px;
  border-left: 4px solid #66bb6a;
  margin-bottom: 1rem;
}

.feedback-icon {
  font-size: 2rem;
  color: #66bb6a;
}

.feedback-text strong {
  color: #66bb6a;
  display: block;
  margin-bottom: 0.3rem;
}

.save-entry-btn {
  width: 100%;
  padding: 1rem 2rem;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  border: none;
  border-radius: 50px;
  font-size: 1.1rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.save-entry-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(236,64,122,0.3);
}

.smart-insights {
  margin-top: 2rem;
}

.smart-insights h3 {
  margin-bottom: 1.5rem;
  color: var(--text-main);
}

.insight-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
}

.insight-card {
  display: flex;
  gap: 1rem;
  padding: 1.2rem;
  border-radius: 16px;
  border-left: 4px solid;
}

.insight-card.green {
  background: rgba(102,187,106,0.1);
  border-color: #66bb6a;
}

.insight-card.blue {
  background: rgba(79,172,254,0.1);
  border-color: #4facfe;
}

.insight-card.orange {
  background: rgba(255,167,38,0.1);
  border-color: #ffa726;
}

.insight-icon {
  font-size: 2rem;
}

.insight-content h4 {
  font-size: 1rem;
  margin-bottom: 0.4rem;
  color: var(--text-main);
}

.insight-content p {
  font-size: 0.9rem;
  color: var(--text-soft);
}

/* Track Checklist */
.track-checklist {
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.track-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.8rem;
  background: rgba(236,64,122,0.05);
  border-radius: 12px;
  font-weight: 600;
  color: var(--text-main);
}

.track-icon {
  font-size: 1.5rem;
}

/* ================================
   INTERACTIVE MEAL PLANNER
   ================================ */
.meal-selector {
  display: flex;
  gap: 1rem;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  justify-content: center;
}

.meal-time-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem 1.5rem;
  background: white;
  border: 3px solid #e0e0e0;
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.3s;
  font-family: 'Manrope', sans-serif;
}

.meal-time-btn:hover {
  border-color: #ec407a;
  transform: translateY(-3px);
}

.meal-time-btn.active {
  border-color: #ec407a;
  background: linear-gradient(135deg, rgba(236,64,122,0.1), rgba(237,231,246,0.1));
}

.meal-icon {
  font-size: 2rem;
}

.meal-name {
  font-weight: 600;
  color: var(--text-main);
}

.plate-builder-interactive {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.virtual-plate-container {
  margin-bottom: 2rem;
}

.dropped-foods {
  position: absolute;
  inset: 0;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: 0.3rem;
  padding: 0.5rem;
  pointer-events: none;
}

.dropped-food-item {
  font-size: 1.5rem;
  animation: dropIn 0.3s ease;
}

@keyframes dropIn {
  from {
    transform: scale(0) rotate(180deg);
    opacity: 0;
  }
  to {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}

.plate-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-top: 1.5rem;
}

.plate-btn {
  padding: 0.8rem 1.5rem;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid;
  font-family: 'Manrope', sans-serif;
}

.clear-btn {
  background: white;
  border-color: #e0e0e0;
  color: var(--text-main);
}

.clear-btn:hover {
  border-color: #ef5350;
  color: #ef5350;
}

.save-btn {
  background: linear-gradient(135deg, #ec407a, #d81b60);
  border-color: transparent;
  color: white;
}

.save-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(236,64,122,0.3);
}

/* Glucose Predictor */
.glucose-predictor {
  background: linear-gradient(135deg, rgba(237,231,246,0.3), rgba(236,64,122,0.05));
  padding: 2rem;
  border-radius: 20px;
  margin-top: 2rem;
}

.glucose-predictor h3 {
  margin-bottom: 1.5rem;
  color: var(--text-main);
  text-align: center;
}

.prediction-meter {
  margin-bottom: 2rem;
}

.meter-bar-container {
  width: 100%;
  height: 20px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.meter-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #66bb6a, #ffa726, #ef5350);
  transition: width 0.8s ease;
  border-radius: 10px;
}

.meter-labels {
  display: flex;
  justify-content: space-between;
  font-size: 0.8rem;
  font-weight: 600;
}

.meter-label.low { color: #66bb6a; }
.meter-label.medium { color: #ffa726; }
.meter-label.high { color: #ef5350; }

.prediction-details {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.prediction-stat {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  background: white;
  padding: 1rem;
  border-radius: 12px;
}

.prediction-stat .stat-icon {
  font-size: 1.8rem;
}

.stat-info {
  display: flex;
  flex-direction: column;
}

.stat-label {
  font-size: 0.75rem;
  color: var(--text-soft);
  font-weight: 600;
}

.stat-value {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-main);
}

.status-good {
  color: #66bb6a !important;
}

.smart-suggestions {
  background: white;
  padding: 1.5rem;
  border-radius: 16px;
  border-left: 4px solid #4facfe;
}

.smart-suggestions h4 {
  margin-bottom: 1rem;
  color: var(--text-main);
}

.smart-suggestions ul {
  list-style: none;
  padding: 0;
}

.smart-suggestions li {
  padding: 0.6rem 0;
  color: var(--text-soft);
  font-size: 0.95rem;
  display: flex;
  align-items: start;
  gap: 0.5rem;
}

.smart-suggestions li:before {
  content: '✓';
  color: #66bb6a;
  font-weight: 700;
}

/* Food Selector */
.food-search {
  position: relative;
  margin-bottom: 2rem;
}

.search-input {
  width: 100%;
  padding: 1rem 3rem 1rem 1rem;
  border: 2px solid #e0e0e0;
  border-radius: 50px;
  font-size: 1rem;
  font-family: 'Manrope', sans-serif;
}

.search-input:focus {
  outline: none;
  border-color: #ec407a;
}

.search-icon {
  position: absolute;
  right: 1.5rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
}

.draggable-food {
  cursor: move;
  transition: all 0.3s;
}

.draggable-food:active {
  transform: scale(1.1);
  opacity: 0.8;
}

.gi-badge {
  position: absolute;
  top: 5px;
  right: 5px;
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 10px;
  font-weight: 700;
  color: white;
}

.gi-badge.low {
  background: #66bb6a;
}

.gi-badge.medium {
  background: #ffa726;
}

.gi-badge.high {
  background: #ef5350;
}

.gi-info-box {
  background: linear-gradient(135deg, rgba(237,231,246,0.5), rgba(236,64,122,0.1));
  padding: 1.5rem;
  border-radius: 16px;
  margin-top: 2rem;
}

.gi-info-box h4 {
  margin-bottom: 1rem;
  color: var(--text-main);
}

.gi-scale {
  display: flex;
  flex-direction: column;
  gap: 0.8rem;
}

.gi-range {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.8rem;
  border-radius: 12px;
  font-weight: 600;
}

.gi-range.low {
  background: rgba(102,187,106,0.2);
  color: #388e3c;
}

.gi-range.medium {
  background: rgba(255,167,38,0.2);
  color: #f57c00;
}

.gi-range.high {
  background: rgba(239,83,80,0.2);
  color: #d32f2f;
}

/* Meal Suggestions */
.meal-suggestions {
  margin-top: 3rem;  /* Changed from: 0 */
  flex: 1;
}

/* Container for Meal History and Quick Meal Ideas */
.meal-history-suggestions-container {
  display: flex;
  gap: 2rem;
  margin-top: 2rem;
}

.meal-history-suggestions-container .meal-history-panel {
  flex: 1;
  margin: 0;
}

.meal-history-suggestions-container .meal-suggestions {
  flex: 1;
}


.meal-suggestions h3 {
  text-align: center;
  margin-bottom: 2rem;
  color: var(--text-main);
  font-size: 2rem;
}

.suggestion-cards {
  display: grid;
  grid-template-columns: repeat(3, 1fr);  /* Changed from: 1fr */
  gap: 2rem;  /* Changed from: 1.5rem */
}

.suggestion-card {
  background: white;
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  text-align: center;
}

.suggestion-card:hover {
  border-color: #ec407a;
  transform: translateY(-5px);
  box-shadow: 0 8px 30px rgba(236,64,122,0.2);
}

.suggestion-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.suggestion-card h4 {
  font-size: 1.3rem;
  margin-bottom: 0.8rem;
  color: #ec407a;
}

.suggestion-card p {
  color: var(--text-soft);
  margin-bottom: 1rem;
}

.suggestion-stats {
  display: flex;
  gap: 0.8rem;
  justify-content: center;
  flex-wrap: wrap;
}

.suggestion-stats .stat {
  background: rgba(236,64,122,0.1);
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  color: #ec407a;
}

/* Mobile Responsive for Meal History and Suggestions */
@media (max-width: 1024px) {
  .meal-history-suggestions-container {
    flex-direction: column;
  }
  
  .suggestion-cards {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  .suggestion-cards {
    grid-template-columns: 1fr;
  }
}



/* ================================
   ENHANCED COMMUNITY CARDS
   ================================ */
.community-card.clickable {
  cursor: pointer;
  position: relative;
}

.card-icon-animated {
  font-size: 4rem;
  margin-bottom: 1rem;
  animation: float 3s ease-in-out infinite;
}

.card-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 700;
  color: white;
}

.card-badge.live {
  background: #66bb6a;
  animation: livePulse 1.5s ease-in-out infinite;
}

.card-badge.popular {
  background: #ec407a;
}

.card-badge.expert {
  background: #4facfe;
}

.card-badge.global {
  background: #9c27b0;
}

.live-activity {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  font-size: 0.85rem;
  color: #66bb6a;
  font-weight: 600;
}

.activity-dot {
  width: 8px;
  height: 8px;
  background: #66bb6a;
  border-radius: 50%;
  animation: livePulse 1.5s ease-in-out infinite;
}

.recent-topics, .channel-preview, .reddit-highlights, .next-session, .story-preview, .expert-panel {
  margin-top: 1rem;
  padding: 1rem;
  background: rgba(236,64,122,0.05);
  border-radius: 12px;
}

.recent-topics h4, .channel-preview h4, .reddit-highlights h4, .next-session h4, .expert-panel h4 {
  font-size: 0.9rem;
  margin-bottom: 0.8rem;
  color: var(--text-main);
}

.recent-topics ul, .reddit-highlights ul, .expert-panel ul {
  list-style: none;
  padding: 0;
}

.recent-topics li, .reddit-highlights li, .expert-panel li {
  padding: 0.4rem 0;
  font-size: 0.85rem;
  color: var(--text-soft);
}

.recent-topics li:before, .reddit-highlights li:before {
  content: '→ ';
  color: #ec407a;
  font-weight: 700;
}

.expert-panel li:before {
  content: '• ';
  color: #ec407a;
  font-weight: 700;
}

.story-quote {
  font-style: italic;
  color: var(--text-soft);
  line-height: 1.7;
  font-size: 0.95rem;
}

.location-finder {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
}

.city-input {
  flex: 1;
  padding: 0.8rem;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  font-family: 'Manrope', sans-serif;
}

.find-btn {
  padding: 0.8rem 1.5rem;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
}

.community-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.btn-arrow {
  font-size: 1.2rem;
  transition: transform 0.3s;
}

.community-card:hover .btn-arrow {
  transform: translateX(5px);
}

/* Community Guidelines */
.community-guidelines {
  margin-top: 3rem;
  background: white;
  padding: 3rem;
  border-radius: 30px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.community-guidelines h3 {
  text-align: center;
  margin-bottom: 2rem;
  font-size: 2rem;
  color: var(--text-main);
}

.guidelines-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 2rem;
}

.guideline-item {
  text-align: center;
}

.guideline-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  display: block;
}

.guideline-item h4 {
  font-size: 1.1rem;
  margin-bottom: 0.5rem;
  color: #ec407a;
}

.guideline-item p {
  color: var(--text-soft);
  font-size: 0.9rem;
}

.plate-section {
  transition: all 0.3s ease;
  box-shadow: inset 0 0 0 2px rgba(255,255,255,0.1);
}

.plate-section.filled {
  box-shadow: inset 0 0 20px rgba(255,255,255,0.3);
  transform: scale(1.02);
}

.dropped-food-item.small {
  font-size: 1.2em;
  opacity: 0.7;
}
.dropped-food-item.medium {
  font-size: 1.5em;
  opacity: 0.9;
}
.dropped-food-item.large {
  font-size: 2em;
  opacity: 1;
}


@keyframes foodDrop {
  0% {
    transform: translateY(-100px) scale(0.5);
    opacity: 0;
  }
  50% {
    transform: translateY(10px) scale(1.1);
  }
  100% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

@keyframes plateGlow {
  0%, 100% {
    box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
  }
  50% {
    box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
  }
}

.dropped-food-item {
  animation: foodDrop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.plate-section.active {
  animation: plateGlow 1s ease-in-out;
}


@media (max-width: 768px) {
  .meal-planner-container {
    flex-direction: column;
  }
  
  .virtual-plate {
    min-height: 300px;
    margin-bottom: 20px;
  }
  
  .food-item {
    min-height: 80px; /* Larger touch targets */
    padding: 15px;
  }
  
/* Portion Controls Styling */
.portion-controls {
  display: flex;
  gap: 4px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  opacity: 0;
  transform: translateY(-5px);
  transition: all 0.3s ease;
}

.food-item:hover .portion-controls {
  opacity: 1;
  transform: translateY(0);
}

.portion-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  padding: 6px 4px;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 11px;
  color: rgba(255, 255, 255, 0.9);
}

.portion-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: rgba(255, 255, 255, 0.4);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.portion-btn:active {
  transform: translateY(0);
}

.portion-btn .portion-icon {
  font-size: 14px;
  line-height: 1;
}

.portion-btn .portion-label {
  font-size: 9px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Size-specific styling */
.portion-btn.small {
  border-color: rgba(76, 175, 80, 0.3);
}

.portion-btn.small:hover {
  background: rgba(76, 175, 80, 0.2);
  border-color: rgba(76, 175, 80, 0.5);
}

.portion-btn.medium {
  border-color: rgba(255, 193, 7, 0.3);
}

.portion-btn.medium:hover {
  background: rgba(255, 193, 7, 0.2);
  border-color: rgba(255, 193, 7, 0.5);
}

.portion-btn.large {
  border-color: rgba(255, 152, 0, 0.3);
}

.portion-btn.large:hover {
  background: rgba(255, 152, 0, 0.2);
  border-color: rgba(255, 152, 0, 0.5);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .portion-controls {
    opacity: 1;
    transform: translateY(0);
  }
  
  .portion-btn {
    padding: 8px 6px;
    min-height: 44px; /* Touch-friendly */
  }
  
  .portion-btn .portion-icon {
    font-size: 16px;
  }
  
  .portion-btn .portion-label {
    font-size: 10px;
  }
}
  /* Swipe gestures for meal navigation */
  .meal-selector {
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }
  
  .meal-time-btn {
    scroll-snap-align: center;
    min-width: 120px;
  }
}


/* ===================================
   GUIDED MEAL WIZARD STYLING
   =================================== */

.meal-wizard {
  background: linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(156, 39, 176, 0.1));
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 20px;
  border: 2px solid rgba(103, 58, 183, 0.2);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.wizard-toggle-btn {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255, 255, 255, 0.05);
  border: none;
  padding: 12px 20px;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  color: white;
  font-size: 16px;
  font-weight: 600;
}

.wizard-toggle-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(103, 58, 183, 0.3);
}

.wizard-toggle-btn .wizard-icon {
  font-size: 24px;
  margin-right: 12px;
}

.wizard-toggle-btn .wizard-text {
  flex: 1;
  text-align: left;
}

.wizard-toggle-btn .wizard-arrow {
  font-size: 12px;
  transition: transform 0.3s ease;
}

.wizard-toggle-btn.active .wizard-arrow {
  transform: rotate(180deg);
}

.wizard-content {
  margin-top: 20px;
  animation: slideDown 0.3s ease;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Wizard Progress Steps */
.wizard-progress {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 30px;
  padding: 20px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
}

.wizard-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  flex: 1;
  position: relative;
}

.step-circle {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  border: 3px solid rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  transition: all 0.3s ease;
  z-index: 2;
}

.wizard-step.active .step-circle {
  background: linear-gradient(135deg, #673ab7, #9c27b0);
  border-color: #9c27b0;
  box-shadow: 0 0 20px rgba(156, 39, 176, 0.5);
  transform: scale(1.1);
}

.wizard-step.completed .step-circle {
  background: linear-gradient(135deg, #4caf50, #45a049);
  border-color: #4caf50;
}

.step-number {
  color: white;
  font-size: 20px;
  font-weight: 700;
}

.wizard-step.completed .step-number {
  display: none;
}

.step-check {
  display: none;
  color: white;
  font-size: 24px;
}

.wizard-step.completed .step-check {
  display: block;
}

.step-label {
  font-size: 12px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.7);
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.wizard-step.active .step-label {
  color: #9c27b0;
}

.wizard-step.completed .step-label {
  color: #4caf50;
}

.wizard-connector {
  flex: 1;
  height: 3px;
  background: rgba(255, 255, 255, 0.2);
  position: relative;
  top: -20px;
  margin: 0 -10px;
}

.wizard-step.completed + .wizard-connector {
  background: linear-gradient(90deg, #4caf50, rgba(76, 175, 80, 0.3));
}

/* Wizard Body */
.wizard-body {
  padding: 20px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 12px;
  margin-bottom: 20px;
}

.wizard-instruction {
  text-align: center;
  margin-bottom: 20px;
}

.instruction-icon {
  font-size: 60px;
  margin-bottom: 16px;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

#wizardTitle {
  font-size: 22px;
  font-weight: 700;
  color: white;
  margin-bottom: 12px;
}

#wizardDescription {
  font-size: 15px;
  color: rgba(255, 255, 255, 0.8);
  line-height: 1.6;
  max-width: 600px;
  margin: 0 auto;
}

/* Wizard Goal */
.wizard-goal {
  margin-top: 20px;
  padding: 16px;
  background: rgba(156, 39, 176, 0.15);
  border-radius: 8px;
  border-left: 4px solid #9c27b0;
}

.goal-label {
  font-weight: 700;
  color: #9c27b0;
  margin-right: 8px;
}

.goal-value {
  color: white;
  font-weight: 600;
}

.goal-progress {
  width: 100%;
  height: 8px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  margin-top: 12px;
  overflow: hidden;
}

.goal-progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #4caf50, #45a049);
  border-radius: 4px;
  transition: width 0.5s ease;
  box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
}

/* Wizard Recommendations */
.wizard-recommendations {
  margin-top: 24px;
}

.wizard-recommendations h4 {
  font-size: 16px;
  color: rgba(255, 255, 255, 0.9);
  margin-bottom: 12px;
}

.wizard-food-suggestions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.wizard-suggestion {
  background: rgba(255, 255, 255, 0.05);
  padding: 16px;
  border-radius: 12px;
  border: 2px solid rgba(76, 175, 80, 0.3);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 12px;
}

.wizard-suggestion:hover {
  background: rgba(76, 175, 80, 0.2);
  border-color: #4caf50;
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(76, 175, 80, 0.3);
}

.suggestion-emoji {
  font-size: 32px;
}

.suggestion-name {
  flex: 1;
  font-weight: 600;
  color: white;
}

.suggestion-badge {
  background: linear-gradient(135deg, #4caf50, #45a049);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
}

/* Wizard Tip */
.wizard-tip {
  margin-top: 20px;
  padding: 16px;
  background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 152, 0, 0.15));
  border-radius: 8px;
  border-left: 4px solid #ffc107;
  display: flex;
  align-items: flex-start;
  gap: 12px;
}

.tip-icon {
  font-size: 24px;
}

.wizard-tip p {
  color: rgba(255, 255, 255, 0.9);
  font-size: 14px;
  line-height: 1.6;
  margin: 0;
}

.wizard-tip strong {
  color: #ffc107;
}

/* Wizard Actions */
.wizard-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.wizard-btn {
  padding: 12px 24px;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}

.wizard-btn.skip {
  background: transparent;
  color: rgba(255, 255, 255, 0.6);
  border: 2px solid rgba(255, 255, 255, 0.2);
}

.wizard-btn.skip:hover {
  color: white;
  border-color: rgba(255, 255, 255, 0.4);
}

.wizard-btn.back {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 2px solid rgba(255, 255, 255, 0.2);
}

.wizard-btn.back:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateX(-4px);
}

.wizard-btn.next {
  background: linear-gradient(135deg, #673ab7, #9c27b0);
  color: white;
  box-shadow: 0 4px 12px rgba(156, 39, 176, 0.3);
}

.wizard-btn.next:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(156, 39, 176, 0.4);
}

.wizard-btn.finish {
  background: linear-gradient(135deg, #4caf50, #45a049);
  color: white;
  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
}

.wizard-btn.finish:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .wizard-progress {
    flex-wrap: wrap;
    gap: 20px;
  }
  
  .wizard-step {
    flex: 0 0 calc(50% - 10px);
  }
  
  .wizard-connector {
    display: none;
  }
  
  .wizard-food-suggestions {
    grid-template-columns: 1fr;
  }
  
  .wizard-actions {
    flex-direction: column;
  }
  
  .wizard-btn {
    width: 100%;
    justify-content: center;
  }
}

/* Food Comparison Tool */


/* ===================================
   FOOD COMPARISON TOOL STYLING
   =================================== */

/* Comparison Tool Button */
.food-comparison-tool {
  margin: 16px 0;
  padding: 12px;
  background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(3, 169, 244, 0.1));
  border-radius: 12px;
  border: 2px dashed rgba(33, 150, 243, 0.3);
}

.compare-btn {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 14px 20px;
  background: linear-gradient(135deg, #2196f3, #03a9f4);
  border: none;
  border-radius: 10px;
  color: white;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(33, 150, 243, 0.3);
  position: relative;
  overflow: hidden;
}

.compare-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.compare-btn:hover::before {
  width: 300px;
  height: 300px;
}

.compare-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(33, 150, 243, 0.4);
}

.compare-icon {
  font-size: 20px;
}

.compare-text {
  position: relative;
  z-index: 1;
}

.compare-badge {
  position: relative;
  z-index: 1;
  background: rgba(255, 193, 7, 0.9);
  color: #000;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 900;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

/* Comparison Modal Overlay */
.comparison-modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(5px);
  z-index: 9998;
  animation: fadeIn 0.3s ease;
}

.comparison-modal-overlay.active {
  display: block;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Comparison Modal */
.comparison-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  width: 90%;
  max-width: 900px;
  max-height: 90vh;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  z-index: 9999;
  overflow: hidden;
  animation: modalSlideIn 0.3s ease forwards;
}

.comparison-modal.active {
  display: block;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

.comparison-header {
  padding: 24px 30px;
  background: linear-gradient(135deg, #2196f3, #03a9f4);
  color: white;
  position: relative;
  border-bottom: 3px solid rgba(255, 255, 255, 0.2);
}

.comparison-header h3 {
  margin: 0 0 8px 0;
  font-size: 26px;
  font-weight: 700;
}

.comparison-header p {
  margin: 0;
  font-size: 14px;
  opacity: 0.95;
}

.close-modal {
  position: absolute;
  top: 20px;
  right: 20px;
  width: 40px;
  height: 40px;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 28px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  line-height: 1;
}

.close-modal:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: rotate(90deg);
}

/* Comparison Selector */
.comparison-selector {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 20px;
  padding: 30px;
  background: rgba(255, 255, 255, 0.02);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  align-items: center;
}

.selector-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.selector-group label {
  font-size: 14px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.8);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.selector-group select {
  padding: 14px 16px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  color: white;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.selector-group select:focus {
  outline: none;
  border-color: #2196f3;
  background: rgba(33, 150, 243, 0.1);
  box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.2);
}

.selector-group select option {
  background: #1a1a2e;
  color: white;
  padding: 10px;
}

.selector-group select optgroup {
  background: #16213e;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 700;
  font-size: 13px;
}

.vs-divider {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 10px;
}

.vs-label {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: 900;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
  animation: rotate 3s linear infinite;
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* Comparison Results */
.comparison-results {
  padding: 30px;
  min-height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.comparison-placeholder {
  text-align: center;
  color: rgba(255, 255, 255, 0.5);
}

.placeholder-icon {
  font-size: 80px;
  margin-bottom: 20px;
  opacity: 0.3;
}

.comparison-placeholder p {
  font-size: 16px;
  margin: 0;
}

/* Comparison Table */
.comparison-table-container {
  padding: 20px 30px;
  max-height: 400px;
  overflow-y: auto;
}

.comparison-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 8px;
}

.comparison-table thead tr {
  background: linear-gradient(135deg, rgba(33, 150, 243, 0.2), rgba(3, 169, 244, 0.2));
}

.comparison-table th {
  padding: 16px 20px;
  text-align: left;
  color: white;
  font-weight: 700;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.comparison-table th:first-child {
  border-radius: 10px 0 0 10px;
}

.comparison-table th:last-child {
  border-radius: 0 10px 10px 0;
  text-align: center;
}

.comparison-table tbody tr {
  background: rgba(255, 255, 255, 0.03);
  transition: all 0.3s ease;
}

.comparison-table tbody tr:hover {
  background: rgba(255, 255, 255, 0.08);
  transform: translateX(5px);
}

.comparison-table td {
  padding: 16px 20px;
  color: rgba(255, 255, 255, 0.9);
  font-size: 15px;
}

.comparison-table td:first-child {
  font-weight: 600;
  color: rgba(255, 255, 255, 0.7);
  border-radius: 10px 0 0 10px;
}

.comparison-table td:last-child {
  text-align: center;
  border-radius: 0 10px 10px 0;
}

.metric-value.success {
  color: #28a745;
  font-weight: 600;
}

.comparison-grid {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.comparison-metrics {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.metric-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 12px;
  transition: transform 0.2s;
}

.metric-row:hover {
  transform: translateX(4px);
  background: #f0f0f0;
}

.metric-label {
  font-weight: 600;
  color: #555;
  flex: 0 0 180px;
}

.metric-values {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  flex: 1;
  justify-content: flex-end;
}

.metric-value {
  font-size: 1.2rem;
  font-weight: 700;
  color: #333;
  padding: 0.5rem 1rem;
  background: white;
  border-radius: 8px;
  min-width: 80px;
  text-align: center;
}

.metric-value.winner {
  background: linear-gradient(135deg, #d4edda, #c3e6cb);
  color: #155724;
  border: 2px solid #28a745;
  box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);
  transform: scale(1.05);
}

.vs-text {
  color: #999;
  font-weight: 600;
  font-size: 0.9rem;
}

.comparison-verdict {
  background: linear-gradient(135deg, #d4edda, #c3e6cb);
  padding: 2rem;
  border-radius: 16px;
  border: 2px solid #28a745;
}

.verdict-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #155724;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.verdict-text {
  font-size: 1.1rem;
  color: #333;
  line-height: 1.6;
  margin-bottom: 1rem;
}

.verdict-benefits {
  margin-top: 1.5rem;
  padding: 1.5rem;
  background: rgba(255, 255, 255, 0.7);
  border-radius: 12px;
}

.verdict-benefits strong {
  color: #155724;
  font-size: 1.1rem;
  display: block;
  margin-bottom: 0.75rem;
}

.verdict-benefits ul {
  margin: 0;
  padding-left: 1.5rem;
  list-style: none;
}

.verdict-benefits li {
  margin: 0.5rem 0;
  color: #28a745;
  font-weight: 600;
  position: relative;
  padding-left: 1.5rem;
}

.verdict-benefits li::before {
  content: '✓';
  position: absolute;
  left: 0;
  color: #28a745;
  font-weight: bold;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .comparison-modal {
    width: 95%;
    max-height: 95vh;
  }
  
  .comparison-selector {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .vs-divider {
    order: 2;
  }
  
  .selector-group:first-child {
    order: 1;
  }
  
  .selector-group:last-child {
    order: 3;
  }
  
  .comparison-table-container {
    padding: 15px;
  }
  
  .comparison-table {
    font-size: 13px;
  }
  
  .comparison-table th,
  .comparison-table td {
    padding: 10px 12px;
  }
  
  .verdict-actions {
    flex-direction: column;
  }
  
  .verdict-btn {
    width: 100%;
  }
}

/* ===================================
   MEAL SCORE & ACHIEVEMENTS CARD
   =================================== */

/* ═══════════════════════════════════════════════
   MEAL SCORE CARD — FULL IMPLEMENTATION CSS
   ═══════════════════════════════════════════════ */

.meal-score-card {
  margin-top: 24px;
  background: #ffffff;
  border-radius: 20px;
  border: 2px solid #e8f5e9;
  box-shadow: 0 4px 24px rgba(76,175,80,0.10), 0 1px 6px rgba(0,0,0,0.06);
  overflow: hidden;
  transition: box-shadow 0.3s;
}
.meal-score-card:hover {
  box-shadow: 0 8px 32px rgba(76,175,80,0.18), 0 2px 10px rgba(0,0,0,0.08);
}

/* ── Header ── */
.score-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 20px 14px;
  background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 60%, #388e3c 100%);
}
.score-card-header-left {
  display: flex;
  align-items: center;
  gap: 12px;
}
.score-card-icon {
  font-size: 2rem;
  filter: drop-shadow(0 2px 6px rgba(0,0,0,0.3));
}
.score-card-title {
  margin: 0;
  color: #fff;
  font-size: 1.1rem;
  font-weight: 800;
  letter-spacing: 0.02em;
  text-transform: uppercase;
}
.score-card-subtitle {
  margin: 2px 0 0;
  color: rgba(255,255,255,0.75);
  font-size: 0.75rem;
  font-weight: 500;
}

/* Grade badge */
.score-grade-badge {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255,255,255,0.15);
  border: 2px solid rgba(255,255,255,0.4);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.3rem;
  font-weight: 900;
  color: #fff;
  font-family: 'Playfair Display', serif;
  transition: all 0.4s ease;
  letter-spacing: -1px;
}
.score-grade-badge.grade-A-plus { background: rgba(255,215,0,0.3); border-color: #ffd700; color: #ffd700; }
.score-grade-badge.grade-A      { background: rgba(76,175,80,0.3);  border-color: #66bb6a; color: #c8e6c9; }
.score-grade-badge.grade-B      { background: rgba(139,195,74,0.3); border-color: #aed581; color: #dcedc8; }
.score-grade-badge.grade-C      { background: rgba(255,193,7,0.3);  border-color: #ffc107; color: #fff9c4; }
.score-grade-badge.grade-D      { background: rgba(255,152,0,0.3);  border-color: #ffa726; color: #ffe0b2; }
.score-grade-badge.grade-F      { background: rgba(239,83,80,0.3);  border-color: #ef5350; color: #ffcdd2; }

/* ── Score Ring ── */
.score-ring-wrapper {
  padding: 20px 20px 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.score-circle-container {
  position: relative;
  width: 160px;
  height: 160px;
  margin-bottom: 10px;
}
.score-circle-svg {
  display: block;
  transition: transform 0.3s ease;
}
.score-circle-container:hover .score-circle-svg {
  transform: scale(1.04);
}
#scoreCircle {
  transition: stroke-dashoffset 1.1s cubic-bezier(0.4,0,0.2,1),
              stroke 0.6s ease;
  filter: drop-shadow(0 0 10px rgba(76,175,80,0.5));
}
#scorePulseRing {
  transition: opacity 0.4s;
  animation: scorePulse 2.2s ease-in-out infinite;
}
@keyframes scorePulse {
  0%,100% { r: 74; opacity: 0.12; }
  50%     { r: 78; opacity: 0.28; }
}
.score-text {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -55%);
  text-align: center;
  line-height: 1;
  pointer-events: none;
}
.score-value {
  display: block;
  font-size: 2.8rem;
  font-weight: 900;
  color: #2e7d32;
  font-family: 'Playfair Display', serif;
  transition: color 0.5s;
  text-shadow: 0 2px 8px rgba(46,125,50,0.2);
}
.score-max {
  display: block;
  font-size: 0.9rem;
  color: #888;
  font-weight: 600;
  margin-top: 2px;
}
.score-label-row {
  text-align: center;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}
.score-rating {
  font-size: 0.85rem;
  font-weight: 700;
  color: #555;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  transition: color 0.4s;
}
.score-rating.tier-perfect  { color: #ff8f00; }
.score-rating.tier-great    { color: #2e7d32; }
.score-rating.tier-good     { color: #558b2f; }
.score-rating.tier-fair     { color: #f57f17; }
.score-rating.tier-poor     { color: #bf360c; }
.score-change {
  font-size: 0.75rem;
  font-weight: 700;
  height: 18px;
  transition: all 0.3s;
}
.score-change.positive { color: #2e7d32; }
.score-change.negative { color: #c62828; }

/* ── Next Action Tip ── */
.score-next-action {
  margin: 4px 20px 12px;
  padding: 10px 14px;
  background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
  border-radius: 12px;
  border-left: 4px solid #66bb6a;
  display: flex;
  align-items: flex-start;
  gap: 8px;
  transition: all 0.3s;
}
.score-next-action.warn {
  background: linear-gradient(135deg, #fff8e1, #fffde7);
  border-left-color: #ffa726;
}
.score-next-action.alert {
  background: linear-gradient(135deg, #fce4ec, #fdf5f7);
  border-left-color: #ef5350;
}
.next-action-icon { font-size: 1rem; flex-shrink: 0; margin-top: 1px; }
.next-action-text { font-size: 0.8rem; color: #444; font-weight: 600; line-height: 1.45; }

/* ── Breakdown ── */
.score-breakdown {
  padding: 0 20px 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.score-dim-label {
  font-size: 0.7rem;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: #aaa;
  margin-bottom: 2px;
}
.score-item {
  background: #fafafa;
  border: 1px solid #f0f0f0;
  border-radius: 12px;
  padding: 10px 12px 8px;
  position: relative;
  transition: all 0.25s;
}
.score-item:hover {
  background: #f5f5f5;
  transform: translateX(3px);
  box-shadow: 2px 2px 8px rgba(0,0,0,0.06);
}
.score-item-header {
  display: flex;
  align-items: center;
  gap: 7px;
  margin-bottom: 8px;
}
.score-icon { font-size: 1.1rem; line-height: 1; }
.score-name {
  font-size: 0.8rem;
  font-weight: 700;
  color: #333;
  flex: 1;
}
.score-max-pts {
  font-size: 0.7rem;
  color: #aaa;
  font-weight: 600;
}
.score-bar-track {
  width: 100%;
  height: 7px;
  background: #e8e8e8;
  border-radius: 10px;
  overflow: hidden;
}
.score-bar-fill {
  height: 100%;
  border-radius: 10px;
  transition: width 0.85s cubic-bezier(0.4,0,0.2,1);
  position: relative;
}
.score-bar-fill::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent 40%, rgba(255,255,255,0.35) 60%, transparent 100%);
  animation: barShimmer 1.8s infinite;
}
@keyframes barShimmer {
  0%   { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}
.veggie-fill   { background: linear-gradient(90deg, #43a047, #76ff03); }
.balance-fill  { background: linear-gradient(90deg, #1e88e5, #40c4ff); }
.gi-fill       { background: linear-gradient(90deg, #ff8f00, #ffca28); }
.protein-fill  { background: linear-gradient(90deg, #8e24aa, #ce93d8); }
.variety-fill  { background: linear-gradient(90deg, #e91e63, #ff80ab); }

.score-points {
  position: absolute;
  top: 10px;
  right: 12px;
  font-size: 1rem;
  font-weight: 900;
  color: #333;
  min-width: 32px;
  text-align: right;
  transition: all 0.3s;
}

/* ── Nutrition Snapshot ── */
.nutrition-snapshot {
  margin: 0 20px 16px;
  background: linear-gradient(135deg, #f3e5f5, #ede7f6);
  border-radius: 14px;
  padding: 12px 14px;
  border: 1px solid #ce93d8;
}
.snap-title {
  font-size: 0.72rem;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: #7b1fa2;
  margin-bottom: 10px;
}
.snap-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}
.snap-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  background: white;
  border-radius: 10px;
  padding: 8px 4px;
  box-shadow: 0 1px 4px rgba(123,31,162,0.08);
}
.snap-icon  { font-size: 1rem; }
.snap-label { font-size: 0.62rem; color: #888; font-weight: 600; text-align: center; }
.snap-value {
  font-size: 0.82rem;
  font-weight: 900;
  color: #333;
  text-align: center;
  transition: all 0.3s;
}
.snap-value.good  { color: #2e7d32; }
.snap-value.warn  { color: #f57f17; }
.snap-value.alert { color: #c62828; }

/* ── Achievements ── */
.achievements-section {
  border-top: 1px solid #f0f0f0;
  padding: 14px 20px 20px;
}
.achievements-title {
  font-size: 0.8rem;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.8px;
  color: #f9a825;
  margin: 0 0 12px;
}
.achievements-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(86px, 1fr));
  gap: 8px;
}
.ach-badge {
  background: #fafafa;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  padding: 10px 6px;
  text-align: center;
  cursor: default;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}
.ach-badge.locked {
  opacity: 0.55;
  filter: grayscale(0.6);
}
.ach-badge.unlocked {
  background: linear-gradient(135deg, #fff9c4, #fff8e1);
  border-color: #ffd54f;
  box-shadow: 0 3px 10px rgba(255,193,7,0.25);
  animation: achPop 0.5s cubic-bezier(0.34,1.56,0.64,1);
}
.ach-badge.unlocked:hover {
  transform: translateY(-3px) scale(1.04);
  box-shadow: 0 6px 18px rgba(255,193,7,0.38);
}
@keyframes achPop {
  0%   { transform: scale(0); opacity: 0; }
  60%  { transform: scale(1.12); }
  100% { transform: scale(1); opacity: 1; }
}
.ach-icon {
  font-size: 1.6rem;
  display: block;
  margin-bottom: 4px;
  transition: filter 0.3s;
}
.ach-badge.locked .ach-icon { filter: grayscale(1); }
.ach-badge.unlocked .ach-icon {
  animation: achBounce 0.6s ease;
}
@keyframes achBounce {
  0%,100% { transform: translateY(0); }
  40%     { transform: translateY(-6px); }
}
.ach-name {
  font-size: 0.62rem;
  font-weight: 700;
  color: #444;
  line-height: 1.25;
  display: block;
}
.ach-badge.locked .ach-name { color: #aaa; }
.ach-desc {
  font-size: 0.55rem;
  color: #888;
  margin-top: 2px;
  display: block;
  line-height: 1.3;
}
.ach-badge.unlocked .ach-name { color: #f57f17; }

/* Unlocked shimmer */
.ach-badge.unlocked::before {
  content: '';
  position: absolute;
  top: -60%; left: -60%;
  width: 220%; height: 220%;
  background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.4) 50%, transparent 60%);
  animation: achShimmer 3s infinite 0.5s;
}
@keyframes achShimmer {
  0%   { transform: rotate(0deg) translateX(-60%); }
  100% { transform: rotate(0deg) translateX(60%); }
}

/* Achievement toast notification */
.ach-notification {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: linear-gradient(135deg, #1b5e20, #2e7d32);
  color: white;
  border-radius: 16px;
  padding: 14px 20px;
  display: flex;
  align-items: center;
  gap: 14px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.25);
  z-index: 99999;
  transform: translateX(120%);
  transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
  max-width: 300px;
}
.ach-notification.show { transform: translateX(0); }
.ach-notif-icon { font-size: 2rem; flex-shrink: 0; }
.ach-notif-body strong { display: block; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: rgba(255,255,255,0.7); margin-bottom: 2px; }
.ach-notif-body p { margin: 0; font-size: 0.95rem; font-weight: 700; }

/* Mobile */
@media (max-width: 768px) {
  .meal-score-card { margin-top: 20px; }
  .score-circle-container { width: 130px; height: 130px; }
  .score-circle-svg { width: 130px; height: 130px; }
  .score-value { font-size: 2.2rem; }
  .snap-grid { grid-template-columns: repeat(2, 1fr); }
  .achievements-grid { grid-template-columns: repeat(auto-fill, minmax(72px, 1fr)); }
}

/* Confetti fall keyframe used by meal score */
@keyframes confetti-fall {
  0%   { transform: translateY(0) rotate(0deg);    opacity: 1; }
  100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
}


/* ===================================
   STREAK TRACKER STYLING
   =================================== */

.streak-tracker {
  display: flex;
  align-items: center;
  gap: 20px;
  background: linear-gradient(135deg, rgba(255, 87, 34, 0.15), rgba(244, 67, 54, 0.1));
  padding: 20px 30px;
  border-radius: 16px;
  margin-top: 24px;
  border: 2px solid rgba(255, 87, 34, 0.3);
  box-shadow: 0 4px 15px rgba(255, 87, 34, 0.2);
  position: relative;
  overflow: hidden;
}

.streak-tracker::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.05), transparent);
  transform: rotate(45deg);
  animation: shine 3s infinite;
}

@keyframes shine {
  0% { transform: translateX(-100%) rotate(45deg); }
  100% { transform: translateX(100%) rotate(45deg); }
}

/* Flame Animation */
.streak-flame {
  position: relative;
  width: 70px;
  height: 70px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.flame-icon {
  font-size: 48px;
  position: relative;
  z-index: 2;
  animation: flameFlicker 1.5s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255, 87, 34, 0.8));
}

@keyframes flameFlicker {
  0%, 100% {
    transform: scale(1) translateY(0);
    filter: drop-shadow(0 0 10px rgba(255, 87, 34, 0.8));
  }
  25% {
    transform: scale(1.05) translateY(-2px);
    filter: drop-shadow(0 0 15px rgba(255, 87, 34, 1));
  }
  50% {
    transform: scale(0.98) translateY(1px);
    filter: drop-shadow(0 0 8px rgba(255, 87, 34, 0.6));
  }
  75% {
    transform: scale(1.02) translateY(-1px);
    filter: drop-shadow(0 0 12px rgba(255, 87, 34, 0.9));
  }
}

.flame-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 80px;
  height: 80px;
  background: radial-gradient(circle, rgba(255, 87, 34, 0.4), transparent 70%);
  border-radius: 50%;
  animation: glowPulse 2s ease-in-out infinite;
  z-index: 1;
}

@keyframes glowPulse {
  0%, 100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.6;
  }
  50% {
    transform: translate(-50%, -50%) scale(1.2);
    opacity: 0.3;
  }
}

/* Streak Info */
.streak-info {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 80px;
}

.streak-count-wrapper {
  display: flex;
  align-items: baseline;
  gap: 6px;
}

.streak-count {
  font-size: 48px;
  font-weight: 900;
  color: #ff5722;
  line-height: 1;
  text-shadow: 0 2px 10px rgba(255, 87, 34, 0.4);
  font-family: 'Arial Black', sans-serif;
}

.streak-unit {
  font-size: 16px;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.8);
  text-transform: uppercase;
}

.streak-label {
  font-size: 14px;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.7);
  text-transform: uppercase;
  letter-spacing: 1px;
}

/* Streak Message */
.streak-message {
  flex: 1;
  font-size: 16px;
  font-weight: 600;
  color: white;
  text-align: center;
  padding: 0 20px;
  line-height: 1.4;
}

.streak-message.motivational {
  background: linear-gradient(90deg, #ff5722, #ff9800, #ff5722);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradientShift 3s ease infinite;
  background-size: 200% auto;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% center; }
  50% { background-position: 100% center; }
}

/* Streak Progress */
.streak-progress {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-width: 180px;
}

.streak-progress-bar {
  width: 100%;
  height: 10px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 5px;
  overflow: hidden;
  position: relative;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
}

.streak-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #ff5722, #ff9800);
  border-radius: 5px;
  transition: width 0.8s ease-out;
  position: relative;
  box-shadow: 0 0 10px rgba(255, 87, 34, 0.6);
}

.streak-progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
  animation: shimmer 2s infinite;
}

.streak-next-goal {
  font-size: 12px;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.9);
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Streak Milestones */
.streak-tracker.milestone-3 {
  border-color: #ffc107;
  box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
}

.streak-tracker.milestone-7 {
  border-color: #4caf50;
  box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
}

.streak-tracker.milestone-30 {
  border-color: #9c27b0;
  box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
  animation: milestoneGlow 2s ease-in-out infinite;
}

@keyframes milestoneGlow {
  0%, 100% {
    box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
  }
  50% {
    box-shadow: 0 8px 25px rgba(156, 39, 176, 0.6);
  }
}

/* Streak Frozen (when streak is broken) */
.streak-tracker.frozen {
  background: linear-gradient(135deg, rgba(96, 125, 139, 0.15), rgba(69, 90, 100, 0.1));
  border-color: rgba(96, 125, 139, 0.3);
}

.streak-tracker.frozen .flame-icon {
  filter: grayscale(100%) brightness(0.7);
  animation: none;
}

.streak-tracker.frozen .streak-count {
  color: #90a4ae;
  text-shadow: none;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .streak-tracker {
    flex-wrap: wrap;
    padding: 16px 20px;
    gap: 12px;
  }
  
  .streak-flame {
    width: 60px;
    height: 60px;
  }
  
  .flame-icon {
    font-size: 40px;
  }
  
  .streak-count {
    font-size: 36px;
  }
  
  .streak-message {
    flex-basis: 100%;
    order: 3;
    padding: 12px 0 0 0;
    text-align: center;
  }
  
  .streak-progress {
    flex-basis: 100%;
    order: 4;
    min-width: 100%;
  }
}

/* Celebration Animation for New Streak Records */
@keyframes streakCelebration {
  0%, 100% {
    transform: scale(1) rotate(0deg);
  }
  25% {
    transform: scale(1.1) rotate(-5deg);
  }
  50% {
    transform: scale(1.15) rotate(5deg);
  }
  75% {
    transform: scale(1.1) rotate(-5deg);
  }
}

.streak-tracker.celebrating .flame-icon {
  animation: streakCelebration 0.6s ease-in-out;
}


/* Streak Milestone Notification */
.streak-milestone-notification {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  background: linear-gradient(135deg, #ff5722, #ff9800);
  color: white;
  padding: 40px;
  border-radius: 20px;
  box-shadow: 0 20px 60px rgba(255, 87, 34, 0.5);
  z-index: 10002;
  min-width: 400px;
  text-align: center;
  transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.streak-milestone-notification.show {
  transform: translate(-50%, -50%) scale(1);
}

.milestone-content {
  position: relative;
}

.milestone-icon {
  font-size: 80px;
  margin-bottom: 20px;
  animation: iconBounce 0.6s ease infinite alternate;
}

@keyframes iconBounce {
  from { transform: translateY(0) scale(1); }
  to { transform: translateY(-10px) scale(1.1); }
}

.milestone-text h3 {
  font-size: 32px;
  margin: 0 0 12px 0;
  font-weight: 900;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.milestone-text p {
  font-size: 18px;
  margin: 0;
  opacity: 0.95;
}

.milestone-confetti {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  pointer-events: none;
  overflow: hidden;
}

.confetti-piece {
  position: absolute;
  font-size: 20px;
  animation: confettiFall 3s linear infinite;
}

.confetti-piece:nth-child(odd) {
  animation-delay: 0.5s;
}

.confetti-piece:nth-child(even) {
  animation-delay: 1s;
}

@keyframes confettiFall {
  0% {
    top: -10%;
    opacity: 1;
    transform: rotate(0deg);
  }
  100% {
    top: 110%;
    opacity: 0;
    transform: rotate(720deg);
  }
}

/* Position confetti pieces randomly */
.confetti-piece:nth-child(1) { left: 5%; }
.confetti-piece:nth-child(2) { left: 15%; }
.confetti-piece:nth-child(3) { left: 25%; }
.confetti-piece:nth-child(4) { left: 35%; }
.confetti-piece:nth-child(5) { left: 45%; }
.confetti-piece:nth-child(6) { left: 55%; }
.confetti-piece:nth-child(7) { left: 65%; }
.confetti-piece:nth-child(8) { left: 75%; }
.confetti-piece:nth-child(9) { left: 85%; }
.confetti-piece:nth-child(10) { left: 95%; }

/* Mobile */
@media (max-width: 768px) {
  .streak-milestone-notification {
    min-width: 90%;
    padding: 30px 20px;
  }
  
  .milestone-icon {
    font-size: 60px;
  }
  
  .milestone-text h3 {
    font-size: 24px;
  }
  
  .milestone-text p {
    font-size: 16px;
  }
}


/* ===================================
   DIETARY FILTERS
   =================================== */

.dietary-filters {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 24px;
  box-shadow: 0 8px 24px rgba(102, 126, 234, 0.25);
}

.dietary-filters h4 {
  color: white;
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.dietary-filters h4::before {
  content: '⚙️';
  font-size: 1.3rem;
}

.filter-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.filter-btn {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 12px;
  padding: 10px 20px;
  color: white;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.filter-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.4s, height 0.4s;
}

.filter-btn:hover::before {
  width: 300px;
  height: 300px;
}

.filter-btn:hover {
  background: rgba(255, 255, 255, 0.25);
  border-color: rgba(255, 255, 255, 0.5);
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.filter-btn.active {
  background: white;
  color: #667eea;
  border-color: white;
  box-shadow: 0 4px 16px rgba(255, 255, 255, 0.4);
  transform: scale(1.05);
}

.filter-btn.active .filter-icon {
  animation: bounceIcon 0.6s ease;
}

.filter-icon {
  font-size: 1.2rem;
  position: relative;
  z-index: 1;
}

@keyframes bounceIcon {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

/* Responsive Design */
@media (max-width: 768px) {
  .dietary-filters {
    padding: 16px;
  }
  
  .filter-buttons {
    gap: 8px;
  }
  
  .filter-btn {
    padding: 8px 16px;
    font-size: 0.85rem;
  }
}



/* ===================================
   CUISINE SELECTOR
   =================================== */

.cuisine-selector {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
  border-radius: 16px;
  padding: 20px 24px;
  margin-bottom: 20px;
  box-shadow: 0 6px 20px rgba(250, 112, 154, 0.25);
}

.cuisine-selector h4 {
  color: white;
  font-size: 1.05rem;
  font-weight: 700;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.cuisine-selector h4::before {
  content: '🍛';
  font-size: 1.3rem;
}

#cuisineStyle {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid rgba(255, 255, 255, 0.5);
  border-radius: 10px;
  font-size: 0.95rem;
  font-weight: 600;
  background: white;
  color: #fa709a;
  cursor: pointer;
  transition: all 0.3s ease;
  outline: none;
}

#cuisineStyle:hover {
  border-color: white;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  transform: translateY(-2px);
}

#cuisineStyle:focus {
  border-color: white;
  box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.3);
}

#cuisineStyle option {
  padding: 10px;
  font-weight: 600;
}

@media (max-width: 768px) {
  .cuisine-selector {
    padding: 16px 20px;
  }
  
  #cuisineStyle {
    font-size: 0.9rem;
    padding: 10px 14px;
  }
}


/* ===================================
   GLUCOSE TIMELINE
   =================================== */

.glucose-timeline {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 16px;
  padding: 24px;
  margin-top: 24px;
  box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
  color: white;
}

.glucose-timeline h4 {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.glucose-timeline h4::before {
  content: '📈';
  font-size: 1.3rem;
}

#glucoseCurve {
  width: 100%;
  height: 200px;
  background: white;
  border-radius: 12px;
  margin-bottom: 16px;
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.1);
}

.timeline-markers {
  display: flex;
  justify-content: space-between;
  margin-bottom: 16px;
  padding: 0 8px;
}

.timeline-markers .marker {
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 600;
  border: 1px solid rgba(255, 255, 255, 0.3);
  transition: all 0.3s ease;
}

.timeline-markers .marker:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

.timeline-zones {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.timeline-zones .zone {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.zone.safe {
  background: rgba(76, 175, 80, 0.3);
  border-left: 4px solid #4caf50;
}

.zone.warning {
  background: rgba(255, 167, 38, 0.3);
  border-left: 4px solid #ffa726;
}

.zone.danger {
  background: rgba(244, 67, 54, 0.3);
  border-left: 4px solid #f44336;
}

.zone:hover {
  transform: translateX(4px);
}

@media (max-width: 768px) {
  .glucose-timeline {
    padding: 16px;
  }
  
  .timeline-markers {
    flex-direction: column;
    gap: 8px;
  }
  
  .timeline-markers .marker {
    text-align: center;
  }
  
  #glucoseCurve {
    height: 180px;
  }
}


/* ===================================
   MEAL HISTORY PANEL
   =================================== */

.meal-history-panel {
  background: white;
  border-radius: 16px;
  padding: 24px;
  margin: 24px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.meal-history-panel h3 {
  font-size: 1.4rem;
  color: var(--primary);
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.meal-history-panel h3::before {
  content: '📚';
  font-size: 1.6rem;
}

.history-filters {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.history-filters button {
  padding: 10px 20px;
  border: 2px solid var(--border-soft);
  background: white;
  border-radius: 10px;
  font-weight: 600;
  color: var(--text-main);
  cursor: pointer;
  transition: all 0.3s ease;
}

.history-filters button:hover {
  border-color: var(--primary);
  color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.2);
}

.history-filters button.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.history-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  max-height: 500px;
  overflow-y: auto;
  padding-right: 8px;
}

.history-list::-webkit-scrollbar {
  width: 6px;
}

.history-list::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.history-list::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 10px;
}

.history-item {
  background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
  border: 2px solid var(--border-soft);
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s ease;
}

.history-item:hover {
  border-color: var(--primary);
  transform: translateX(4px);
  box-shadow: 0 4px 16px rgba(236, 64, 122, 0.15);
}

.history-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.history-date {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  color: var(--text-soft);
  font-weight: 600;
}

.date-icon {
  font-size: 1.1rem;
}

.history-actions {
  display: flex;
  gap: 8px;
}

.history-actions button {
  background: rgba(236, 64, 122, 0.1);
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1.1rem;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.history-actions button:hover {
  background: var(--primary);
  transform: scale(1.1);
  color: white;
}

.favorite-btn.active {
  background: gold;
  animation: starPulse 0.5s ease;
}

@keyframes starPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

.history-items {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 12px;
}

.history-food-tag {
  background: white;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 0.85rem;
  font-weight: 600;
  border: 1px solid var(--border-soft);
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.history-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 12px;
  border-top: 1px solid var(--border-soft);
}

.history-score {
  display: flex;
  align-items: center;
  gap: 8px;
}

.score-label {
  font-size: 0.9rem;
  color: var(--text-soft);
  font-weight: 600;
}

.score-value {
  font-size: 1.1rem;
  font-weight: 700;
  padding: 4px 12px;
  border-radius: 8px;
}

.score-value.excellent {
  background: rgba(76, 175, 80, 0.2);
  color: #4caf50;
}

.score-value.good {
  background: rgba(33, 150, 243, 0.2);
  color: #2196f3;
}

.score-value.fair {
  background: rgba(255, 167, 38, 0.2);
  color: #ffa726;
}

.score-value.needs-improvement {
  background: rgba(244, 67, 54, 0.2);
  color: #f44336;
}

.history-empty {
  text-align: center;
  padding: 40px 20px;
  color: var(--text-soft);
}

.empty-icon {
  font-size: 3rem;
  display: block;
  margin-bottom: 16px;
}

.history-empty p {
  font-size: 1rem;
  font-weight: 600;
}

@media (max-width: 768px) {
  .meal-history-panel {
    padding: 16px;
  }
  
  .history-filters {
    gap: 8px;
  }
  
  .history-filters button {
    padding: 8px 16px;
    font-size: 0.85rem;
  }
  
  .history-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
}


/* ===================================
   VIRTUAL PLATE ENHANCEMENTS
   =================================== */

.virtual-plate-container {
  margin-bottom: 2rem;
  position: relative;
}

.plate-section {
  transition: all 0.3s ease;
}

.plate-section.filled {
  background: rgba(76, 175, 80, 0.1) !important;
  border: 2px solid rgba(76, 175, 80, 0.3);
}

.plate-section.active {
  transform: scale(1.02);
  box-shadow: 0 4px 20px rgba(236, 64, 122, 0.3);
  border: 2px solid var(--primary);
}

.section-label {
  font-weight: 700;
  font-size: 0.85rem;
  color: var(--text-soft);
  text-align: center;
  pointer-events: none;
  z-index: 1;
  position: relative;
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
}

.plate-section.filled .section-label {
  color: #4caf50;
  font-weight: 800;
}

.dropped-food-item {
  font-size: 1.5rem;
  animation: dropIn 0.3s ease;
  position: relative;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.dropped-food-item:hover {
  transform: scale(1.2) rotate(10deg);
}

.plate-btn {
  position: relative;
  overflow: hidden;
}

.plate-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.5);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.plate-btn:active::before {
  width: 300px;
  height: 300px;
}

.save-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
}

/* Share button styling */
.share-meal-btn {
  padding: 0.8rem 1.5rem;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  display: flex;
  align-items: center;
  gap: 8px;
}

.share-meal-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
}

.share-icon {
  font-size: 1.1rem;
}

/* Notification Toast */
.notification-toast {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  padding: 16px 24px;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
  z-index: 10000;
  animation: slideInUp 0.3s ease;
  font-weight: 600;
}

@keyframes slideInUp {
  from {
    transform: translateY(100px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@media (max-width: 768px) {
  .plate-actions {
    flex-direction: column;
    gap: 12px;
  }
  
  .plate-btn {
    width: 100%;
  }
}


/* ===================================
   SHARE MEAL FUNCTIONALITY
   =================================== */

.share-meal-btn {
  padding: 0.8rem 1.5rem;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 2px solid transparent;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-family: 'Manrope', sans-serif;
  position: relative;
  overflow: hidden;
}

.share-meal-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.share-meal-btn:hover::before {
  width: 300px;
  height: 300px;
}

.share-meal-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.share-icon {
  font-size: 1.1rem;
  position: relative;
  z-index: 1;
}

.share-meal-btn span {
  position: relative;
  z-index: 1;
}

/* Share Modal */
.share-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: white;
  border-radius: 20px;
  padding: 32px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  z-index: 10000;
  max-width: 500px;
  width: 90%;
  opacity: 0;
  transition: all 0.3s ease;
}

.share-modal.active {
  display: block;
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.share-modal h3 {
  font-size: 1.6rem;
  color: var(--primary);
  margin-bottom: 24px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.share-modal h3::before {
  content: '📤';
  font-size: 1.8rem;
}

.share-preview {
  background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
  border: 2px solid var(--border-soft);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 24px;
  min-height: 150px;
}

.share-preview-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.share-preview-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding-bottom: 12px;
  border-bottom: 2px solid var(--border-soft);
}

.share-preview-icon {
  font-size: 2.5rem;
}

.share-preview-title {
  flex: 1;
}

.share-preview-title h4 {
  font-size: 1.2rem;
  color: var(--text-main);
  margin-bottom: 4px;
}

.share-preview-title p {
  font-size: 0.85rem;
  color: var(--text-soft);
}

.share-preview-foods {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.share-food-tag {
  background: white;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 600;
  border: 1px solid var(--border-soft);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.share-preview-score {
  display: flex;
  justify-content: space-between;
  padding: 12px;
  background: white;
  border-radius: 10px;
  margin-top: 8px;
}

.share-stat {
  text-align: center;
}

.share-stat-value {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--primary);
  display: block;
}

.share-stat-label {
  font-size: 0.8rem;
  color: var(--text-soft);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.share-options {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.share-options button {
  padding: 14px 20px;
  border: 2px solid var(--border-soft);
  background: white;
  border-radius: 12px;
  font-weight: 600;
  color: var(--text-main);
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 0.95rem;
}

.share-options button:hover {
  border-color: var(--primary);
  background: var(--primary);
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(236, 64, 122, 0.3);
}

.share-options button .icon {
  font-size: 1.2rem;
}

/* Share Modal Backdrop */
.share-backdrop {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.share-backdrop.active {
  display: block;
  opacity: 1;
}

/* Close button for modal */
.share-modal-close {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: rgba(236, 64, 122, 0.1);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.3rem;
  color: var(--primary);
  transition: all 0.3s ease;
}

.share-modal-close:hover {
  background: var(--primary);
  color: white;
  transform: rotate(90deg);
}

/* Success notification */
.share-success {
  position: fixed;
  bottom: 24px;
  right: 24px;
  background: linear-gradient(135deg, #4caf50, #45a049);
  color: white;
  padding: 16px 24px;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(76, 175, 80, 0.4);
  z-index: 10001;
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 600;
  animation: slideInUp 0.3s ease;
}

.share-success-icon {
  font-size: 1.5rem;
}

@media (max-width: 768px) {
  .share-modal {
    width: 95%;
    padding: 24px;
  }
  
  .share-options {
    grid-template-columns: 1fr;
  }
  
  .share-options button {
    padding: 12px 16px;
  }
}


/* ===================================
   FOOD INFO TOOLTIPS
   =================================== */

.info-icon {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 28px;
  height: 28px;
  background: rgba(102, 126, 234, 0.15);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 1rem;
  color: #667eea;
  transition: all 0.3s ease;
  z-index: 10;
  border: 2px solid transparent;
}

.info-icon:hover {
  background: #667eea;
  color: white;
  transform: scale(1.15) rotate(15deg);
  border-color: white;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.info-icon:active {
  transform: scale(0.95);
}

/* Ensure food-item has position relative for absolute positioning */
.food-item {
  position: relative;
}

/* Food Info Tooltip */
.food-info-tooltip {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  background: white;
  border-radius: 20px;
  padding: 0;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  z-index: 10001;
  max-width: 550px;
  width: 90%;
  max-height: 85vh;
  overflow: hidden;
  opacity: 0;
  transition: all 0.3s ease;
}

.food-info-tooltip.active {
  display: block;
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.tooltip-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-radius: 20px 20px 0 0;
}

.tooltip-header h4 {
  font-size: 1.6rem;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 700;
}

.close-tooltip {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.3);
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  font-weight: 300;
  line-height: 1;
}

.close-tooltip:hover {
  background: white;
  color: #667eea;
  transform: rotate(90deg);
  border-color: white;
}

.tooltip-body {
  padding: 24px;
  max-height: calc(85vh - 96px);
  overflow-y: auto;
}

.tooltip-body::-webkit-scrollbar {
  width: 6px;
}

.tooltip-body::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.tooltip-body::-webkit-scrollbar-thumb {
  background: #667eea;
  border-radius: 10px;
}

.nutrient-info {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  margin-bottom: 12px;
  background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
  border-radius: 12px;
  border-left: 4px solid #667eea;
  transition: all 0.3s ease;
}

.nutrient-info:hover {
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
}

.nutrient-info .label {
  font-weight: 700;
  color: var(--text-main);
  font-size: 0.95rem;
}

.nutrient-info .value {
  font-weight: 600;
  color: #667eea;
  font-size: 0.95rem;
  text-align: right;
}

.nutrient-info ul {
  list-style: none;
  padding: 0;
  margin: 8px 0 0 0;
  width: 100%;
}

.nutrient-info ul li {
  padding: 6px 0 6px 24px;
  position: relative;
  color: var(--text-soft);
  font-size: 0.9rem;
  line-height: 1.5;
}

.nutrient-info ul li::before {
  content: '✓';
  position: absolute;
  left: 0;
  color: #4caf50;
  font-weight: 700;
  font-size: 1.1rem;
}

.portion-guide {
  margin-top: 20px;
  padding: 20px;
  background: linear-gradient(135deg, #fff5e6 0%, #ffe9cc 100%);
  border-radius: 12px;
  border: 2px solid #ffa726;
}

.portion-guide h5 {
  color: #f57c00;
  font-size: 1.1rem;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.portion-guide h5::before {
  content: '📏';
  font-size: 1.3rem;
}

.portion-visual {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
}

.portion-visual img {
  width: 100%;
  max-width: 200px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.portion-visual p {
  font-weight: 600;
  color: #f57c00;
  font-size: 1rem;
  margin: 0;
  text-align: center;
  background: white;
  padding: 8px 16px;
  border-radius: 8px;
}

.recipe-links {
  margin-top: 20px;
  padding: 20px;
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
  border-radius: 12px;
  border: 2px solid #66bb6a;
}

.recipe-links h5 {
  color: #2e7d32;
  font-size: 1.1rem;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.recipe-links h5::before {
  content: '👨‍🍳';
  font-size: 1.3rem;
}

.recipe-links a {
  display: block;
  padding: 12px 16px;
  margin-bottom: 8px;
  background: white;
  border-radius: 10px;
  color: #2e7d32;
  text-decoration: none;
  font-weight: 600;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.recipe-links a:hover {
  background: #2e7d32;
  color: white;
  transform: translateX(8px);
  border-color: #2e7d32;
  box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
}

.recipe-links a::before {
  content: '→ ';
  font-weight: 700;
}

/* Tooltip Backdrop */
.tooltip-backdrop {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  z-index: 10000;
  opacity: 0;
  transition: opacity 0.3s ease;
  backdrop-filter: blur(4px);
}

.tooltip-backdrop.active {
  display: block;
  opacity: 1;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .food-info-tooltip {
    width: 95%;
    max-height: 90vh;
  }
  
  .tooltip-header {
    padding: 20px 16px;
  }
  
  .tooltip-header h4 {
    font-size: 1.3rem;
  }
  
  .tooltip-body {
    padding: 16px;
  }
  
  .nutrient-info {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .nutrient-info .value {
    text-align: left;
  }
  
  /* Daily Tip Mobile Styles */
  .daily-tip {
    padding: 1rem 1.5rem;
    gap: 1rem;
  }
  
  .tip-icon {
    font-size: 2rem;
  }
  
  .daily-tip p {
    font-size: 1rem;
  }
}

/* Animation for tooltip */
@keyframes tooltipSlideIn {
  from {
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
  }
  to {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
}

.food-info-tooltip.active {
  animation: tooltipSlideIn 0.3s ease;
}

/* ================================
   REDESIGNED TRACKER MODAL - MODERN UI
   ================================ */

.sugar-tracker-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10001;
  opacity: 0;
  transition: opacity 0.4s ease;
  overflow: hidden;
}

.sugar-tracker-modal.active {
  display: flex;
  opacity: 1;
  align-items: center;
  justify-content: center;
}

.tracker-container-new {
  width: 95%;
  max-width: 1400px;
  max-height: 95vh;
  background: linear-gradient(135deg, #ffffff 0%, #faf5fb 100%);
  border-radius: 32px;
  box-shadow: 0 30px 90px rgba(0, 0, 0, 0.3);
  overflow: hidden;
  position: relative;
  display: flex;
  flex-direction: column;
}

.close-tracker {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  border: 2px solid rgba(236, 64, 122, 0.2);
  cursor: pointer;
  font-size: 1.5rem;
  color: var(--primary);
  transition: all 0.3s;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-tracker:hover {
  background: var(--primary);
  color: white;
  transform: rotate(90deg) scale(1.1);
  box-shadow: 0 8px 24px rgba(236, 64, 122, 0.4);
}

/* Modern Header */
.tracker-header-modern {
  padding: 2rem 2.5rem 1.5rem;
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 100%);
  position: relative;
  overflow: hidden;
}

.tracker-header-modern::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    radial-gradient(circle at 20% 50%, rgba(255,255,255,0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(255,255,255,0.1) 0%, transparent 50%);
  pointer-events: none;
}

.header-glass-card {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 1.5rem;
  border: 1px solid rgba(255, 255, 255, 0.2);
  position: relative;
}

.header-content-flex {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.header-icon-modern {
  font-size: 3.5rem;
  filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2));
  animation: float 3s ease-in-out infinite;
}

.tracker-title-modern {
  font-size: 2rem;
  color: white;
  margin: 0;
  font-weight: 700;
  text-shadow: 0 2px 12px rgba(0,0,0,0.2);
}

.tracker-subtitle {
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.95rem;
  margin: 0.5rem 0 0;
}

.quick-stats-row {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.quick-stat-pill {
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(10px);
  padding: 0.6rem 1.2rem;
  border-radius: 50px;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: white;
  font-weight: 600;
  font-size: 0.9rem;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.quick-stat-pill.success {
  background: rgba(102, 187, 106, 0.3);
  border-color: rgba(102, 187, 106, 0.5);
}

.stat-icon {
  font-size: 1.1rem;
}

/* Tab Navigation */
.tracker-tabs {
  display: flex;
  background: white;
  padding: 0 2rem;
  gap: 0.5rem;
  border-bottom: 2px solid var(--lavender);
  position: sticky;
  top: 0;
  z-index: 10;
}

.tab-btn {
  padding: 1rem 1.5rem;
  background: transparent;
  border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  font-weight: 600;
  color: var(--text-soft);
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.95rem;
}

.tab-btn:hover {
  color: var(--primary);
  background: var(--lavender);
}

.tab-btn.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
  background: linear-gradient(to bottom, rgba(236, 64, 122, 0.05), transparent);
}

.tab-icon {
  font-size: 1.2rem;
}

/* Tab Content */
.tab-content {
  display: none;
  padding: 2rem 2.5rem;
  overflow-y: auto;
  flex: 1;
}

.tab-content.active {
  display: block;
}

.tab-content::-webkit-scrollbar {
  width: 10px;
}

.tab-content::-webkit-scrollbar-track {
  background: var(--lavender);
  border-radius: 10px;
}

.tab-content::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 10px;
}

/* Glass Card Design */
.glass-card {
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 1.5rem;
  border: 1px solid rgba(236, 64, 122, 0.1);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
}

.card-title {
  font-size: 1.3rem;
  color: var(--primary);
  margin-bottom: 1.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 700;
}

.title-icon {
  font-size: 1.5rem;
}

/* LOG MEAL TAB */
.log-meal-grid {
  display: grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap: 2rem;
}

.meal-entry-card {
  height: fit-content;
}

.form-group-modern {
  margin-bottom: 1.5rem;
}

.form-label {
  display: block;
  font-weight: 600;
  color: var(--text-main);
  margin-bottom: 0.8rem;
  font-size: 0.95rem;
}

.input-modern {
  width: 100%;
  padding: 0.9rem 1.2rem;
  border: 2px solid rgba(236, 64, 122, 0.2);
  border-radius: 12px;
  font-size: 0.95rem;
  font-family: 'Manrope', sans-serif;
  transition: all 0.3s;
  background: white;
}

.input-modern:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(236, 64, 122, 0.1);
}

.datetime-flex {
  display: flex;
  gap: 0.75rem;
}

.btn-now {
  padding: 0.9rem 1.5rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  white-space: nowrap;
}

.btn-now:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(236, 64, 122, 0.3);
}

/* Meal Type Carousel */
.meal-type-carousel {
  display: flex;
  gap: 0.75rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
}

.meal-type-carousel::-webkit-scrollbar {
  height: 6px;
}

.meal-type-carousel::-webkit-scrollbar-thumb {
  background: var(--primary-light);
  border-radius: 10px;
}

.meal-type-card {
  min-width: 100px;
  padding: 1rem;
  background: white;
  border: 2px solid rgba(236, 64, 122, 0.2);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s;
  text-align: center;
}

.meal-type-card:hover {
  border-color: var(--primary);
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(236, 64, 122, 0.2);
}

.meal-type-card.selected {
  background: linear-gradient(135deg, rgba(236, 64, 122, 0.1), rgba(244, 143, 177, 0.15));
  border-color: var(--primary);
  box-shadow: 0 8px 24px rgba(236, 64, 122, 0.3);
}

.meal-icon {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.meal-name {
  font-weight: 600;
  color: var(--text-main);
  font-size: 0.85rem;
  margin-bottom: 0.3rem;
}

.meal-target {
  font-size: 0.75rem;
  color: var(--text-soft);
  background: var(--lavender);
  padding: 0.2rem 0.5rem;
  border-radius: 8px;
  display: inline-block;
}

/* Glucose Input */
.glucose-input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  gap: 1rem;
  background: white;
  border: 3px solid rgba(236, 64, 122, 0.2);
  border-radius: 16px;
  padding: 1.2rem;
  transition: all 0.3s;
}

.glucose-input-wrapper:focus-within {
  border-color: var(--primary);
  box-shadow: 0 8px 32px rgba(236, 64, 122, 0.15);
}

.glucose-input-large {
  flex: 1;
  border: none;
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--primary);
  text-align: center;
  font-family: 'Playfair Display', serif;
  background: transparent;
}

.glucose-input-large:focus {
  outline: none;
}

.glucose-unit {
  font-size: 1.2rem;
  color: var(--text-soft);
  font-weight: 600;
}

.glucose-status {
  position: absolute;
  top: -12px;
  right: 1rem;
  padding: 0.4rem 1rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  display: none;
}

.glucose-status.show {
  display: block;
}

.glucose-status.normal {
  background: #e8f5e9;
  color: #2e7d32;
}

.glucose-status.high {
  background: #ffebee;
  color: #c62828;
}

.glucose-status.low {
  background: #fff3e0;
  color: #e65100;
}

.quick-glucose-btns {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin-top: 0.75rem;
}

.quick-glucose {
  padding: 0.6rem 1.2rem;
  background: white;
  border: 2px solid var(--primary-light);
  border-radius: 10px;
  color: var(--primary);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.95rem;
}

.quick-glucose:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.05);
}

/* Food Search */
.food-search-wrapper {
  position: relative;
}

.food-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 2px solid var(--primary-light);
  border-radius: 12px;
  margin-top: 0.5rem;
  max-height: 300px;
  overflow-y: auto;
  z-index: 10;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
  display: none;
}

.food-suggestions.show {
  display: block;
}

.food-suggestion-item.no-match {
  color: #999;
  font-style: italic;
  cursor: default;
  text-align: center;
}

.food-suggestion-item.no-match:hover {
  background: white;
}

.metric-values {
  display: flex;
  align-items: center;
  gap: 1rem;
  justify-content: space-between;
}

.metric-values .vs-text {
  color: #999;
  font-size: 0.9rem;
  font-weight: 600;
}

.verdict-benefits {
  margin-top: 1rem;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
}

.verdict-benefits ul {
  margin: 0.5rem 0 0 0;
  padding-left: 1.5rem;
}

.verdict-benefits li {
  margin: 0.25rem 0;
  color: #28a745;
}

.food-name-gi {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
}

.food-name {
  font-weight: 600;
  color: var(--text-main);
}

.food-gi {
  font-size: 0.85rem;
  color: var(--text-soft);
}

.gi-badge {
  padding: 0.3rem 0.8rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}

.gi-low {
  background: #e8f5e9;
  color: #2e7d32;
}

.gi-medium {
  background: #fff3e0;
  color: #e65100;
}

.gi-high {
  background: #ffebee;
  color: #c62828;
}

.selected-foods {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 1rem;
}

.food-chip {
  background: linear-gradient(135deg, var(--primary-light), var(--primary));
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
  font-weight: 600;
}

.remove-food {
  background: rgba(255, 255, 255, 0.3);
  border: none;
  color: white;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8rem;
  transition: all 0.2s;
}

.remove-food:hover {
  background: rgba(255, 255, 255, 0.5);
  transform: rotate(90deg);
}

.textarea-modern {
  width: 100%;
  padding: 0.9rem 1.2rem;
  border: 2px solid rgba(236, 64, 122, 0.2);
  border-radius: 12px;
  font-size: 0.95rem;
  font-family: 'Manrope', sans-serif;
  resize: vertical;
  transition: all 0.3s;
}

.textarea-modern:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(236, 64, 122, 0.1);
}

/* Action Buttons */
.action-btns-row {
  display: flex;
  gap: 1rem;
  margin-top: 2rem;
}

.btn-primary-modern,
.btn-secondary-modern {
  flex: 1;
  padding: 1rem 1.5rem;
  border: none;
  border-radius: 12px;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.btn-primary-modern {
  background: linear-gradient(135deg, #66bb6a, #4caf50);
  color: white;
  box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
}

.btn-primary-modern:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 28px rgba(76, 175, 80, 0.4);
}

.btn-secondary-modern {
  background: white;
  color: var(--text-main);
  border: 2px solid var(--border-soft);
}

.btn-secondary-modern:hover {
  border-color: var(--primary);
  background: var(--lavender);
}

/* Preview Column */
.preview-column {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.preview-card {
  flex: 1;
}

.entry-preview {
  min-height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.preview-placeholder {
  text-align: center;
  color: var(--text-soft);
}

.placeholder-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.5;
}

.preview-content {
  background: white;
  padding: 1.5rem;
  border-radius: 12px;
  border-left: 4px solid var(--primary);
}

.preview-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.preview-meal-type {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 600;
  font-size: 1.1rem;
}

.preview-datetime {
  font-size: 0.85rem;
  color: var(--text-soft);
}

.preview-glucose {
  text-align: center;
  padding: 1rem;
  background: var(--lavender);
  border-radius: 12px;
  margin-bottom: 1rem;
}

.preview-glucose-value {
  font-size: 2rem;
  font-weight: 700;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.preview-foods {
  margin-bottom: 1rem;
}

.preview-foods-title {
  font-size: 0.9rem;
  color: var(--text-soft);
  margin-bottom: 0.5rem;
}

.preview-notes {
  font-size: 0.9rem;
  color: var(--text-soft);
  font-style: italic;
}

/* Quick Tips */
.insights-quick {
  background: linear-gradient(135deg, #fff9e6, #fff3cc);
  border-color: #ffd54f;
}

.tips-list {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.tip-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem;
  background: white;
  border-radius: 10px;
  font-size: 0.9rem;
  color: var(--text-main);
}

.tip-icon {
  font-size: 1.5rem;
}

/* SEARCH FOODS TAB */
.search-foods-container {
  max-width: 1200px;
  margin: 0 auto;
}

.search-header-card {
  margin-bottom: 2rem;
}

.search-subtitle {
  color: var(--text-soft);
  font-size: 0.95rem;
  margin-bottom: 1.5rem;
}

.search-bar-modern {
  display: flex;
  align-items: center;
  gap: 1rem;
  background: white;
  padding: 0.5rem;
  border-radius: 16px;
  border: 2px solid rgba(236, 64, 122, 0.2);
  margin-bottom: 1.5rem;
  transition: all 0.3s;
}

.search-bar-modern:focus-within {
  border-color: var(--primary);
  box-shadow: 0 8px 32px rgba(236, 64, 122, 0.15);
}

.search-icon {
  font-size: 1.5rem;
  margin-left: 0.5rem;
}

.search-input-large {
  flex: 1;
  border: none;
  font-size: 1.1rem;
  padding: 0.75rem;
  font-family: 'Manrope', sans-serif;
  background: transparent;
}

.search-input-large:focus {
  outline: none;
}

.search-btn-modern {
  padding: 0.75rem 2rem;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  border-radius: 12px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}

.search-btn-modern:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(236, 64, 122, 0.3);
}

.search-filters {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.filter-chip {
  padding: 0.6rem 1.2rem;
  background: white;
  border: 2px solid var(--border-soft);
  border-radius: 20px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s;
  font-size: 0.9rem;
  color: var(--text-soft);
}

.filter-chip:hover {
  border-color: var(--primary-light);
}

.filter-chip.active {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border-color: var(--primary);
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.3);
}

.search-results-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 1.5rem;
}

.search-placeholder {
  grid-column: 1 / -1;
  text-align: center;
  padding: 4rem 2rem;
  color: var(--text-soft);
}

.placeholder-icon-large {
  font-size: 5rem;
  opacity: 0.3;
  margin-bottom: 1rem;
}

.food-card {
  background: white;
  border-radius: 16px;
  padding: 1.5rem;
  border: 2px solid rgba(236, 64, 122, 0.1);
  transition: all 0.3s;
  cursor: pointer;
}

.food-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
  border-color: var(--primary);
}

.food-card-header {
  display: flex;
  justify-content: space-between;
  align-items: start;
  margin-bottom: 1rem;
}

.food-card-icon {
  font-size: 2.5rem;
}

.food-card-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 0.5rem;
}

.food-card-category {
  font-size: 0.85rem;
  color: var(--text-soft);
  text-transform: capitalize;
}

.food-card-stats {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-bottom: 1rem;
}

.food-stat {
  text-align: center;
  padding: 0.75rem;
  background: var(--lavender);
  border-radius: 10px;
}

.stat-value-food {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.stat-label-food {
  font-size: 0.8rem;
  color: var(--text-soft);
  margin-top: 0.2rem;
}

.food-card-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 1rem;
  border-top: 1px solid var(--lavender);
}

.impact-label {
  font-size: 0.85rem;
  color: var(--text-soft);
  font-weight: 600;
}

.add-to-compare {
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, var(--primary-light), var(--primary));
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  transition: all 0.3s;
}

.add-to-compare:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.3);
}


/* COMPARE FOODS TAB */
.compare-container {
  max-width: 1200px;
  margin: 0 auto;
}

.compare-header-card {
  margin-bottom: 2rem;
}

.compare-selection-area {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 2rem;
  margin-bottom: 2rem;
  align-items: start;
}

.compare-slot {
  position: relative;  /* ADD THIS LINE */
  background: white;
  border-radius: 16px;
  padding: 1.5rem;
  border: 2px solid rgba(236, 64, 122, 0.1);
  min-height: 400px;  /* ADD THIS LINE - ensures slot has height */
}


.slot-header {
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 1rem;
  font-size: 1.1rem;
}

.compare-search-input {
  width: 100%;
  padding: 0.9rem 1.2rem;
  border: 2px solid rgba(236, 64, 122, 0.2);
  border-radius: 12px;
  font-size: 0.95rem;
  font-family: 'Manrope', sans-serif;
  margin-bottom: 1rem;
  transition: all 0.3s;
  display: block;  /* ADD THIS LINE - force display */
  visibility: visible;  /* ADD THIS LINE - ensure visibility */
  opacity: 1;  /* ADD THIS LINE - ensure opacity */
  min-height: 48px;  /* ADD THIS LINE - ensure clickable area */
  background-color: white;  /* ADD THIS LINE - ensure background */
  color: #333;  /* ADD THIS LINE - ensure text is visible */
  z-index: 1;  /* ADD THIS LINE - ensure it's above other elements */
}


/* EMERGENCY FIX - Force input visibility */
#compareA,
#compareB {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  width: 100% !important;
  height: auto !important;
  min-height: 48px !important;
  padding: 0.9rem 1.2rem !important;
  border: 2px solid #ec407a !important;
  background: white !important;
  color: #333 !important;
  font-size: 16px !important;
  border-radius: 12px !important;
  margin: 10px 0 !important;
  z-index: 10 !important;
  position: relative !important;
}

#compareA::placeholder,
#compareB::placeholder {
  color: #999 !important;
  opacity: 1 !important;
}



.compare-search-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(236, 64, 122, 0.1);
}

.compare-suggestions {
  position: absolute;
  background: white;
  border: 2px solid var(--primary-light);
  border-radius: 12px;
  max-height: 300px;
  overflow-y: auto;
  z-index: 10;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
  width: calc(100% - 3rem);
  display: none;
}

.compare-suggestions.show {
  display: block;
}

.comparison-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  opacity: 0;
  transition: opacity 0.3s;
}

.comparison-overlay.active {
  display: block;
  opacity: 1;
}


.selected-food-compare {
  min-height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;  /* ADD THIS LINE */
  background: #f8f9fa;  /* ADD THIS LINE - light background */
  border-radius: 12px;  /* ADD THIS LINE */
  padding: 1rem;  /* ADD THIS LINE */
  margin-top: 1rem;  /* ADD THIS LINE - spacing from input */

}


.compare-slot .slot-header {
  display: block;
  margin-bottom: 1rem;
  visibility: visible;
}

.compare-slot input[type="text"] {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
}


.slot-placeholder {
  text-align: center;
  color: var(--text-soft);
  font-style: italic;
  padding: 2rem;
}

.compare-vs {
  display: flex;
  align-items: center;
  justify-content: center;
  padding-top: 4rem;
}

.vs-circle {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 1.2rem;
  box-shadow: 0 8px 24px rgba(236, 64, 122, 0.4);
}

.comparison-results {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  border: 2px solid rgba(236, 64, 122, 0.1);
  min-height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.comparison-placeholder {
  text-align: center;
  color: var(--text-soft);
}

.comparison-grid {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 2rem;
}

.comparison-food-detail {
  text-align: center;
  padding: 1.5rem;
}

.comparison-food-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.comparison-food-name {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-main);
  margin-bottom: 1rem;
}

.comparison-metrics {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-top: 2rem;
}

.metric-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  background: var(--lavender);
  border-radius: 10px;
}

.metric-label {
  font-weight: 600;
  color: var(--text-main);
}

.metric-values {
  display: flex;
  gap: 2rem;
  align-items: center;
}

.metric-value {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--primary);
}

.metric-value.winner {
  color: #4caf50;
  font-size: 1.4rem;
}

.comparison-verdict {
  text-align: center;
  margin-top: 2rem;
  padding: 1.5rem;
  background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
  border-radius: 12px;
  border: 2px solid #66bb6a;
}

.verdict-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: #2e7d32;
  margin-bottom: 0.5rem;
}

.verdict-text {
  color: #1b5e20;
  font-size: 0.95rem;
}



.metric-divider {
  width: 2px;
  height: 100%;
  background: var(--border-soft);
}


/* HISTORY TAB */
.history-modern-container {
  max-width: 1200px;
  margin: 0 auto;
}

.history-controls {
  margin-bottom: 2rem;
}

.controls-flex {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.search-history {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: white;
  padding: 0.5rem 1rem;
  border-radius: 12px;
  border: 2px solid rgba(236, 64, 122, 0.2);
  flex: 1;
  max-width: 400px;
}

.search-input-small {
  border: none;
  flex: 1;
  font-size: 0.95rem;
  font-family: 'Manrope', sans-serif;
  background: transparent;
}

.search-input-small:focus {
  outline: none;
}

.history-actions {
  display: flex;
  gap: 0.5rem;
}

.btn-icon-modern {
  width: 44px;
  height: 44px;
  border-radius: 12px;
  background: white;
  border: 2px solid var(--border-soft);
  cursor: pointer;
  font-size: 1.2rem;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-icon-modern:hover {
  border-color: var(--primary);
  background: var(--lavender);
  transform: scale(1.05);
}

.btn-icon-modern.danger:hover {
  border-color: #c62828;
  background: #ffebee;
}

.date-range-filter {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-weight: 600;
}

.select-modern {
  padding: 0.75rem 1rem;
  border: 2px solid rgba(236, 64, 122, 0.2);
  border-radius: 12px;
  font-size: 0.95rem;
  font-family: 'Manrope', sans-serif;
  cursor: pointer;
  transition: all 0.3s;
  background: white;
}

.select-modern:focus {
  outline: none;
  border-color: var(--primary);
}

.history-stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.stat-card-modern {
  background: white;
  border-radius: 16px;
  padding: 1.5rem;
  border: 2px solid rgba(236, 64, 122, 0.1);
  display: flex;
  align-items: center;
  gap: 1.5rem;
  transition: all 0.3s;
}

.stat-card-modern:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  border-color: var(--primary);
}

.stat-icon-modern {
  font-size: 3rem;
  width: 60px;
  height: 60px;
  border-radius: 16px;
  background: var(--lavender);
  display: flex;
  align-items: center;
  justify-content: center;
}

.stat-icon-modern.success {
  background: #e8f5e9;
}

.stat-content {
  flex: 1;
}

.stat-value-modern {
  font-size: 2rem;
  font-weight: 700;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
  line-height: 1;
  margin-bottom: 0.3rem;
}

.stat-label-modern {
  font-size: 0.9rem;
  color: var(--text-soft);
}

/* Timeline View */
.timeline-view {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.history-day-group {
  background: white;
  border-radius: 16px;
  padding: 1.5rem;
  border: 2px solid rgba(236, 64, 122, 0.1);
}

.day-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--lavender);
}

.day-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--text-main);
}

.day-summary {
  display: flex;
  gap: 1rem;
  font-size: 0.85rem;
  color: var(--text-soft);
}

.history-entries {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.history-entry-card {
  background: var(--lavender);
  border-radius: 12px;
  padding: 1.2rem;
  border-left: 4px solid var(--primary);
  transition: all 0.3s;
  cursor: pointer;
}

.history-entry-card:hover {
  background: rgba(244, 143, 177, 0.15);
  transform: translateX(4px);
}

.entry-header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
}

.entry-time-type {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

.entry-icon {
  font-size: 1.5rem;
}

.entry-time {
  font-size: 0.9rem;
  color: var(--text-soft);
}

.entry-type {
  font-weight: 600;
  color: var(--text-main);
}

.entry-glucose-display {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.entry-glucose-value {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  font-family: 'Playfair Display', serif;
}

.entry-status-badge {
  padding: 0.3rem 0.8rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}

.entry-foods-row {
  margin-bottom: 0.5rem;
}

.entry-foods-label {
  font-size: 0.85rem;
  color: var(--text-soft);
  margin-bottom: 0.3rem;
}

.entry-food-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.entry-food-chip {
  background: white;
  padding: 0.3rem 0.8rem;
  border-radius: 12px;
  font-size: 0.8rem;
  color: var(--text-main);
}

.entry-notes {
  font-size: 0.85rem;
  color: var(--text-soft);
  font-style: italic;
  margin-top: 0.5rem;
}

.entry-actions {
  margin-top: 0.75rem;
  padding-top: 0.75rem;
  border-top: 1px solid white;
  display: flex;
  gap: 0.5rem;
}

.entry-action-btn {
  padding: 0.4rem 1rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  transition: all 0.3s;
}

.entry-action-btn.edit {
  background: white;
  color: var(--primary);
}

.entry-action-btn.delete {
  background: #ffebee;
  color: #c62828;
}

.entry-action-btn:hover {
  transform: scale(1.05);
}

/* Responsive Design */
@media (max-width: 1200px) {
  .log-meal-grid {
    grid-template-columns: 1fr;
  }
  
  .preview-column {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
  }
}

@media (max-width: 768px) {
  .tracker-container-new {
    width: 100%;
    height: 100%;
    max-height: 100vh;
    border-radius: 0;
  }
  
  .tracker-header-modern {
    padding: 1.5rem 1rem 1rem;
  }
  
  .tracker-title-modern {
    font-size: 1.5rem;
  }
  
  .quick-stats-row {
    flex-direction: column;
  }
  
  .tracker-tabs {
    padding: 0 1rem;
    overflow-x: auto;
  }
  
  .tab-content {
    padding: 1.5rem 1rem;
  }
  
  .log-meal-grid,
  .preview-column {
    grid-template-columns: 1fr;
  }
  
  .meal-type-carousel {
    overflow-x: scroll;
  }
  
  .search-results-grid {
    grid-template-columns: 1fr;
  }
  
  .compare-selection-area {
    grid-template-columns: 1fr;
  }
  
  .compare-vs {
    padding: 1rem 0;
  }
  
  .history-stats-row {
    grid-template-columns: 1fr;
  }
  
  .day-summary {
    flex-direction: column;
    gap: 0.5rem;
  }
}

/* Backdrop */
.tracker-backdrop {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  z-index: 10000;
  opacity: 0;
  transition: opacity 0.4s;
  backdrop-filter: blur(8px);
}

.tracker-backdrop.active {
  display: block;
  opacity: 1;
}

/* Animations */
@keyframes float {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

/* Insights Section */
.insights-section {
  background: linear-gradient(135deg, #fff9e6, #fff3cc);
  padding: 1.5rem;
  border-radius: 16px;
  border: 2px solid #ffd54f;
}

.insights-section h3 {
  margin-bottom: 1rem;
  color: #f57f17;
}

.insights-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.insight-card {
  background: white;
  padding: 1rem;
  border-radius: 12px;
  border-left: 4px solid #ffa726;
}

.insight-card h4 {
  color: #f57c00;
  margin-bottom: 0.5rem;
  font-size: 1rem;
}

.insight-card p {
  color: var(--text-soft);
  font-size: 0.9rem;
}

.tracker-backdrop {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  z-index: 10000;
  opacity: 0;
  transition: opacity 0.3s;
  backdrop-filter: blur(4px);
}

.tracker-backdrop.active {
  display: block;
  opacity: 1;
}

@media (max-width: 768px) {
  .tracker-container {
    padding: 1.5rem 1rem;
  }
  
  .reading-type-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .trend-stats {
    grid-template-columns: 1fr;
  }
  
  .history-table {
    font-size: 0.85rem;
  }
}

/* ================================
   MOBILE RESPONSIVE ADDITIONS
   ================================ */

/* Hero title glowing - was fixed size, now responsive */
.hero-title-glowing {
  font-size: clamp(1.8rem, 5vw, 3.5rem);
  line-height: 1.1;
  margin-bottom: 1.5rem;
  font-weight: 800;
  color: #212121;
}

.title-emphasis-glow {
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 50%, #ad1457 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  display: inline-block;
  animation: title-shimmer 3s ease-in-out infinite;
  filter: drop-shadow(0 2px 8px rgba(236, 64, 122, 0.3));
}

@keyframes title-shimmer {
  0%, 100% { 
    filter: brightness(1) drop-shadow(0 2px 8px rgba(236, 64, 122, 0.3)); 
  }
  50% { 
    filter: brightness(1.3) drop-shadow(0 4px 16px rgba(236, 64, 122, 0.5)); 
  }
}

/* ================================================================
   COMPREHENSIVE MOBILE RESPONSIVE ADDITIONS
   Targeting all components not yet fully covered
   ================================================================ */

/* --- Modal header text --- */
@media (max-width: 768px) {
  .modal-header-modern h2 {
    font-size: 1.4rem;
  }
  .modal-header-modern p {
    font-size: 0.95rem;
  }
  .comparison-modal-content-new {
    width: 95%;
    padding: 1.25rem;
  }
}

/* --- Meal planner container (1fr 1fr grid) --- */
@media (max-width: 768px) {
  .meal-planner-container {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
}

/* --- Tracker container (1.5fr 1fr grid) --- */
@media (max-width: 768px) {
  .tracker-container {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
}

/* --- Prediction details (3-col grid) --- */
@media (max-width: 768px) {
  .prediction-details {
    grid-template-columns: 1fr;
  }
}

/* --- Entry row (2-col grid in modal forms) --- */
@media (max-width: 768px) {
  .entry-row {
    grid-template-columns: 1fr;
  }
}

/* --- comparison-grid new tracker (1fr auto 1fr) --- */
@media (max-width: 768px) {
  .comparison-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  .metric-divider {
    display: none;
  }
  .metric-values {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  .metric-label {
    flex: 0 0 auto;
    width: 100%;
  }
}

/* --- Date range filter --- */
@media (max-width: 768px) {
  .date-range-filter {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
  .select-modern {
    width: 100%;
  }
}

/* --- Compare selection area in tracker (1fr auto 1fr) --- */
@media (max-width: 768px) {
  .compare-selection-area {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  .compare-slot {
    min-height: unset;
  }
}

/* --- Hero section single column on all mobile --- */
@media (max-width: 768px) {
  .hero {
    grid-template-columns: 1fr;
    gap: 2rem;
    padding: 2rem 0;
    min-height: unset;
  }
  .hero-visual-3d {
    order: -1;
  }
}

/* --- Hero stats already 1fr on mobile, improve spacing --- */
@media (max-width: 480px) {
  .hero-stats {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  .stat-item {
    padding: 1rem;
  }
  .stat-number {
    font-size: 1.6rem;
  }
}

/* --- Section title sizes on very small screens --- */
@media (max-width: 480px) {
  .section-title {
    font-size: 1.8rem;
  }
  .section-title-prominent {
    font-size: 1.8rem;
  }
  .section-subtitle-prominent {
    font-size: 1rem;
    padding: 1rem 1rem;
  }
  .section-subtitle-enhanced {
    font-size: 1rem;
    padding: 1rem;
  }
}

/* --- Quiz container on mobile --- */
@media (max-width: 480px) {
  .quiz-container {
    padding: 1.5rem 1rem;
    border-radius: 20px;
  }
  .quiz-container h2 {
    font-size: 1.8rem;
  }
}

/* --- Panel header on mobile --- */
@media (max-width: 480px) {
  .panel-header {
    padding: 2rem 1.5rem 1.5rem;
    margin: -3rem -2.5rem 2rem;
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }
  .panel-scroll {
    padding: 2rem 1.5rem;
  }
  .panel-title-block h2 {
    font-size: 1.5rem;
  }
  .panel-icon {
    font-size: 3rem;
  }
}

/* --- Tracker tools row --- */
@media (max-width: 768px) {
  .tracker-tools-row {
    grid-template-columns: 1fr;
  }
}

/* --- simulation controls --- */
@media (max-width: 480px) {
  .simulation-controls {
    gap: 0.75rem;
  }
  .sim-btn {
    padding: 1rem 1.25rem;
    flex: 1 1 calc(50% - 0.5rem);
    min-width: 0;
  }
  .sim-icon {
    font-size: 1.5rem;
  }
  .sim-label {
    font-size: 0.8rem;
  }
}

/* --- meal history suggestions container --- */
@media (max-width: 768px) {
  .meal-history-suggestions-container {
    flex-direction: column;
  }
  .meal-suggestions h3 {
    font-size: 1.5rem;
  }
}

/* --- Food grid in meal planner --- */
@media (max-width: 480px) {
  .food-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* --- Topic panel on very small screens --- */
@media (max-width: 480px) {
  .topic-panel {
    width: 100%;
  }
}

/* --- Community guidelines grid --- */
@media (max-width: 480px) {
  .guidelines-grid {
    grid-template-columns: 1fr 1fr;
  }
}

/* --- Nutrition summary wrap --- */
@media (max-width: 480px) {
  .nutrition-summary {
    flex-wrap: wrap;
  }
  .nutrition-item {
    flex: 1 1 calc(50% - 0.5rem);
    min-width: 0;
  }
}

/* --- Quick entry form (2-col) --- */
@media (max-width: 768px) {
  .quick-entry-form .entry-row {
    grid-template-columns: 1fr;
  }
}

/* --- Datetime flex wrap --- */
@media (max-width: 480px) {
  .datetime-flex {
    flex-direction: column;
  }
  .btn-now {
    width: 100%;
  }
}

/* --- Action buttons row --- */
@media (max-width: 480px) {
  .action-btns-row {
    flex-direction: column;
  }
}

/* --- Food card stats grid --- */
@media (max-width: 480px) {
  .food-card-stats {
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
  }
}

/* --- Search bar modern responsive --- */
@media (max-width: 480px) {
  .search-bar-modern {
    flex-wrap: wrap;
  }
  .search-btn-modern {
    width: 100%;
    text-align: center;
  }
  .search-input-large {
    width: 100%;
  }
}

/* --- Daily tip full padding on mobile --- */
@media (max-width: 480px) {
  .daily-tip {
    padding: 1rem;
    margin: 1.5rem 0;
  }
  .daily-tip p {
    font-size: 0.95rem;
  }
}

/* --- Track levels CTA padding --- */
@media (max-width: 768px) {
  .track-levels-cta {
    padding: 0 1rem;
    margin: 2rem auto;
  }
}

/* --- Page shell tighter on small screens --- */
@media (max-width: 480px) {
  .page-shell {
    padding: 0 0.75rem;
  }
}

/* --- Journey section spacing --- */
@media (max-width: 480px) {
  .journey-section {
    padding: 2rem 0;
    border-radius: 16px;
  }
  .section-header {
    margin-bottom: 2rem;
  }
}

/* --- Topics grid single column on very small --- */
@media (max-width: 480px) {
  .topics-grid {
    grid-template-columns: 1fr;
  }
}

/* --- Community card stats flex wrap --- */
@media (max-width: 480px) {
  .community-stats {
    flex-wrap: wrap;
  }
}

/* --- Location finder flex wrap --- */
@media (max-width: 480px) {
  .location-finder {
    flex-direction: column;
  }
  .city-input, .find-btn {
    width: 100%;
  }
}

/* --- Snap grid 2-col even on small --- */
@media (max-width: 480px) {
  .snap-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* --- Hero CTA row stack on very small --- */
@media (max-width: 480px) {
  .hero-cta-row {
    flex-direction: column;
  }
  .btn-primary, .btn-secondary {
    width: 100%;
    justify-content: center;
    text-align: center;
  }
}

/* --- Glucose meter absolute positioned - hide on very small screens --- */
@media (max-width: 480px) {
  .glucose-meter {
    display: none;
  }
}

/* --- Health icon: hide icon-label on very small --- */
@media (max-width: 360px) {
  .icon-label {
    display: none;
  }
  .health-icon {
    padding: 0.6rem;
  }
}

/* --- Modal content large padding --- */
@media (max-width: 480px) {
  .modal-body {
    padding: 1.5rem 1rem;
  }
  .modal-header-gradient {
    padding: 2rem 1.5rem 1.5rem;
  }
  .modal-header-gradient h2 {
    font-size: 1.6rem;
  }
}

/* --- Suggestion cards single col on small --- */
@media (max-width: 480px) {
  .suggestion-cards {
    grid-template-columns: 1fr;
  }
}

/* --- History stats row (already responsive, but ensure 1-col at 480) --- */
@media (max-width: 480px) {
  .history-stats-row {
    grid-template-columns: 1fr;
  }
}

/* --- Tracker header flex wrap --- */
@media (max-width: 480px) {
  .header-content-flex {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
  }
  .tracker-title-modern {
    font-size: 1.3rem;
  }
  .header-icon-modern {
    font-size: 2.5rem;
  }
}

/* --- Tab buttons overflow scroll on mobile --- */
@media (max-width: 768px) {
  .tracker-tabs {
    padding: 0 0.5rem;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    gap: 0;
  }
  .tab-btn {
    padding: 0.75rem 1rem;
    font-size: 0.85rem;
    white-space: nowrap;
    flex-shrink: 0;
  }
  .tab-icon {
    font-size: 1rem;
  }
}

/* --- Preview column responsive --- */
@media (max-width: 768px) {
  .preview-column {
    grid-template-columns: 1fr;
  }
}

/* --- Comparison table scrollable on mobile --- */
@media (max-width: 768px) {
  .comparison-table-container {
    overflow-x: auto;
  }
  .comparison-table {
    min-width: 400px;
  }
}

/* --- Community guidelines 1-col on tiny screens --- */
@media (max-width: 360px) {
  .guidelines-grid {
    grid-template-columns: 1fr;
  }
}

/* --- Wizard food suggestions single col on tiny --- */
@media (max-width: 360px) {
  .wizard-food-suggestions {
    grid-template-columns: 1fr;
  }
}

/* --- Meal time btn min width on small --- */
@media (max-width: 480px) {
  .meal-time-btn {
    min-width: 90px;
    padding: 0.75rem 1rem;
  }
  .meal-icon {
    font-size: 1.5rem;
  }
}

/* --- Plate actions column on small --- */
@media (max-width: 480px) {
  .plate-actions {
    flex-direction: column;
    gap: 0.75rem;
  }
  .plate-btn {
    width: 100%;
    justify-content: center;
  }
}

/* --- Community card padding reduce on mobile --- */
@media (max-width: 480px) {
  .community-card {
    padding: 1.5rem;
  }
  .community-guidelines {
    padding: 1.5rem;
  }
  .community-guidelines h3 {
    font-size: 1.5rem;
  }
}

/* --- Share preview score wrap --- */
@media (max-width: 480px) {
  .share-preview-score {
    flex-wrap: wrap;
    gap: 0.75rem;
    justify-content: center;
  }
}

/* --- Topic card header layout --- */
@media (max-width: 480px) {
  .topic-header {
    padding: 1.5rem;
  }
  .topic-body {
    padding: 1.25rem 1.5rem;
  }
  .topic-footer {
    padding: 0.75rem 1.5rem;
  }
}

/* End of mobile responsive additions */

/* ================================================================
   ADDITIONAL MOBILE RESPONSIVE FIXES — COMPLETE COVERAGE
   ================================================================ */

/* ── Simulation dashboard 3-col → 1-col on mobile ── */
@media (max-width: 1024px) {
  .simulation-dashboard {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  .body-simulation-container {
    order: -1;
  }
  .sim-body-visual {
    min-height: 400px;
  }
}

@media (max-width: 768px) {
  .simulation-dashboard {
    grid-template-columns: 1fr;
  }
  .sim-body-visual {
    min-height: 300px;
  }
  #bodySimulationSvg {
    max-width: 280px;
  }
  /* Organ labels may overflow on mobile – scale them down */
  .organ-label {
    padding: 0.4rem 0.6rem;
    font-size: 0.75rem;
    border-radius: 8px;
  }
  .label-text strong {
    font-size: 0.75rem;
  }
  .label-status {
    font-size: 0.65rem;
  }
  .label-dot {
    width: 7px;
    height: 7px;
  }
}

/* ── Streak milestone notification – prevent overflow ── */
.streak-milestone-notification {
  min-width: unset;
  width: 90%;
  max-width: 400px;
  box-sizing: border-box;
}

@media (max-width: 480px) {
  .streak-milestone-notification {
    padding: 24px 16px;
    width: 92%;
  }
  .milestone-icon {
    font-size: 56px;
    margin-bottom: 14px;
  }
  .milestone-text h3 {
    font-size: 22px;
  }
  .milestone-text p {
    font-size: 14px;
  }
}

/* ── Tracker tabs – horizontal scroll, hide overflow ── */
@media (max-width: 600px) {
  .tracker-tabs {
    padding: 0 0.5rem;
    gap: 0.25rem;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    white-space: nowrap;
    flex-wrap: nowrap;
  }
  .tracker-tabs::-webkit-scrollbar {
    display: none;
  }
  .tab-btn {
    padding: 0.85rem 0.75rem;
    font-size: 0;
    white-space: nowrap;
    flex-shrink: 0;
    gap: 0;
  }
  .tab-btn .tab-icon {
    font-size: 1.2rem;
    display: inline-block;
  }
}

/* ── Canvas elements – prevent overflow on mobile ── */
@media (max-width: 768px) {
  canvas,
  #macroChart,
  #glucoseCurve,
  #glucoseTrendChart {
    max-width: 100%;
    width: 100% !important;
    height: auto !important;
  }
  .macro-balance-chart {
    overflow: hidden;
  }
  .glucose-timeline {
    overflow-x: auto;
  }
  .glucose-timeline canvas {
    min-width: 280px;
  }
  .timeline-markers {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    font-size: 0.78rem;
  }
  .timeline-zones {
    font-size: 0.8rem;
  }
  .zone {
    padding: 0.4rem 0.6rem;
  }
}

/* ── Prediction details grid – 1-col on small mobile ── */
@media (max-width: 480px) {
  .prediction-details {
    grid-template-columns: 1fr;
  }
  .prediction-stat {
    flex-direction: row;
    align-items: center;
  }
}

/* ── Wizard progress steps – horizontal scroll on tiny ── */
@media (max-width: 480px) {
  .wizard-progress {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding: 14px 10px;
    gap: 0.25rem;
  }
  .step-circle {
    width: 38px;
    height: 38px;
    min-width: 38px;
  }
  .step-number {
    font-size: 15px;
  }
  .step-label {
    font-size: 10px;
  }
  .wizard-connector {
    min-width: 14px;
    flex: 0 0 14px;
    margin: 0 -2px;
  }
}

/* ── Header content flex in tracker modal ── */
@media (max-width: 480px) {
  .header-content-flex {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }
  .header-icon-modern {
    font-size: 2.5rem;
  }
  .tracker-title-modern {
    font-size: 1.3rem;
  }
  .tracker-subtitle {
    font-size: 0.85rem;
  }
  .quick-stats-row {
    flex-direction: row;
    flex-wrap: wrap;
  }
  .quick-stat-pill {
    padding: 0.5rem 0.8rem;
    font-size: 0.8rem;
  }
}

/* ── Panel header negative margin fix on mobile ── */
@media (max-width: 768px) {
  .panel-header {
    margin: -3rem -2.5rem 2rem;
  }
}
@media (max-width: 480px) {
  .panel-header {
    margin: -2rem -1.5rem 1.5rem;
    padding: 1.5rem 1.5rem 1.2rem;
    gap: 0.75rem;
    flex-wrap: wrap;
  }
  .panel-scroll {
    padding: 2rem 1.5rem;
  }
}

/* ── Feature modal header – smaller text on mobile ── */
@media (max-width: 480px) {
  .modal-header-gradient h2 {
    font-size: 1.6rem;
  }
  .modal-header-gradient p {
    font-size: 0.95rem;
  }
  .modal-icon {
    font-size: 3rem;
  }
  .modal-body {
    padding: 1.5rem 1rem;
  }
  .modal-content-large {
    width: 95%;
    border-radius: 20px;
  }
}

/* ── Ultra frame (baby SVG section) ── */
@media (max-width: 480px) {
  .ultra-frame {
    padding: 10px 10px 8px;
  }
  .hud-pill {
    font-size: 9px;
    padding: 5px 7px;
  }
  .hud-bar {
    width: 32px;
    height: 5px;
  }
  .cap-title {
    font-size: 11px;
  }
  .cap-sub {
    font-size: 10px;
  }
}

/* ── Meal history panel on mobile ── */
@media (max-width: 768px) {
  .meal-history-panel {
    overflow-x: auto;
  }
  .history-table {
    min-width: 400px;
  }
}

/* ── Food selector grid adjust on small ── */
@media (max-width: 360px) {
  .food-grid {
    grid-template-columns: 1fr;
  }
}

/* ── Comparison area in food search tab ── */
@media (max-width: 768px) {
  .compare-selection-area {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  .compare-vs {
    padding: 0.5rem 0;
    justify-content: center;
  }
  .vs-circle {
    width: 48px;
    height: 48px;
    font-size: 1rem;
  }
  .comparison-results {
    min-height: unset;
  }
}

/* ── Track levels CTA button ── */
@media (max-width: 480px) {
  .track-levels-cta {
    padding: 0 1rem;
  }
  .open-tracker-btn {
    padding: 1.25rem 1rem;
  }
  .btn-content h3 {
    font-size: 1.2rem;
  }
  .btn-content p {
    font-size: 0.88rem;
  }
}

/* ── Glucose predictor on mobile ── */
@media (max-width: 480px) {
  .glucose-predictor {
    padding: 1.25rem 1rem;
  }
  .smart-suggestions {
    padding: 1.25rem 1rem;
  }
}

/* ── Nutrition summary in plate builder ── */
@media (max-width: 480px) {
  .nutrition-summary {
    flex-wrap: wrap;
    gap: 0.75rem;
  }
  .nutrition-item {
    flex: 1 1 calc(50% - 0.5rem);
    min-width: 0;
  }
}

/* ── Simulation controls – 2-col on mobile ── */
@media (max-width: 480px) {
  .simulation-controls {
    justify-content: flex-start;
  }
  .sim-btn {
    padding: 1.2rem 1rem;
    flex: 1 1 calc(50% - 0.5rem);
    max-width: calc(50% - 0.5rem);
  }
}

/* ── Location finder / city input flex wrap ── */
@media (max-width: 480px) {
  .location-finder {
    flex-direction: column;
  }
  .city-input,
  .find-btn {
    width: 100%;
  }
}

/* ── Topic panel – ensure it doesn't overlap nav ── */
.topic-panel {
  top: 0;
}

/* ── Close panel button – ensure always accessible ── */
@media (max-width: 480px) {
  .close-panel {
    top: 1rem;
    right: 1rem;
    width: 44px;
    height: 44px;
    font-size: 1.3rem;
  }
}

/* ── Hero visual – pregnancy core on very small screens ── */
@media (max-width: 380px) {
  .pregnancy-3d-container {
    height: 280px;
  }
  .pregnancy-core {
    width: 240px;
    height: 240px;
  }
  /* Hide health icons on very small screens to avoid overlap */
  .health-icon {
    display: none;
  }
  .glucose-meter {
    right: 6px;
    bottom: 6px;
    width: 140px;
    padding: 0.75rem;
  }
  .reading-value {
    font-size: 1.7rem;
  }
}

/* ── Section container padding on very small screens ── */
@media (max-width: 360px) {
  .page-shell {
    padding: 0 0.75rem;
  }
  .tab-content {
    padding: 1rem 0.75rem;
  }
  .glass-card {
    padding: 1rem;
  }
  .tracker-header-modern {
    padding: 1rem 0.75rem 0.75rem;
  }
  .header-glass-card {
    padding: 1rem;
  }
}

/* ── Action buttons row – vertical on mobile ── */
@media (max-width: 480px) {
  .action-btns-row {
    flex-direction: column;
    gap: 0.75rem;
  }
}

/* ── Datetime flex – wrap on mobile ── */
@media (max-width: 480px) {
  .datetime-flex {
    flex-direction: column;
  }
  .btn-now {
    width: 100%;
  }
}

/* ── Ensure no horizontal overflow on body ── */
@media (max-width: 768px) {
  body {
    overflow-x: hidden;
  }
  .page-shell {
    overflow-x: hidden;
  }
  /* NOTE: overflow:hidden intentionally NOT set on .hero-visual-3d or
     .pregnancy-3d-container here — doing so would create a stacking context
     that flattens transform-style:preserve-3d on the pulse-rings, making the
     hero animation completely invisible on mobile browsers.
     Horizontal scroll is already blocked by body/page-shell overflow-x:hidden.
     The orbit icons that previously caused scroll are display:none at ≤380px. */
}

/* ═══════════════════════════════════════════════════════════════════
   HERO ANIMATION FIX — 360 / 375 / 480px
   Root causes:
     1. overflow:hidden on .hero-visual-3d & .pregnancy-3d-container (set above
        at 768px) flattens preserve-3d on pulse-rings → rings go invisible.
     2. ring-3 is 380px inside a 280-340px container; at peak animation scale
        1.15× it reaches 437px — entirely clipped → animation not visible at all.
   Fix: keep those containers at overflow:visible, resize rings to fit.
   ═══════════════════════════════════════════════════════════════════ */

@media (max-width: 768px) {
  /* Allow the ring animations to render — do NOT apply overflow:hidden to
     elements that directly contain preserve-3d / translateZ children */
  .hero-visual-3d {
    overflow: visible;
  }
  .pregnancy-3d-container {
    overflow: visible;
  }

  /* Flatten 3D on pulse-rings for mobile — preserve-3d is already broken by
     any ancestor overflow:hidden, so removing it makes rendering predictable */
  .pulse-ring {
    transform-style: flat;
  }

  /* Resize rings to fit the 340px container (pregnancy-core = 280px).
     At peak animation scale 1.15× each ring must stay within 140px from
     centre (= half the container height).
       ring-1: 120px × 1.15 = 138px → 69px from centre ✓
       ring-2: 190px × 1.15 = 218px → 109px from centre ✓
       ring-3: 260px × 1.15 = 299px → 149px from centre ≈ edge ✓ */
  .ring-1 { width: 120px; height: 120px; }
  .ring-2 { width: 190px; height: 190px; }
  .ring-3 { width: 260px; height: 260px; }
}

@media (max-width: 380px) {
  /* Container shrinks to 280px, core to 240px → half-height = 140px.
       ring-1:  90px × 1.15 = 103px → 51.5px ✓
       ring-2: 140px × 1.15 = 161px → 80.5px ✓
       ring-3: 200px × 1.15 = 230px → 115px ✓ */
  .ring-1 { width: 90px;  height: 90px;  }
  .ring-2 { width: 140px; height: 140px; }
  .ring-3 { width: 200px; height: 200px; }
}

/* ── Override wave-pulse for mobile: remove translateY to prevent vertical
   overflow. The default keyframe nudges rings ±10px which pushes them
   outside the visible area on screens ≤480px.                          ── */
@media (max-width: 480px) {
  @keyframes wave-pulse {
    0%   { transform: scale(0.65); opacity: 0;   }
    30%  { transform: scale(0.9);  opacity: 0.65; }
    60%  { transform: scale(1.05); opacity: 0.5;  }
    100% { transform: scale(1.15); opacity: 0;   }
  }
}

/* ── food-category grid on mobile ── */
@media (max-width: 480px) {
  .food-category {
    padding: 1.25rem;
  }
  .category-title {
    font-size: 1.1rem;
  }
}

/* ── history-controls layout ── */
@media (max-width: 600px) {
  .controls-flex {
    flex-direction: column;
    align-items: stretch;
  }
  .search-history {
    max-width: 100%;
  }
  .history-actions {
    justify-content: flex-end;
  }
}

/* ── Snap grid nutrition – 2-col on narrow ── */
@media (max-width: 360px) {
  .snap-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ── Community stats flex-wrap ── */
@media (max-width: 480px) {
  .community-stats {
    flex-wrap: wrap;
  }
}

/* ── Achievement notification – don't overflow ── */
@media (max-width: 480px) {
  .ach-notification {
    right: 8px;
    left: 8px;
    max-width: unset;
    transform: translateX(110%);
  }
  .ach-notification.show {
    transform: translateX(0);
  }
}

/* ── Quiz container – ensure scrollable on mobile ── */
@media (max-width: 768px) {
  .quiz-container {
    max-height: 90vh;
    overflow-y: auto;
  }
}

/* ── Share preview header – allow wrapping ── */
@media (max-width: 480px) {
  .share-preview-header {
    flex-wrap: wrap;
    gap: 0.75rem;
  }
}

/* ── Food info tooltip – fully within viewport ── */
@media (max-width: 360px) {
  .food-info-tooltip {
    width: 98%;
  }
  .tooltip-header h4 {
    font-size: 1.1rem;
  }
  .tooltip-body {
    padding: 12px;
  }
}

/* End of additional mobile responsive fixes */

/* =======================================================================
   360px AND BELOW — FINAL TARGETED MICRO-FIXES
   These address the last remaining layout concerns on the smallest phones
   (Galaxy A series, older iPhones SE 1st gen, budget Android devices).
   ======================================================================= */

/* ── 1. Food Comparison modal — tighten padding so inner content
        doesn't get crushed to only ~260px at 90% width              ── */
@media (max-width: 360px) {
  .comparison-modal-content-new {
    padding: 1rem;
    width: 96%;
    border-radius: 16px;
  }
  .modal-header-modern {
    margin-bottom: 1rem;
    padding-bottom: 0.85rem;
  }
  .modal-header-modern h2 {
    font-size: 1.45rem;
  }
  .modal-header-modern p {
    font-size: 0.95rem;
  }
}

/* ── 2. Hero badge — prevent potential overflow of the longer badge
        text "Supporting 3–25% of Pregnancies in India" at 360px    ── */
@media (max-width: 360px) {
  .hero-badge {
    padding: 0.5rem 0.9rem;
    gap: 0.35rem;
    flex-wrap: wrap;
    justify-content: center;
  }
  .badge-text {
    font-size: 0.76rem;
  }
}

/* ── 3. Hero h1 — drop from 2rem to 1.75rem for tightest screens   ── */
@media (max-width: 360px) {
  .hero h1,
  .hero-title-3d {
    font-size: 1.75rem;
  }
}

/* ── 4. CTA tracker button heading — slightly tighter at 360px      ── */
@media (max-width: 360px) {
  .btn-content h3 {
    font-size: 1rem;
  }
  .btn-content p {
    font-size: 0.82rem;
  }
  .track-levels-cta {
    padding: 0 0.25rem;
  }
}

/* ── 5. Simulation organ buttons — reduce horizontal padding so the
        2-per-row layout breathes at 336px container width           ── */
@media (max-width: 360px) {
  .sim-btn {
    padding: 0.85rem 0.6rem;
  }
  .sim-label {
    font-size: 0.75rem;
  }
}

/* ── 6. Section title prominent — 1.8rem → 1.6rem for very narrow  ── */
@media (max-width: 360px) {
  .section-title-prominent {
    font-size: 1.6rem;
  }
}

/* ── 7. stat-item — minor padding tighten at 360px (already 1rem
        from 480px, but make gap tighter too)                        ── */
@media (max-width: 360px) {
  .hero-stats {
    gap: 0.75rem;
  }
  .stat-item {
    padding: 0.85rem;
  }
}

/* ── 8. Panel header negative margins — re-sync with 0.75rem
        page-shell so content hugs edges cleanly at 360px            ── */
@media (max-width: 360px) {
  .panel-header {
    margin: -2rem -1rem 1.25rem;
    padding: 1.25rem 1rem 1rem;
  }
  .panel-scroll {
    padding: 1.5rem 1rem;
  }
}

/* ── 9. Community / resource card padding — 1rem at 360px           ── */
@media (max-width: 360px) {
  .community-card {
    padding: 1rem;
  }
}

/* ── 10. Wizard food suggestions already go 1-col at 360px
         (line 10097). Ensure step labels don't overflow            ── */
@media (max-width: 360px) {
  .step-label {
    font-size: 9px;
  }
  .step-circle {
    width: 34px;
    height: 34px;
    min-width: 34px;
  }
}

/* ── 11. Meal time buttons — stretch full row at 360px to avoid
         cramped 90px min-width in tiny space                        ── */
@media (max-width: 360px) {
  .meal-time-btn {
    min-width: 0;
    flex: 1 1 calc(50% - 0.5rem);
    padding: 0.65rem 0.5rem;
  }
  .meal-icon {
    font-size: 1.3rem;
  }
}

/* ── 12. Daily tip — shrink icon at 360px                           ── */
@media (max-width: 360px) {
  .tip-icon {
    font-size: 1.5rem;
  }
  .daily-tip p {
    font-size: 0.88rem;
  }
}


/* =======================================================================
   TARGETED MOBILE FIXES
   Complements the existing comprehensive mobile CSS already in the file.
   ======================================================================= */

/* ── 1. HEADER NAV — hide CTA buttons when hamburger is active ──── */
@media (max-width: 1060px) {
  .nav-actions .btn-nav.outline,
  .nav-actions .btn-nav.primary {
    display: none;
  }
}

/* Always show both buttons inside mobile slide-out menu */
.mobile-menu .btn-nav.outline,
.mobile-menu .btn-nav.primary {
  display: inline-flex !important;
}

/* Button row styling inside mobile-menu */
.mobile-menu .mm-btn-row {
  display: flex;
  gap: .75rem;
  margin-top: 1rem;
  padding: .5rem;
}
.mobile-menu .mm-btn-row .btn-nav {
  flex: 1;
  justify-content: center;
  text-align: center;
}

/* ── 2. SECTION PADDING & RADIUS on mobile ─────────────────────── */
/* Sections have 3rem padding and 30px radius on desktop.
   These are too large on phones — reduce them.                     */
@media (max-width: 768px) {
  .tracker-section,
  .community-section {
    padding: 2rem 0;
    border-radius: 20px;
    margin: 1.5rem 0;
  }

  .meal-planner-section,
  .resources-section,
  .topics-explorer {
    padding: 2rem 0;
    margin: 1.5rem 0;
  }

  /* Section header bottom margin: 4rem → 2.5rem */
  .section-header {
    margin-bottom: 2.5rem;
  }

  /* Hero info box: reduce padding and spacing */
  .hero-info-box {
    padding: 1.5rem;
    margin-top: 1.25rem;
  }
  .info-title {
    font-size: 1.2rem;
  }
}

@media (max-width: 480px) {
  .tracker-section,
  .community-section,
  .journey-section {
    border-radius: 16px;
    padding: 1.5rem 0;
    margin: 1rem 0;
  }

  .meal-planner-section,
  .resources-section,
  .topics-explorer {
    padding: 1.5rem 0;
    margin: 1rem 0;
  }

  .section-header {
    margin-bottom: 2rem;
  }

  /* Hero info box tighter on phones */
  .hero-info-box {
    padding: 1.25rem;
    margin-top: 1rem;
    border-radius: 16px;
  }
  .info-title {
    font-size: 1.1rem;
  }
  .info-text {
    font-size: 0.9rem;
  }
}

/* ── 3. TRACKER SECTION — simulation margin top ──────────────────── */
@media (max-width: 768px) {
  /* simulation-controls already flex-wrap, just reduce margin */
  .simulation-controls {
    margin: 1.5rem 0 1rem;
    gap: 0.75rem;
  }

  /* Simulation dashboard already 1-col at 1024px, ensure gap */
  .simulation-dashboard {
    gap: 1.5rem;
  }

  /* tracker container gap reduce */
  .tracker-container {
    gap: 1.5rem;
    margin-top: 1.5rem;
  }
}

/* ── 4. MEAL PLANNER — section margin-top ───────────────────────── */
@media (max-width: 768px) {
  .meal-planner-container {
    gap: 2rem;
    margin-top: 1.5rem;
  }
}

/* ── 5. COMMUNITY SECTION — card padding ────────────────────────── */
@media (max-width: 480px) {
  .community-grid {
    margin-top: 1.5rem;
    gap: 1rem;
  }
  .community-card {
    padding: 1.75rem;
  }
}

/* ── 6. RESOURCES SECTION ───────────────────────────────────────── */
@media (max-width: 480px) {
  .resources-grid {
    margin-top: 1.5rem;
    gap: 1rem;
  }
}

/* ── 7. SECTION SUBTITLE PROMINENT — padding on mobile ──────────── */
@media (max-width: 768px) {
  .section-subtitle-prominent {
    padding: 1.25rem 1.25rem;
    font-size: 1.05rem;
    margin: 0 auto 2rem;
  }
  .section-subtitle-enhanced {
    padding: 1.25rem;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .section-subtitle-prominent {
    padding: 1rem;
    font-size: 1rem;
    border-radius: 16px;
  }
}

/* ── 8. OPEN TRACKER BUTTON — full width touch-friendly on mobile ── */
@media (max-width: 768px) {
  .track-levels-cta {
    padding: 0 0.5rem;
    margin: 2rem auto;
  }
  .open-tracker-btn {
    gap: 1rem;
    padding: 1.25rem 1.5rem;
  }
  .btn-icon-lg {
    font-size: 2.5rem;
  }
  .btn-arrow {
    font-size: 1.8rem;
  }
}

@media (max-width: 480px) {
  .open-tracker-btn {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1.25rem;
  }
  .btn-content h3 {
    font-size: 1.1rem;
  }
  .btn-content p {
    font-size: 0.85rem;
  }
  .btn-arrow {
    display: none;
  }
}

/* ── 9. HERO SUBTITLE & BADGE ────────────────────────────────────── */
@media (max-width: 768px) {
  .hero-subtitle {
    font-size: 1rem;
    margin-bottom: 1.5rem;
    line-height: 1.7;
  }
  .hero-badge {
    margin-bottom: 1rem;
  }
  .badge-text {
    font-size: 0.82rem;
  }
}

@media (max-width: 480px) {
  .hero-subtitle {
    font-size: 0.95rem;
  }
  .hero h1,
  .hero-title-3d {
    font-size: 2rem;
    margin-bottom: 1rem;
  }
}

/* ── 10. TOPIC PANEL — full-height scrollable on phones ─────────── */
@media (max-width: 480px) {
  .topic-panel {
    width: 100%;
  }
  .panel-header {
    padding: 1.5rem 1.5rem 1.2rem;
  }
  .panel-scroll {
    padding: 1.5rem;
  }
}

/* ── 11. TIMELINE STAGES — touch friendly on small ──────────────── */
@media (max-width: 480px) {
  .timeline-stage {
    padding: 0 0.25rem;
  }
  .stage-content {
    padding: 1rem;
  }
  .stage-title {
    font-size: 1rem;
  }
  .stage-weeks {
    font-size: 0.8rem;
  }
  .stage-desc {
    font-size: 0.8rem;
  }
  .stage-icon {
    font-size: 1.5rem;
  }
}


/* ═══════════════════════════════════════════════════════════════════
   HERO FLOATING ICONS — RESTORE AT 360px / 375px / 480px
   ───────────────────────────────────────────────────────────────────
   Problem 1: @media (max-width:380px) sets .health-icon{display:none}
              → hides ALL orbit icons at 360px and 375px.
   Problem 2: @media (max-width:360px) sets .icon-label{display:none}
              → hides text labels.
   Problem 3: ≤360px still uses the 768px orbit keyframes (±118px
              translate) — on a 312px content width that places icons
              partially off-screen.
   Fix: override with !important, resize icons, tighten orbits.
   ═══════════════════════════════════════════════════════════════════ */

/* ── Step 1: Restore icons at ≤480px with compact sizing ── */
@media (max-width: 480px) {
  .health-icon {
    display: flex !important;   /* override display:none from ≤380px rule */
    padding: 0.5rem 0.65rem;
    border-radius: 12px;
    gap: 0.2rem;
    box-shadow: 0 6px 18px rgba(236,64,122,0.2);
  }
  .icon-inner {
    font-size: 1.2rem;
  }
  .icon-label {
    display: block !important;  /* override display:none from ≤360px rule */
    font-size: 0.6rem;
    white-space: nowrap;
  }
}

/* ── Step 2: At ≤360px, tighten orbits to fit 312px content width ──
   Content width = 360 - 2×12 (page-shell 0.75rem) = 336px → ½ = 168px.
   Icon half-width ≈ 30px → safe orbit radius ≤ 168 - 30 - 8 = 130px.
   Using ±90px horizontal and ±64px diagonal (radius ≈ 90px) leaves
   comfortable margins on all edges.                                  ── */
@media (max-width: 360px) {
  .health-icon {
    display: flex !important;
    padding: 0.38rem 0.5rem;
    border-radius: 10px;
  }
  .icon-inner {
    font-size: 1rem;
  }
  .icon-label {
    display: block !important;
    font-size: 0.55rem;
  }

  @keyframes orbit1 {
    0%, 100% { transform: translate(-90px,  0px)  rotate( 0deg); }
    25%       { transform: translate(-93px, -4px)  rotate( 2deg); }
    50%       { transform: translate(-90px,  0px)  rotate( 0deg); }
    75%       { transform: translate(-87px,  4px)  rotate(-2deg); }
  }
  @keyframes orbit2 {
    0%, 100% { transform: translate(-64px, -64px) rotate( 0deg); }
    25%       { transform: translate(-67px, -67px) rotate(-2deg); }
    50%       { transform: translate(-64px, -64px) rotate( 0deg); }
    75%       { transform: translate(-61px, -61px) rotate( 2deg); }
  }
  @keyframes orbit3 {
    0%, 100% { transform: translate( 64px, -64px) rotate( 0deg); }
    25%       { transform: translate( 67px, -67px) rotate( 2deg); }
    50%       { transform: translate( 64px, -64px) rotate( 0deg); }
    75%       { transform: translate( 61px, -61px) rotate(-2deg); }
  }
  @keyframes orbit4 {
    0%, 100% { transform: translate( 90px,  0px)  rotate( 0deg); }
    25%       { transform: translate( 93px,  4px)  rotate(-2deg); }
    50%       { transform: translate( 90px,  0px)  rotate( 0deg); }
    75%       { transform: translate( 87px, -4px)  rotate( 2deg); }
  }
  @keyframes orbit5 {
    0%, 100% { transform: translate(-64px,  64px) rotate( 0deg); }
    25%       { transform: translate(-67px,  67px) rotate( 2deg); }
    50%       { transform: translate(-64px,  64px) rotate( 0deg); }
    75%       { transform: translate(-61px,  61px) rotate(-2deg); }
  }
}
</style>
<body>
<!-- ===== HEADER ===== -->
<header class="site-header">
  <div class="nav-container">
    <!-- Logo -->
    <div class="logo">
      <div class="logo-icon">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="white">
          <circle cx="12" cy="5.5" r="2.8"/>
          <path d="M9.3 4.8 Q9.1 2.5 12 2.2 Q14.9 2.5 14.7 4.8" opacity="0.7"/>
          <path d="M9.5 13.2 Q9 10.5 10 9.3 Q11 8.6 12 8.6 Q13 8.6 14 9.3 Q15 10.5 14.5 13.2Z"/>
          <path d="M9.5 13.2 Q7.2 13.8 6.8 16.2 Q7.8 16.4 8.8 15Z" opacity="0.85"/>
          <path d="M14.5 13.2 Q16.8 13.8 17.2 16.2 Q16.2 16.4 15.2 15Z" opacity="0.85"/>
          <path d="M8.2 22 Q7.6 17.2 8.8 15 Q10.2 13 12 13 Q13.8 13 15.2 15 Q16.4 17.2 15.8 22Z"/>
        </svg>
      </div>
      <div class="logo-text">
        <a href="index.html">Nari Swasthya</a>
        <span>Women's Complete Health</span>
      </div>
    </div>

    <!-- Desktop Nav -->
    <nav class="main-nav">

      <!-- Home -->
      <div class="nav-item"><a href="index.html" class="nav-link">Home</a></div>

      <!-- Journeys dropdown -->
      <div class="nav-item">
        <button class="nav-link" aria-haspopup="true">Journeys <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown">
          <a href="journeys.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
            <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;box-shadow:0 4px 12px rgba(236,64,122,0.35);"><i class="fa-solid fa-map"></i></div>
            <div><strong style="display:block;font-size:.82rem;color:var(--deep-pink);">View Full Journeys</strong><span style="font-size:.73rem;color:var(--text-soft);">Browse all her journeys</span></div>
          </a>
          <div class="dd-sep"></div>
          <a href="conceiving.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Conceiving</strong><span style="font-size:.73rem;color:var(--text-soft);">Preparation &amp; planning</span></div></a>
          <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-dna"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:var(--text-soft);">Cycle &amp; ovulation</span></div></a>
          <!-- Pregnancy Journey with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-baby-carriage"></i></div>
            <a href="pregnancy_journey.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Pregnancy Journey</strong><span style="font-size:.73rem;color:var(--text-soft);">Week by week guide</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="normal_delivery.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-circle-check"></i></div><div><strong style="display:block;font-size:.82rem;">Normal Delivery</strong><span style="font-size:.73rem;color:var(--text-soft);">Vaginal birth guide</span></div></a>
              <a href="csection.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-hospital"></i></div><div><strong style="display:block;font-size:.82rem;">C-Section</strong><span style="font-size:.73rem;color:var(--text-soft);">Surgical birth info</span></div></a>
              <a href="pregnancy_loss.html" class="dd-item"><div class="dd-icon" style="background:#fafafa;color:#9e9e9e;"><i class="fa-solid fa-hands-holding-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy Loss</strong><span style="font-size:.73rem;color:var(--text-soft);">Support &amp; care</span></div></a>
            </div>
          </div>
          <a href="antenatal_care.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-clipboard-list"></i></div><div><strong style="display:block;font-size:.82rem;">Antenatal Care</strong><span style="font-size:.73rem;color:var(--text-soft);">ANC visits &amp; checklist</span></div></a>
          <!-- NCD with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
            <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:var(--text-soft);">Diabetes, hypertension &amp; more</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:var(--text-soft);">Manage blood sugar</span></div></a>
              <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:var(--text-soft);">Blood pressure care</span></div></a>
              <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:var(--text-soft);">Simulation journey</span></div></a>
            </div>
          </div>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Newborn &amp; Postpartum</strong><span style="font-size:.73rem;color:var(--text-soft);">4th trimester care</span></div></a>
          <a href="breastfeeding_journey.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57c00;"><i class="fa-solid fa-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Breastfeeding</strong><span style="font-size:.73rem;color:var(--text-soft);">Latch, supply, nutrition</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-fire-flame-curved"></i></div><div><strong style="display:block;font-size:.82rem;">Menopause</strong><span style="font-size:.73rem;color:var(--text-soft);">Perimenopause &amp; beyond</span></div></a>
        </div>
      </div>

      <!-- Services dropdown (active) -->
      <div class="nav-item">
        <button class="nav-link active" aria-haspopup="true">Services <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown">
          <a href="services.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
            <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;box-shadow:0 4px 12px rgba(236,64,122,0.35);"><i class="fa-solid fa-grid-2"></i></div>
            <div><strong style="display:block;font-size:.82rem;color:var(--deep-pink);">Services Available</strong><span style="font-size:.73rem;color:var(--text-soft);">Browse all our services</span></div>
          </a>
          <div class="dd-sep"></div>
          <a href="symptom_checker.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-stethoscope"></i></div><div><strong style="display:block;font-size:.82rem;">Symptom Checker</strong><span style="font-size:.73rem;color:var(--text-soft);">AI-powered diagnosis</span></div></a>
          <a href="dashboard.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-gauge-high"></i></div><div><strong style="display:block;font-size:.82rem;">My Dashboard</strong><span style="font-size:.73rem;color:var(--text-soft);">Track your health</span></div></a>
          <a href="screening.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-magnifying-glass-plus"></i></div><div><strong style="display:block;font-size:.82rem;">Health Screening</strong><span style="font-size:.73rem;color:var(--text-soft);">Cancer &amp; preventive</span></div></a>
          <a href="vaccination.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-syringe"></i></div><div><strong style="display:block;font-size:.82rem;">Vaccination</strong><span style="font-size:.73rem;color:var(--text-soft);">Immunization schedule</span></div></a>
          <a href="otc.html" class="dd-item"><div class="dd-icon" style="background:#e0f7fa;color:#006064;"><i class="fa-solid fa-pills"></i></div><div><strong style="display:block;font-size:.82rem;">OTC Medicine Guide</strong><span style="font-size:.73rem;color:var(--text-soft);">Safe self-care options</span></div></a>
          <a href="government_schemes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#e65100;"><i class="fa-solid fa-landmark"></i></div><div><strong style="display:block;font-size:.82rem;">Govt Schemes</strong><span style="font-size:.73rem;color:var(--text-soft);">Benefits you deserve</span></div></a>
          <a href="insurance.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#1b5e20;"><i class="fa-solid fa-shield-halved"></i></div><div><strong style="display:block;font-size:.82rem;">Insurance</strong><span style="font-size:.73rem;color:var(--text-soft);">Coverage &amp; claims guide</span></div></a>
        </div>
      </div>

      <!-- Stories -->
      <div class="nav-item"><a href="stories.html" class="nav-link">Stories</a></div>

      <!-- About Us -->
      <div class="nav-item"><a href="about.html" class="nav-link">About Us</a></div>

      <!-- Additional Information dropdown -->
      <div class="nav-item">
        <button class="nav-link" aria-haspopup="true">Additional Info <i class="fa-solid fa-chevron-down chevron"></i></button>
        <div class="nav-dropdown" style="min-width:240px;">
          <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.08em;">Health Topics</div>
          <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:var(--text-soft);">Cycle, conceiving &amp; IVF</span></div></a>
          <a href="pregnancy_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-baby-carriage"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy</strong><span style="font-size:.73rem;color:var(--text-soft);">All trimesters covered</span></div></a>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Motherhood</strong><span style="font-size:.73rem;color:var(--text-soft);">Newborn &amp; postpartum</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-spa"></i></div><div><strong style="display:block;font-size:.82rem;">Wellness</strong><span style="font-size:.73rem;color:var(--text-soft);">Menopause, bone, mental</span></div></a>
          <div class="dd-sep"></div>
          <a href="community.html" class="dd-item"><div class="dd-icon" style="background:#ede7f6;color:#4527a0;"><i class="fa-solid fa-users"></i></div><div><strong style="display:block;font-size:.82rem;">Community</strong><span style="font-size:.73rem;color:var(--text-soft);">Share &amp; connect</span></div></a>
          <div class="dd-sep"></div>
          <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:var(--text-soft);text-transform:uppercase;letter-spacing:.08em;">Specialised Care</div>
          <!-- NCD with flyout -->
          <div class="dd-item dd-has-flyout">
            <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
            <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:var(--text-soft);">Diabetes, hypertension &amp; more</span></a>
            <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
            <div class="dd-flyout">
              <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:var(--text-soft);">Manage blood sugar</span></div></a>
              <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:var(--text-soft);">Blood pressure care</span></div></a>
              <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:var(--text-soft);">Simulation journey</span></div></a>
            </div>
          </div>
          <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Newborn &amp; Postpartum</strong><span style="font-size:.73rem;color:var(--text-soft);">4th trimester care</span></div></a>
          <a href="breastfeeding_journey.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57c00;"><i class="fa-solid fa-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Breastfeeding</strong><span style="font-size:.73rem;color:var(--text-soft);">Latch, supply, nutrition</span></div></a>
          <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-fire-flame-curved"></i></div><div><strong style="display:block;font-size:.82rem;">Menopause</strong><span style="font-size:.73rem;color:var(--text-soft);">Perimenopause &amp; beyond</span></div></a>
        </div>
      </div>

    </nav>

    <!-- Right: Sign In + Contact Us -->
    <div class="nav-actions">
      <a class="btn-nav outline" href="signin.html">
        <i class="fa-regular fa-user"></i> Sign In
      </a>
      <a class="btn-nav primary" href="contact.html">
        <i class="fa-solid fa-envelope"></i> Contact Us
      </a>
      <!-- Mobile hamburger -->
      <button class="hamburger" id="hamburgerBtn" aria-label="Menu" onclick="toggleMobile()">
        <span id="hb1"></span><span id="hb2"></span><span id="hb3"></span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mm-section">Navigation</div>
  <a href="index.html" class="mm-link"><i class="fa-solid fa-house" style="color:var(--deep-pink);width:20px;"></i> Home</a>
  <div class="mm-section">Journeys</div>
  <a href="conceiving.html" class="mm-link"><i class="fa-solid fa-seedling" style="color:var(--deep-pink);width:20px;"></i> Conceiving</a>
  <a href="fertility.html" class="mm-link"><i class="fa-solid fa-dna" style="color:var(--deep-pink);width:20px;"></i> Fertility</a>
  <a href="pregnancy_journey.html" class="mm-link"><i class="fa-solid fa-baby-carriage" style="color:var(--deep-pink);width:20px;"></i> Pregnancy Journey</a>
  <a href="antenatal_care.html" class="mm-link"><i class="fa-solid fa-clipboard-list" style="color:var(--deep-pink);width:20px;"></i> Antenatal Care</a>
  <a href="newborn_postpartum_care.html" class="mm-link"><i class="fa-solid fa-baby" style="color:var(--deep-pink);width:20px;"></i> Newborn &amp; Postpartum</a>
  <a href="breastfeeding-journey.html" class="mm-link"><i class="fa-solid fa-heart" style="color:var(--deep-pink);width:20px;"></i> Breastfeeding</a>
  <a href="menopause.html" class="mm-link"><i class="fa-solid fa-fire-flame-curved" style="color:var(--deep-pink);width:20px;"></i> Menopause</a>
  <div class="mm-section">Services</div>
  <a href="symptom_checker.html" class="mm-link"><i class="fa-solid fa-stethoscope" style="color:var(--deep-pink);width:20px;"></i> Symptom Checker</a>
  <a href="dashboard.html" class="mm-link"><i class="fa-solid fa-gauge-high" style="color:var(--deep-pink);width:20px;"></i> My Dashboard</a>
  <a href="screening.html" class="mm-link"><i class="fa-solid fa-magnifying-glass-plus" style="color:var(--deep-pink);width:20px;"></i> Health Screening</a>
  <a href="government-schemes.html" class="mm-link"><i class="fa-solid fa-landmark" style="color:var(--deep-pink);width:20px;"></i> Govt Schemes</a>
  <div class="mm-section">More</div>
  <a href="stories.html" class="mm-link"><i class="fa-solid fa-book-open" style="color:var(--deep-pink);width:20px;"></i> Stories</a>
  <a href="community.html" class="mm-link"><i class="fa-solid fa-users" style="color:var(--deep-pink);width:20px;"></i> Community</a>
  <a href="about.html" class="mm-link"><i class="fa-solid fa-circle-info" style="color:var(--deep-pink);width:20px;"></i> About Us</a>
  <a href="gestational_diabetes.html" class="mm-link" style="color:var(--deep-pink);font-weight:700;"><i class="fa-solid fa-droplet" style="color:var(--deep-pink);width:20px;"></i> Gestational Diabetes</a>
  <div style="display:flex;gap:.75rem;margin-top:1rem;padding:.5rem;">
    <a href="signin.html" class="btn-nav outline" style="flex:1;justify-content:center;"><i class="fa-regular fa-user"></i> Sign In</a>
    <a href="contact.html" class="btn-nav primary" style="flex:1;justify-content:center;"><i class="fa-solid fa-envelope"></i> Contact Us</a>
  </div>
</div>

  <!-- Main Page Container -->
  <div class="page-shell">

    <!-- Neural Network Particle Background -->
    <div class="hero-constellation-bg">
      <canvas id="particleCanvas"></canvas>
      <div class="gradient-morph"></div>
    </div>
    
    <!-- HERO SECTION WITH ANIMATED PREGNANCY JOURNEY -->
    <section class="hero">
      <div class="hero-content">
        <div class="hero-badge">
          <span class="badge-icon">🤰</span>
          <span class="badge-text">Supporting 3-25% of Pregnancies in India</span>
        </div>
       <h1 class="hero-title-3d">Your <span class="title-emphasis">Gestational Diabetes</span> Journey</h1>
        <p class="hero-subtitle">
          Empowering expecting mothers with medically-accurate information about gestational diabetes.
          Knowledge is your strongest ally for a healthy pregnancy.
        </p>
        
        <div class="hero-stats">
          <div class="stat-item">
            <span class="stat-number">25 Topics</span>
            <span class="stat-label">Comprehensive coverage</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">50-70%</span>
            <span class="stat-label">Can prevent Type 2 with lifestyle</span>
          </div>
          <div class="stat-item">
            <span class="stat-number">24-28 Weeks</span>
            <span class="stat-label">Typical screening time</span>
          </div>
        </div>

        <div class="hero-cta-row">
          <button class="btn-primary" onclick="scrollToJourney()">Begin Your Journey</button>
          <button class="btn-secondary" onclick="openQuiz()">Take Knowledge Quiz</button>
        </div>
      </div>

      <!-- ANIMATED PREGNANCY VISUALIZATION -->
      <!-- ANIMATED PREGNANCY VISUALIZATION -->
      <div class="hero-visual-3d">
        <div class="pregnancy-3d-container">
          <!-- Detailed Woman Silhouette (Matching Preeclampsia Style) -->
          <div class="pregnancy-core">
            <!-- Central Glow Point -->
            <div class="center-glow"></div>
            
            <div class="pulse-ring ring-1"></div>
            <div class="pulse-ring ring-2"></div>
            <div class="pulse-ring ring-3"></div>
          </div>

          <!-- Floating Health Icons - Positioned on circle boundaries -->
          <div class="health-icon icon-1" onclick="scrollToTopic('monitoring')">
            <div class="icon-inner">🩺</div>
            <div class="icon-label">Monitoring</div>
          </div>
          <div class="health-icon icon-2" onclick="scrollToTopic('exercise')">
            <div class="icon-inner">💪</div>
            <div class="icon-label">Exercise</div>
          </div>
          <div class="health-icon icon-3" onclick="scrollToTopic('nutrition')">
            <div class="icon-inner">🥗</div>
            <div class="icon-label">Nutrition</div>
          </div>
          <div class="health-icon icon-4" onclick="scrollToTopic('treatment')">
            <div class="icon-inner">💊</div>
            <div class="icon-label">Treatment</div>
          </div>
          <div class="health-icon icon-5" onclick="scrollToTopic('baby-health')">
            <div class="icon-inner">❤️</div>
            <div class="icon-label">Baby Health</div>
          </div>
          <!-- Glucose Level Indicator -->
          <div class="glucose-meter">
            <div class="meter-reading">
              <span class="reading-value" id="glucoseReading">95</span>
              <span class="reading-unit">mg/dL</span>
            </div>
            <div class="meter-status status-normal">Target Range</div>
            <div class="meter-bar">
              <div class="meter-fill" id="meterFill"></div>
            </div>
          </div>
        </div>

        <!-- Info Box -->
        <div class="hero-info-box">
          <div class="info-badge">
            <span class="badge-icon">✨</span>
            <span class="badge-text">Interactive Learning</span>
          </div>
          <h3 class="info-title">Your Personalized Health Companion</h3>
          <p class="info-text">
            Navigate through 25 comprehensive topics with interactive visualizations, 
            real-time tracking tools, and evidence-based guidance from ICMR, WHO, and ACOG.
          </p>
        </div>
      </div>
    </section>

    <!-- INTERACTIVE JOURNEY TIMELINE -->
    <section id="journey" class="journey-section">
     <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">Your 40-Week Journey</span>
        </div>
        <h2 class="section-title-prominent">
          Navigate Your <span class="title-highlight">Pregnancy Timeline</span>
        </h2>
        <p class="section-subtitle-prominent">
          <span class="subtitle-sparkle">✨</span>
          From first screening to postpartum recovery — every week matters. 
          <strong>Tap any trimester</strong> to unlock personalized care guides, milestone trackers, and expert insights tailored to your journey.
          <span class="subtitle-sparkle">✨</span>
        </p>
      </div>

      <!-- Timeline Navigator -->
      <div class="timeline-container">
        <div class="timeline-rail"></div>
        
        <div class="timeline-stage" data-stage="first" onclick="showStageDetails('first')">
          <div class="stage-marker">
            <div class="marker-dot">1</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">First Trimester</h3>
            <p class="stage-weeks">Weeks 1-12</p>
            <p class="stage-desc">Foundation & Early Screening for High-Risk Women</p>
            <div class="stage-icon">🌱</div>
          </div>
        </div>

        <div class="timeline-stage" data-stage="second" onclick="showStageDetails('second')">
          <div class="stage-marker">
            <div class="marker-dot">2</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Second Trimester</h3>
            <p class="stage-weeks">Weeks 13-27</p>
            <p class="stage-desc">GDM Screening & Diagnosis (24-28 weeks)</p>
            <div class="stage-icon">🔬</div>
          </div>
        </div>

        <div class="timeline-stage" data-stage="third" onclick="showStageDetails('third')">
          <div class="stage-marker">
            <div class="marker-dot">3</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Third Trimester</h3>
            <p class="stage-weeks">Weeks 28-40</p>
            <p class="stage-desc">Intensive Monitoring & Delivery Preparation</p>
            <div class="stage-icon">👶</div>
          </div>
        </div>

        <div class="timeline-stage" data-stage="postpartum" onclick="showStageDetails('postpartum')">
          <div class="stage-marker">
            <div class="marker-dot">4</div>
            <div class="marker-pulse"></div>
          </div>
          <div class="stage-content">
            <h3 class="stage-title">Postpartum</h3>
            <p class="stage-weeks">After Delivery</p>
            <p class="stage-desc">Recovery & Long-term Health Management</p>
            <div class="stage-icon">🌸</div>
          </div>
        </div>
      </div>
    </section>

    <!-- MAIN CONTENT: 25 TOPICS EXPLORER -->
    <section id="learn" class="topics-explorer">
      <div class="section-header">
        <div class="header-badge-prominent">
          <span class="badge-pulse"></span>
          <span class="badge-text">25 Comprehensive Topics</span>
        </div>
        <h2 class="section-title-prominent">
          Your Complete <span class="title-highlight">GDM Knowledge Hub</span>
        </h2>
        <p class="section-subtitle-prominent">
          <span class="subtitle-sparkle">💡</span>
          Medically-accurate, beautifully explained. Each topic card opens a world of interactive learning — 
          <strong>click to explore</strong> blood sugar science, nutrition plans, monitoring techniques, and evidence-based care strategies.
          <span class="subtitle-sparkle">💡</span>
        </p>
      </div>


      <!-- Topics Grid -->
      <div class="topics-grid">
        <!-- Topic 1: Understanding GDM -->
        <div class="topic-card" data-topic="understanding" onclick="openTopicPanel('understanding')">
          <div class="topic-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="topic-icon">📚</div>
            <div class="topic-number">01</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Understanding Gestational Diabetes</h3>
            <p class="topic-preview">What is GDM, why it happens, and how it affects 3-25% of pregnancies in India</p>
            <div class="topic-tags">
              <span class="tag">Basics</span>
              <span class="tag">Definition</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 5 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 2: Risk Factors -->
        <div class="topic-card" data-topic="risk-factors" onclick="openTopicPanel('risk-factors')">
          <div class="topic-header" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <div class="topic-icon">⚠️</div>
            <div class="topic-number">02</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Risk Factors for Indian Women</h3>
            <p class="topic-preview">Genetic predisposition, lifestyle factors, and high-risk categories specific to South Asian women</p>
            <div class="topic-tags">
              <span class="tag">Risk Assessment</span>
              <span class="tag">Prevention</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 7 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 3: Screening & Diagnosis -->
        <div class="topic-card" data-topic="screening" onclick="openTopicPanel('screening')">
          <div class="topic-header" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <div class="topic-icon">🔬</div>
            <div class="topic-number">03</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Screening and Diagnosis</h3>
            <p class="topic-preview">OGTT testing, diagnostic criteria, and screening protocols (DIPSI/WHO guidelines)</p>
            <div class="topic-tags">
              <span class="tag">Testing</span>
              <span class="tag">ICMR Guidelines</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 6 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 4: Symptoms -->
        <div class="topic-card" data-topic="symptoms" onclick="openTopicPanel('symptoms')">
          <div class="topic-header" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
            <div class="topic-icon">🌡️</div>
            <div class="topic-number">04</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Symptoms: Mild to Severe</h3>
            <p class="topic-preview">Recognizing symptoms from mild thirst to critical warning signs requiring immediate attention</p>
            <div class="topic-tags">
              <span class="tag">Warning Signs</span>
              <span class="tag">Emergency</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 8 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 5: When to See Doctor -->
        <div class="topic-card" data-topic="doctor-visit" onclick="openTopicPanel('doctor-visit')">
          <div class="topic-header" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
            <div class="topic-icon">👨‍⚕️</div>
            <div class="topic-number">05</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">When to See Your Doctor</h3>
            <p class="topic-preview">Immediate, urgent, and routine care timelines for optimal GDM management</p>
            <div class="topic-tags">
              <span class="tag">Medical Care</span>
              <span class="tag">Emergency</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 5 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 6: Impact on Mother -->
        <div class="topic-card" data-topic="mother-impact" onclick="openTopicPanel('mother-impact')">
          <div class="topic-header" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
            <div class="topic-icon">🤰</div>
            <div class="topic-number">06</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Impact on Mother's Health</h3>
            <p class="topic-preview">Short-term complications and long-term health implications including Type 2 diabetes risk</p>
            <div class="topic-tags">
              <span class="tag">Maternal Health</span>
              <span class="tag">Long-term</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 9 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 7: Impact on Baby -->
        <div class="topic-card" data-topic="baby-impact" onclick="openTopicPanel('baby-impact')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
            <div class="topic-icon">👶</div>
            <div class="topic-number">07</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Impact on Baby's Health</h3>
            <p class="topic-preview">Understanding macrosomia, birth complications, and long-term health effects on your child</p>
            <div class="topic-tags">
              <span class="tag">Fetal Health</span>
              <span class="tag">Neonatal</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 8 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 8: Questions for Doctor -->
        <div class="topic-card" data-topic="doctor-questions" onclick="openTopicPanel('doctor-questions')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
            <div class="topic-icon">❓</div>
            <div class="topic-number">08</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Questions to Ask Your Doctor</h3>
            <p class="topic-preview">Essential questions about diagnosis, treatment, baby's health, and delivery planning</p>
            <div class="topic-tags">
              <span class="tag">Communication</span>
              <span class="tag">Empowerment</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 6 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 9: Medical Management -->
        <div class="topic-card" data-topic="medical-management" onclick="openTopicPanel('medical-management')">
          <div class="topic-header" style="background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);">
            <div class="topic-icon">💊</div>
            <div class="topic-number">09</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Medical Management</h3>
            <p class="topic-preview">Dietary management, exercise, insulin therapy, and medication options</p>
            <div class="topic-tags">
              <span class="tag">Treatment</span>
              <span class="tag">Medications</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 10 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 10: Blood Glucose Monitoring -->
        <div class="topic-card" data-topic="monitoring" onclick="openTopicPanel('monitoring')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
            <div class="topic-icon">📊</div>
            <div class="topic-number">10</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Blood Glucose Monitoring</h3>
            <p class="topic-preview">Home monitoring guidelines, target levels, and tracking tools (ACOG/ADA standards)</p>
            <div class="topic-tags">
              <span class="tag">Self-Care</span>
              <span class="tag">Daily Tracking</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 7 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 11: Dietary Guidelines -->
        <div class="topic-card" data-topic="diet" onclick="openTopicPanel('diet')">
          <div class="topic-header" style="background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);">
            <div class="topic-icon">🥗</div>
            <div class="topic-number">11</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Dietary Guidelines for Indian Women</h3>
            <p class="topic-preview">Indian meal planning, foods to include and avoid, and practical tips for managing GDM</p>
            <div class="topic-tags">
              <span class="tag">Nutrition</span>
              <span class="tag">Indian Diet</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 12 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 12: Exercise -->
        <div class="topic-card" data-topic="exercise" onclick="openTopicPanel('exercise')">
          <div class="topic-header" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
            <div class="topic-icon">💪</div>
            <div class="topic-number">12</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Exercise and Physical Activity</h3>
            <p class="topic-preview">Safe exercises during pregnancy, guidelines, and benefits for glucose control</p>
            <div class="topic-tags">
              <span class="tag">Fitness</span>
              <span class="tag">Safety</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 8 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 13: Pregnancy Stages -->
        <div class="topic-card" data-topic="pregnancy-stages" onclick="openTopicPanel('pregnancy-stages')">
          <div class="topic-header" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
            <div class="topic-icon">📅</div>
            <div class="topic-number">13</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Journey Through Pregnancy Stages</h3>
            <p class="topic-preview">Trimester-by-trimester guide to managing GDM from diagnosis to delivery</p>
            <div class="topic-tags">
              <span class="tag">Timeline</span>
              <span class="tag">Care Plan</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 11 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 14: Warning Signs -->
        <div class="topic-card" data-topic="warning-signs" onclick="openTopicPanel('warning-signs')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);">
            <div class="topic-icon">🚨</div>
            <div class="topic-number">14</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Alarming Signs to Watch For</h3>
            <p class="topic-preview">Critical warning signs for both mother and baby requiring immediate medical attention</p>
            <div class="topic-tags">
              <span class="tag">Emergency</span>
              <span class="tag">Safety</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 6 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 15: Family Support -->
        <div class="topic-card" data-topic="family-support" onclick="openTopicPanel('family-support')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
            <div class="topic-icon">👨‍👩‍👧‍👦</div>
            <div class="topic-number">15</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Family Support and Care</h3>
            <p class="topic-preview">How family members can support, create supportive environment, and emotional needs</p>
            <div class="topic-tags">
              <span class="tag">Support System</span>
              <span class="tag">Family Care</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 9 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 16: Prevention -->
        <div class="topic-card" data-topic="prevention" onclick="openTopicPanel('prevention')">
          <div class="topic-header" style="background: linear-gradient(135deg, #96fbc4 0%, #f9f586 100%);">
            <div class="topic-icon">🛡️</div>
            <div class="topic-number">16</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Preventive Steps for Future</h3>
            <p class="topic-preview">Preventing GDM in next pregnancy and reducing Type 2 diabetes risk</p>
            <div class="topic-tags">
              <span class="tag">Prevention</span>
              <span class="tag">Future Health</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 7 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 17: Postpartum Care -->
        <div class="topic-card" data-topic="postpartum" onclick="openTopicPanel('postpartum')">
          <div class="topic-header" style="background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);">
            <div class="topic-icon">🌸</div>
            <div class="topic-number">17</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Postpartum Care</h3>
            <p class="topic-preview">After delivery care, glucose monitoring, and long-term follow-up schedule</p>
            <div class="topic-tags">
              <span class="tag">Recovery</span>
              <span class="tag">Follow-up</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 8 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 18: Breastfeeding -->
        <div class="topic-card" data-topic="breastfeeding" onclick="openTopicPanel('breastfeeding')">
          <div class="topic-header" style="background: linear-gradient(135deg, #f3e7e9 0%, #e3eeff 100%);">
            <div class="topic-icon">🤱</div>
            <div class="topic-number">18</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Breastfeeding with GDM History</h3>
            <p class="topic-preview">Benefits of breastfeeding for mother and baby, tips for successful nursing</p>
            <div class="topic-tags">
              <span class="tag">Breastfeeding</span>
              <span class="tag">Benefits</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 6 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 19: Lifestyle Modifications -->
        <div class="topic-card" data-topic="lifestyle" onclick="openTopicPanel('lifestyle')">
          <div class="topic-header" style="background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);">
            <div class="topic-icon">🏃‍♀️</div>
            <div class="topic-number">19</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Lifestyle Modifications</h3>
            <p class="topic-preview">Long-term dietary changes, physical activity, and sustainable weight management</p>
            <div class="topic-tags">
              <span class="tag">Lifestyle</span>
              <span class="tag">Sustainability</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 10 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 20: Myths & Facts -->
        <div class="topic-card" data-topic="myths" onclick="openTopicPanel('myths')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);">
            <div class="topic-icon">🔍</div>
            <div class="topic-number">20</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Traditional Practices & Myths</h3>
            <p class="topic-preview">Separating facts from fiction, safe traditional practices, and what to avoid</p>
            <div class="topic-tags">
              <span class="tag">Myths</span>
              <span class="tag">Facts</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 8 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 21: Emotional Health -->
        <div class="topic-card" data-topic="emotional-health" onclick="openTopicPanel('emotional-health')">
          <div class="topic-header" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
            <div class="topic-icon">🧘‍♀️</div>
            <div class="topic-number">21</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Emotional and Mental Health</h3>
            <p class="topic-preview">Managing anxiety, stress, guilt, and maintaining mental wellbeing during pregnancy</p>
            <div class="topic-tags">
              <span class="tag">Mental Health</span>
              <span class="tag">Coping</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 9 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 22: Work & Daily Life -->
        <div class="topic-card" data-topic="work-life" onclick="openTopicPanel('work-life')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);">
            <div class="topic-icon">💼</div>
            <div class="topic-number">22</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Work and Daily Life Management</h3>
            <p class="topic-preview">Managing GDM at workplace, social situations, and daily routines</p>
            <div class="topic-tags">
              <span class="tag">Work-Life</span>
              <span class="tag">Practical Tips</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 7 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 23: Financial Considerations -->
        <div class="topic-card" data-topic="financial" onclick="openTopicPanel('financial')">
          <div class="topic-header" style="background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);">
            <div class="topic-icon">💰</div>
            <div class="topic-number">23</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Financial Considerations</h3>
            <p class="topic-preview">Healthcare costs, government schemes, insurance coverage, and cost-saving strategies</p>
            <div class="topic-tags">
              <span class="tag">Finances</span>
              <span class="tag">Resources</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 6 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 24: Technology & Resources -->
        <div class="topic-card" data-topic="technology" onclick="openTopicPanel('technology')">
          <div class="topic-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="topic-icon">📱</div>
            <div class="topic-number">24</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Technology and Resources</h3>
            <p class="topic-preview">Helpful apps, tracking tools, reliable sources (ICMR, WHO, ACOG, FOGSI)</p>
            <div class="topic-tags">
              <span class="tag">Technology</span>
              <span class="tag">Tools</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 7 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>

        <!-- Topic 25: Labor & Delivery -->
        <div class="topic-card" data-topic="delivery" onclick="openTopicPanel('delivery')">
          <div class="topic-header" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
            <div class="topic-icon">🏥</div>
            <div class="topic-number">25</div>
          </div>
          <div class="topic-body">
            <h3 class="topic-title">Labor and Delivery Preparation</h3>
            <p class="topic-preview">What to expect during labor, delivery planning, and immediate postpartum care</p>
            <div class="topic-tags">
              <span class="tag">Delivery</span>
              <span class="tag">Planning</span>
            </div>
          </div>
          <div class="topic-footer">
            <span class="read-time">⏱ 10 min read</span>
            <span class="topic-arrow">→</span>
          </div>
        </div>
      </div>
    </section>

    <!-- INTERACTIVE GLUCOSE TRACKER WITH ADVANCED SIMULATION -->
    <section id="tracker" class="tracker-section">
   <div class="section-header">
      <div class="header-badge-prominent">
        <span class="badge-pulse"></span>
        <span class="badge-text">Live Body Simulation</span>
      </div>
      <h2 class="section-title-prominent">
        Real-Time <span class="title-highlight">Glucose & Body Dynamics</span>
      </h2>
      <p class="section-subtitle-prominent">
        <span class="subtitle-sparkle">💡</span> Experience a live visualization of your body’s internal processes — <strong>watch how glucose, insulin, and pregnancy hormones</strong> interact in real-time to shape your health. <span class="subtitle-sparkle">💡</span>
      </p>
    </div>


      <!-- SIMULATION CONTROL PANEL -->
      <div class="simulation-controls">
        <button class="sim-btn active" onclick="setSimulationScenario('fasting')" id="btn-fasting">
          <span class="sim-icon">🌅</span>
          <span class="sim-label">Fasting State</span>
        </button>
        <button class="sim-btn" onclick="setSimulationScenario('after-meal')" id="btn-after-meal">
          <span class="sim-icon">🍽️</span>
          <span class="sim-label">After Meal</span>
        </button>
        <button class="sim-btn" onclick="setSimulationScenario('exercise')" id="btn-exercise">
          <span class="sim-icon">💪</span>
          <span class="sim-label">During Exercise</span>
        </button>
        <button class="sim-btn" onclick="setSimulationScenario('insulin')" id="btn-insulin">
          <span class="sim-icon">💉</span>
          <span class="sim-label">After Insulin</span>
        </button>
      </div>

      <!-- MAIN SIMULATION DASHBOARD -->
      <div class="simulation-dashboard">
        
        <!-- LEFT: BODY VISUALIZATION -->
        <div class="body-simulation-container">
          <div class="sim-body-visual">
            <!-- Detailed SVG Body Instead of Canvas -->
            <svg id="bodySimulationSvg" viewBox="0 0 320 600" style="width: 100%; max-width: 400px; height: auto;">
              <!-- Head -->
              <ellipse cx="160" cy="62" rx="42" ry="48" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Hair -->
              <ellipse cx="160" cy="38" rx="44" ry="30" fill="#5c3d2e"/>
              <rect x="116" y="30" width="12" height="55" rx="6" fill="#5c3d2e"/>
              <rect x="192" y="30" width="12" height="55" rx="6" fill="#5c3d2e"/>
              
              <!-- Eyes -->
              <circle cx="143" cy="65" r="4" fill="#3a2520"/>
              <circle cx="177" cy="65" r="4" fill="#3a2520"/>
              
              <!-- Smile -->
              <path d="M148 78 Q160 86 172 78" fill="none" stroke="#3a2520" stroke-width="2" stroke-linecap="round"/>
              
              <!-- Neck -->
              <rect x="148" y="106" width="24" height="28" rx="4" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              
              <!-- Torso (fitted dress) -->
              <path d="M100 134 Q100 128 130 128 L190 128 Q220 128 220 134 L220 280 Q220 285 215 285 L105 285 Q100 285 100 280 Z" 
                    fill="#e8a0b8" stroke="#d47a9a" stroke-width="2"/>
              
              <!-- Pregnant Belly -->
              <ellipse cx="160" cy="300" rx="65" ry="75" fill="#e8a0b8" stroke="#d47a9a" stroke-width="2"/>
              
              <!-- Collar detail -->
              <path d="M148 128 L148 148 Q160 156 172 148 L172 128" fill="none" stroke="#d47a9a" stroke-width="1.5"/>
              
              <!-- Arms -->
              <path d="M100 140 Q70 170 60 240 Q55 270 65 290 L82 290 Q85 270 90 240 Q100 175 118 145" 
                    fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              <path d="M220 140 Q250 170 260 240 Q265 270 255 290 L238 290 Q235 270 230 240 Q220 175 202 145" 
                    fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Hands -->
              <ellipse cx="74" cy="298" rx="14" ry="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              <ellipse cx="246" cy="298" rx="14" ry="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="1.5"/>
              
              <!-- Skirt -->
              <path d="M95 372 L88 480 Q88 490 100 490 L220 490 Q232 490 232 480 L225 372" 
                    fill="#c077a8" stroke="#a85d8a" stroke-width="2"/>
              
              <!-- Legs -->
              <rect x="118" y="488" width="34" height="90" rx="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              <rect x="168" y="488" width="34" height="90" rx="10" fill="#f5c6a0" stroke="#e0a882" stroke-width="2"/>
              
              <!-- Feet -->
              <ellipse cx="135" cy="586" rx="22" ry="10" fill="#8b5e83"/>
              <ellipse cx="185" cy="586" rx="22" ry="10" fill="#8b5e83"/>

              <!-- Organ Highlights (glow zones - controlled by simulation) -->
              <circle id="sim-pancreas-glow" cx="160" cy="240" r="35" fill="rgba(255, 235, 59, 0.3)" opacity="0" class="sim-organ-glow"/>
              <circle id="sim-liver-glow" cx="195" cy="220" r="30" fill="rgba(255, 152, 0, 0.3)" opacity="0" class="sim-organ-glow"/>
              <ellipse id="sim-placenta-glow" cx="160" cy="310" rx="70" ry="80" fill="rgba(236, 64, 122, 0.3)" opacity="0" class="sim-organ-glow"/>
            </svg>

            
            <!-- Animated Particles Overlay -->
            <div class="particle-system" id="particleSystem">
              <!-- Glucose particles (yellow) -->
              <div class="sim-particle glucose-particle" style="top: 20%; left: 30%;"></div>
              <div class="sim-particle glucose-particle" style="top: 40%; left: 50%;"></div>
              <div class="sim-particle glucose-particle" style="top: 60%; left: 35%;"></div>
              <div class="sim-particle glucose-particle" style="top: 80%; left: 45%;"></div>
              
              <!-- Insulin particles (blue) -->
              <div class="sim-particle insulin-particle" style="top: 25%; left: 60%;"></div>
              <div class="sim-particle insulin-particle" style="top: 55%; left: 65%;"></div>
              <div class="sim-particle insulin-particle" style="top: 75%; left: 55%;"></div>
            </div>

            <!-- Organ Labels -->
            <div class="organ-labels">
              <div class="organ-label pancreas-label" style="top: 40%; left: 50%;">
                <div class="label-dot"></div>
                <div class="label-text">
                  <strong>Pancreas</strong>
                  <span class="label-status" id="pancreasStatus">Working Hard</span>
                </div>
              </div>
              <div class="organ-label liver-label" style="top: 35%; left: 55%;">
                <div class="label-dot"></div>
                <div class="label-text">
                  <strong>Liver</strong>
                  <span class="label-status" id="liverStatus">Storing Glucose</span>
                </div>
              </div>
              <div class="organ-label placenta-label" style="top: 55%; left: 48%;">
                <div class="label-dot"></div>
                <div class="label-text">
                  <strong>Placenta</strong>
                  <span class="label-status" id="placentaStatus">Producing Hormones</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Scenario Description -->
          <div class="scenario-description">
            <h4 id="scenarioTitle">Fasting State</h4>
            <p id="scenarioDesc">Your body is using stored glucose for energy. Insulin levels are low, and the liver releases glucose to maintain blood sugar levels.</p>
          </div>
        </div>

        <!-- CENTER: LIVE METRICS DASHBOARD -->
        <div class="metrics-dashboard">
          
          <!-- Real-time Glucose Graph -->
          <div class="metric-card glucose-graph-card">
            <div class="card-header">
              <h3>Blood Glucose Level</h3>
              <div class="live-indicator">
                <span class="live-dot"></span>
                <span>LIVE</span>
              </div>
            </div>
            <div class="glucose-display">
              <div class="glucose-reading">
                <span class="reading-value" id="currentGlucose">95</span>
                <span class="reading-unit">mg/dL</span>
              </div>
              <div class="glucose-status" id="glucoseStatus">Target Range</div>
            </div>
            <canvas id="glucoseTrendChart" width="300" height="150"></canvas>
          </div>

          <!-- Hormone Levels -->
          <div class="metric-card hormones-card">
            <div class="card-header">
              <h3>Pregnancy Hormones</h3>
              <span class="info-icon" title="Hormones affecting insulin resistance">ℹ️</span>
            </div>
            
            <div class="hormone-meter">
              <div class="hormone-item">
                <div class="hormone-label">
                  <span class="hormone-icon">🔴</span>
                  <span class="hormone-name">Human Placental Lactogen (hPL)</span>
                </div>
                <div class="hormone-bar-container">
                  <div class="hormone-bar" id="hplBar" style="width: 75%; background: linear-gradient(90deg, #ff6b9d, #c44569);"></div>
                  <span class="hormone-value" id="hplValue">75%</span>
                </div>
              </div>

              <div class="hormone-item">
                <div class="hormone-label">
                  <span class="hormone-icon">🟡</span>
                  <span class="hormone-name">Cortisol</span>
                </div>
                <div class="hormone-bar-container">
                  <div class="hormone-bar" id="cortisolBar" style="width: 60%; background: linear-gradient(90deg, #ffd93d, #f5a623);"></div>
                  <span class="hormone-value" id="cortisolValue">60%</span>
                </div>
              </div>

              <div class="hormone-item">
                <div class="hormone-label">
                  <span class="hormone-icon">🟠</span>
                  <span class="hormone-name">Progesterone</span>
                </div>
                <div class="hormone-bar-container">
                  <div class="hormone-bar" id="progesteroneBar" style="width: 80%; background: linear-gradient(90deg, #fa709a, #fee140);"></div>
                  <span class="hormone-value" id="progesteroneValue">80%</span>
                </div>
              </div>

              <div class="hormone-item">
                <div class="hormone-label">
                  <span class="hormone-icon">🔵</span>
                  <span class="hormone-name">Insulin Production</span>
                </div>
                <div class="hormone-bar-container">
                  <div class="hormone-bar" id="insulinBar" style="width: 45%; background: linear-gradient(90deg, #4facfe, #00f2fe);"></div>
                  <span class="hormone-value" id="insulinValue">45%</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Insulin Resistance Indicator -->
          <div class="metric-card resistance-card">
            <div class="card-header">
              <h3>Insulin Resistance</h3>
            </div>
            <div class="resistance-gauge">
              <canvas id="resistanceGauge" width="200" height="150"></canvas>
              <div class="gauge-value">
                <span id="resistancePercent">65</span>%
              </div>
              <div class="gauge-label" id="resistanceLabel">Moderate</div>
            </div>
          </div>
        </div>

        <!-- RIGHT: KEY METRICS & PARAMETERS -->
        <div class="parameters-panel">
          
          <!-- Quick Stats -->
          <div class="quick-stats">
            <div class="stat-box">
              <div class="stat-icon">💧</div>
              <div class="stat-content">
                <div class="stat-label">Glucose in Bloodstream</div>
                <div class="stat-value" id="bloodGlucose">95 mg/dL</div>
              </div>
            </div>

            <div class="stat-box">
              <div class="stat-icon">🏭</div>
              <div class="stat-content">
                <div class="stat-label">Pancreas Activity</div>
                <div class="stat-value" id="pancreasActivity">High</div>
              </div>
            </div>

            <div class="stat-box">
              <div class="stat-icon">⚡</div>
              <div class="stat-content">
                <div class="stat-label">Energy Production</div>
                <div class="stat-value" id="energyProduction">Normal</div>
              </div>
            </div>

            <div class="stat-box">
              <div class="stat-icon">🍼</div>
              <div class="stat-content">
                <div class="stat-label">Baby's Glucose</div>
                <div class="stat-value" id="babyGlucose">Optimal</div>
              </div>
            </div>
          </div>

          <!-- Body Systems Status -->
          <div class="systems-status">
            <h4>Body Systems Status</h4>
            
            <div class="system-item">
              <div class="system-header">
                <span class="system-name">🫀 Cardiovascular</span>
                <span class="system-status status-good">Good</span>
              </div>
              <div class="system-bar">
                <div class="system-fill" style="width: 85%; background: #10ac84;"></div>
              </div>
            </div>

            <div class="system-item">
              <div class="system-header">
                <span class="system-name">🧠 Nervous System</span>
                <span class="system-status status-good">Good</span>
              </div>
              <div class="system-bar">
                <div class="system-fill" style="width: 90%; background: #10ac84;"></div>
              </div>
            </div>

            <div class="system-item">
              <div class="system-header">
                <span class="system-name">🔄 Metabolic</span>
                <span class="system-status status-warning" id="metabolicStatus">Compensating</span>
              </div>
              <div class="system-bar">
                <div class="system-fill" id="metabolicBar" style="width: 65%; background: #f39c12;"></div>
              </div>
            </div>

            <div class="system-item">
              <div class="system-header">
                <span class="system-name">👶 Fetal Development</span>
                <span class="system-status status-good">Healthy</span>
              </div>
              <div class="system-bar">
                <div class="system-fill" style="width: 95%; background: #10ac84;"></div>
              </div>
            </div>
          </div>

          <!-- Time-based Changes -->
          <div class="time-tracker">
            <h4>Timeline</h4>
            <div class="time-display">
              <div class="time-icon">⏱️</div>
              <div class="time-info">
                <div class="time-elapsed" id="timeElapsed">0:00</div>
                <div class="time-label">Time Since Last Event</div>
              </div>
            </div>
            <div class="time-events">
              <div class="event-item">
                <span class="event-dot"></span>
                <span class="event-text" id="lastEvent">Fasting started</span>
              </div>
            </div>
          </div>

          <!-- Legend -->
          <div class="simulation-legend">
            <h4>Legend</h4>
            <div class="legend-items">
              <div class="legend-item">
                <div class="legend-color" style="background: #ffd93d;"></div>
                <span>Glucose Molecules</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #4facfe;"></div>
                <span>Insulin Molecules</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #ff6b9d;"></div>
                <span>Pregnancy Hormones</span>
              </div>
              <div class="legend-item">
                <div class="legend-color" style="background: #10ac84;"></div>
                <span>Energy/ATP</span>
              </div>
            </div>
          </div>
        </div>

  </div>

      <!-- TRADITIONAL TRACKER TOOLS BELOW -->
      <div class="tracker-tools-row">
        <div class="tool-card">
          <div class="tool-icon">📝</div>
          <h3>Daily Log</h3>
          <p>Track your glucose readings, meals, and activities in one place</p>
          <button class="tool-btn">Start Logging</button>
        </div>

        <div class="tool-card">
          <div class="tool-icon">📊</div>
          <h3>Weekly Report</h3>
          <p>View trends and patterns in your glucose management</p>
          <button class="tool-btn">View Report</button>
        </div>

        <div class="tool-card">
          <div class="tool-icon">🔔</div>
          <h3>Reminders</h3>
          <p>Set alerts for testing times, meals, and medications</p>
          <button class="tool-btn">Set Reminders</button>
        </div>

        <div class="tool-card">
          <div class="tool-icon">📈</div>
          <h3>Target Ranges</h3>
          <p>View and customize your glucose target ranges</p>
          <button class="tool-btn">View Ranges</button>
        </div>
      </div>



    </section>



   <!-- TRACKER TOOLS ROW -->
<div class="tracker-tools-row">
  <div class="tool-card interactive-tool" onclick="openDailyLog()">
    <div class="tool-icon-animated">
      <span class="icon-main">📝</span>
      <span class="icon-badge">New</span>
    </div>
    <h3>Interactive Daily Log</h3>
    <p>Smart tracking with instant feedback and insights</p>
    <button class="tool-btn">Start Tracking Now →</button>
    <div class="tool-preview">Last entry: 2 hours ago</div>
  </div>

  <div class="tool-card interactive-tool" onclick="openWeeklyReport()">
    <div class="tool-icon-animated">
      <span class="icon-main">📊</span>
      <span class="icon-badge">Live</span>
    </div>
    <h3>AI-Powered Insights</h3>
    <p>Personalized patterns and recommendations</p>
    <button class="tool-btn">View My Report →</button>
    <div class="tool-preview">85% readings in target 🎉</div>
  </div>

  <div class="tool-card interactive-tool" onclick="openSmartReminders()">
    <div class="tool-icon-animated">
      <span class="icon-main">🔔</span>
      <span class="icon-badge">Smart</span>
    </div>
    <h3>Smart Reminders</h3>
    <p>Adaptive alerts that learn your schedule</p>
    <button class="tool-btn">Set Up Alerts →</button>
    <div class="tool-preview">Next test in 45 min ⏱️</div>
  </div>

  <div class="tool-card interactive-tool" onclick="openTargetZones()">
    <div class="tool-icon-animated">
      <span class="icon-main">🎯</span>
      <span class="icon-badge">Guide</span>
    </div>
    <h3>Target Zone Coach</h3>
    <p>Personalized ranges with real-time guidance</p>
    <button class="tool-btn">See My Zones →</button>
    <div class="tool-preview">Fasting zone: ✓ Perfect</div>
  </div>
</div>

<!-- DAILY LOG MODAL -->
<div class="feature-modal" id="dailyLogModal">
  <div class="modal-content-large">
    <button class="close-modal" onclick="closeDailyLog()">✕</button>
    <div class="modal-header-gradient">
      <div class="modal-icon">📝</div>
      <h2>Your Daily Glucose Journey</h2>
      <p>Track, learn, and thrive with intelligent logging</p>
    </div>
    
    <div class="modal-body">
      <div class="log-entry-section">
        <h3>Quick Entry</h3>
        <div class="quick-entry-form">
          <div class="entry-row">
            <div class="entry-field">
              <label>Glucose Reading</label>
              <input type="number" placeholder="95" class="glucose-input" id="glucoseInput">
              <span class="unit">mg/dL</span>
            </div>
            <div class="entry-field">
              <label>When</label>
              <select class="time-select">
                <option>Fasting</option>
                <option>After Breakfast</option>
                <option>After Lunch</option>
                <option>After Dinner</option>
                <option>Bedtime</option>
              </select>
            </div>
          </div>
          
          <div class="instant-feedback" id="instantFeedback">
            <div class="feedback-icon">✓</div>
            <div class="feedback-text">
              <strong>Perfect!</strong> This reading is right in your target zone.
            </div>
          </div>
          
          <button class="save-entry-btn" onclick="saveEntry()">
            <span>Save Entry</span>
            <span class="btn-icon">→</span>
          </button>
        </div>
      </div>
      
      <div class="smart-insights">
        <h3>Today's Insights</h3>
        <div class="insight-cards">
          <div class="insight-card green">
            <div class="insight-icon">🎯</div>
            <div class="insight-content">
              <h4>On Target</h4>
              <p>3 out of 4 readings in perfect range today</p>
            </div>
          </div>
          <div class="insight-card blue">
            <div class="insight-icon">💡</div>
            <div class="insight-content">
              <h4>Pattern Detected</h4>
              <p>Post-lunch readings slightly high after rice meals</p>
            </div>
          </div>
          <div class="insight-card orange">
            <div class="insight-icon">🍎</div>
            <div class="insight-content">
              <h4>Food Tip</h4>
              <p>Try brown rice or reduce portion by 25%</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="what-to-track">
        <h3>What to Track</h3>
        <div class="track-checklist">
          <div class="track-item">
            <span class="track-icon">⏰</span>
            <span class="track-label">Time & date of test</span>
          </div>
          <div class="track-item">
            <span class="track-icon">💧</span>
            <span class="track-label">Blood glucose reading</span>
          </div>
          <div class="track-item">
            <span class="track-icon">🍽️</span>
            <span class="track-label">Meals eaten (what & how much)</span>
          </div>
          <div class="track-item">
            <span class="track-icon">💪</span>
            <span class="track-label">Physical activity</span>
          </div>
          <div class="track-item">
            <span class="track-icon">💊</span>
            <span class="track-label">Medications/insulin doses</span>
          </div>
          <div class="track-item">
            <span class="track-icon">😊</span>
            <span class="track-label">How you feel</span>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
</section>


<!-- INTERACTIVE MEAL PLANNER -->
<section class="meal-planner-section">
 <div class="section-header">
  <div class="header-badge-prominent">
    <span class="badge-pulse"></span>
    <span class="badge-text">Interactive Meal Builder</span>
  </div>

  <h2 class="section-title-prominent">
    GDM-Friendly <span class="title-highlight">Indian Meal Planner</span>
  </h2>

  <p class="section-subtitle-prominent">
    <span class="subtitle-sparkle">💡</span>
    Build your perfect Indian plate and get an instant prediction of its blood glucose impact —
    <strong>drag and drop foods</strong> to see how your choices shape a balanced GDM-friendly meal.
    <span class="subtitle-sparkle">💡</span>
  </p>
</div>

    <!-- TRACK MY LEVELS - CALL TO ACTION BUTTON -->
    <div class="track-levels-cta">
      <button class="open-tracker-btn" onclick="openSugarTracker()">
        <span class="btn-icon-lg">📊</span>
        <div class="btn-content">
          <h3>Track My Glucose Levels</h3>
          <p>Log meals, monitor readings, search foods, and compare nutrition</p>
        </div>
        <span class="btn-arrow">→</span>
      </button>
    </div>
    <!-- END TRACK MY LEVELS -->
    
  </div>


  <div class="meal-planner-container">
    <!-- LEFT: Interactive Plate Builder -->
    <div class="plate-builder-interactive">
      <div class="meal-selector">
        <button class="meal-time-btn active" onclick="selectMealTime('breakfast')">
          <span class="meal-icon">🌅</span>
          <span class="meal-name">Breakfast</span>
        </button>
        <button class="meal-time-btn" onclick="selectMealTime('lunch')">
          <span class="meal-icon">☀️</span>
          <span class="meal-name">Lunch</span>
        </button>
        <button class="meal-time-btn" onclick="selectMealTime('dinner')">
          <span class="meal-icon">🌙</span>
          <span class="meal-name">Dinner</span>
        </button>
        <button class="meal-time-btn" onclick="selectMealTime('snack')">
          <span class="meal-icon">🍎</span>
          <span class="meal-name">Snack</span>
        </button>
      </div>

      <!-- GUIDED MEAL WIZARD - ADD THIS ENTIRE SECTION HERE -->
      <div class="meal-wizard" id="mealWizard">
        <div class="wizard-toggle">
          <button class="wizard-toggle-btn" onclick="toggleWizard()">
            <span class="wizard-icon">🧙‍♀️</span>
            <span class="wizard-text">Guided Meal Builder</span>
            <span class="wizard-arrow">▼</span>
          </button>
        </div>
        
        <div class="wizard-content" id="wizardContent" style="display: none;">
          <div class="wizard-progress">
            <div class="wizard-step active" data-step="1">
              <div class="step-circle">
                <span class="step-number">1</span>
                <span class="step-check">✓</span>
              </div>
              <span class="step-label">Vegetables</span>
            </div>
            <div class="wizard-connector"></div>
            <div class="wizard-step" data-step="2">
              <div class="step-circle">
                <span class="step-number">2</span>
                <span class="step-check">✓</span>
              </div>
              <span class="step-label">Protein</span>
            </div>
            <div class="wizard-connector"></div>
            <div class="wizard-step" data-step="3">
              <div class="step-circle">
                <span class="step-number">3</span>
                <span class="step-check">✓</span>
              </div>
              <span class="step-label">Carbs</span>
            </div>
            <div class="wizard-connector"></div>
            <div class="wizard-step" data-step="4">
              <div class="step-circle">
                <span class="step-number">4</span>
                <span class="step-check">✓</span>
              </div>
              <span class="step-label">Review</span>
            </div>
          </div>
          
          <div class="wizard-body">
            <div class="wizard-instruction" id="wizardInstruction">
              <div class="instruction-icon">🥦</div>
              <h3 id="wizardTitle">Step 1: Fill Half Your Plate with Vegetables</h3>
              <p id="wizardDescription">
                Vegetables should make up 50% of your plate. They're rich in fiber, 
                which slows glucose absorption and keeps you full longer.
              </p>
              <div class="wizard-goal" id="wizardGoal">
                <span class="goal-label">Goal:</span>
                <span class="goal-value">Add 2-3 vegetable items</span>
                <div class="goal-progress">
                  <div class="goal-progress-bar" id="goalProgress" style="width: 0%"></div>
                </div>
              </div>
            </div>
            
            <div class="wizard-recommendations" id="wizardRecs">
              <h4>Recommended for You:</h4>
              <div class="wizard-food-suggestions">
                <div class="wizard-suggestion" onclick="addFood('leafy-greens', 'vegetable', 'low', 'Leafy Greens', '🥬', 'medium')">
                  <span class="suggestion-emoji">🥬</span>
                  <span class="suggestion-name">Leafy Greens</span>
                  <span class="suggestion-badge">Best Choice</span>
                </div>
                <div class="wizard-suggestion" onclick="addFood('vegetables', 'vegetable', 'low', 'Mixed Veggies', '🥦', 'medium')">
                  <span class="suggestion-emoji">🥦</span>
                  <span class="suggestion-name">Mixed Veggies</span>
                  <span class="suggestion-badge">Best Choice</span>
                </div>
              </div>
            </div>
            
            <div class="wizard-tip" id="wizardTip">
              <div class="tip-icon">💡</div>
              <p><strong>Pro Tip:</strong> Eating vegetables first can reduce glucose spikes by up to 30%!</p>
            </div>
          </div>
          
          <div class="wizard-actions">
            <button class="wizard-btn skip" onclick="skipWizard()">
              <span>Skip Guide</span>
            </button>
            <button class="wizard-btn back" onclick="previousWizardStep()" style="display: none;">
              <span>← Back</span>
            </button>
            <button class="wizard-btn next" onclick="nextWizardStep()">
              <span>Next Step →</span>
            </button>
            <button class="wizard-btn finish" onclick="finishWizard()" style="display: none;">
              <span>✓ Finish</span>
            </button>
          </div>
        </div>
      </div>
      <!-- END OF WIZARD -->

      <div class="virtual-plate-container">
        <div class="virtual-plate" id="virtualPlate">
          <div class="plate-section vegetables" id="plateVeggies">
            <span class="section-label">Vegetables<br>50%</span>
            <div class="dropped-foods" id="veggiesDropped"></div>
          </div>
          <div class="plate-section protein" id="plateProtein">
            <span class="section-label">Protein<br>25%</span>
            <div class="dropped-foods" id="proteinDropped"></div>
          </div>
          <div class="plate-section carbs" id="plateCarbs">
            <span class="section-label">Carbs<br>25%</span>
            <div class="dropped-foods" id="carbsDropped"></div>
          </div>
        </div>
        
        <div class="plate-actions">
          <button class="plate-btn clear-btn" onclick="clearPlate()">
            <span>Clear Plate</span>
          </button>
          <button class="plate-btn save-btn" onclick="saveMeal()">
            <span>Save Meal</span>
          </button>
        </div>
      </div>

      <button class="share-meal-btn" onclick="shareMeal()">
          <span class="share-icon">📤</span> Share This Meal
        </button>

        <div class="share-modal" id="shareModal">
          <h3>Share Your Healthy Meal</h3>
          <div class="share-preview" id="sharePreview">
            <!-- Visual preview of the meal -->
          </div>
          
          <div class="share-options">
            <button onclick="shareViaWhatsApp()">
              <span class="icon">💬</span> WhatsApp
            </button>
            <button onclick="downloadMealImage()">
              <span class="icon">📷</span> Save Image
            </button>
            <button onclick="copyMealLink()">
              <span class="icon">🔗</span> Copy Link
            </button>
            <button onclick="emailMeal()">
              <span class="icon">✉️</span> Email
            </button>
          </div>
        </div>
      
      <!-- Real-time Glucose Impact Prediction -->
      <div class="glucose-predictor">
        <h3>Predicted Glucose Impact</h3>
        <div class="prediction-meter">
          <div class="meter-bar-container">
            <div class="meter-bar-fill" id="predictionBar" style="width: 0%"></div>
          </div>
          <div class="meter-labels">
            <span class="meter-label low">Low Impact</span>
            <span class="meter-label medium">Medium Impact</span>
            <span class="meter-label high">High Impact</span>
          </div>
        </div>


        <!-- Add after glucose predictor -->
      <div class="macro-balance-chart">
        <h4>Plate Balance</h4>
        <canvas id="macroChart" width="200" height="200"></canvas>
        <div class="balance-indicators">
          <div class="balance-item">
            <span class="color-dot vegetables"></span>
            <span class="label">Vegetables: <span id="vegPercent">0%</span></span>
          </div>
          <div class="balance-item">
            <span class="color-dot protein"></span>
            <span class="label">Protein: <span id="proteinPercent">0%</span></span>
          </div>
          <div class="balance-item">
            <span class="color-dot carbs"></span>
            <span class="label">Carbs: <span id="carbsPercent">0%</span></span>
          </div>
        </div>
        <div class="balance-status" id="balanceStatus">
          🎯 Aim: 50% Veggies, 25% Protein, 25% Carbs
        </div>
      </div>
        
        <div class="prediction-details">
          <div class="prediction-stat">
            <span class="stat-icon">📊</span>
            <div class="stat-info">
              <span class="stat-label">Estimated Peak</span>
              <span class="stat-value" id="predictedPeak">115 mg/dL</span>
            </div>
          </div>
          <div class="prediction-stat">
            <span class="stat-icon">⏱️</span>
            <div class="stat-info">
              <span class="stat-label">Time to Peak</span>
              <span class="stat-value" id="timeToPeak">45-60 min</span>
            </div>
          </div>
          <div class="prediction-stat">
            <span class="stat-icon">✓</span>
            <div class="stat-info">
              <span class="stat-label">Status</span>
              <span class="stat-value status-good" id="mealStatus">Safe Choice</span>
            </div>
          </div>
        </div>
        
        <div class="smart-suggestions" id="smartSuggestions">
          <h4>💡 Smart Suggestions</h4>
          <ul id="suggestionsList">
            <li>Great choice! This meal has perfect protein-carb balance</li>
            <li>Add more vegetables to fill you up and slow glucose absorption</li>
          </ul>
        </div>


        <!-- GLUCOSE TIMELINE - ADD HERE -->
      <div class="glucose-timeline">
        <h4>Predicted Glucose Response (2 hours)</h4>
        <canvas id="glucoseCurve" width="400" height="200"></canvas>
        <div class="timeline-markers">
          <span class="marker fasting">Fasting: 95</span>
          <span class="marker one-hour">1hr: 135</span>
          <span class="marker two-hour">2hr: 110</span>
        </div>
        <div class="timeline-zones">
          <div class="zone safe">✓ Safe Zone: < 140 mg/dL</div>
          <div class="zone warning">⚠️ Caution: 140-160 mg/dL</div>
          <div class="zone danger">❌ Avoid: > 160 mg/dL</div>
        </div>
      </div>


        <!-- ═══════════════════════════════════════════════
             MEAL SCORE CARD — FULLY IMPLEMENTED
             ═══════════════════════════════════════════════ -->
        <div class="meal-score-card" id="mealScoreCard">

          <!-- Card Header -->
          <div class="score-card-header">
            <div class="score-card-header-left">
              <span class="score-card-icon">🍽️</span>
              <div>
                <h3 class="score-card-title">Meal Score</h3>
                <p class="score-card-subtitle">GDM-Friendly Rating</p>
              </div>
            </div>
            <div class="score-grade-badge" id="scoreGrade">—</div>
          </div>

          <!-- Main Score Ring -->
          <div class="score-ring-wrapper">
            <div class="score-circle-container">
              <svg class="score-circle-svg" width="160" height="160" viewBox="0 0 160 160">
                <defs>
                  <linearGradient id="scoreGradientPoor"   x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#ef5350"/>
                    <stop offset="100%" style="stop-color:#c62828"/>
                  </linearGradient>
                  <linearGradient id="scoreGradientFair"   x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#ff9800"/>
                    <stop offset="100%" style="stop-color:#e65100"/>
                  </linearGradient>
                  <linearGradient id="scoreGradientGood"   x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#ffc107"/>
                    <stop offset="100%" style="stop-color:#f57f17"/>
                  </linearGradient>
                  <linearGradient id="scoreGradientGreat"  x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#66bb6a"/>
                    <stop offset="100%" style="stop-color:#2e7d32"/>
                  </linearGradient>
                  <linearGradient id="scoreGradientPerfect" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#ffd700"/>
                    <stop offset="100%" style="stop-color:#ff8c00"/>
                  </linearGradient>
                </defs>
                <!-- Track -->
                <circle cx="80" cy="80" r="66"
                        fill="none"
                        stroke="rgba(0,0,0,0.06)"
                        stroke-width="14"/>
                <!-- Score arc -->
                <circle id="scoreCircle"
                        cx="80" cy="80" r="66"
                        fill="none"
                        stroke="url(#scoreGradientGreat)"
                        stroke-width="14"
                        stroke-linecap="round"
                        stroke-dasharray="414.69"
                        stroke-dashoffset="414.69"
                        transform="rotate(-90 80 80)"/>
                <!-- Pulse ring (visible when score > 0) -->
                <circle id="scorePulseRing"
                        cx="80" cy="80" r="74"
                        fill="none"
                        stroke="rgba(76,175,80,0.15)"
                        stroke-width="4"
                        opacity="0"/>
              </svg>
              <div class="score-text">
                <span class="score-value" id="mealScore">0</span>
                <span class="score-max">/100</span>
              </div>
            </div>
            <div class="score-label-row">
              <div class="score-rating" id="scoreRating">Add foods to your plate</div>
              <div class="score-change" id="scoreChange"></div>
            </div>
          </div>

          <!-- Next Action Tip -->
          <div class="score-next-action" id="scoreNextAction">
            <span class="next-action-icon">💡</span>
            <span class="next-action-text" id="nextActionText">Drag foods onto your plate to start scoring!</span>
          </div>

          <!-- 5-Dimension Score Breakdown -->
          <div class="score-breakdown">

            <div class="score-dim-label">Score Breakdown</div>

            <div class="score-item" id="dimVeggies">
              <div class="score-item-header">
                <span class="score-icon">🥦</span>
                <span class="score-name">Vegetable Power</span>
                <span class="score-max-pts">/ 30</span>
              </div>
              <div class="score-bar-track">
                <div class="score-bar-fill veggie-fill" id="veggieBar" style="width:0%"></div>
              </div>
              <span class="score-points" id="veggiePoints">0</span>
            </div>

            <div class="score-item" id="dimBalance">
              <div class="score-item-header">
                <span class="score-icon">⚖️</span>
                <span class="score-name">Plate Balance</span>
                <span class="score-max-pts">/ 25</span>
              </div>
              <div class="score-bar-track">
                <div class="score-bar-fill balance-fill" id="balanceBar" style="width:0%"></div>
              </div>
              <span class="score-points" id="balancePoints">0</span>
            </div>

            <div class="score-item" id="dimGI">
              <div class="score-item-header">
                <span class="score-icon">📉</span>
                <span class="score-name">GI Control</span>
                <span class="score-max-pts">/ 25</span>
              </div>
              <div class="score-bar-track">
                <div class="score-bar-fill gi-fill" id="giBar" style="width:0%"></div>
              </div>
              <span class="score-points" id="giPoints">0</span>
            </div>

            <div class="score-item" id="dimProtein">
              <div class="score-item-header">
                <span class="score-icon">💪</span>
                <span class="score-name">Protein Adequacy</span>
                <span class="score-max-pts">/ 10</span>
              </div>
              <div class="score-bar-track">
                <div class="score-bar-fill protein-fill" id="proteinBar" style="width:0%"></div>
              </div>
              <span class="score-points" id="proteinPoints">0</span>
            </div>

            <div class="score-item" id="dimVariety">
              <div class="score-item-header">
                <span class="score-icon">🌈</span>
                <span class="score-name">Variety Bonus</span>
                <span class="score-max-pts">/ 10</span>
              </div>
              <div class="score-bar-track">
                <div class="score-bar-fill variety-fill" id="varietyBar" style="width:0%"></div>
              </div>
              <span class="score-points" id="varietyPoints">0</span>
            </div>

          </div>

          <!-- Nutrition Snapshot -->
          <div class="nutrition-snapshot" id="nutritionSnapshot">
            <div class="snap-title">📊 Meal Nutrition Snapshot</div>
            <div class="snap-grid">
              <div class="snap-item">
                <span class="snap-icon">🩸</span>
                <span class="snap-label">Avg GI</span>
                <span class="snap-value" id="snapGI">—</span>
              </div>
              <div class="snap-item">
                <span class="snap-icon">🥩</span>
                <span class="snap-label">Protein</span>
                <span class="snap-value" id="snapProtein">—</span>
              </div>
              <div class="snap-item">
                <span class="snap-icon">🌾</span>
                <span class="snap-label">Fiber</span>
                <span class="snap-value" id="snapFiber">—</span>
              </div>
              <div class="snap-item">
                <span class="snap-icon">🍽️</span>
                <span class="snap-label">Foods</span>
                <span class="snap-value" id="snapFoods">0</span>
              </div>
            </div>
          </div>

          <!-- Achievements Panel -->
          <div class="achievements-section">
            <h4 class="achievements-title">🏆 Achievements</h4>
            <div class="achievements-grid" id="achievementsGrid">
              <!-- Populated by JS -->
            </div>
          </div>

        </div>
        <!-- END MEAL SCORE CARD -->

        <!-- Meal History and Quick Ideas Container -->
        <div class="meal-history-suggestions-container">
          <div class="meal-history-panel">
            <h3>Your Meal History</h3>
            <div class="history-filters">
              <button onclick="filterHistory('today')">Today</button>
              <button onclick="filterHistory('week')">This Week</button>
              <button onclick="filterHistory('favorites')">⭐ Favorites</button>
            </div>
            
            <div class="history-list" id="mealHistory">
              <!-- Populated dynamically -->
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- RIGHT: Draggable Food Selector -->
    <div class="food-selector-interactive">
      <div class="food-search">
        <input type="text" placeholder="Search foods..." class="search-input" id="foodSearch">
        <span class="search-icon">🔍</span>
      </div>

      <div class="food-comparison-tool">
        <button class="compare-btn" onclick="openTrackerComparison()">
          Compare Foods 🔍
        </button>
      </div>

      <!-- Comparison Overlay -->
      <div class="comparison-overlay" id="comparisonOverlay"></div>

      <div class="comparison-modal" id="comparisonModal">
      <div class="comparison-modal-content-new">
        <button class="close-comparison" onclick="closeComparison()">✕</button>
        
        <div class="modal-header-modern">
          <h2>⚖️ Compare Foods Side-by-Side</h2>
          <p>Search and compare nutritional values for better glucose control</p>
        </div>
        
        <div class="compare-selection-area">
          <div class="compare-slot">
            <div class="slot-header">Food A</div>
            <input 
              type="text" 
              class="compare-search-input" 
              placeholder="Search food..." 
              id="modalCompareA" 
              oninput="searchForModalCompare('A')"
              style="display: block !important; visibility: visible !important; opacity: 1 !important;">
            <div class="compare-suggestions" id="modalSuggestionsA"></div>
            <div class="selected-food-compare" id="modalSelectedA">
              <div class="slot-placeholder">Select a food to compare</div>
            </div>
          </div>

          <div class="compare-vs">
            <div class="vs-circle">VS</div>
          </div>

          <div class="compare-slot">
            <div class="slot-header">Food B</div>
            <input 
              type="text" 
              class="compare-search-input" 
              placeholder="Search food..." 
              id="modalCompareB" 
              oninput="searchForModalCompare('B')"
              style="display: block !important; visibility: visible !important; opacity: 1 !important;">
            <div class="compare-suggestions" id="modalSuggestionsB"></div>
            <div class="selected-food-compare" id="modalSelectedB">
              <div class="slot-placeholder">Select a food to compare</div>
            </div>
          </div>
        </div>

        <div class="comparison-results" id="modalComparisonResults">
          <div class="comparison-placeholder">
            <div class="placeholder-icon-large">⚖️</div>
            <p>Select two foods to see detailed comparison</p>
          </div>
        </div>
      </div>
    </div>


      <!-- Comparison Backdrop -->
      <div class="comparison-backdrop" id="comparisonBackdrop" onclick="closeComparison()"></div>

    
      <!-- CUISINE SELECTOR - ADD HERE FIRST -->
      <div class="cuisine-selector">
        <h4>Choose Your Cuisine Style</h4>
        <select id="cuisineStyle" onchange="updateFoodOptions()">
          <option value="all">All Indian Foods</option>
          <option value="north">North Indian</option>
          <option value="south">South Indian</option>
          <option value="east">East Indian</option>
          <option value="west">West Indian</option>
          <option value="fusion">Modern Fusion</option>
        </select>
      </div>

      <!-- DIETARY FILTERS - ADD HERE SECOND -->
      <div class="dietary-filters">
        <h4>Customize Your Options</h4>
        <div class="filter-buttons">
          <button class="filter-btn" data-filter="vegetarian" onclick="toggleFilter('vegetarian')">
            <span class="filter-icon">🥬</span> Vegetarian
          </button>
          <button class="filter-btn" data-filter="non-veg" onclick="toggleFilter('non-veg')">
            <span class="filter-icon">🍗</span> Non-Veg
          </button>
          <button class="filter-btn" data-filter="vegan" onclick="toggleFilter('vegan')">
            <span class="filter-icon">🌱</span> Vegan
          </button>
          <button class="filter-btn" data-filter="gluten-free" onclick="toggleFilter('gluten-free')">
            <span class="filter-icon">🌾</span> Gluten-Free
          </button>
          <button class="filter-btn" data-filter="dairy-free" onclick="toggleFilter('dairy-free')">
            <span class="filter-icon">🥛</span> Dairy-Free
          </button>
        </div>
      </div>


      <div class="food-category">
        <h4 class="category-title">✅ Excellent Choices (Low GI)</h4>
        <div class="food-grid draggable">
          <div class="food-item good draggable-food" draggable="true" data-type="vegetable" data-gi="low" data-food="leafy-greens">

            <!-- Add to each food item -->
            <div class="food-item" data-tooltip-id="leafy-greens">
              <span class="food-icon">🥬</span>
              <span class="food-name">Leafy Greens</span>
              <span class="gi-badge low">GI: 15</span>
              <span class="info-icon" onclick="showFoodInfo('leafy-greens')">ℹ️</span>
            </div>

            <div class="food-info-tooltip" id="tooltip-leafy-greens">
              <div class="tooltip-header">
                <h4>🥬 Leafy Greens</h4>
                <button class="close-tooltip">×</button>
              </div>
              
              <div class="tooltip-body">
                <div class="nutrient-info">
                  <span class="label">GI:</span>
                  <span class="value">15 (Very Low)</span>
                </div>
                <div class="nutrient-info">
                  <span class="label">Fiber:</span>
                  <span class="value">High - Slows glucose absorption</span>
                </div>
                <div class="nutrient-info">
                  <span class="label">Benefits:</span>
                  <ul>
                    <li>Rich in folate (essential for baby's development)</li>
                    <li>High in iron (prevents anemia)</li>
                    <li>Minimal effect on blood sugar</li>
                  </ul>
                </div>
                
                <div class="portion-guide">
                  <h5>Serving Guide:</h5>
                  <div class="portion-visual">
                    <img src="portion-leafy-greens.jpg" alt="Portion size">
                    <p>1 cup cooked = 1 serving</p>
                  </div>
                </div>
                
                <div class="recipe-links">
                  <h5>Try These Recipes:</h5>
                  <a href="#recipe1">Palak Paneer (Low GI)</a>
                  <a href="#recipe2">Saag Dal</a>
                </div>
              </div>
            </div>

          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="protein" data-gi="low" data-food="dal">
            <span class="food-icon">🫘</span>
            <span class="food-name">Dal/Legumes</span>
            <span class="gi-badge low">GI: 28</span>
            <div class="portion-controls">
              <button class="portion-btn small" onclick="addFood('dal', 'protein', 'low', 'Dal/Legumes', '🫘', 'small')">
                <span class="portion-icon">🥄</span>
                <span class="portion-label">Small</span>
              </button>
              <button class="portion-btn medium" onclick="addFood('dal', 'protein', 'low', 'Dal/Legumes', '🫘', 'medium')">
                <span class="portion-icon">🍽️</span>
                <span class="portion-label">Med</span>
              </button>
              <button class="portion-btn large" onclick="addFood('dal', 'protein', 'low', 'Dal/Legumes', '🫘', 'large')">
                <span class="portion-icon">🍲</span>
                <span class="portion-label">Large</span>
              </button>
            </div>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="carbs" data-gi="low" data-food="brown-rice">
            <span class="food-icon">🍚</span>
            <span class="food-name">Brown Rice</span>
            <span class="gi-badge low">GI: 50</span>
            <div class="portion-controls">
              <button class="portion-btn small" onclick="addFood('brown-rice', 'carbs', 'low', 'Brown Rice', '🍚', 'small')">
                <span class="portion-icon">🥄</span>
                <span class="portion-label">Small</span>
              </button>
              <button class="portion-btn medium" onclick="addFood('brown-rice', 'carbs', 'low', 'Brown Rice', '🍚', 'medium')">
                <span class="portion-icon">🍽️</span>
                <span class="portion-label">Med</span>
              </button>
              <button class="portion-btn large" onclick="addFood('brown-rice', 'carbs', 'low', 'Brown Rice', '🍚', 'large')">
                <span class="portion-icon">🍲</span>
                <span class="portion-label">Large</span>
              </button>
            </div>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="protein" data-gi="low" data-food="eggs">
            <span class="food-icon">🥚</span>
            <span class="food-name">Eggs</span>
            <span class="gi-badge low">GI: 0</span>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="protein" data-gi="low" data-food="curd">
            <span class="food-icon">🥛</span>
            <span class="food-name">Curd/Yogurt</span>
            <span class="gi-badge low">GI: 36</span>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="vegetable" data-gi="low" data-food="vegetables">
            <span class="food-icon">🥦</span>
            <span class="food-name">Mixed Veggies</span>
            <span class="gi-badge low">GI: 20</span>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="protein" data-gi="low" data-food="fish">
            <span class="food-icon">🐟</span>
            <span class="food-name">Fish</span>
            <span class="gi-badge low">GI: 0</span>
          </div>
          <div class="food-item good draggable-food" draggable="true" data-type="carbs" data-gi="medium" data-food="roti">
            <span class="food-icon">🫓</span>
            <span class="food-name">Whole Wheat Roti</span>
            <span class="gi-badge medium">GI: 62</span>
          </div>
        </div>
      </div>

      <div class="food-category">
        <h4 class="category-title">⚠️ Use Sparingly (Medium GI)</h4>
        <div class="food-grid draggable">
          <div class="food-item moderate draggable-food" draggable="true" data-type="carbs" data-gi="medium" data-food="white-rice">
            <span class="food-icon">🍚</span>
            <span class="food-name">White Rice</span>
            <span class="gi-badge medium">GI: 73</span>
          </div>
          <div class="food-item moderate draggable-food" draggable="true" data-type="carbs" data-gi="medium" data-food="potato">
            <span class="food-icon">🥔</span>
            <span class="food-name">Potato</span>
            <span class="gi-badge medium">GI: 78</span>
          </div>
          <div class="food-item moderate draggable-food" draggable="true" data-type="carbs" data-gi="medium" data-food="banana">
            <span class="food-icon">🍌</span>
            <span class="food-name">Banana</span>
            <span class="gi-badge medium">GI: 51</span>
          </div>
        </div>
      </div>

      <div class="food-category">
        <h4 class="category-title">❌ Avoid (High GI)</h4>
        <div class="food-grid draggable">
          <div class="food-item avoid" data-food="sweets">
            <span class="food-icon">🧁</span>
            <span class="food-name">Sweets</span>
            <span class="gi-badge high">GI: 90+</span>
          </div>
          <div class="food-item avoid" data-food="sugary-drinks">
            <span class="food-icon">🥤</span>
            <span class="food-name">Sugary Drinks</span>
            <span class="gi-badge high">GI: 95+</span>
          </div>
          <div class="food-item avoid" data-food="fried">
            <span class="food-icon">🍟</span>
            <span class="food-name">Fried Foods</span>
            <span class="gi-badge high">GI: 85+</span>
          </div>
          <div class="food-item avoid" data-food="white-bread">
            <span class="food-icon">🍞</span>
            <span class="food-name">White Bread</span>
            <span class="gi-badge high">GI: 75</span>
          </div>
        </div>
      </div>

      <div class="gi-info-box">
        <h4>Understanding Glycemic Index (GI)</h4>
        <div class="gi-scale">
          <div class="gi-range low">
            <span class="gi-value">0-55</span>
            <span class="gi-label">Low GI - Best Choice</span>
          </div>
          <div class="gi-range medium">
            <span class="gi-value">56-69</span>
            <span class="gi-label">Medium GI - Moderate</span>
          </div>
          <div class="gi-range high">
            <span class="gi-value">70+</span>
            <span class="gi-label">High GI - Limit/Avoid</span>
          </div>
        </div>
      </div>

      <!-- Pre-made Meal Suggestions -->
      <div class="meal-suggestions">
        <h3>Quick Meal Ideas</h3>
        <div class="suggestion-cards">
          <div class="suggestion-card" onclick="loadMealTemplate('breakfast1')">
            <div class="suggestion-icon">🌅</div>
            <h4>Perfect Breakfast</h4>
            <p>Oats upma + boiled egg + buttermilk</p>
            <div class="suggestion-stats">
              <span class="stat">GI: Low</span>
              <span class="stat">Protein: High</span>
            </div>
          </div>
          <div class="suggestion-card" onclick="loadMealTemplate('lunch1')">
            <div class="suggestion-icon">☀️</div>
            <h4>Balanced Lunch</h4>
            <p>Brown rice + dal + mixed veggies + salad</p>
            <div class="suggestion-stats">
              <span class="stat">GI: Low</span>
              <span class="stat">Fiber: High</span>
            </div>
          </div>
          <div class="suggestion-card" onclick="loadMealTemplate('dinner1')">
            <div class="suggestion-icon">🌙</div>
            <h4>Light Dinner</h4>
            <p>Grilled fish + roti + vegetable curry</p>
            <div class="suggestion-stats">
              <span class="stat">GI: Low</span>
              <span class="stat">Omega-3: High</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



    <!-- SUPPORT COMMUNITY -->
    <!-- SUPPORT COMMUNITY WITH REAL CONNECTIONS -->
<section id="support" class="community-section">
  <div class="section-header">
    <div class="header-badge">
      <span class="badge-pulse"></span>
      <span class="badge-text">You're Not Alone - 2,500+ Mothers</span>
    </div>
    <h2 class="section-title">Join Our Thriving Community</h2>
    <p class="section-subtitle">
      Connect with thousands of mothers managing GDM. Share stories, get support, and learn from each other's experiences.
    </p>
  </div>

  <div class="community-grid">
    <!-- WhatsApp Groups -->
    <div class="community-card clickable" onclick="window.open('https://chat.whatsapp.com/invite-link', '_blank')">
      <div class="card-icon-animated">💬</div>
      <div class="card-badge live">Live Chat</div>
      <h3>WhatsApp Support Groups</h3>
      <p>24/7 peer support from mothers experiencing GDM right now</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">👥</span>
          <span class="stat-text">450+ Active Members</span>
        </span>
        <span class="stat">
          <span class="stat-icon">💬</span>
          <span class="stat-text">100+ Daily Messages</span>
        </span>
      </div>
      <div class="live-activity">
        <div class="activity-dot"></div>
        <span>12 members active now</span>
      </div>
      <button class="community-btn">
        <span>Join WhatsApp Group</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Facebook Groups -->
    <div class="community-card clickable" onclick="window.open('https://www.facebook.com/groups/gestational-diabetes-india', '_blank')">
      <div class="card-icon-animated">👥</div>
      <div class="card-badge popular">Most Popular</div>
      <h3>Facebook Community</h3>
      <p>Share experiences, meal ideas, and victories with mothers across India</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">👥</span>
          <span class="stat-text">1,200+ Members</span>
        </span>
        <span class="stat">
          <span class="stat-icon">📝</span>
          <span class="stat-text">Daily Posts</span>
        </span>
      </div>
      <div class="recent-topics">
        <h4>Recent Topics:</h4>
        <ul>
          <li>"My glucose finally under control!"</li>
          <li>"Best low-GI Indian breakfast ideas"</li>
          <li>"Managing GDM at work"</li>
        </ul>
      </div>
      <button class="community-btn">
        <span>Join Facebook Group</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Telegram Channel -->
    <div class="community-card clickable" onclick="window.open('https://t.me/gdm_support_india', '_blank')">
      <div class="card-icon-animated">📱</div>
      <div class="card-badge expert">Expert Tips</div>
      <h3>Telegram Channel</h3>
      <p>Daily tips, meal ideas, and expert advice delivered to your phone</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">📢</span>
          <span class="stat-text">800+ Subscribers</span>
        </span>
        <span class="stat">
          <span class="stat-icon">⭐</span>
          <span class="stat-text">Expert Curated</span>
        </span>
      </div>
      <div class="channel-preview">
        <h4>Today's Tip:</h4>
        <p>"Add 1 tbsp of cinnamon to your morning oats - may help regulate blood sugar!"</p>
      </div>
      <button class="community-btn">
        <span>Subscribe to Channel</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Reddit Community -->
    <div class="community-card clickable" onclick="window.open('https://www.reddit.com/r/GestationalDiabetes/', '_blank')">
      <div class="card-icon-animated">📖</div>
      <div class="card-badge global">Global Community</div>
      <h3>Reddit Discussions</h3>
      <p>In-depth discussions, scientific articles, and global perspectives</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">🌍</span>
          <span class="stat-text">15,000+ Members</span>
        </span>
        <span class="stat">
          <span class="stat-icon">💡</span>
          <span class="stat-text">Evidence-Based</span>
        </span>
      </div>
      <div class="reddit-highlights">
        <h4>Top Discussions:</h4>
        <ul>
          <li>"GDM success stories compilation"</li>
          <li>"Latest research on GDM management"</li>
          <li>"International meal ideas"</li>
        </ul>
      </div>
      <button class="community-btn">
        <span>Join Reddit</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Virtual Meetups -->
    <div class="community-card clickable" onclick="window.open('https://meet.google.com/gdm-support', '_blank')">
      <div class="card-icon-animated">🎥</div>
      <div class="card-badge">Weekly Sessions</div>
      <h3>Virtual Support Meetups</h3>
      <p>Weekly video calls with healthcare educators and peer support</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">📅</span>
          <span class="stat-text">Every Saturday 5 PM</span>
        </span>
        <span class="stat">
          <span class="stat-icon">👨‍⚕️</span>
          <span class="stat-text">Expert Led</span>
        </span>
      </div>
      <div class="next-session">
        <h4>Next Session:</h4>
        <p><strong>Saturday, Feb 8 at 5:00 PM</strong></p>
        <p>Topic: "Indian Meal Planning for GDM"</p>
        <p>Speaker: Dr. Priya Sharma, Nutritionist</p>
      </div>
      <button class="community-btn">
        <span>Register for Meetup</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Success Stories -->
    <div class="community-card clickable" onclick="openSuccessStories()">
      <div class="card-icon-animated">⭐</div>
      <div class="card-badge inspiring">Inspiring</div>
      <h3>Success Stories</h3>
      <p>Read how other mothers managed GDM and had healthy babies</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">📖</span>
          <span class="stat-text">500+ Stories</span>
        </span>
        <span class="stat">
          <span class="stat-icon">❤️</span>
          <span class="stat-text">Hope & Inspiration</span>
        </span>
      </div>
      <div class="story-preview">
        <div class="story-quote">"I was terrified when diagnosed at 26 weeks. With diet changes and walking, I managed without insulin. My baby was born healthy at 3.2 kg!" - Priya, Mumbai</div>
      </div>
      <button class="community-btn">
        <span>Read Stories</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Expert Q&A -->
    <div class="community-card clickable" onclick="window.open('https://forms.gle/gdm-expert-qa', '_blank')">
      <div class="card-icon-animated">🩺</div>
      <div class="card-badge">Free</div>
      <h3>Ask the Experts</h3>
      <p>Monthly Q&A with endocrinologists, nutritionists, and obstetricians</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">📅</span>
          <span class="stat-text">Last Sunday/Month</span>
        </span>
        <span class="stat">
          <span class="stat-icon">🎓</span>
          <span class="stat-text">Certified Experts</span>
        </span>
      </div>
      <div class="expert-panel">
        <h4>Expert Panel:</h4>
        <ul>
          <li>Dr. Anjali Mehta - Endocrinologist</li>
          <li>Dr. Kavita Singh - Obstetrician</li>
          <li>Neha Gupta - Clinical Nutritionist</li>
        </ul>
      </div>
      <button class="community-btn">
        <span>Submit Question</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>

    <!-- Local Support Groups -->
    <div class="community-card clickable" onclick="findLocalGroups()">
      <div class="card-icon-animated">📍</div>
      <div class="card-badge">Near You</div>
      <h3>Local Support Groups</h3>
      <p>Find in-person support groups in your city</p>
      <div class="community-stats">
        <span class="stat">
          <span class="stat-icon">🏙️</span>
          <span class="stat-text">25+ Cities</span>
        </span>
        <span class="stat">
          <span class="stat-icon">🤝</span>
          <span class="stat-text">In-Person Meetups</span>
        </span>
      </div>
      <div class="location-finder">
        <input type="text" placeholder="Enter your city..." class="city-input">
        <button class="find-btn">Find Groups</button>
      </div>
      <button class="community-btn">
        <span>Browse All Cities</span>
        <span class="btn-arrow">→</span>
      </button>
    </div>
  </div>

  <!-- Community Guidelines -->
  <div class="community-guidelines">
    <h3>Community Guidelines</h3>
    <div class="guidelines-grid">
      <div class="guideline-item">
        <span class="guideline-icon">💝</span>
        <h4>Be Kind & Supportive</h4>
        <p>We're all on this journey together</p>
      </div>
      <div class="guideline-item">
        <span class="guideline-icon">🔒</span>
        <h4>Privacy First</h4>
        <p>What's shared here stays here</p>
      </div>
      <div class="guideline-item">
        <span class="guideline-icon">🩺</span>
        <h4>Medical Advice Disclaimer</h4>
        <p>Always consult your doctor</p>
      </div>
      <div class="guideline-item">
        <span class="guideline-icon">🌟</span>
        <h4>Share Your Wins</h4>
        <p>Celebrate every victory, big or small</p>
      </div>
    </div>
  </div>
</section>

  </div>

  <!-- TOPIC DETAIL PANEL (Side Panel) -->
  <div class="topic-panel" id="topicPanel">
    <button class="close-panel" onclick="closeTopicPanel()">✕</button>
    <div class="panel-scroll">
      <div class="panel-header" id="panelHeader">
        <div class="panel-icon" id="panelIcon"></div>
        <div class="panel-title-block">
          <h2 id="panelTitle"></h2>
          <p id="panelSubtitle"></p>
        </div>
      </div>
      <div class="panel-content" id="panelContent"></div>
    </div>
  </div>

  <!-- BACKDROP -->
  <div class="backdrop" id="backdrop" onclick="closeTopicPanel()"></div>

  <!-- KNOWLEDGE QUIZ MODAL -->
  <div class="quiz-modal" id="quizModal">
    <div class="quiz-container">
      <button class="close-quiz" onclick="closeQuiz()">✕</button>
      <h2>GDM Knowledge Quiz</h2>
      <p class="quiz-intro">Test your understanding of gestational diabetes</p>
      <div class="quiz-content" id="quizContent">
        <!-- Quiz questions will be loaded here -->
      </div>
    </div>
  </div>


 <!-- SUGAR TRACKER MODAL -->
<!-- REDESIGNED MEAL & GLUCOSE TRACKER MODAL -->
<div class="sugar-tracker-modal" id="sugarTrackerModal">
  <div class="tracker-container-new">
    <button class="close-tracker" onclick="closeSugarTracker()">✕</button>
    
    <!-- Modern Header with Gradient -->
    <div class="tracker-header-modern">
      <div class="header-glass-card">
        <div class="header-content-flex">
          <div class="header-icon-modern">🍽️</div>
          <div>
            <h2 class="tracker-title-modern">Smart Meal & Glucose Tracker</h2>
            <p class="tracker-subtitle">Track meals • Monitor glucose • Stay healthy</p>
          </div>
        </div>
        <div class="quick-stats-row">
          <div class="quick-stat-pill">
            <span class="stat-icon">📊</span>
            <span id="todayReadingsCount">0</span> Today
          </div>
          <div class="quick-stat-pill success">
            <span class="stat-icon">✓</span>
            <span id="inRangeToday">0</span> In Range
          </div>
          <div class="quick-stat-pill">
            <span class="stat-icon">📈</span>
            <span id="avgToday">--</span> mg/dL Avg
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tracker-tabs">
      <button class="tab-btn active" data-tab="log" onclick="switchTrackerTab('log')">
        <span class="tab-icon">📝</span>
        Log Meal
      </button>
      <button class="tab-btn" data-tab="search" onclick="switchTrackerTab('search')">
        <span class="tab-icon">🔍</span>
        Search Foods
      </button>
      <button class="tab-btn" data-tab="compare" onclick="switchTrackerTab('compare')">
        <span class="tab-icon">⚖️</span>
        Compare Foods
      </button>
      <button class="tab-btn" data-tab="history" onclick="switchTrackerTab('history')">
        <span class="tab-icon">📋</span>
        History
      </button>
    </div>

    <!-- TAB 1: LOG MEAL -->
    <div class="tab-content active" id="tab-log">
      <div class="log-meal-grid">
        <!-- Left Column: Meal Entry -->
        <div class="meal-entry-card glass-card">
          <h3 class="card-title">
            <span class="title-icon">🍽️</span>
            Log Your Meal
          </h3>
          
          <!-- Date & Time -->
          <div class="form-group-modern">
            <label class="form-label">📅 Date & Time</label>
            <div class="datetime-flex">
              <input type="datetime-local" id="mealDateTime" class="input-modern">
              <button class="btn-now" onclick="setNow()">Now</button>
            </div>
          </div>

          <!-- Meal Type -->
          <div class="form-group-modern">
            <label class="form-label">⏰ Meal Type</label>
            <div class="meal-type-carousel">
              <button class="meal-type-card" data-type="fasting" onclick="selectMealType('fasting')">
                <div class="meal-icon">🌅</div>
                <div class="meal-name">Fasting</div>
                <div class="meal-target">&lt;95</div>
              </button>
              <button class="meal-type-card" data-type="breakfast" onclick="selectMealType('breakfast')">
                <div class="meal-icon">🍳</div>
                <div class="meal-name">Breakfast</div>
                <div class="meal-target">&lt;140</div>
              </button>
              <button class="meal-type-card" data-type="lunch" onclick="selectMealType('lunch')">
                <div class="meal-icon">🍽️</div>
                <div class="meal-name">Lunch</div>
                <div class="meal-target">&lt;140</div>
              </button>
              <button class="meal-type-card" data-type="snack" onclick="selectMealType('snack')">
                <div class="meal-icon">🥗</div>
                <div class="meal-name">Snack</div>
                <div class="meal-target">&lt;120</div>
              </button>
              <button class="meal-type-card" data-type="dinner" onclick="selectMealType('dinner')">
                <div class="meal-icon">🌙</div>
                <div class="meal-name">Dinner</div>
                <div class="meal-target">&lt;140</div>
              </button>
            </div>
          </div>

          <!-- Glucose Reading -->
          <div class="form-group-modern">
            <label class="form-label">🩸 Glucose Reading</label>
            <div class="glucose-input-wrapper">
              <input type="number" id="glucoseReading" class="glucose-input-large" placeholder="--" min="40" max="400">
              <span class="glucose-unit">mg/dL</span>
              <div class="glucose-status" id="glucoseStatus"></div>
            </div>
            <div class="quick-glucose-btns">
              <button class="quick-glucose" onclick="setGlucose(85)">85</button>
              <button class="quick-glucose" onclick="setGlucose(95)">95</button>
              <button class="quick-glucose" onclick="setGlucose(110)">110</button>
              <button class="quick-glucose" onclick="setGlucose(125)">125</button>
              <button class="quick-glucose" onclick="setGlucose(140)">140</button>
            </div>
          </div>

          <!-- Food Search & Add -->
          <div class="form-group-modern">
            <label class="form-label">🍴 What did you eat?</label>
            <div class="food-search-wrapper">
              <input type="text" id="foodSearchInput" class="input-modern" placeholder="Type to search foods..." oninput="searchFoodsInline()">
              <div class="food-suggestions" id="foodSuggestions"></div>
            </div>
            <div class="selected-foods" id="selectedFoods"></div>
          </div>

          <!-- Notes -->
          <div class="form-group-modern">
            <label class="form-label">💭 Notes (Optional)</label>
            <textarea id="mealNotes" class="textarea-modern" rows="3" placeholder="How are you feeling? Any symptoms?"></textarea>
          </div>

          <!-- Action Buttons -->
          <div class="action-btns-row">
            <button class="btn-secondary-modern" onclick="clearMealForm()">
              <span>🔄</span> Clear
            </button>
            <button class="btn-primary-modern" onclick="saveMealEntry()">
              <span>💾</span> Save Entry
            </button>
          </div>
        </div>



        <!-- Right Column: Live Preview & Insights -->
        <div class="preview-column">
          <div class="glass-card preview-card">
            <h3 class="card-title">
              <span class="title-icon">👁️</span>
              Live Preview
            </h3>
            <div class="entry-preview" id="entryPreview">
              <div class="preview-placeholder">
                <div class="placeholder-icon">📝</div>
                <p>Start filling the form to see preview</p>
              </div>
            </div>
          </div>

          <div class="glass-card insights-quick">
            <h3 class="card-title">
              <span class="title-icon">💡</span>
              Quick Tips
            </h3>
            <div class="tips-list">
              <div class="tip-item">
                <span class="tip-icon">⏱️</span>
                <span>Measure 1-2 hours after eating</span>
              </div>
              <div class="tip-item">
                <span class="tip-icon">🚶</span>
                <span>Walk 10-15 min after meals</span>
              </div>
              <div class="tip-item">
                <span class="tip-icon">💧</span>
                <span>Stay well hydrated</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- TAB 2: SEARCH FOODS -->
    <div class="tab-content" id="tab-search">
      <div class="search-foods-container">
        <div class="search-header-card glass-card">
          <h3 class="card-title">
            <span class="title-icon">🔍</span>
            Search Food Database
          </h3>
          <p class="search-subtitle">Find glycemic index, carbs, and impact on blood sugar</p>
          
          <div class="search-bar-modern">
            <span class="search-icon">🔍</span>
            <input type="text" id="foodSearchMain" class="search-input-large" placeholder="Search for rice, roti, fruits, vegetables..." oninput="performFoodSearch()">
            <button class="search-btn-modern" onclick="performFoodSearch()">Search</button>
          </div>

          <div class="search-filters">
            <button class="filter-chip active" data-filter="all" onclick="filterFoodCategory('all')">All</button>
            <button class="filter-chip" data-filter="grains" onclick="filterFoodCategory('grains')">Grains</button>
            <button class="filter-chip" data-filter="fruits" onclick="filterFoodCategory('fruits')">Fruits</button>
            <button class="filter-chip" data-filter="vegetables" onclick="filterFoodCategory('vegetables')">Vegetables</button>
            <button class="filter-chip" data-filter="protein" onclick="filterFoodCategory('protein')">Protein</button>
            <button class="filter-chip" data-filter="dairy" onclick="filterFoodCategory('dairy')">Dairy</button>
          </div>
        </div>

        <div class="search-results-grid" id="searchResultsGrid">
          <div class="search-placeholder">
            <div class="placeholder-icon-large">🔍</div>
            <h4>Search for foods to see detailed information</h4>
            <p>Get glycemic index, carb content, and blood sugar impact</p>
          </div>
        </div>
      </div>
    </div>

    <!-- TAB 3: COMPARE FOODS -->
    <div class="tab-content" id="tab-compare">
      <div class="compare-container">
        <div class="compare-header-card glass-card">
          <h3 class="card-title">
            <span class="title-icon">⚖️</span>
            Compare Foods Side-by-Side
          </h3>
          <p class="search-subtitle">Choose healthier alternatives for better glucose control</p>
        </div>

        <div class="compare-selection-area">
          <div class="compare-slot">
            <div class="slot-header">Food A</div>
            <input type="text" 
                  class="compare-search-input" 
                  placeholder="Search food..." 
                  id="compareA" 
                  oninput="searchForCompare('A')"
                  style="display: block !important; visibility: visible !important; opacity: 1 !important;">
            <div class="compare-suggestions" id="suggestionsA"></div>
            <div class="selected-food-compare" id="selectedA">
              <div class="slot-placeholder">Select a food to compare</div>
            </div>
          </div>

          <div class="compare-vs">
            <div class="vs-circle">VS</div>
          </div>

          <div class="compare-slot">
            <div class="slot-header">Food B</div>
            <input type="text" 
              class="compare-search-input" 
              placeholder="Search food..." 
              id="compareB" 
              oninput="searchForCompare('B')"
              style="display: block !important; visibility: visible !important; opacity: 1 !important;">
            <div class="compare-suggestions" id="suggestionsB"></div>
            <div class="selected-food-compare" id="selectedB">
              <div class="slot-placeholder">Select a food to compare</div>
            </div>
          </div>
        </div>

        <div class="comparison-results" id="comparisonResults">
          <div class="comparison-placeholder">
            <div class="placeholder-icon-large">⚖️</div>
            <p>Select two foods to see detailed comparison</p>
          </div>
        </div>
      </div>
    </div>

    <!-- TAB 4: HISTORY -->
    <div class="tab-content" id="tab-history">
      <div class="history-modern-container">
        <div class="history-controls glass-card">
          <div class="controls-flex">
            <div class="search-history">
              <span class="search-icon">🔍</span>
              <input type="text" id="historySearch" class="search-input-small" placeholder="Search history..." oninput="filterHistory()">
            </div>
            <div class="history-actions">
              <button class="btn-icon-modern" onclick="exportHistory()" title="Export Data">
                <span>📤</span>
              </button>
              <button class="btn-icon-modern danger" onclick="clearAllHistory()" title="Clear All">
                <span>🗑️</span>
              </button>
            </div>
          </div>
          
          <div class="date-range-filter">
            <label>Date Range:</label>
            <select id="dateRangeFilter" class="select-modern" onchange="filterHistoryByDate()">
              <option value="all">All Time</option>
              <option value="today">Today</option>
              <option value="week">This Week</option>
              <option value="month">This Month</option>
            </select>
          </div>
        </div>

        <div class="history-stats-row">
          <div class="stat-card-modern">
            <div class="stat-icon-modern">📊</div>
            <div class="stat-content">
              <div class="stat-value-modern" id="totalEntries">0</div>
              <div class="stat-label-modern">Total Entries</div>
            </div>
          </div>
          <div class="stat-card-modern">
            <div class="stat-icon-modern success">✓</div>
            <div class="stat-content">
              <div class="stat-value-modern" id="inRangePercent">0%</div>
              <div class="stat-label-modern">In Target Range</div>
            </div>
          </div>
          <div class="stat-card-modern">
            <div class="stat-icon-modern">📈</div>
            <div class="stat-content">
              <div class="stat-value-modern" id="avgGlucoseAll">--</div>
              <div class="stat-label-modern">Average Glucose</div>
            </div>
          </div>
        </div>

        <div class="timeline-view" id="historyTimeline">
          <div class="search-placeholder">
            <div class="placeholder-icon-large">📋</div>
            <h4>No entries yet</h4>
            <p>Start logging your meals to see your history here</p>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Backdrop for tracker modal -->
<div class="tracker-backdrop" id="trackerBackdrop" onclick="closeSugarTracker()"></div>

<script>
  
// ================================
// GESTATIONAL DIABETES EDUCATION PLATFORM
// Interactive JavaScript
// ================================


// ===================================
// MEAL SCORE & ACHIEVEMENTS SYSTEM
// ===================================

/**
 * Safely get element and perform operation
 * @param {string} id - Element ID
 * @param {function} callback - Function to execute if element exists
 */
function safeElementOperation(id, callback) {
  const element = document.getElementById(id);
  if (element && callback) {
    callback(element);
  }
  return element;
}

/**
 * Safely set text content
 * @param {string} id - Element ID
 * @param {string} text - Text to set
 */
function safeSetText(id, text) {
  const element = document.getElementById(id);
  if (element) {
    element.textContent = text;
  }
}

/**
 * Safely add CSS class
 * @param {string} id - Element ID
 * @param {string} className - Class to add
 */
function safeAddClass(id, className) {
  const element = document.getElementById(id);
  if (element) {
    element.classList.add(className);
  }
}

/**
 * Safely remove CSS class
 * @param {string} id - Element ID
 * @param {string} className - Class to remove
 */
function safeRemoveClass(id, className) {
  const element = document.getElementById(id);
  if (element) {
    element.classList.remove(className);
  }
}


let userAchievements = [];

// Achievement definitions
const achievements = {
  'first-meal': {
    id: 'first-meal',
    title: 'First Meal! 🎉',
    description: 'Created your first meal',
    icon: '🍽️',
    condition: (stats) => stats.mealsCreated >= 1
  },
  'veggie-master': {
    id: 'veggie-master',
    title: 'Veggie Master',
    description: 'Perfect vegetable portions',
    icon: '🥗',
    condition: (stats) => stats.veggieScore >= 40
  },
  'balanced-pro': {
    id: 'balanced-pro',
    title: 'Balance Pro',
    description: 'Perfect plate balance',
    icon: '⚖️',
    condition: (stats) => stats.balanceScore >= 30
  },
  'gi-champion': {
    id: 'gi-champion',
    title: 'GI Champion',
    description: 'All low-GI choices',
    icon: '📉',
    condition: (stats) => stats.giScore >= 30
  },
  'perfect-plate': {
    id: 'perfect-plate',
    title: 'Perfect Plate!',
    description: 'Scored 90+',
    icon: '⭐',
    condition: (stats) => stats.totalScore >= 90
  },
  'consistent': {
    id: 'consistent',
    title: 'Consistency King',
    description: '5 meals in a row',
    icon: '🔥',
    condition: (stats) => stats.mealsCreated >= 5
  }
};

function calculateMealScore() {
  if (currentMeal.length === 0) {
    updateScoreDisplay(0, 0, 0, 0);
    return { totalScore: 0, breakdown: {} };
  }
  
  let breakdown = {};
  
  // 1. Vegetable Score (40 points max)
  const veggieItems = currentMeal.filter(f => f.type === 'vegetable');
  const veggieCount = veggieItems.length;
  breakdown.veggies = Math.min(veggieCount * 15, 40);
  
  // 2. Plate Balance Score (30 points)
  const veggieRatio = veggieItems.length / currentMeal.length;
  const proteinItems = currentMeal.filter(f => f.type === 'protein');
  const carbItems = currentMeal.filter(f => f.type === 'carbs');
  
  const hasAllTypes = veggieItems.length > 0 && proteinItems.length > 0 && carbItems.length > 0;
  const idealRatio = veggieRatio >= 0.4 && veggieRatio <= 0.6;
  
  if (hasAllTypes && idealRatio) {
    breakdown.balance = 30;
  } else if (hasAllTypes) {
    breakdown.balance = 20;
  } else {
    breakdown.balance = 10;
  }
  
  // 3. Low GI Selection Score (30 points)
  const totalGI = currentMeal.reduce((sum, food) => {
    const giValue = food.gi === 'low' ? 30 : food.gi === 'medium' ? 60 : 85;
    return sum + giValue;
  }, 0);
  
  const avgGI = totalGI / currentMeal.length;
  
  if (avgGI < 40) {
    breakdown.gi = 30;
  } else if (avgGI < 55) {
    breakdown.gi = 20;
  } else if (avgGI < 70) {
    breakdown.gi = 10;
  } else {
    breakdown.gi = 5;
  }
  
  const totalScore = breakdown.veggies + breakdown.balance + breakdown.gi;
  
  // Update display
  updateScoreDisplay(totalScore, breakdown.veggies, breakdown.balance, breakdown.gi);
  
  // Check for achievements
  checkAchievements({
    totalScore,
    veggieScore: breakdown.veggies,
    balanceScore: breakdown.balance,
    giScore: breakdown.gi,
    mealsCreated: getMealsCreatedCount() + 1
  });
  
  return { totalScore, breakdown };
}

function updateScoreDisplay(totalScore, veggieScore, balanceScore, giScore) {
  // Update main score circle
  const scoreCircle = document.getElementById('scoreCircle');
  const circumference = 2 * Math.PI * 60; // radius = 60
  const offset = circumference - (totalScore / 100) * circumference;
  
  if (scoreCircle) {
    scoreCircle.style.strokeDashoffset = offset;
  }
  
  // Update score value with animation
  animateValue('mealScore', 0, totalScore, 1000);
  
  // Update rating text
  const ratingElement = document.getElementById('scoreRating');
  if (ratingElement) {
    let rating = '';
    let ratingClass = '';
    
    if (totalScore >= 90) {
      rating = 'Excellent! 🌟';
      ratingClass = 'excellent';
    } else if (totalScore >= 75) {
      rating = 'Great Choice! 👍';
      ratingClass = 'great';
    } else if (totalScore >= 60) {
      rating = 'Good Start! 💪';
      ratingClass = 'good';
    } else if (totalScore > 0) {
      rating = 'Keep Improving! 📈';
      ratingClass = 'needs-improvement';
    } else {
      rating = 'Build Your Meal';
      ratingClass = '';
    }
    
    ratingElement.textContent = rating;
    ratingElement.className = 'score-rating ' + ratingClass;
  }
  
  // Update breakdown scores
// Update breakdown scores
  const veggiePointsEl = document.getElementById('veggiePoints');
  const balancePointsEl = document.getElementById('balancePoints');
  const giPointsEl = document.getElementById('giPoints');
  
  if (veggiePointsEl) veggiePointsEl.textContent = '+' + veggieScore;
  if (balancePointsEl) balancePointsEl.textContent = '+' + balanceScore;
  if (giPointsEl) giPointsEl.textContent = '+' + giScore;
  
  // Update breakdown bars
  const veggieBarEl = document.getElementById('veggieBar');
  const balanceBarEl = document.getElementById('balanceBar');
  const giBarEl = document.getElementById('giBar');
  
  if (veggieBarEl) veggieBarEl.style.width = (veggieScore / 40 * 100) + '%';
  if (balanceBarEl) balanceBarEl.style.width = (balanceScore / 30 * 100) + '%';
  if (giBarEl) giBarEl.style.width = (giScore / 30 * 100) + '%';


  
  // Confetti for perfect score
  if (totalScore >= 95) {
    triggerConfetti();
  }
}

function animateValue(elementId, start, end, duration) {
  const element = document.getElementById(elementId);
  if (!element) return;
  
  const range = end - start;
  const increment = range / (duration / 16); // 60fps
  let current = start;
  
  const timer = setInterval(() => {
    current += increment;
    if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
      current = end;
      clearInterval(timer);
    }
    element.textContent = Math.round(current);
  }, 16);
}

function checkAchievements(stats) {
  const newAchievements = [];
  
  Object.values(achievements).forEach(achievement => {
    // Check if already unlocked
    if (userAchievements.includes(achievement.id)) return;
    
    // Check if condition is met
    if (achievement.condition(stats)) {
      userAchievements.push(achievement.id);
      newAchievements.push(achievement);
    }
  });
  
  // Display achievements
  if (newAchievements.length > 0) {
    displayAchievements();
    
    // Show notification for new achievements
    newAchievements.forEach((achievement, index) => {
      setTimeout(() => {
        showAchievementNotification(achievement);
      }, index * 500);
    });
  }
}

function displayAchievements() {
  const container = document.getElementById('achievements');
  if (!container) return;
  
  if (userAchievements.length === 0) {
    container.innerHTML = `
      <div class="achievement-placeholder">
        <span class="placeholder-icon">🎯</span>
        <p>Complete your first meal to earn achievements!</p>
      </div>
    `;
    return;
  }
  
  const achievementHTML = userAchievements.map(id => {
    const achievement = achievements[id];
    return `
      <div class="achievement-badge unlocked" title="${achievement.description}">
        <span class="achievement-icon">${achievement.icon}</span>
        <h5 class="achievement-title">${achievement.title}</h5>
        <p class="achievement-description">${achievement.description}</p>
      </div>
    `;
  }).join('');
  
  container.innerHTML = achievementHTML;
}

function showAchievementNotification(achievement) {
  const notification = document.createElement('div');
  notification.className = 'achievement-notification';
  notification.innerHTML = `
    <div class="achievement-notification-content">
      <span class="notification-icon">${achievement.icon}</span>
      <div class="notification-text">
        <strong>Achievement Unlocked!</strong>
        <p>${achievement.title}</p>
      </div>
    </div>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => notification.classList.add('show'), 100);
  
  setTimeout(() => {
    notification.classList.remove('show');
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

function triggerConfetti() {
  const colors = ['#ffc107', '#4caf50', '#2196f3', '#ff9800', '#e91e63'];
  
  for (let i = 0; i < 50; i++) {
    setTimeout(() => {
      const confetti = document.createElement('div');
      confetti.className = 'confetti';
      confetti.style.left = Math.random() * 100 + '%';
      confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
      confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
      document.body.appendChild(confetti);
      
      setTimeout(() => confetti.remove(), 3000);
    }, i * 30);
  }
}

function getMealsCreatedCount() {
  // This would typically come from localStorage
  return parseInt(localStorage.getItem('mealsCreated') || '0');
}

function incrementMealsCreated() {
  const count = getMealsCreatedCount() + 1;
  localStorage.setItem('mealsCreated', count);
  return count;
}

// Update the existing saveMeal function to calculate score
const originalSaveMeal = window.saveMeal;
window.saveMeal = function() {
  if (currentMeal.length === 0) {
    alert('Please add some foods to your plate first!');
    return;
  }
  
  const { totalScore } = calculateMealScore();
  incrementMealsCreated();
  
  const mealSummary = currentMeal.map(food => food.name).join(', ');
  alert(`✓ Meal saved with score: ${totalScore}/100!\n\nYour meal: ${mealSummary}\n\n${totalScore >= 80 ? 'Excellent GDM-friendly meal! 🎉' : 'Keep improving your choices! 💪'}`);
};

// Update score whenever meal changes
const originalUpdateGlucosePrediction = window.updateGlucosePrediction;
window.updateGlucosePrediction = function() {
  originalUpdateGlucosePrediction();
  calculateMealScore();
};

// ===================================
// FOOD COMPARISON TOOL
// ===================================

const foodDatabase = {

  'white-rice': {
    name: 'White Rice',
    emoji: '🍚',
    type: 'carbs',
    gi: 73,
    fiber: 0.4,
    protein: 2.7,
    calories: 130,
    carbsPerServing: 28,
    benefits: ['Quick energy'],
    drawbacks: ['High GI', 'Low fiber']
  },

  'brown-rice': {
    name: 'Brown Rice',
    emoji: '🍚',
    type: 'carbs',
    gi: 50,
    fiber: 1.8,
    protein: 2.6,
    calories: 112,
    carbsPerServing: 24,
    benefits: [
      'Lower GI', 
      'Higher fiber', 
      'More nutrients',
      'Slower digestion than white rice',
      'Helps maintain steady glucose levels'
    ],
    drawbacks: ['Takes longer to cook'],
    giLabel: '50 (Low)',
    fiberLabel: 'High - Contains bran layer',
    serving: '1/2 cup cooked = 1 serving',
    recipes: [
      { name: 'Brown Rice Pulao', link: '#recipe5' },
      { name: 'Brown Rice Curd Rice', link: '#recipe6' }
    ]
  },

  'white-bread': {
    name: 'White Bread',
    emoji: '🍞',
    type: 'carbs',
    gi: 75,
    fiber: 0.7,
    protein: 2.7,
    calories: 79,
    carbsPerServing: 15,
    benefits: ['Convenient'],
    drawbacks: ['Very high GI', 'Low nutrients']
  },

  'roti': {
    name: 'Whole Wheat Roti',
    emoji: '🫓',
    type: 'carbs',
    gi: 62,
    fiber: 2.1,
    protein: 3.1,
    calories: 71,
    carbsPerServing: 15,
    benefits: [
      'Moderate GI',
      'Good fiber',
      'Traditional',
      'Better than white bread',
      'Pair with vegetables for balanced meal'
    ],
    drawbacks: ['Slightly higher GI than desired'],
    giLabel: '62 (Medium)',
    fiberLabel: 'Moderate',
    serving: '1-2 rotis = 1 serving',
    recipes: [
      { name: 'Multigrain Roti', link: '#recipe15' },
      { name: 'Jowar Roti', link: '#recipe16' }
    ]
  },

  'quinoa': {
    name: 'Quinoa',
    emoji: '🌾',
    type: 'carbs',
    gi: 53,
    fiber: 2.8,
    protein: 4.4,
    calories: 120,
    carbsPerServing: 21,
    benefits: ['Complete protein', 'Low GI', 'High fiber'],
    drawbacks: ['More expensive', 'Not traditional Indian']
  },

  'oats': {
    name: 'Oats',
    emoji: '🥣',
    type: 'carbs',
    gi: 55,
    fiber: 4.0,
    protein: 5.3,
    calories: 71,
    carbsPerServing: 12,
    benefits: ['Very high fiber', 'Low GI', 'Heart healthy'],
    drawbacks: ['Different texture']
  },

  'dal': {
    name: 'Dal/Legumes',
    emoji: '🫘',
    type: 'protein',
    gi: 28,
    fiber: 7.9,
    protein: 9.0,
    calories: 116,
    carbsPerServing: 20,
    benefits: [
      'Very low GI',
      'High protein',
      'High fiber',
      'Rich in folate and iron',
      'Low glycemic index helps stabilize blood sugar',
      'High in protein (essential for baby\'s growth)'
    ],
    drawbacks: ['None significant'],
    giLabel: '28 (Low)',
    fiberLabel: 'Very High - Excellent for blood sugar control',
    serving: '1 cup cooked = 1 serving',
    recipes: [
      { name: 'Moong Dal Tadka', link: '#recipe3' },
      { name: 'Dal Khichdi', link: '#recipe4' }
    ]
  },

  'chickpeas': {
    name: 'Chickpeas',
    emoji: '🫘',
    type: 'protein',
    gi: 33,
    fiber: 7.6,
    protein: 8.9,
    calories: 164,
    carbsPerServing: 27,
    benefits: ['Low GI', 'High protein', 'Versatile'],
    drawbacks: ['Slightly higher calories']
  },

  'eggs': {
    name: 'Eggs',
    emoji: '🥚',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 6.3,
    calories: 78,
    carbsPerServing: 0.6,
    benefits: [
      'No GI impact',
      'Complete protein',
      'Nutrient-dense',
      'Rich in choline (brain development)',
      'Zero carbs - excellent for GDM'
    ],
    drawbacks: ['Cholesterol (not a concern for most)'],
    giLabel: '0 (Zero)',
    fiberLabel: 'No impact on blood sugar',
    serving: '1-2 eggs = 1 serving',
    recipes: [
      { name: 'Egg Bhurji', link: '#recipe7' },
      { name: 'Boiled Egg Salad', link: '#recipe8' }
    ]
  },

  'fish': {
    name: 'Fish',
    emoji: '🐟',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 22.0,
    calories: 206,
    carbsPerServing: 0,
    benefits: [
      'No GI impact',
      'Omega-3',
      'High protein',
      'Rich in Omega-3 (baby\'s brain development)',
      'Zero impact on blood sugar'
    ],
    drawbacks: ['Can be expensive'],
    giLabel: '0 (Zero)',
    fiberLabel: 'No carbs',
    serving: '100-150g = 1 serving',
    recipes: [
      { name: 'Grilled Fish', link: '#recipe13' },
      { name: 'Fish Curry', link: '#recipe14' }
    ]
  },

  'chicken': {
    name: 'Chicken',
    emoji: '🍗',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 27.0,
    calories: 165,
    carbsPerServing: 0,
    benefits: ['No GI impact', 'Lean protein'],
    drawbacks: ['None significant']
  },

  'paneer': {
    name: 'Paneer',
    emoji: '🧀',
    type: 'protein',
    gi: 27,
    fiber: 0,
    protein: 18.0,
    calories: 265,
    carbsPerServing: 3,
    benefits: ['No GI impact', 'High protein', 'Calcium-rich'],
    drawbacks: ['High fat', 'High calories']
  },

  'leafy-greens': {
    name: 'Leafy Greens',
    emoji: '🥬',
    type: 'vegetable',
    gi: 15,
    fiber: 2.2,
    protein: 2.9,
    calories: 23,
    carbsPerServing: 3.6,
    benefits: [
      'Extremely low GI',
      'High nutrients',
      'Very low calories',
      'Rich in folate (essential for baby\'s development)',
      'High in iron (prevents anemia)',
      'Minimal effect on blood sugar'
    ],
    drawbacks: ['None'],
    giLabel: '15 (Very Low)',
    fiberLabel: 'High - Slows glucose absorption',
    serving: '1 cup cooked = 1 serving',
    recipes: [
      { name: 'Palak Paneer (Low GI)', link: '#recipe1' },
      { name: 'Saag Dal', link: '#recipe2' }
    ]
  },

  'cauliflower': {
    name: 'Cauliflower',
    emoji: '🥦',
    type: 'vegetable',
    gi: 15,
    fiber: 2.0,
    protein: 1.9,
    calories: 25,
    carbsPerServing: 5,
    benefits: ['Very low GI', 'Versatile', 'Low calories'],
    drawbacks: ['Can cause gas']
  },

  'carrots': {
    name: 'Carrots',
    emoji: '🥕',
    type: 'vegetable',
    gi: 39,
    fiber: 2.8,
    protein: 0.9,
    calories: 41,
    carbsPerServing: 10,
    benefits: ['Low GI', 'High beta-carotene'],
    drawbacks: ['Slightly higher GI when cooked']
  },

  'potato': {
    name: 'Potato',
    emoji: '🥔',
    type: 'vegetable',
    gi: 78,
    fiber: 2.2,
    protein: 2.0,
    calories: 77,
    carbsPerServing: 17,
    benefits: ['Filling', 'Versatile'],
    drawbacks: ['High GI', 'Starchy']
  },

  'sweet-potato': {
    name: 'Sweet Potato',
    emoji: '🍠',
    type: 'vegetable',
    gi: 63,
    fiber: 3.0,
    protein: 1.6,
    calories: 86,
    carbsPerServing: 20,
    benefits: ['Lower GI than potato', 'High in vitamins'],
    drawbacks: ['Still moderate-high GI']
  },
  // Fruits
  'apple': {
    name: 'Apple',
    emoji: '🍎',
    type: 'fruit',
    gi: 39,           // low GI [web:35][web:41][web:38]
    fiber: 2.4,
    protein: 0.3,
    calories: 52,
    carbsPerServing: 14,
    benefits: ['Low GI', 'Good fiber', 'Portable snack'],
    drawbacks: ['Natural sugars']
  },
  'banana-ripe': {
    name: 'Banana (ripe)',
    emoji: '🍌',
    type: 'fruit',
    gi: 51,           // moderate GI [web:35][web:38]
    fiber: 2.6,
    protein: 1.3,
    calories: 96,
    carbsPerServing: 23,
    benefits: ['Potassium-rich', 'Quick energy'],
    drawbacks: ['Moderate GI', 'Best in small portions']
  },
  'mango': {
    name: 'Mango',
    emoji: '🥭',
    type: 'fruit',
    gi: 51,           // moderate GI [web:33][web:38]
    fiber: 1.6,
    protein: 0.8,
    calories: 60,
    carbsPerServing: 15,
    benefits: ['Rich in vitamins A and C'],
    drawbacks: ['Moderate GI, limit portion']
  },
  'papaya': {
    name: 'Papaya',
    emoji: '🍊',
    type: 'fruit',
    gi: 58,           // moderate GI [web:35]
    fiber: 1.7,
    protein: 0.5,
    calories: 43,
    carbsPerServing: 11,
    benefits: ['Digestive enzymes', 'Vitamins A and C'],
    drawbacks: ['Moderate GI, watch portion']
  },
  'watermelon': {
    name: 'Watermelon',
    emoji: '🍉',
    type: 'fruit',
    gi: 76,           // high GI [web:35][web:38]
    fiber: 0.4,
    protein: 0.6,
    calories: 30,
    carbsPerServing: 8,
    benefits: ['Very hydrating'],
    drawbacks: ['High GI, pair with protein or fat']
  },
  'grapes': {
    name: 'Grapes',
    emoji: '🍇',
    type: 'fruit',
    gi: 59,           // moderate-high GI [web:38][web:41]
    fiber: 0.9,
    protein: 0.6,
    calories: 69,
    carbsPerServing: 16,
    benefits: ['Antioxidants'],
    drawbacks: ['Moderate-high GI, easy to overeat']
  },
  'orange': {
    name: 'Orange',
    emoji: '🍊',
    type: 'fruit',
    gi: 35,           // low GI (range 35–43) [web:41][web:38]
    fiber: 2.4,
    protein: 0.9,
    calories: 47,
    carbsPerServing: 12,
    benefits: ['Vitamin C', 'Low GI'],
    drawbacks: ['Acidic for some people']
  },
  'guava': {
    name: 'Guava',
    emoji: '🍐',
    type: 'fruit',
    gi: 12,           // very low GI (approx) [web:38][web:35]
    fiber: 5.4,
    protein: 2.6,
    calories: 68,
    carbsPerServing: 9,
    benefits: ['Very low GI', 'High fiber', 'Vitamin C rich'],
    drawbacks: ['Seeds can be hard for some']
  },
  'pomegranate': {
    name: 'Pomegranate',
    emoji: '🌸',
    type: 'fruit',
    gi: 53,           // moderate GI [web:35][web:38][web:41]
    fiber: 4.0,
    protein: 1.7,
    calories: 83,
    carbsPerServing: 14,
    benefits: ['Antioxidant-rich'],
    drawbacks: ['Moderate GI, watch portion']
  },
  'berries-mixed': {
    name: 'Berries (mixed)',
    emoji: '🫐',
    type: 'fruit',
    gi: 40,           // generally low GI < 40–41 [web:35][web:38][web:41]
    fiber: 5.3,
    protein: 1.0,
    calories: 57,
    carbsPerServing: 10,
    benefits: ['Very high antioxidants', 'Low GI'],
    drawbacks: ['Can be expensive']
  },

  // Extra vegetables (detailed keys reuse your earlier ones)
  'potato-boiled': {
    name: 'Potato (boiled)',
    emoji: '🥔',
    type: 'vegetable',
    gi: 78,           // high GI [web:38]
    fiber: 2.2,
    protein: 2.0,
    calories: 77,
    carbsPerServing: 17,
    benefits: ['Filling', 'Comfort food'],
    drawbacks: ['High GI, starchy']
  },
  'sweet-potato-veg': {
    name: 'Sweet Potato',
    emoji: '🍠',
    type: 'vegetable',
    gi: 54,           // moderate GI range 54–63 [web:36][web:38]
    fiber: 3.0,
    protein: 1.6,
    calories: 86,
    carbsPerServing: 20,
    benefits: ['More fiber than potato'],
    drawbacks: ['Moderate GI']
  },
  'carrots-raw': {
    name: 'Carrots (raw)',
    emoji: '🥕',
    type: 'vegetable',
    gi: 39,           // low-moderate GI [web:36][web:38]
    fiber: 2.8,
    protein: 0.9,
    calories: 41,
    carbsPerServing: 7,
    benefits: ['Low GI, good crunch'],
    drawbacks: ['GI rises slightly when cooked']
  },
  'broccoli': {
    name: 'Broccoli',
    emoji: '🥦',
    type: 'vegetable',
    gi: 10,           // very low GI [web:36][web:38]
    fiber: 2.6,
    protein: 2.8,
    calories: 34,
    carbsPerServing: 4,
    benefits: ['Very low GI', 'High micronutrients'],
    drawbacks: ['Can cause gas in some']
  },
  'spinach': {
    name: 'Spinach (palak)',
    emoji: '🥬',
    type: 'vegetable',
    gi: 15,           // low GI leafy green [web:36][web:45]
    fiber: 2.2,
    protein: 2.9,
    calories: 23,
    carbsPerServing: 1,
    benefits: ['Iron and folate rich'],
    drawbacks: ['Oxalates for some kidney conditions']
  },
  'cauliflower-extra': {
    name: 'Cauliflower',
    emoji: '🥬',
    type: 'vegetable',
    gi: 15,           // low GI [web:36][web:38]
    fiber: 2.0,
    protein: 1.9,
    calories: 25,
    carbsPerServing: 3,
    benefits: ['Low GI, versatile'],
    drawbacks: ['Gas for some']
  },
  'tomato': {
    name: 'Tomato',
    emoji: '🍅',
    type: 'vegetable',
    gi: 15,           // very low GI < 15 [web:36][web:38]
    fiber: 1.2,
    protein: 0.9,
    calories: 18,
    carbsPerServing: 3,
    benefits: ['Very low GI', 'Vitamin C'],
    drawbacks: ['Acidic']
  },
  'cucumber': {
    name: 'Cucumber',
    emoji: '🥒',
    type: 'vegetable',
    gi: 15,           // very low GI [web:36][web:38]
    fiber: 0.5,
    protein: 0.7,
    calories: 16,
    carbsPerServing: 2,
    benefits: ['Hydrating, very low calories'],
    drawbacks: ['Low satiety for some']
  },
  'bhindi-okra': {
    name: 'Bhindi (Okra)',
    emoji: '🌱',
    type: 'vegetable',
    gi: 20,           // low GI [web:36][web:38]
    fiber: 3.2,
    protein: 1.9,
    calories: 33,
    carbsPerServing: 4,
    benefits: ['Good fiber, traditional Indian'],
    drawbacks: ['Slimy texture for some']
  },
  'beans-green': {
    name: 'Beans (green)',
    emoji: '🫘',
    type: 'vegetable',
    gi: 15,           // low GI green beans [web:36][web:38][web:42]
    fiber: 2.7,
    protein: 1.8,
    calories: 31,
    carbsPerServing: 4,
    benefits: ['Low GI, fiber-rich'],
    drawbacks: ['None significant']
  },

  // Extra protein (variants)
  'chicken-grilled': {
    name: 'Chicken (grilled)',
    emoji: '🍗',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 27,
    calories: 165,
    carbsPerServing: 0,
    benefits: ['No GI impact', 'Lean protein'],
    drawbacks: ['None significant']
  },
  'fish-generic': {
    name: 'Fish',
    emoji: '🐟',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 22,
    calories: 206,
    carbsPerServing: 0,
    benefits: ['No GI impact', 'Omega-3'],
    drawbacks: ['Can be expensive']
  },
  'eggs-extra': {
    name: 'Eggs',
    emoji: '🥚',
    type: 'protein',
    gi: 0,
    fiber: 0,
    protein: 6.3,
    calories: 78,
    carbsPerServing: 1,
    benefits: ['No GI impact', 'Complete protein'],
    drawbacks: ['Cholesterol concern in some cases']
  },
  'tofu': {
    name: 'Tofu',
    emoji: '⬜',
    type: 'protein',
    gi: 15,           // low GI soy product [web:40][web:37]
    fiber: 0.3,
    protein: 8,
    calories: 76,
    carbsPerServing: 2,
    benefits: ['Plant protein', 'Low GI'],
    drawbacks: ['Processed soy, texture not liked by all']
  },

  // Dairy
  'milk-full-fat': {
    name: 'Milk (full fat)',
    emoji: '🥛',
    type: 'dairy',
    gi: 39,           // milk GI ~39 [web:38][web:40]
    fiber: 0,
    protein: 3.4,
    calories: 61,
    carbsPerServing: 5,
    benefits: ['Calcium and protein'],
    drawbacks: ['Lactose for sensitive individuals']
  },
  'yogurt-plain': {
    name: 'Yogurt (plain)',
    emoji: '🥄',
    type: 'dairy',
    gi: 36,           // low GI plain yogurt [web:40][web:37]
    fiber: 0,
    protein: 3.5,
    calories: 59,
    carbsPerServing: 5,
    benefits: ['Probiotics', 'Low GI'],
    drawbacks: ['Avoid sweetened varieties']
  },
  'curd': {
    name: 'Curd',
    emoji: '🥄',
    type: 'dairy',
    gi: 28,           // low GI curd [web:38][web:40]
    fiber: 0,
    protein: 3.5,
    calories: 60,
    carbsPerServing: 5,
    benefits: ['Gut-friendly probiotics'],
    drawbacks: ['Check added sugar in flavored versions']
  },
  'buttermilk': {
    name: 'Buttermilk',
    emoji: '🥛',
    type: 'dairy',
    gi: 20,           // low GI buttermilk approx [web:38]
    fiber: 0,
    protein: 3.3,
    calories: 40,
    carbsPerServing: 5,
    benefits: ['Hydrating, light'],
    drawbacks: ['Watch added salt']
  }
};


let comparisonFood1 = null;
let comparisonFood2 = null;

function openComparison() {
  const overlay = document.getElementById('comparisonOverlay');
  const modal = document.getElementById('comparisonModal');
  
  if (overlay) overlay.classList.add('active');
  if (modal) modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeComparison() {
  const overlay = document.getElementById('comparisonOverlay');
  const modal = document.getElementById('comparisonModal');
  
  if (overlay) overlay.classList.remove('active');
  if (modal) modal.classList.remove('active');
  document.body.style.overflow = 'auto';
}

function updateComparison() {
  const compareFood1El = document.getElementById('compareFood1');
  const compareFood2El = document.getElementById('compareFood2');
  
  if (!compareFood1El || !compareFood2El) return;
  
  const food1Id = compareFood1El.value;
  const food2Id = compareFood2El.value;
  
  const comparisonResultsEl = document.getElementById('comparisonResults');
  const comparisonTableEl = document.getElementById('comparisonTableContainer');
  const comparisonVerdictEl = document.getElementById('comparisonVerdict');
  
  if (!food1Id || !food2Id) {
    if (comparisonResultsEl) comparisonResultsEl.style.display = 'flex';
    if (comparisonTableEl) comparisonTableEl.style.display = 'none';
    if (comparisonVerdictEl) comparisonVerdictEl.style.display = 'none';
    return;
  }
  
  comparisonFood1 = foodDatabase[food1Id];
  comparisonFood2 = foodDatabase[food2Id];
  
  if (comparisonResultsEl) comparisonResultsEl.style.display = 'none';
  if (comparisonTableEl) comparisonTableEl.style.display = 'block';
  if (comparisonVerdictEl) comparisonVerdictEl.style.display = 'block';
  
  // Update table headers
  document.getElementById('food1Header').innerHTML = `${comparisonFood1.emoji} ${comparisonFood1.name}`;
  document.getElementById('food2Header').innerHTML = `${comparisonFood2.emoji} ${comparisonFood2.name}`;
  
  // Build comparison rows
  const metrics = [
    { key: 'gi', label: 'Glycemic Index', unit: '', lower: true },
    { key: 'fiber', label: 'Fiber', unit: 'g', lower: false },
    { key: 'protein', label: 'Protein', unit: 'g', lower: false },
    { key: 'calories', label: 'Calories', unit: 'kcal', lower: true },
    { key: 'carbsPerServing', label: 'Carbs', unit: 'g', lower: true }
  ];
  
  let food1Score = 0;
  let food2Score = 0;
  
  const rows = metrics.map(metric => {
    const val1 = comparisonFood1[metric.key];
    const val2 = comparisonFood2[metric.key];
    
    let winner = '';
    let val1Class = '';
    let val2Class = '';
    
    if (metric.lower) {
      // Lower is better
      if (val1 < val2) {
        winner = comparisonFood1.name;
        val1Class = 'better';
        val2Class = 'worse';
        food1Score++;
      } else if (val2 < val1) {
        winner = comparisonFood2.name;
        val2Class = 'better';
        val1Class = 'worse';
        food2Score++;
      } else {
        winner = 'Tie';
      }
    } else {
      // Higher is better
      if (val1 > val2) {
        winner = comparisonFood1.name;
        val1Class = 'better';
        val2Class = 'worse';
        food1Score++;
      } else if (val2 > val1) {
        winner = comparisonFood2.name;
        val2Class = 'better';
        val1Class = 'worse';
        food2Score++;
      } else {
        winner = 'Tie';
      }
    }
    
    return `
      <tr>
        <td>${metric.label}</td>
        <td><span class="metric-value ${val1Class}">${val1}${metric.unit}</span></td>
        <td><span class="metric-value ${val2Class}">${val2}${metric.unit}</span></td>
        <td>${winner !== 'Tie' ? `<span class="winner-badge">✓ ${winner}</span>` : 'Tie'}</td>
      </tr>
    `;
  }).join('');
  
  document.getElementById('comparisonBody').innerHTML = rows;
  
  // Update verdict
  let winnerFood, winnerScore;
  if (food1Score > food2Score) {
    winnerFood = comparisonFood1;
    winnerScore = food1Score;
  } else if (food2Score > food1Score) {
    winnerFood = comparisonFood2;
    winnerScore = food2Score;
  } else {
    winnerFood = null;
  }
  
  if (winnerFood) {
    const verdictIconEl = document.getElementById('verdictIcon');
    const verdictTitleEl = document.getElementById('verdictTitle');
    const verdictReasonEl = document.getElementById('verdictReason');
    
    if (verdictIconEl) verdictIconEl.textContent = '🏆';
    if (verdictTitleEl) verdictTitleEl.textContent = `Winner: ${winnerFood.emoji} ${winnerFood.name}`;

    document.getElementById('verdictReason').innerHTML = `
      <strong>${winnerFood.name}</strong> is the better choice for GDM management with ${winnerScore} out of 5 key metrics in its favor.<br><br>
      <strong>Key Benefits:</strong> ${winnerFood.benefits.join(', ')}
    `;
    
    // Store winner for "Add to Plate" button
    window.comparisonWinner = winnerFood;
  } else {
    document.getElementById('verdictIcon').textContent = '🤝';
    document.getElementById('verdictTitle').textContent = 'It\'s a Tie!';
    document.getElementById('verdictReason').textContent = 'Both foods have equal nutritional benefits. Choose based on your preference and meal variety.';
  }
}

function addWinnerToPlate() {
  if (window.comparisonWinner) {
    const food = window.comparisonWinner;
    // Find the food ID from database
    const foodId = Object.keys(foodDatabase).find(key => foodDatabase[key].name === food.name);
    
    if (foodId) {
      addFood(foodId, food.type, food.gi < 55 ? 'low' : food.gi < 70 ? 'medium' : 'high', food.name, food.emoji, 'medium');
      showToast(`Added ${food.name} to your plate!`, 'success');
      closeComparison();
    }
  }
}

// Close modal with Escape key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape' && document.getElementById('comparisonModal').classList.contains('active')) {
    closeComparison();
  }
});


// ===================================
// GUIDED MEAL WIZARD FUNCTIONALITY
// ===================================

let wizardCurrentStep = 1;
let wizardOpen = false;

const wizardSteps = {
  1: {
    title: 'Step 1: Fill Half Your Plate with Vegetables',
    description: 'Vegetables should make up 50% of your plate. They\'re rich in fiber, which slows glucose absorption and keeps you full longer.',
    icon: '🥦',
    goal: 'Add 2-3 vegetable items',
    goalTarget: 2,
    type: 'vegetable',
    suggestions: [
      { id: 'leafy-greens', type: 'vegetable', gi: 'low', name: 'Leafy Greens', emoji: '🥬' },
      { id: 'vegetables', type: 'vegetable', gi: 'low', name: 'Mixed Veggies', emoji: '🥦' }
    ],
    tip: 'Eating vegetables first can reduce glucose spikes by up to 30%!'
  },
  2: {
    title: 'Step 2: Add Quality Protein',
    description: 'Protein should fill 25% of your plate. It helps maintain steady blood sugar and keeps you satisfied between meals.',
    icon: '🍗',
    goal: 'Add 1-2 protein sources',
    goalTarget: 1,
    type: 'protein',
    suggestions: [
      { id: 'dal', type: 'protein', gi: 'low', name: 'Dal/Legumes', emoji: '🫘' },
      { id: 'eggs', type: 'protein', gi: 'low', name: 'Eggs', emoji: '🥚' },
      { id: 'fish', type: 'protein', gi: 'low', name: 'Fish', emoji: '🐟' }
    ],
    tip: 'Combining dal with rice creates a complete protein - perfect for vegetarians!'
  },
  3: {
    title: 'Step 3: Choose Smart Carbs',
    description: 'Carbs should be 25% of your plate. Choose low-GI options like brown rice, whole wheat roti, or millets.',
    icon: '🍚',
    goal: 'Add 1 low-GI carb source',
    goalTarget: 1,
    type: 'carbs',
    suggestions: [
      { id: 'brown-rice', type: 'carbs', gi: 'low', name: 'Brown Rice', emoji: '🍚' },
      { id: 'roti', type: 'carbs', gi: 'medium', name: 'Whole Wheat Roti', emoji: '🫓' }
    ],
    tip: 'Brown rice has a GI of 50 vs white rice at 73 - that\'s a 23-point difference!'
  },
  4: {
    title: 'Step 4: Review Your Perfect Plate',
    description: 'Great job! Review your meal and check the glucose impact prediction. Make any final adjustments.',
    icon: '✅',
    goal: 'Meal complete!',
    goalTarget: 0,
    type: 'review',
    suggestions: [],
    tip: 'A balanced plate like this can help keep your blood sugar in the healthy range!'
  }
};

function toggleWizard() {
  wizardOpen = !wizardOpen;
  const wizardContent = document.getElementById('wizardContent');
  const toggleBtn = document.querySelector('.wizard-toggle-btn');
  
  if (wizardOpen) {
    wizardContent.style.display = 'block';
    toggleBtn.classList.add('active');
    wizardCurrentStep = 1;
    updateWizardStep();
  } else {
    wizardContent.style.display = 'none';
    toggleBtn.classList.remove('active');
  }
}

function updateWizardStep() {
  const step = wizardSteps[wizardCurrentStep];
  
  // Update progress indicators
  document.querySelectorAll('.wizard-step').forEach((el, index) => {
    const stepNum = index + 1;
    el.classList.remove('active', 'completed');
    
    if (stepNum < wizardCurrentStep) {
      el.classList.add('completed');
    } else if (stepNum === wizardCurrentStep) {
      el.classList.add('active');
    }
  });
  
  // Update content
  document.querySelector('.instruction-icon').textContent = step.icon;
  document.getElementById('wizardTitle').textContent = step.title;
  document.getElementById('wizardDescription').textContent = step.description;
  document.getElementById('wizardGoal').querySelector('.goal-value').textContent = step.goal;
  
  // Update suggestions
  const recsContainer = document.getElementById('wizardRecs');
  if (step.suggestions.length > 0) {
    const suggestionsHTML = step.suggestions.map(food => `
      <div class="wizard-suggestion" onclick="addFood('${food.id}', '${food.type}', '${food.gi}', '${food.name}', '${food.emoji}', 'medium')">
        <span class="suggestion-emoji">${food.emoji}</span>
        <span class="suggestion-name">${food.name}</span>
        <span class="suggestion-badge">Best Choice</span>
      </div>
    `).join('');
    
    recsContainer.innerHTML = `
      <h4>Recommended for You:</h4>
      <div class="wizard-food-suggestions">
        ${suggestionsHTML}
      </div>
    `;
    recsContainer.style.display = 'block';
  } else {
    recsContainer.style.display = 'none';
  }
  
  // Update tip
  document.getElementById('wizardTip').querySelector('p').innerHTML = 
    `<strong>Pro Tip:</strong> ${step.tip}`;
  
  // Update buttons
  document.querySelector('.wizard-btn.back').style.display = 
    wizardCurrentStep > 1 ? 'block' : 'none';
  document.querySelector('.wizard-btn.next').style.display = 
    wizardCurrentStep < 4 ? 'block' : 'none';
  document.querySelector('.wizard-btn.finish').style.display = 
    wizardCurrentStep === 4 ? 'block' : 'none';
  
  // Update progress bar
  updateWizardProgress();
}

function updateWizardProgress() {
  const step = wizardSteps[wizardCurrentStep];
  if (step.type === 'review') {
    document.getElementById('goalProgress').style.width = '100%';
    return;
  }
  
  const itemCount = currentMeal.filter(f => f.type === step.type).length;
  const progress = Math.min((itemCount / step.goalTarget) * 100, 100);
  document.getElementById('goalProgress').style.width = progress + '%';
  
  // Auto-advance when goal is met
  if (itemCount >= step.goalTarget && wizardCurrentStep < 4) {
    setTimeout(() => {
      showToast(`Great! You've completed Step ${wizardCurrentStep}. Moving to next step...`, 'success');
      setTimeout(nextWizardStep, 1500);
    }, 500);
  }
}

function nextWizardStep() {
  if (wizardCurrentStep < 4) {
    wizardCurrentStep++;
    updateWizardStep();
  }
}

function previousWizardStep() {
  if (wizardCurrentStep > 1) {
    wizardCurrentStep--;
    updateWizardStep();
  }
}

function skipWizard() {
  if (confirm('Are you sure you want to skip the guided builder? You can always come back later!')) {
    toggleWizard();
  }
}

function finishWizard() {
  showToast('🎉 Congratulations! You\'ve built a balanced GDM-friendly meal!', 'success');
  setTimeout(() => {
    toggleWizard();
  }, 2000);
}

// Update wizard progress when foods are added
const originalAddFood = window.addFood;
window.addFood = function(...args) {
  originalAddFood(...args);
  if (wizardOpen) {
    updateWizardProgress();
  }
};



// Separate concerns into modules
const MealPlanner = {
  state: {
    currentMeal: [],
    mealTime: 'breakfast',
    filters: []
  },
  
  ui: {
    updatePlate() {},
    showFeedback() {},
    renderSuggestions() {}
  },
  
  calculator: {
    getGlucoseImpact() {},
    getMealScore() {},
    getBalance() {}
  },
  
  storage: {
    saveMeal() {},
    loadHistory() {},
    exportMeal() {}
  }
};

function celebratePerfectMeal() {
  if (mealScore >= 90) {
    // Trigger confetti animation
    confetti({
      particleCount: 100,
      spread: 70,
      origin: { y: 0.6 }
    });
  }
}


function plateTalk(message) {
  const plate = document.getElementById('virtualPlate');
  const bubble = document.createElement('div');
  bubble.className = 'speech-bubble';
  bubble.textContent = message;
  plate.appendChild(bubble);
  
  setTimeout(() => bubble.remove(), 3000);
}

// Usage
plateTalk("Great start! Now add some protein 💪");




// Topic Content Database
const topicContent = {
  'understanding': {
    icon: '📚',
    title: 'Understanding Gestational Diabetes',
    subtitle: 'What is GDM and why does it happen?',
    content: `
      <h3>What is Gestational Diabetes?</h3>
      <p>Gestational diabetes mellitus (GDM) is high blood sugar that develops during pregnancy and usually disappears after giving birth. It affects <strong>3-25% of pregnancies in India</strong>, which is higher than the global average according to ICMR studies.</p>
      
      <h4>Why It Happens</h4>
      <p>During pregnancy, your placenta produces hormones that help your baby develop. However, these hormones can also <strong>block insulin's action</strong> in your body, creating a condition called insulin resistance.</p>
      
      <p>When this happens:</p>
      <ul>
        <li>Your pancreas cannot produce enough extra insulin to overcome this resistance</li>
        <li>Blood glucose levels rise above normal</li>
        <li>These high levels affect both you and your baby</li>
        <li>Risk increases with each trimester as pregnancy hormones increase</li>
      </ul>
      
      <h4>Key Facts</h4>
      <ul>
        <li>Unlike pre-existing diabetes, GDM develops <strong>specifically during pregnancy</strong></li>
        <li>Typically develops between <strong>24-28 weeks</strong> of pregnancy</li>
        <li>With proper management, most women have <strong>healthy pregnancies and babies</strong></li>
        <li>GDM usually resolves after delivery, but increases future diabetes risk</li>
      </ul>
      
      <h4>What Makes Indian Women More Susceptible?</h4>
      <p>Research shows that South Asian women, including Indian women, have:</p>
      <ul>
        <li>Higher genetic predisposition to diabetes</li>
        <li>Central obesity pattern (more fat around abdomen)</li>
        <li>Early insulin resistance due to metabolic syndrome</li>
        <li>Dietary patterns high in refined carbohydrates</li>
      </ul>
      
      <p><strong>Important:</strong> Having GDM doesn't mean you did anything wrong. It's a result of how your body responds to pregnancy hormones, often combined with genetic factors beyond your control.</p>
    `
  },
  
  'risk-factors': {
    icon: '⚠️',
    title: 'Risk Factors for Indian Women',
    subtitle: 'Understanding your personal risk',
    content: `
      <h3>Are You at Higher Risk?</h3>
      <p>Understanding your risk factors helps you and your healthcare team plan appropriate screening and prevention strategies.</p>
      
      <h4>High-Risk Categories</h4>
      <ul>
        <li><strong>Family history:</strong> First-degree relatives (parents, siblings) with type 2 diabetes</li>
        <li><strong>Previous GDM:</strong> Had gestational diabetes in an earlier pregnancy</li>
        <li><strong>Age:</strong> Above 25 years at conception (lower threshold than Western populations)</li>
        <li><strong>Weight:</strong> Pre-pregnancy BMI above 25 kg/m² (Asian-specific threshold)</li>
        <li><strong>Large baby:</strong> Previous delivery of baby weighing over 4 kg</li>
        <li><strong>PCOS:</strong> Polycystic ovary syndrome diagnosis</li>
        <li><strong>Previous complications:</strong> History of unexplained stillbirth or miscarriage</li>
      </ul>
      
      <h4>Indian Population-Specific Risks</h4>
      <p>Research by ICMR and international studies shows Indian women face unique challenges:</p>
      
      <ul>
        <li><strong>Genetic Susceptibility:</strong> Higher prevalence of diabetes-related genes in South Asian ethnicity</li>
        <li><strong>Body Composition:</strong> Central obesity pattern common even in normal-weight women</li>
        <li><strong>Metabolic Profile:</strong> Earlier development of insulin resistance</li>
        <li><strong>Dietary Patterns:</strong> Traditional diets high in refined carbohydrates (white rice, maida)</li>
        <li><strong>Lifestyle Factors:</strong> Increasing sedentary lifestyle in urban populations</li>
        <li><strong>Early Age Pregnancy:</strong> Many Indian women conceive in their early 20s when metabolic changes begin</li>
      </ul>
      
      <h4>What You Can Do</h4>
      <p>If you have multiple risk factors:</p>
      <ul>
        <li>Request <strong>early screening</strong> at your first prenatal visit</li>
        <li>Start healthy eating habits <strong>before conception</strong> if planning pregnancy</li>
        <li>Maintain <strong>regular physical activity</strong></li>
        <li>Work towards <strong>healthy weight</strong> before pregnancy</li>
        <li>Be proactive in discussing your concerns with your doctor</li>
      </ul>
      
      <p><strong>Remember:</strong> Having risk factors doesn't guarantee you'll develop GDM, but awareness helps you take preventive action and ensures early detection if it does develop.</p>
    `
  },
  
  'screening': {
    icon: '🔬',
    title: 'Screening and Diagnosis',
    subtitle: 'Testing protocols and what to expect',
    content: `
      <h3>GDM Screening in India</h3>
      <p>ICMR recommends <strong>universal screening</strong> for all pregnant women in India due to high prevalence rates.</p>
      
      <h4>When Will You Be Screened?</h4>
      <ul>
        <li><strong>First Antenatal Visit:</strong> If you have high-risk factors</li>
        <li><strong>24-28 Weeks:</strong> Routine screening for all pregnant women</li>
        <li><strong>32+ Weeks:</strong> Re-screening if initial test was normal but symptoms develop</li>
      </ul>
      
      <h4>The Screening Test: 75g OGTT</h4>
      <p>The standard test in India is the <strong>75-gram Oral Glucose Tolerance Test (OGTT)</strong>, recommended by DIPSI and WHO.</p>
      
      <p><strong>How it works:</strong></p>
      <ul>
        <li>Fast overnight (8-12 hours)</li>
        <li>Fasting blood glucose measured</li>
        <li>Drink 75g glucose solution</li>
        <li>Blood glucose measured at 1 hour and 2 hours</li>
      </ul>
      
      <h4>Diagnostic Criteria (WHO 2013)</h4>
      <p>You have GDM if <strong>any one</strong> of these values is met or exceeded:</p>
      <ul>
        <li><strong>Fasting:</strong> ≥ 92 mg/dL</li>
        <li><strong>1-hour:</strong> ≥ 180 mg/dL</li>
        <li><strong>2-hour:</strong> ≥ 153 mg/dL</li>
      </ul>
      
      <p><strong>Important:</strong> Only <strong>one abnormal value</strong> is sufficient for diagnosis in Indian guidelines.</p>
      
      <h4>What to Expect During Testing</h4>
      <ul>
        <li><strong>Before test:</strong> Eat normally for 3 days prior, fast 8-12 hours before test</li>
        <li><strong>During test:</strong> Sit quietly, no eating or drinking except water</li>
        <li><strong>Side effects:</strong> May feel nauseous, light-headed (this is normal)</li>
        <li><strong>Duration:</strong> Entire test takes about 2-3 hours</li>
      </ul>
      
      <h4>If Diagnosed with GDM</h4>
      <p>Don't panic! A GDM diagnosis means:</p>
      <ul>
        <li>You've caught it early enough to manage</li>
        <li>Most women control it with diet and exercise alone</li>
        <li>Your healthcare team will support you</li>
        <li>With proper management, you can have a healthy pregnancy</li>
      </ul>
      
      <h4>Questions to Ask Your Doctor</h4>
      <ul>
        <li>What were my exact test results?</li>
        <li>When should I start monitoring my blood glucose?</li>
        <li>Do I need to see a diabetes specialist or nutritionist?</li>
        <li>How often will I need follow-up appointments?</li>
      </ul>
    `
  },
  
  'symptoms': {
    icon: '🌡️',
    title: 'Recognizing Symptoms',
    subtitle: 'From mild to critical warning signs',
    content: `
      <h3>Understanding GDM Symptoms</h3>
      <p>Many women with gestational diabetes have <strong>no obvious symptoms</strong>, which is why screening is so important. However, some women do experience symptoms that range from mild to severe.</p>
      
      <h4>Mild Symptoms (Often Unnoticed)</h4>
      <p>These symptoms are easy to miss or attribute to normal pregnancy:</p>
      <ul>
        <li><strong>Increased thirst</strong> (polydipsia) - more than usual pregnancy thirst</li>
        <li><strong>Frequent urination</strong> - especially at night, beyond normal pregnancy frequency</li>
        <li><strong>Mild fatigue</strong> - more tired than typical pregnancy tiredness</li>
        <li><strong>Slight blurring of vision</strong> - comes and goes</li>
        <li><strong>Dry mouth</strong> - persistent despite hydration</li>
      </ul>
      
      <h4>Moderate Symptoms</h4>
      <p>These symptoms are more noticeable and warrant medical attention:</p>
      <ul>
        <li><strong>Persistent excessive thirst</strong> despite drinking plenty of fluids</li>
        <li><strong>Unexplained weight loss</strong> despite eating normally</li>
        <li><strong>Recurring urinary tract infections</strong></li>
        <li><strong>Vaginal yeast infections</strong> that don't respond well to treatment</li>
        <li><strong>Slow healing</strong> of minor cuts or bruises</li>
      </ul>
      
      <h4>Critical Symptoms - Seek Immediate Care</h4>
      <p><strong>Call your doctor immediately if you experience:</strong></p>
      <ul>
        <li><strong>Severe nausea and vomiting</strong> that prevents you from keeping food down</li>
        <li><strong>Rapid breathing</strong> or shortness of breath</li>
        <li><strong>Sweet or fruity-smelling breath</strong> (sign of ketones)</li>
        <li><strong>Confusion</strong> or difficulty concentrating</li>
        <li><strong>Extreme weakness</strong> or dizziness</li>
      </ul>
      
      <h4>Severe Complications (Emergency)</h4>
      <p><strong>Go to emergency room if you have:</strong></p>
      <ul>
        <li>Signs of <strong>diabetic ketoacidosis</strong> (DKA) - rare but dangerous</li>
        <li><strong>Severe abdominal pain</strong></li>
        <li><strong>Loss of consciousness</strong></li>
        <li><strong>Sudden severe headache</strong> with vision changes</li>
        <li><strong>Decreased fetal movement</strong> (after 28 weeks)</li>
      </ul>
      
      <h4>Why Some Women Have No Symptoms</h4>
      <p>GDM can be "silent" because:</p>
      <ul>
        <li>Blood sugar elevations may be mild to moderate</li>
        <li>Symptoms overlap with normal pregnancy changes</li>
        <li>Body adapts gradually to higher glucose levels</li>
        <li>Symptoms only appear when glucose is very high</li>
      </ul>
      
      <p><strong>This is why screening is mandatory</strong> - you cannot rely on symptoms alone to detect GDM.</p>
      
      <h4>When to Contact Your Doctor</h4>
      <p>Contact your healthcare provider if you:</p>
      <ul>
        <li>Notice any of the moderate symptoms listed above</li>
        <li>Have blood glucose readings consistently above target</li>
        <li>Experience unusual fatigue or weakness</li>
        <li>Have recurring infections</li>
        <li>Notice decreased fetal movement</li>
      </ul>
    `
  },

  'doctor-visit': {
    icon: '👨‍⚕️',
    title: 'When to See Your Doctor',
    subtitle: 'Timing medical care appropriately',
    content: `
      <h3>Medical Care Timeline</h3>
      <p>Knowing when to seek medical attention is crucial for managing GDM effectively and ensuring the safety of both you and your baby.</p>
      
      <h4>Immediate Medical Attention Required (Go to ER or Call Emergency)</h4>
      <ul>
        <li><strong>Blood glucose consistently above 200 mg/dL</strong> despite treatment</li>
        <li><strong>Signs of diabetic ketoacidosis:</strong> fruity breath, rapid breathing, confusion</li>
        <li><strong>Unable to keep food or fluids down</strong> for 24 hours</li>
        <li><strong>Severe preeclampsia signs:</strong> severe headache, upper abdominal pain, sudden swelling</li>
        <li><strong>Reduced or absent fetal movements</strong> after 28 weeks</li>
        <li><strong>Vaginal bleeding</strong></li>
        <li><strong>Severe dizziness or loss of consciousness</strong></li>
        <li><strong>Chest pain or severe shortness of breath</strong></li>
      </ul>
      
      <h4>Contact Doctor Within 24 Hours</h4>
      <ul>
        <li><strong>Blood glucose readings consistently above target range</strong> (>140 mg/dL 1-hour post-meal)</li>
        <li><strong>Recurring infections</strong> despite treatment</li>
        <li><strong>Rapid weight gain</strong> (more than 2 kg per week)</li>
        <li><strong>Persistent vision problems</strong> or seeing spots</li>
        <li><strong>Signs of urinary tract infection</strong> with fever</li>
        <li><strong>Unusual or persistent headaches</strong></li>
        <li><strong>Burning or pain during urination</strong></li>
      </ul>
      
      <h4>Schedule Routine Appointment (Within Week)</h4>
      <ul>
        <li><strong>Questions about diet or meal planning</strong></li>
        <li><strong>Concerns about exercise safety</strong></li>
        <li><strong>Need for medication adjustment</strong></li>
        <li><strong>Difficulty understanding glucose readings</strong></li>
        <li><strong>Emotional stress or anxiety</strong> about diagnosis</li>
        <li><strong>Minor infections</strong> (yeast, cold symptoms)</li>
      </ul>
      
      <h4>Regular Monitoring Schedule After GDM Diagnosis</h4>
      <p>You'll have more frequent checkups than women without GDM:</p>
      <ul>
        <li><strong>Weeks 24-28:</strong> Diagnosis and initial management plan</li>
        <li><strong>Weeks 28-36:</strong> Every 2 weeks for checkups</li>
        <li><strong>Weeks 36-40:</strong> Weekly checkups</li>
        <li><strong>Additional ultrasounds:</strong> Every 2-4 weeks to monitor baby's growth</li>
        <li><strong>Non-stress tests:</strong> Weekly after 32-34 weeks</li>
      </ul>
      
      <h4>What to Bring to Appointments</h4>
      <ul>
        <li>Your glucose log book or app data</li>
        <li>List of all medications and vitamins</li>
        <li>Questions you want to ask</li>
        <li>Food diary if requested</li>
        <li>Support person if needed</li>
      </ul>
      
      <h4>Red Flags - Never Wait</h4>
      <p><strong>Call your doctor immediately if you notice:</strong></p>
      <ul>
        <li>Baby moving less than usual</li>
        <li>Sudden severe swelling of face or hands</li>
        <li>Severe continuous headache that doesn't respond to medication</li>
        <li>Changes in vision (blurriness, spots, flashes)</li>
        <li>Persistent pain in upper right abdomen</li>
        <li>Contractions before 37 weeks</li>
        <li>Leaking fluid from vagina</li>
      </ul>
    `
  },

  'mother-impact': {
    icon: '🤰',
    title: 'Impact on Mother\'s Health',
    subtitle: 'Short and long-term health considerations',
    content: `
      <h3>Understanding Health Implications</h3>
      <p>GDM affects your health both during pregnancy and in the years following delivery. Understanding these impacts helps you take preventive action.</p>
      
      <h4>Short-Term Complications During Pregnancy</h4>
      <ul>
        <li><strong>Preeclampsia:</strong> 3-4 times higher risk of high blood pressure and protein in urine</li>
        <li><strong>Cesarean delivery:</strong> Higher likelihood due to large baby size</li>
        <li><strong>Polyhydramnios:</strong> Excess amniotic fluid around baby</li>
        <li><strong>Premature rupture of membranes:</strong> Water breaking early</li>
        <li><strong>Increased infection risk:</strong> Urinary tract and yeast infections</li>
        <li><strong>Longer hospital stay:</strong> May need extra monitoring</li>
      </ul>
      
      <h4>Delivery Complications</h4>
      <ul>
        <li><strong>Shoulder dystocia:</strong> Baby's shoulder getting stuck during delivery</li>
        <li><strong>Perineal tears:</strong> Due to larger baby size</li>
        <li><strong>Postpartum hemorrhage:</strong> Heavy bleeding after delivery</li>
        <li><strong>Need for assisted delivery:</strong> Forceps or vacuum</li>
      </ul>
      
      <h4>Long-Term Health Risks</h4>
      <p><strong>Type 2 Diabetes:</strong></p>
      <ul>
        <li><strong>50-70% risk</strong> of developing type 2 diabetes within 10 years (ICMR data)</li>
        <li>Risk increases with each subsequent pregnancy with GDM</li>
        <li>Earlier onset compared to women without GDM history</li>
        <li>Preventable with lifestyle modifications</li>
      </ul>
      
      <p><strong>Cardiovascular Disease:</strong></p>
      <ul>
        <li>2-3 times higher risk of heart disease</li>
        <li>Increased risk of high blood pressure</li>
        <li>Higher cholesterol levels</li>
        <li>Greater risk of stroke</li>
      </ul>
      
      <p><strong>Future Pregnancies:</strong></p>
      <ul>
        <li><strong>30-84% chance</strong> of GDM in next pregnancy</li>
        <li>May develop earlier in subsequent pregnancies</li>
        <li>Increased risk with weight gain between pregnancies</li>
      </ul>
      
      <p><strong>Metabolic Syndrome:</strong></p>
      <ul>
        <li>Cluster of conditions including obesity, high blood pressure, abnormal cholesterol</li>
        <li>Significantly increases diabetes and heart disease risk</li>
      </ul>
      
      <h4>Positive News: Prevention is Powerful</h4>
      <p>You can significantly reduce these risks by:</p>
      <ul>
        <li><strong>Maintaining healthy weight:</strong> Lose pregnancy weight gradually</li>
        <li><strong>Regular exercise:</strong> At least 150 minutes per week</li>
        <li><strong>Healthy diet:</strong> Continue GDM meal planning principles</li>
        <li><strong>Breastfeeding:</strong> Reduces diabetes risk by 40-50%</li>
        <li><strong>Regular screening:</strong> Get tested for diabetes every 1-3 years</li>
        <li><strong>Managing stress:</strong> Chronic stress affects blood sugar</li>
        <li><strong>Adequate sleep:</strong> Poor sleep increases diabetes risk</li>
      </ul>
      
      <h4>Empowerment Through Knowledge</h4>
      <p><strong>Remember:</strong> Having GDM doesn't guarantee future diabetes. Many women who take proactive steps never develop type 2 diabetes. Your actions today shape your health tomorrow.</p>
    `
  },

  'baby-impact': {
    icon: '👶',
    title: 'Impact on Baby\'s Health',
    subtitle: 'Understanding effects on your child',
    content: `
      <h3>How GDM Affects Your Baby</h3>
      <p>Understanding potential impacts on your baby helps you appreciate the importance of good glucose control during pregnancy.</p>
      
      <h4>During Pregnancy</h4>
      <p><strong>Macrosomia (Large Baby):</strong></p>
      <ul>
        <li>Birth weight over 4 kg (8 lbs 13 oz)</li>
        <li>Caused by extra glucose crossing placenta</li>
        <li>Baby's pancreas produces extra insulin</li>
        <li>Insulin acts as growth hormone</li>
        <li>Can complicate delivery</li>
      </ul>
      
      <p><strong>Excess Amniotic Fluid:</strong></p>
      <ul>
        <li>Baby produces more urine with high glucose</li>
        <li>Can cause premature labor</li>
        <li>May lead to umbilical cord problems</li>
      </ul>
      
      <p><strong>Premature Birth Risk:</strong></p>
      <ul>
        <li>May deliver early due to complications</li>
        <li>Increased risk of respiratory distress syndrome</li>
        <li>Lungs may not be fully mature</li>
      </ul>
      
      <h4>At Birth</h4>
      <p><strong>Neonatal Hypoglycemia (Low Blood Sugar):</strong></p>
      <ul>
        <li>Most common complication</li>
        <li>Occurs in first few hours after birth</li>
        <li>Baby's insulin production still high but glucose supply cut off</li>
        <li>Requires immediate feeding or IV glucose</li>
        <li>Usually resolves within 24-48 hours</li>
      </ul>
      
      <p><strong>Respiratory Distress:</strong></p>
      <ul>
        <li>Difficulty breathing at birth</li>
        <li>More common in babies born early</li>
        <li>May need oxygen or breathing support</li>
        <li>Usually temporary</li>
      </ul>
      
      <p><strong>Jaundice (Hyperbilirubinemia):</strong></p>
      <ul>
        <li>Yellowing of skin and eyes</li>
        <li>More common in GDM babies</li>
        <li>Treated with phototherapy (bili lights)</li>
        <li>Monitored closely</li>
      </ul>
      
      <p><strong>Birth Injuries:</strong></p>
      <ul>
        <li>Shoulder dystocia from large size</li>
        <li>Nerve damage (usually temporary)</li>
        <li>Fracture of collar bone (heals well)</li>
        <li>Prevented with good glucose control</li>
      </ul>
      
      <p><strong>Low Calcium and Magnesium:</strong></p>
      <ul>
        <li>Can cause jitteriness or tremors</li>
        <li>Easily treated with supplements</li>
        <li>Resolves quickly</li>
      </ul>
      
      <h4>Long-Term Effects on Child</h4>
      <p><strong>Childhood Obesity:</strong></p>
      <ul>
        <li>Higher risk if GDM poorly controlled</li>
        <li>Preventable with healthy family lifestyle</li>
        <li>Encourage active play and healthy eating</li>
      </ul>
      
      <p><strong>Type 2 Diabetes Risk:</strong></p>
      <ul>
        <li>Increased risk in adolescence/adulthood</li>
        <li>Risk reduced with healthy lifestyle</li>
        <li>Regular pediatric checkups important</li>
      </ul>
      
      <p><strong>Metabolic Syndrome:</strong></p>
      <ul>
        <li>May develop in teenage years</li>
        <li>Family healthy habits make big difference</li>
      </ul>
      
      <h4>The Good News</h4>
      <p><strong>Most complications are preventable or treatable with:</strong></p>
      <ul>
        <li>Good glucose control during pregnancy</li>
        <li>Regular prenatal monitoring</li>
        <li>Proper medical care at delivery</li>
        <li>Immediate postnatal assessment</li>
        <li>Healthy family lifestyle after birth</li>
      </ul>
      
      <p><strong>Remember:</strong> The vast majority of women with well-controlled GDM have healthy babies with no complications. Your efforts to manage glucose levels directly benefit your baby's health now and in the future.</p>
    `
  },

  'doctor-questions': {
    icon: '❓',
    title: 'Questions to Ask Your Doctor',
    subtitle: 'Be an informed, empowered patient',
    content: `
      <h3>Essential Questions for Your Healthcare Team</h3>
      <p>Being prepared with questions helps you get the most from your appointments and ensures you understand your care plan.</p>
      
      <h4>About Diagnosis and Test Results</h4>
      <ul>
        <li>What were my exact test results and what do they mean?</li>
        <li>How severe is my gestational diabetes?</li>
        <li>Why did I develop GDM?</li>
        <li>Will this affect my baby right now?</li>
        <li>What tests will my baby need after birth?</li>
        <li>When will we know if GDM has resolved after delivery?</li>
      </ul>
      
      <h4>About Monitoring</h4>
      <ul>
        <li>How often should I check my blood glucose levels?</li>
        <li>What are my target blood glucose ranges?</li>
        <li>When should I test - before or after meals?</li>
        <li>What type of glucose meter do you recommend?</li>
        <li>How do I record my readings?</li>
        <li>When should I call you about high or low readings?</li>
        <li>Will insurance cover testing supplies?</li>
      </ul>
      
      <h4>About Treatment Options</h4>
      <ul>
        <li>Can I control this with diet and exercise alone?</li>
        <li>When would I need medication or insulin?</li>
        <li>If I need insulin, how will I learn to inject it?</li>
        <li>What are the side effects of the medications?</li>
        <li>Is insulin safe for my baby?</li>
        <li>Can I take oral diabetes medications instead of insulin?</li>
        <li>What if my blood sugar doesn't respond to treatment?</li>
      </ul>
      
      <h4>About Diet and Nutrition</h4>
      <ul>
        <li>Should I see a dietitian or nutritionist?</li>
        <li>How many carbohydrates should I eat per day?</li>
        <li>Are there specific foods I must avoid?</li>
        <li>Can I eat traditional Indian foods?</li>
        <li>How can I modify my family's meals?</li>
        <li>What snacks are safe?</li>
        <li>Should I take any supplements?</li>
        <li>How much weight should I gain during pregnancy?</li>
      </ul>
      
      <h4>About Exercise</h4>
      <ul>
        <li>What types of exercise are safe for me?</li>
        <li>How much should I exercise and how often?</li>
        <li>Should I check blood sugar before exercise?</li>
        <li>What are warning signs to stop exercising?</li>
        <li>Can exercise replace some medication?</li>
      </ul>
      
      <h4>About Baby's Health</h4>
      <ul>
        <li>How will this affect my baby's growth and development?</li>
        <li>Will my baby need special monitoring?</li>
        <li>How often will I have ultrasounds?</li>
        <li>What complications should I watch for?</li>
        <li>What tests will my baby need after birth?</li>
        <li>Will my baby's blood sugar be low at birth?</li>
        <li>Can I still breastfeed?</li>
      </ul>
      
      <h4>About Delivery and Labor</h4>
      <ul>
        <li>Will I need to deliver early?</li>
        <li>Am I more likely to need a cesarean section?</li>
        <li>What happens to my blood sugar during labor?</li>
        <li>Will I need insulin during labor?</li>
        <li>Can I still have a vaginal delivery?</li>
        <li>What should I pack in my hospital bag?</li>
        <li>Will a pediatrician be present at delivery?</li>
      </ul>
      
      <h4>About Postpartum Care</h4>
      <ul>
        <li>When will I be tested again for diabetes?</li>
        <li>Will my diabetes go away after delivery?</li>
        <li>How can I reduce my risk of type 2 diabetes?</li>
        <li>When can I stop checking blood sugar?</li>
        <li>Does breastfeeding help with blood sugar?</li>
        <li>Can I take diabetes medication while breastfeeding?</li>
        <li>When can I try to conceive again?</li>
      </ul>
      
      <h4>About Resources and Support</h4>
      <ul>
        <li>Do you have educational materials I can take home?</li>
        <li>Are there support groups for women with GDM?</li>
        <li>Can you recommend reliable websites or apps?</li>
        <li>Is there a diabetes educator I can see?</li>
        <li>What government schemes can help with costs?</li>
        <li>How can my family support me?</li>
      </ul>
      
      <h4>Questions for Specialized Team Members</h4>
      
      <p><strong>For Endocrinologist/Diabetologist:</strong></p>
      <ul>
        <li>How is pregnancy diabetes different from regular diabetes?</li>
        <li>What's the best insulin regimen for me?</li>
        <li>How do pregnancy hormones affect my blood sugar?</li>
      </ul>
      
      <p><strong>For Nutritionist:</strong></p>
      <ul>
        <li>Can you create a meal plan using Indian foods?</li>
        <li>How do I count carbohydrates?</li>
        <li>What's the glycemic index and why does it matter?</li>
      </ul>
      
      <p><strong>For Obstetrician:</strong></p>
      <ul>
        <li>How does GDM change my pregnancy care plan?</li>
        <li>Are there additional risks for me or my baby?</li>
        <li>What's the plan if my baby is measuring large?</li>
      </ul>
      
      <h4>Don't Hesitate to Ask</h4>
      <p><strong>Remember:</strong> No question is too small or silly. Your healthcare team is there to help you understand and manage your condition. Write down questions as they come to you, and bring the list to every appointment.</p>
      
      <p><strong>Tip:</strong> Bring a notebook or use your phone to record answers. You're getting a lot of information, and it's easy to forget details later.</p>
    `
  },

  'medical-management': {
    icon: '💊',
    title: 'Medical Management',
    subtitle: 'Treatment options and strategies',
    content: `
      <h3>Managing GDM: Your Treatment Plan</h3>
      <p>Most women can manage GDM through lifestyle modifications alone, but some may need medication. Here's what you need to know about all treatment options.</p>
      
      <h4>First-Line Treatment: Medical Nutrition Therapy</h4>
      <p>Diet is the cornerstone of GDM management:</p>
      <ul>
        <li><strong>Work with a qualified dietitian</strong> experienced in GDM</li>
        <li><strong>Carbohydrate counting:</strong> Learn to track and distribute carbs throughout the day</li>
        <li><strong>Focus on low glycemic index foods</strong> that don't spike blood sugar</li>
        <li><strong>Adequate protein and healthy fats</strong> at each meal</li>
        <li><strong>Small, frequent meals:</strong> 5-6 times per day prevents glucose spikes</li>
        <li><strong>Avoid skipping meals,</strong> especially breakfast</li>
      </ul>
      
      <h4>Physical Activity</h4>
      <p>Exercise is powerful medicine for GDM:</p>
      <ul>
        <li><strong>Moderate exercise 30 minutes daily</strong> (walking, swimming, prenatal yoga)</li>
        <li><strong>Helps lower blood glucose naturally</strong> without medication</li>
        <li><strong>Reduces insulin resistance</strong></li>
        <li><strong>Improves overall pregnancy outcomes</strong></li>
        <li><strong>Always get doctor approval</strong> before starting new exercise</li>
        <li><strong>Post-meal walks:</strong> Even 10-15 minutes helps significantly</li>
      </ul>
      
      <h4>Blood Glucose Monitoring</h4>
      <p>Self-monitoring is essential:</p>
      <ul>
        <li><strong>Test 4 times daily:</strong> Fasting and 1-2 hours after each meal</li>
        <li><strong>Keep detailed records</strong> in logbook or app</li>
        <li><strong>Learn to identify patterns</strong> and triggers</li>
        <li><strong>Share readings with healthcare team</strong> regularly</li>
        <li><strong>Helps determine if medication is needed</strong></li>
      </ul>
      
      <h4>When Medication is Needed</h4>
      <p>If diet and exercise don't achieve target glucose levels:</p>
      
      <p><strong>Insulin Therapy (Gold Standard):</strong></p>
      <ul>
        <li><strong>Safest option for pregnancy</strong> - doesn't cross placenta</li>
        <li><strong>Directly replaces what your body can't produce</strong></li>
        <li><strong>Types of insulin:</strong>
          <ul>
            <li>Rapid-acting: Taken before meals</li>
            <li>Long-acting: Once or twice daily for baseline coverage</li>
            <li>Mixed insulin: Combination therapy</li>
          </ul>
        </li>
        <li><strong>Injection sites:</strong> Abdomen (avoid near baby), thighs, arms</li>
        <li><strong>Dosage adjusted frequently</strong> as pregnancy progresses</li>
        <li><strong>Common regimen:</strong> Long-acting at bedtime + rapid-acting before meals</li>
      </ul>
      
      <p><strong>Metformin (Oral Medication):</strong></p>
      <ul>
        <li>Sometimes used as alternative to insulin</li>
        <li><strong>Does cross placenta</strong> - discuss risks/benefits with doctor</li>
        <li>Not approved by all medical guidelines for pregnancy</li>
        <li>May cause gastrointestinal side effects</li>
        <li>Less effective than insulin for some women</li>
        <li>Often used in combination with insulin</li>
      </ul>
      
      <p><strong>Important About Medications:</strong></p>
      <ul>
        <li>Never use pre-pregnancy diabetes medications without doctor approval</li>
        <li>Most oral diabetes drugs are NOT safe during pregnancy</li>
        <li>Insulin needs increase as pregnancy progresses</li>
        <li>Don't be discouraged if you need medication - it doesn't mean you failed</li>
      </ul>
      
      <h4>Regular Dose Adjustments</h4>
      <p>Your treatment plan will change throughout pregnancy:</p>
      <ul>
        <li><strong>Second trimester:</strong> Insulin resistance increases weekly</li>
        <li><strong>Third trimester:</strong> Highest insulin needs</li>
        <li><strong>Near delivery:</strong> May need less insulin</li>
        <li><strong>After delivery:</strong> Insulin needs drop dramatically</li>
        <li><strong>Work closely with your team</strong> for appropriate adjustments</li>
      </ul>
      
      <h4>Preventing Hypoglycemia (Low Blood Sugar)</h4>
      <p>If you're on insulin:</p>
      <ul>
        <li><strong>Learn to recognize symptoms:</strong> shakiness, sweating, rapid heartbeat, confusion</li>
        <li><strong>Always carry glucose tablets or juice</strong></li>
        <li><strong>Don't skip meals</strong></li>
        <li><strong>Test before driving</strong></li>
        <li><strong>Wear medical ID</strong> bracelet</li>
        <li><strong>Teach family members</strong> how to help</li>
      </ul>
      
      <h4>Treatment Success Criteria</h4>
      <p>Your treatment is working if:</p>
      <ul>
        <li>Fasting glucose < 95 mg/dL</li>
        <li>1-hour post-meal < 140 mg/dL</li>
        <li>2-hour post-meal < 120 mg/dL</li>
        <li>Baby growing appropriately (not too large or small)</li>
        <li>No signs of complications</li>
        <li>You feel well and energetic</li>
      </ul>
      
      <h4>Complementary Approaches</h4>
      <p>These support your main treatment (not replacements):</p>
      <ul>
        <li><strong>Stress management:</strong> Yoga, meditation, deep breathing</li>
        <li><strong>Adequate sleep:</strong> 7-9 hours nightly</li>
        <li><strong>Stay hydrated:</strong> Water helps regulate blood sugar</li>
        <li><strong>Support system:</strong> Family, friends, support groups</li>
      </ul>
      
      <p><strong>Remember:</strong> GDM management is a team effort. You, your obstetrician, endocrinologist, dietitian, and diabetes educator all work together for your and your baby's health.</p>
    `
  },

  'monitoring': {
    icon: '📊',
    title: 'Blood Glucose Monitoring',
    subtitle: 'Track and understand your levels',
    content: `
      <h3>Self-Monitoring Blood Glucose (SMBG)</h3>
      <p>Regular monitoring is your most powerful tool for managing GDM. It helps you understand how foods, activities, and medications affect your blood sugar.</p>
      
      <h4>Home Monitoring Guidelines</h4>
      
      <p><strong>When to Test:</strong></p>
      <ul>
        <li><strong>Fasting:</strong> First thing in the morning before eating or drinking anything</li>
        <li><strong>Post-meal testing:</strong> 1 or 2 hours after the start of your meal (doctor will specify)</li>
        <li><strong>Minimum 4 times daily:</strong> Fasting + after breakfast, lunch, dinner</li>
        <li><strong>Before bed:</strong> Sometimes recommended</li>
        <li><strong>Before driving:</strong> If on insulin</li>
        <li><strong>When feeling unwell:</strong> Symptoms of high or low blood sugar</li>
      </ul>
      
      <p><strong>How to Test Properly:</strong></p>
      <ul>
        <li>Wash hands with soap and warm water (dry completely)</li>
        <li>Use sides of fingertips, not center (less painful)</li>
        <li>Rotate fingers to prevent soreness</li>
        <li>Let hand hang down to increase blood flow</li>
        <li>Use first drop of blood (don't squeeze excessively)</li>
        <li>Record result immediately</li>
      </ul>
      
      <h4>Target Blood Glucose Levels (ACOG/ADA Standards)</h4>
      <ul>
        <li><strong>Fasting:</strong> < 95 mg/dL (5.3 mmol/L)</li>
        <li><strong>1-hour after meal:</strong> < 140 mg/dL (7.8 mmol/L)</li>
        <li><strong>2-hours after meal:</strong> < 120 mg/dL (6.7 mmol/L)</li>
      </ul>
      
      <p><strong>Note:</strong> Your doctor may set slightly different targets based on your specific situation.</p>
      
      <h4>Choosing a Glucose Meter</h4>
      
      <p><strong>Features to Look For:</strong></p>
      <ul>
        <li><strong>Accuracy:</strong> Look for meters validated for pregnancy</li>
        <li><strong>Easy to use:</strong> Large display, simple operation</li>
        <li><strong>Memory:</strong> Stores at least 200-500 readings</li>
        <li><strong>Data download:</strong> Can sync with phone app or computer</li>
        <li><strong>Small blood sample:</strong> Less painful testing</li>
        <li><strong>Insurance coverage:</strong> Check what's covered</li>
      </ul>
      
      <p><strong>Supplies You'll Need:</strong></p>
      <ul>
        <li>Glucose meter</li>
        <li>Test strips (check expiration dates)</li>
        <li>Lancets (disposable needles)</li>
        <li>Lancing device</li>
        <li>Logbook or app for recording</li>
        <li>Control solution (to test meter accuracy)</li>
      </ul>
      
      <h4>Keeping Detailed Records</h4>
      
      <p><strong>What to Record:</strong></p>
      <ul>
        <li>Date and time of test</li>
        <li>Blood glucose reading</li>
        <li>Meal eaten (what and how much)</li>
        <li>Physical activity</li>
        <li>Medications/insulin doses</li>
        <li>Any symptoms or unusual events</li>
        <li>Stress levels or illness</li>
      </ul>
      
      <p><strong>Recording Methods:</strong></p>
      <ul>
        <li><strong>Paper logbook:</strong> Simple, always available</li>
        <li><strong>Mobile apps:</strong> MySugr, Glucose Buddy, Diabetes:M</li>
        <li><strong>Meter memory:</strong> Review trends on device</li>
        <li><strong>Spreadsheet:</strong> For detailed analysis</li>
      </ul>
      
      <h4>Understanding Your Numbers</h4>
      
      <p><strong>Patterns to Watch For:</strong></p>
      <ul>
        <li><strong>Morning highs:</strong> May need bedtime insulin adjustment</li>
        <li><strong>Post-meal spikes:</strong> Review meal composition, may need medication</li>
        <li><strong>Lows after exercise:</strong> Adjust pre-exercise snack or medication</li>
        <li><strong>Weekend differences:</strong> Different routine affects readings</li>
        <li><strong>Stress-related highs:</strong> Hormones raise blood sugar</li>
      </ul>
      
      <p><strong>When to Call Your Doctor:</strong></p>
      <ul>
        <li>Fasting glucose above 95 mg/dL for 3+ days</li>
        <li>Post-meal readings above target for 3+ consecutive readings</li>
        <li>Any reading above 200 mg/dL</li>
        <li>Two or more readings below 60 mg/dL</li>
        <li>Unable to identify cause of high or low readings</li>
        <li>Symptoms of hyperglycemia: extreme thirst, frequent urination, fatigue</li>
      </ul>
      
      <h4>Tips for Successful Monitoring</h4>
      <ul>
        <li><strong>Set phone alarms:</strong> Reminders for testing times</li>
        <li><strong>Keep meter accessible:</strong> Bathroom, bedside, purse</li>
        <li><strong>Test before eating:</strong> Easy to remember</li>
        <li><strong>Involve family:</strong> They can help remind you</li>
        <li><strong>Make it routine:</strong> Link to other daily habits</li>
        <li><strong>Don't stress over one high reading:</strong> Look for patterns</li>
        <li><strong>Celebrate successes:</strong> Days with all readings in target</li>
      </ul>
      
      <h4>Common Mistakes to Avoid</h4>
      <ul>
        <li>Not testing often enough</li>
        <li>Using expired test strips</li>
        <li>Not recording results immediately</li>
        <li>Testing at inconsistent times</li>
        <li>Not bringing logbook to appointments</li>
        <li>Squeezing finger too hard (dilutes blood with tissue fluid)</li>
        <li>Not calibrating meter with control solution</li>
      </ul>
      
      <h4>Meter Accuracy Tips</h4>
      <ul>
        <li>Store strips in original container (moisture-proof)</li>
        <li>Check expiration dates monthly</li>
        <li>Use control solution weekly to test meter</li>
        <li>Clean meter regularly per manufacturer instructions</li>
        <li>Replace batteries when low</li>
        <li>Don't use meter in extreme temperatures</li>
      </ul>
      
      <h4>Financial Considerations</h4>
      <ul>
        <li>Check insurance coverage for meters and strips</li>
        <li>Some government schemes cover supplies (PMJAY, state programs)</li>
        <li>Buy strips in bulk when possible (cheaper)</li>
        <li>Ask doctor for samples to try different meters</li>
        <li>Generic strips sometimes work with brand-name meters (check compatibility)</li>
      </ul>
      
      <p><strong>Remember:</strong> Your glucose log is a powerful tool. It shows your healthcare team how your body responds to food, activity, and medication, allowing them to fine-tune your treatment plan for optimal results.</p>
    `
  },

  'diet': {
    icon: '🥗',
    title: 'Dietary Guidelines for Indian Women',
    subtitle: 'Eating well with GDM',
    content: `
      <h3>Indian Meal Planning for GDM</h3>
      <p>Managing GDM with traditional Indian foods is absolutely possible! The key is choosing the right foods, portions, and timing.</p>
      
      <h4>Foods to Include Generously</h4>
      
      <p><strong>Whole Grains (Choose Complex Carbs):</strong></p>
      <ul>
        <li>Brown rice, red rice, black rice</li>
        <li>Whole wheat roti/chapati</li>
        <li>Oats (steel-cut or rolled)</li>
        <li>Quinoa, ragi (finger millet)</li>
        <li>Jowar (sorghum), bajra (pearl millet)</li>
        <li>Barley (jau)</li>
      </ul>
      
      <p><strong>Proteins (Essential at Every Meal):</strong></p>
      <ul>
        <li>All dals: moong, masoor, chana, toor, urad</li>
        <li>Legumes: chickpeas, kidney beans, black beans</li>
        <li>Eggs (boiled, poached, or scrambled)</li>
        <li>Fish: pomfret, salmon, sardines, rohu</li>
        <li>Lean chicken (skinless)</li>
        <li>Paneer (cottage cheese) - in moderation</li>
        <li>Tofu and soy products</li>
        <li>Greek yogurt, hung curd</li>
      </ul>
      
      <p><strong>Non-Starchy Vegetables (Eat Freely):</strong></p>
      <ul>
        <li>Leafy greens: palak, methi, amaranth</li>
        <li>Cruciferous: cauliflower, cabbage, broccoli</li>
        <li>Gourds: lauki, karela, tori, tinda</li>
        <li>Others: bhindi, beans, capsicum, tomatoes, cucumber</li>
        <li>Radish, turnip, carrots (in moderation)</li>
      </ul>
      
      <p><strong>Healthy Fats (In Controlled Portions):</strong></p>
      <ul>
        <li>Nuts: almonds, walnuts, pistachios (handful daily)</li>
        <li>Seeds: chia, flax, pumpkin, sunflower</li>
        <li>Ghee: 1-2 teaspoons per day</li>
        <li>Olive oil, mustard oil for cooking</li>
        <li>Avocado (when available)</li>
      </ul>
      
      <p><strong>Dairy (Low-Fat Options):</strong></p>
      <ul>
        <li>Low-fat milk or toned milk</li>
        <li>Curd/dahi (unflavored, unsweetened)</li>
        <li>Buttermilk (chaas)</li>
        <li>Paneer (limited quantity)</li>
      </ul>
      
      <h4>Foods to Limit or Avoid</h4>
      
      <p><strong>Refined Carbohydrates:</strong></p>
      <ul>
        <li>White rice (replace with brown/red rice)</li>
        <li>Maida products: white bread, biscuits, cakes</li>
        <li>Noodles, pasta (unless whole grain)</li>
        <li>Poha, upma made with refined grains</li>
      </ul>
      
      <p><strong>Sugary Foods:</strong></p>
      <ul>
        <li>All sweets: gulab jamun, jalebi, barfi, halwa</li>
        <li>Desserts, cakes, pastries</li>
        <li>Sugary drinks, sodas, packaged fruit juices</li>
        <li>Sweetened condensed milk</li>
        <li>Honey, jaggery in excess</li>
      </ul>
      
      <p><strong>Fried Foods:</strong></p>
      <ul>
        <li>Samosas, pakoras, kachoris</li>
        <li>Fried puris, bhature</li>
        <li>Potato chips, namkeen</li>
        <li>Deep-fried snacks</li>
      </ul>
      
      <p><strong>High-Sugar Fruits (Limit Portions):</strong></p>
      <ul>
        <li>Mangoes (small portions only)</li>
        <li>Grapes (limit to small handful)</li>
        <li>Bananas (half at a time)</li>
        <li>Chikoo, custard apple</li>
        <li>Fruit juices (even fresh - eat whole fruit instead)</li>
      </ul>
      
      <p><strong>Processed Foods:</strong></p>
      <ul>
        <li>Packaged snacks with hidden sugars</li>
        <li>Instant mixes and ready-to-eat meals</li>
        <li>Flavored yogurts</li>
        <li>Breakfast cereals (most are high in sugar)</li>
      </ul>
      
      <h4>Sample Indian Meal Plan</h4>
      
      <p><strong>Early Morning (6-7 AM):</strong></p>
      <ul>
        <li>Methi water or jeera water (aids digestion)</li>
        <li>Handful of soaked almonds</li>
      </ul>
      
      <p><strong>Breakfast (8-9 AM):</strong></p>
      <p>Option 1:</p>
      <ul>
        <li>1 bowl oats upma with vegetables</li>
        <li>1 boiled egg</li>
        <li>1 cup buttermilk</li>
      </ul>
      <p>Option 2:</p>
      <ul>
        <li>2 small whole wheat dosas with sambar (less rice, more dal)</li>
        <li>Green chutney</li>
        <li>1 cup curd</li>
      </ul>
      <p>Option 3:</p>
      <ul>
        <li>2 moong dal chillas (lentil pancakes)</li>
        <li>Mint chutney</li>
        <li>1 cup low-fat milk</li>
      </ul>
      
      <p><strong>Mid-Morning Snack (11 AM):</strong></p>
      <ul>
        <li>1 small apple or pear with skin</li>
        <li>10-12 roasted almonds/walnuts</li>
      </ul>
      <p>Or:</p>
      <ul>
        <li>1 cup sprouts chaat with lemon</li>
        <li>Green tea</li>
      </ul>
      
      <p><strong>Lunch (1-2 PM):</strong></p>
      <ul>
        <li>1 small bowl brown rice OR 2 small whole wheat rotis</li>
        <li>1 bowl dal (any variety)</li>
        <li>1 bowl mixed vegetable sabzi (dry or semi-dry)</li>
        <li>Large serving of salad (cucumber, tomato, radish, onion)</li>
        <li>Small bowl raita or curd</li>
      </ul>
      
      <p><strong>Evening Snack (4-5 PM):</strong></p>
      <ul>
        <li>Roasted chana (chickpeas)</li>
        <li>Green tea or herbal tea</li>
      </ul>
      <p>Or:</p>
      <ul>
        <li>Vegetable soup (without cream)</li>
        <li>Few multigrain crackers</li>
      </ul>
      
      <p><strong>Dinner (7-8 PM, Earlier is Better):</strong></p>
      <ul>
        <li>1 small bowl brown rice OR 1-2 rotis</li>
        <li>Grilled fish or chicken curry (made with minimal oil)</li>
        <li>1-2 bowls of vegetable curry or stir-fry</li>
        <li>Clear soup (if still hungry)</li>
        <li>Small bowl curd</li>
      </ul>
      
      <p><strong>Before Bed (Optional, if needed):</strong></p>
      <ul>
        <li>1 cup warm low-fat milk</li>
        <li>2-3 almonds</li>
      </ul>
      
      <h4>Meal Planning Tips</h4>
      
      <p><strong>The Plate Method (Indian Adaptation):</strong></p>
      <ul>
        <li><strong>Half plate:</strong> Vegetables (sabzi, salad)</li>
        <li><strong>Quarter plate:</strong> Protein (dal, chicken, fish, egg, paneer)</li>
        <li><strong>Quarter plate:</strong> Carbohydrates (roti, brown rice)</li>
      </ul>
      
      <p><strong>Timing Matters:</strong></p>
      <ul>
        <li>Eat every 2-3 hours (prevents glucose spikes and dips)</li>
        <li>Don't skip meals, especially breakfast</li>
        <li>Avoid large gaps between meals</li>
        <li>Eat dinner 2-3 hours before bedtime</li>
      </ul>
      
      <p><strong>Portion Control:</strong></p>
      <ul>
        <li>Use smaller plates</li>
        <li>Measure carbs initially to understand portions</li>
        <li>Don't eat directly from packages</li>
        <li>Stop eating when 80% full</li>
      </ul>
      
      <p><strong>Cooking Methods:</strong></p>
      <ul>
        <li>Prefer: grilling, baking, steaming, boiling, roasting</li>
        <li>Limit: deep frying, excessive oil usage</li>
        <li>Use non-stick cookware to reduce oil</li>
        <li>Dry roast spices for flavor without fat</li>
      </ul>
      
      <h4>Special Situations</h4>
      
      <p><strong>Eating Out:</strong></p>
      <ul>
        <li>Choose tandoori over fried items</li>
        <li>Ask for roti instead of naan</li>
        <li>Request less oil in preparations</li>
        <li>Skip the rice or take very small portion</li>
        <li>Fill up on salads and raita first</li>
        <li>Share desserts or skip entirely</li>
      </ul>
      
      <p><strong>Festivals and Celebrations:</strong></p>
      <ul>
        <li>Eat your regular meal before going</li>
        <li>Choose one small sweet to taste</li>
        <li>Focus on socializing, not food</li>
        <li>Compensate with extra walking/activity</li>
        <li>Test blood sugar more frequently</li>
      </ul>
      
      <p><strong>Cravings:</strong></p>
      <ul>
        <li>Try sugar-free versions first</li>
        <li>Have a tiny portion paired with protein</li>
        <li>Test blood sugar after to see impact</li>
        <li>Find healthy swaps (baked vs fried)</li>
      </ul>
      
      <h4>Indian Superfoods for GDM</h4>
      <ul>
        <li><strong>Karela (bitter gourd):</strong> May help lower blood sugar</li>
        <li><strong>Methi (fenugreek):</strong> Seeds and leaves beneficial</li>
        <li><strong>Jamun (black plum):</strong> Seeds have anti-diabetic properties</li>
        <li><strong>Amla (Indian gooseberry):</strong> Rich in vitamin C, low GI</li>
        <li><strong>Curry leaves:</strong> May help regulate glucose</li>
        <li><strong>Cinnamon (dalchini):</strong> Small amounts in food</li>
      </ul>
      
      <p><strong>Important:</strong> These are supportive foods, not treatments. Always follow your doctor's medical advice.</p>
      
      <p><strong>Remember:</strong> Indian food can be healthy and delicious with GDM. Focus on whole grains, lots of vegetables, adequate protein, and controlled portions. You're not giving up your cultural foods - you're making smarter choices within your cuisine!</p>
    `
  },

  
  'exercise': {
    icon: '💪',
    title: 'Physical Activity Guidelines',
    subtitle: 'Safe exercise during pregnancy with GDM',
    content: `
      <h3>Exercise and GDM Management</h3>
      <p>Regular physical activity is a cornerstone of GDM management. Exercise helps your body use insulin more effectively and can reduce the need for medication.</p>
      
      <h4>Benefits of Exercise with GDM</h4>
      <ul>
        <li>Lowers blood glucose levels naturally</li>
        <li>Improves insulin sensitivity</li>
        <li>Helps manage weight gain</li>
        <li>Reduces stress and improves mood</li>
        <li>Prepares body for labor and delivery</li>
        <li>May reduce risk of future Type 2 diabetes</li>
      </ul>
      
      <h4>Recommended Activities</h4>
      <p><strong>Safe for Most Pregnant Women:</strong></p>
      <ul>
        <li><strong>Walking:</strong> 30 minutes after meals, most effective</li>
        <li><strong>Swimming:</strong> Low impact, full body workout</li>
        <li><strong>Prenatal yoga:</strong> Flexibility and relaxation</li>
        <li><strong>Stationary cycling:</strong> Safe cardio option</li>
        <li><strong>Light strength training:</strong> With doctor approval</li>
      </ul>
      
      <h4>Exercise Guidelines</h4>
      <ul>
        <li><strong>Frequency:</strong> At least 5 days per week</li>
        <li><strong>Duration:</strong> 30 minutes per session</li>
        <li><strong>Intensity:</strong> Moderate - you should be able to talk</li>
        <li><strong>Best time:</strong> 20-30 minutes after meals</li>
      </ul>
      
      <h4>Safety Precautions</h4>
      <ul>
        <li>Always get doctor's clearance before starting</li>
        <li>Stop if you feel dizzy, short of breath, or have pain</li>
        <li>Avoid exercises lying flat on back after 20 weeks</li>
        <li>Stay hydrated</li>
        <li>Avoid overheating</li>
        <li>Test blood sugar before and after exercise</li>
      </ul>
      
      <h4>Warning Signs to Stop</h4>
      <p>Stop exercising and call your doctor if you experience:</p>
      <ul>
        <li>Vaginal bleeding or fluid leakage</li>
        <li>Regular painful contractions</li>
        <li>Chest pain or severe shortness of breath</li>
        <li>Dizziness or fainting</li>
        <li>Severe headache</li>
        <li>Calf pain or swelling</li>
      </ul>
    `
  },
  
  'lifestyle': {
    icon: '🌟',
    title: 'Lifestyle Management',
    subtitle: 'Daily habits for optimal GDM control',
    content: `
      <h3>Creating a GDM-Friendly Lifestyle</h3>
      <p>Managing GDM requires consistent healthy habits throughout your pregnancy. Small daily changes make a big difference.</p>
      
      <h4>Sleep and Rest</h4>
      <ul>
        <li><strong>7-9 hours:</strong> Aim for adequate sleep each night</li>
        <li>Poor sleep can worsen insulin resistance</li>
        <li>Elevate feet to reduce swelling</li>
        <li>Sleep on left side for better blood flow</li>
      </ul>
      
      <h4>Stress Management</h4>
      <p>Stress hormones can raise blood sugar levels:</p>
      <ul>
        <li>Practice deep breathing exercises</li>
        <li>Try prenatal meditation or yoga</li>
        <li>Join support groups</li>
        <li>Talk to your partner, family, or counselor</li>
        <li>Limit exposure to stressful situations</li>
      </ul>
      
      <h4>Hydration</h4>
      <ul>
        <li>Drink 8-10 glasses of water daily</li>
        <li>Avoid sugary drinks and sodas</li>
        <li>Limit caffeine to 200mg per day</li>
        <li>Herbal teas (doctor-approved varieties)</li>
      </ul>
      
      <h4>Daily Routine Tips</h4>
      <ul>
        <li><strong>Meal timing:</strong> Eat at regular intervals</li>
        <li><strong>Don't skip meals:</strong> Especially breakfast</li>
        <li><strong>After-meal walks:</strong> Even 10 minutes helps</li>
        <li><strong>Monitor consistently:</strong> Same times each day</li>
        <li><strong>Keep a log:</strong> Track food, activity, and glucose</li>
      </ul>
      
      <h4>Indian Lifestyle Adaptations</h4>
      <ul>
        <li>Choose stairs over elevator when safe</li>
        <li>Do household chores as light activity</li>
        <li>Traditional activities like walking to temple</li>
        <li>Yoga and pranayama (breathing exercises)</li>
        <li>Family involvement in healthy cooking</li>
      </ul>
    `
  },
  
  'prevention': {
    icon: '🛡️',
    title: 'Prevention Strategies',
    subtitle: 'Reducing GDM risk in future pregnancies',
    content: `
      <h3>Preventing GDM in Future Pregnancies</h3>
      <p>If you've had GDM, you have a 30-70% chance of developing it in future pregnancies. However, lifestyle changes can significantly reduce this risk.</p>
      
      <h4>Between Pregnancies</h4>
      <ul>
        <li><strong>Achieve healthy weight:</strong> Lose excess weight before conceiving again</li>
        <li><strong>Maintain active lifestyle:</strong> Regular exercise 5 days/week</li>
        <li><strong>Healthy diet:</strong> Continue low-GI eating patterns</li>
        <li><strong>Regular screening:</strong> Check for Type 2 diabetes 6-12 weeks postpartum and yearly</li>
        <li><strong>Plan spacing:</strong> Allow body to recover between pregnancies</li>
      </ul>
      
      <h4>Pre-Conception Planning</h4>
      <p>Before getting pregnant again:</p>
      <ul>
        <li>Get HbA1c tested to check glucose control</li>
        <li>Achieve BMI under 25 if possible</li>
        <li>Start prenatal vitamins with folic acid</li>
        <li>Discuss early screening with doctor</li>
        <li>Review family history and risk factors</li>
      </ul>
      
      <h4>First Pregnancy Prevention</h4>
      <p>For women planning their first pregnancy:</p>
      <ul>
        <li><strong>Know your risk:</strong> Family history, ethnicity, PCOS</li>
        <li><strong>Pre-pregnancy weight:</strong> Reach healthy weight before conceiving</li>
        <li><strong>Lifestyle habits:</strong> Establish healthy eating and exercise early</li>
        <li><strong>Early prenatal care:</strong> First trimester screening if high risk</li>
      </ul>
      
      <h4>Preventing Type 2 Diabetes After GDM</h4>
      <ul>
        <li>50-70% of women with GDM develop Type 2 diabetes</li>
        <li><strong>Weight management:</strong> Return to pre-pregnancy weight</li>
        <li><strong>Breastfeeding:</strong> May reduce diabetes risk by 30-50%</li>
        <li><strong>Regular screening:</strong> Blood sugar tests at 6-12 weeks, then yearly</li>
        <li><strong>Sustained lifestyle:</strong> Continue healthy habits long-term</li>
        <li><strong>Medication:</strong> Metformin if recommended by doctor</li>
      </ul>
    `
  },
  
  'pregnancy-stages': {
    icon: '📅',
    title: 'GDM Through Pregnancy Stages',
    subtitle: 'What to expect each trimester',
    content: `
      <h3>GDM Management Across Trimesters</h3>
      
      <h4>First Trimester (Weeks 1-12)</h4>
      <p><strong>For Most Women:</strong></p>
      <ul>
        <li>No GDM yet - develops later in pregnancy</li>
        <li>Focus on healthy eating habits</li>
        <li>Start gentle exercise routine</li>
        <li>Take prenatal vitamins</li>
      </ul>
      
      <p><strong>High-Risk Women Should:</strong></p>
      <ul>
        <li>Get early glucose screening</li>
        <li>See endocrinologist if pre-existing diabetes suspected</li>
        <li>More frequent monitoring if diagnosed early</li>
      </ul>
      
      <h4>Second Trimester (Weeks 13-27)</h4>
      <p><strong>Weeks 24-28 - Critical Screening Period:</strong></p>
      <ul>
        <li>Universal GDM screening with OGTT</li>
        <li>Placental hormones peak, increasing insulin resistance</li>
        <li>Diagnosis and treatment begins if positive</li>
        <li>Start blood glucose monitoring</li>
        <li>Diet and exercise modifications</li>
        <li>Meet with diabetes educator and nutritionist</li>
      </ul>
      
      <h4>Third Trimester (Weeks 28-40)</h4>
      <p><strong>Most Intensive Management Period:</strong></p>
      <ul>
        <li>Insulin resistance continues to increase</li>
        <li>May need to add or increase insulin</li>
        <li>More frequent prenatal visits (weekly or bi-weekly)</li>
        <li>Fetal monitoring (NST, ultrasounds)</li>
        <li>Delivery planning discussions</li>
      </ul>
      
      <p><strong>Week-by-Week Changes:</strong></p>
      <ul>
        <li><strong>Weeks 28-32:</strong> Insulin needs may increase 50%</li>
        <li><strong>Weeks 32-36:</strong> Peak insulin resistance</li>
        <li><strong>Weeks 36-40:</strong> Close monitoring of baby size</li>
        <li><strong>Week 38-39:</strong> Delivery often recommended</li>
      </ul>
      
      <h4>Delivery and Immediate Postpartum</h4>
      <ul>
        <li>Blood sugar typically normalizes immediately after delivery</li>
        <li>Stop diabetes medications (unless pre-existing diabetes)</li>
        <li>Continue monitoring for 24-48 hours</li>
        <li>Baby's glucose monitored after birth</li>
      </ul>
    `
  },
  
  'warning-signs': {
    icon: '🚨',
    title: 'Warning Signs & Emergencies',
    subtitle: 'When to seek immediate medical care',
    content: `
      <h3>Critical Warning Signs</h3>
      <p>While most GDM is well-managed, certain symptoms require immediate medical attention.</p>
      
      <h4>🚨 Call Emergency (Ambulance) Immediately If:</h4>
      <ul>
        <li><strong>Loss of consciousness</strong> or unresponsive</li>
        <li><strong>Severe chest pain</strong> or difficulty breathing</li>
        <li><strong>Seizures</strong> or convulsions</li>
        <li><strong>Severe bleeding</strong> from vagina</li>
        <li><strong>Sudden severe headache</strong> with vision changes and upper abdominal pain (eclampsia signs)</li>
        <li><strong>Baby not moving</strong> or very reduced movement</li>
      </ul>
      
      <h4>📞 Call Doctor Immediately (Same Day) If:</h4>
      <p><strong>High Blood Sugar (Hyperglycemia):</strong></p>
      <ul>
        <li>Fasting glucose > 140 mg/dL repeatedly</li>
        <li>Post-meal glucose > 200 mg/dL</li>
        <li>Extreme thirst despite drinking fluids</li>
        <li>Fruity-smelling breath</li>
        <li>Nausea and vomiting that won't stop</li>
      </ul>
      
      <p><strong>Low Blood Sugar (Hypoglycemia - if on insulin):</strong></p>
      <ul>
        <li>Blood sugar < 60 mg/dL</li>
        <li>Severe shakiness, sweating, confusion</li>
        <li>Can't keep juice or sugar down</li>
        <li>Repeated episodes in one day</li>
      </ul>
      
      <p><strong>Pregnancy Complications:</strong></p>
      <ul>
        <li>Leaking amniotic fluid</li>
        <li>Regular contractions before 37 weeks</li>
        <li>Severe swelling of face and hands</li>
        <li>Persistent severe headache</li>
        <li>Vision changes (blurry, spots, flashing lights)</li>
        <li>Upper right abdominal pain</li>
      </ul>
      
      <p><strong>Infection Signs:</strong></p>
      <ul>
        <li>Fever > 100.4°F (38°C)</li>
        <li>Burning or pain with urination</li>
        <li>Vaginal discharge that's foul-smelling</li>
        <li>Red, hot, swollen area on skin</li>
      </ul>
      
      <h4>⏰ Schedule Appointment Within 24-48 Hours If:</h4>
      <ul>
        <li>Blood sugar consistently above target range</li>
        <li>Difficulty following diet plan</li>
        <li>Side effects from medication</li>
        <li>Questions about insulin dosing</li>
        <li>Mild symptoms getting worse</li>
      </ul>
      
      <h4>Emergency Kit Essentials</h4>
      <p>Keep these items accessible:</p>
      <ul>
        <li>Glucose meter and test strips</li>
        <li>Fast-acting sugar (glucose tablets, juice)</li>
        <li>Emergency contact numbers</li>
        <li>List of current medications</li>
        <li>Hospital/doctor address</li>
        <li>Your medical records (digital copy)</li>
      </ul>
      
      <p><strong>Remember:</strong> It's always better to call and be reassured than to delay care when something serious is happening. Trust your instincts - you know your body best.</p>
    `
  },
  
  'myths': {
    icon: '❌',
    title: 'Common Myths About GDM',
    subtitle: 'Separating fact from fiction',
    content: `
      <h3>Debunking GDM Myths</h3>
      <p>Let's address common misconceptions about gestational diabetes that can cause unnecessary worry or lead to poor management.</p>
      
      <h4>Myth 1: "I ate too much sugar, that's why I got GDM"</h4>
      <p><strong>FACT:</strong> GDM is caused by pregnancy hormones affecting insulin function, not by eating too much sugar. While healthy eating helps manage GDM, eating sweets didn't cause it. You did nothing wrong!</p>
      
      <h4>Myth 2: "GDM means my baby will have diabetes"</h4>
      <p><strong>FACT:</strong> Your baby will not be born with diabetes. However, with poor GDM control, there's a higher risk of your child developing obesity and Type 2 diabetes later in life. Good management significantly reduces this risk.</p>
      
      <h4>Myth 3: "I need to eat for two"</h4>
      <p><strong>FACT:</strong> You only need about 300-500 extra calories per day in 2nd and 3rd trimesters. Quality of food matters more than quantity. Focus on nutrient-dense foods, not eating double portions.</p>
      
      <h4>Myth 4: "Taking insulin will harm my baby"</h4>
      <p><strong>FACT:</strong> Insulin does not cross the placenta and is completely safe for your baby. High blood sugar is much more harmful than insulin. If your doctor recommends insulin, it's to protect both you and your baby.</p>
      
      <h4>Myth 5: "I can't eat any carbs or fruits"</h4>
      <p><strong>FACT:</strong> You can and should eat carbohydrates - they're essential for baby's growth. The key is choosing complex carbs, controlling portions, and spreading them throughout the day. Most fruits are fine in moderate amounts.</p>
      
      <h4>Myth 6: "Bed rest is better than exercise with GDM"</h4>
      <p><strong>FACT:</strong> Unless your doctor specifically orders bed rest for other complications, exercise is strongly recommended for GDM. Walking after meals is one of the best ways to manage blood sugar.</p>
      
      <h4>Myth 7: "I'll definitely develop Type 2 diabetes later"</h4>
      <p><strong>FACT:</strong> While the risk is higher (50-70%), it's not inevitable. Maintaining healthy weight, exercising regularly, and breastfeeding can reduce your risk by 30-50%.</p>
      
      <h4>Myth 8: "Herbal remedies can cure GDM"</h4>
      <p><strong>FACT:</strong> While some herbs like cinnamon and fenugreek may help manage blood sugar, they cannot cure GDM. Never replace medical treatment with herbal remedies. Always consult your doctor before taking any supplements.</p>
      
      <h4>Myth 9: "I have to have a C-section"</h4>
      <p><strong>FACT:</strong> Many women with well-controlled GDM have vaginal deliveries. C-section is recommended only if there are complications like a very large baby (> 4.5 kg) or other medical reasons.</p>
      
      <h4>Myth 10: "I can't breastfeed with GDM"</h4>
      <p><strong>FACT:</strong> GDM does not prevent breastfeeding. In fact, breastfeeding is highly encouraged as it helps your blood sugar normalize faster and reduces your future diabetes risk.</p>
      
      <h4>Indian-Specific Myths</h4>
      <ul>
        <li><strong>Myth:</strong> "Eating jaggery is better than sugar for GDM"<br>
        <strong>Fact:</strong> Jaggery raises blood sugar just like regular sugar. It's not a safe alternative.</li>
        
        <li><strong>Myth:</strong> "Karela (bitter gourd) can replace insulin"<br>
        <strong>Fact:</strong> While karela may have mild blood sugar benefits, it cannot replace medical treatment.</li>
        
        <li><strong>Myth:</strong> "Only overweight women get GDM"<br>
        <strong>Fact:</strong> Indian women can develop GDM even at normal BMI due to genetic factors and body composition.</li>
      </ul>
    `
  },
  
  'family-support': {
    icon: '👨‍👩‍👧‍👦',
    title: 'Family Support & Involvement',
    subtitle: 'How loved ones can help',
    content: `
      <h3>The Power of Family Support</h3>
      <p>Managing GDM is easier when your family understands and supports your journey. Here's how your loved ones can help.</p>
      
      <h4>For Partners</h4>
      <p><strong>How You Can Support:</strong></p>
      <ul>
        <li><strong>Learn together:</strong> Attend doctor appointments, read about GDM</li>
        <li><strong>Diet buddy:</strong> Eat the same healthy meals together</li>
        <li><strong>Exercise partner:</strong> Go for walks after meals together</li>
        <li><strong>Emotional support:</strong> Listen without judging, encourage progress</li>
        <li><strong>Share responsibilities:</strong> Help with cooking, shopping, monitoring</li>
        <li><strong>Be patient:</strong> Hormones + stress + diet restrictions = mood changes</li>
      </ul>
      
      <p><strong>What NOT to Say:</strong></p>
      <ul>
        <li>"You're being too strict with your diet"</li>
        <li>"One sweet won't hurt"</li>
        <li>"My mom/sister had GDM and she ate everything"</li>
        <li>"You're worrying too much"</li>
        <li>"Can't you just try harder to control it?"</li>
      </ul>
      
      <p><strong>What TO Say:</strong></p>
      <ul>
        <li>"I'm proud of how well you're managing this"</li>
        <li>"What can I do to help?"</li>
        <li>"Let's cook a healthy meal together"</li>
        <li>"Your health and baby's health are most important"</li>
        <li>"I'm here for you"</li>
      </ul>
      
      <h4>For Parents and In-Laws</h4>
      <p><strong>Understanding the Condition:</strong></p>
      <ul>
        <li>GDM is not caused by eating sweets or being careless</li>
        <li>It's a medical condition requiring treatment</li>
        <li>Your daughter/daughter-in-law didn't do anything wrong</li>
        <li>Traditional beliefs may need to be adjusted</li>
      </ul>
      
      <p><strong>Practical Support:</strong></p>
      <ul>
        <li>Help prepare GDM-friendly Indian meals</li>
        <li>Support her dietary choices at family gatherings</li>
        <li>Don't pressure her to eat foods she shouldn't</li>
        <li>Help with household chores to reduce stress</li>
        <li>Accompany to medical appointments if needed</li>
      </ul>
      
      <h4>For Siblings and Extended Family</h4>
      <ul>
        <li>Don't make her feel guilty for not eating sweets at celebrations</li>
        <li>Offer GDM-friendly snacks when she visits</li>
        <li>Include her in activities that don't revolve around food</li>
        <li>Check in regularly to see how she's doing</li>
        <li>Share positive stories, not horror stories</li>
      </ul>
      
      <h4>Managing Family Pressure</h4>
      <p><strong>Common Situations:</strong></p>
      <ul>
        <li><strong>Festivals and functions:</strong> Inform hosts in advance about dietary needs</li>
        <li><strong>"Just one bite" pressure:</strong> Have partner/family deflect for you</li>
        <li><strong>Unsolicited advice:</strong> Politely say "Thank you, but I'm following doctor's orders"</li>
        <li><strong>Criticism of medical care:</strong> Stand firm on evidence-based treatment</li>
      </ul>
      
      <h4>Creating a Supportive Home Environment</h4>
      <ul>
        <li><strong>Stock GDM-friendly foods:</strong> Whole grains, vegetables, proteins</li>
        <li><strong>Remove temptations:</strong> Keep sweets and junk food out of sight</li>
        <li><strong>Meal planning together:</strong> Involve family in weekly menu</li>
        <li><strong>Celebrate milestones:</strong> Good glucose readings, reaching goals</li>
        <li><strong>Join support groups:</strong> Connect with other families managing GDM</li>
      </ul>
      
      <h4>For Older Children</h4>
      <p>If you have other kids:</p>
      <ul>
        <li>Explain in age-appropriate way why mom has to be careful with food</li>
        <li>Involve them in choosing vegetables at market</li>
        <li>Let them help with simple meal prep</li>
        <li>Reassure them that mom and baby will be okay</li>
        <li>Don't let them feel guilty about their snacks</li>
      </ul>
      
      <p><strong>Remember:</strong> GDM management is a family journey. When everyone works together, outcomes are better for both mother and baby.</p>
    `
  },
  
  'breastfeeding': {
    icon: '🤱',
    title: 'Breastfeeding with GDM History',
    subtitle: 'Benefits and what to know',
    content: `
      <h3>Breastfeeding After GDM</h3>
      <p>Breastfeeding is not only safe after GDM - it's highly beneficial for both you and your baby!</p>
      
      <h4>Benefits for Mother</h4>
      <ul>
        <li><strong>Lowers diabetes risk:</strong> Reduces chance of Type 2 diabetes by 30-50%</li>
        <li><strong>Aids weight loss:</strong> Burns 300-500 calories per day</li>
        <li><strong>Improves insulin sensitivity:</strong> Helps blood sugar regulation</li>
        <li><strong>Hormonal benefits:</strong> Oxytocin helps uterus return to normal size</li>
        <li><strong>Delays return of periods:</strong> Natural birth spacing</li>
      </ul>
      
      <h4>Benefits for Baby</h4>
      <ul>
        <li><strong>Optimal nutrition:</strong> Perfect food for newborns</li>
        <li><strong>Immune protection:</strong> Antibodies from mother</li>
        <li><strong>Reduces obesity risk:</strong> Lower chance of childhood obesity</li>
        <li><strong>May lower diabetes risk:</strong> Protective effect against Type 1 and 2 diabetes</li>
        <li><strong>Better metabolic outcomes:</strong> Improved glucose metabolism</li>
      </ul>
      
      <h4>Getting Started</h4>
      <p><strong>First 24-48 Hours:</strong></p>
      <ul>
        <li>Start breastfeeding within first hour after birth</li>
        <li>Colostrum (first milk) is crucial for baby's blood sugar</li>
        <li>Feed frequently (8-12 times per day) to stimulate milk production</li>
        <li>Baby may need extra monitoring if you needed insulin</li>
        <li>Lactation consultant can help with positioning</li>
      </ul>
      
      <h4>Managing Blood Sugar While Breastfeeding</h4>
      <p><strong>Your Glucose Levels:</strong></p>
      <ul>
        <li>Blood sugar typically normalizes after delivery</li>
        <li>Breastfeeding can lower blood sugar further</li>
        <li>Keep snacks handy while nursing</li>
        <li>May need small carb snack before/during feeding</li>
        <li>Continue monitoring if recommended by doctor</li>
      </ul>
      
      <p><strong>Baby's Glucose Levels:</strong></p>
      <ul>
        <li>Babies born to GDM mothers monitored closely</li>
        <li>Risk of low blood sugar (hypoglycemia) in first 24 hours</li>
        <li>Frequent feeding helps prevent low blood sugar</li>
        <li>Hospital staff will check baby's levels regularly</li>
      </ul>
      
      <h4>Nutrition for Breastfeeding</h4>
      <ul>
        <li><strong>Calories:</strong> Need extra 300-500 calories per day</li>
        <li><strong>Protein:</strong> Include protein with each meal and snack</li>
        <li><strong>Calcium:</strong> 1000mg daily (dairy, fortified foods)</li>
        <li><strong>Hydration:</strong> 10-12 glasses of water daily</li>
        <li><strong>Continue prenatal vitamins</strong> while breastfeeding</li>
      </ul>
      
      <h4>Common Concerns</h4>
      <p><strong>Q: Will metformin affect my milk?</strong></p>
      <p>A: Small amounts pass into milk but generally considered safe. Discuss with doctor.</p>
      
      <p><strong>Q: Can I still breastfeed if baby needs formula supplement?</strong></p>
      <p>A: Yes! Any amount of breastmilk is beneficial. Combination feeding is fine.</p>
      
      <p><strong>Q: How long should I breastfeed?</strong></p>
      <p>A: WHO recommends exclusive breastfeeding for 6 months, continued up to 2 years or beyond with complementary foods.</p>
      
      <h4>Tips for Success</h4>
      <ul>
        <li>Get professional help early if struggling</li>
        <li>Join breastfeeding support groups</li>
        <li>Rest and prioritize self-care</li>
        <li>Have partner help with other baby care</li>
        <li>Be patient - it gets easier after first few weeks</li>
        <li>Don't feel guilty if you need to supplement</li>
      </ul>
      
      <h4>Indian Cultural Considerations</h4>
      <ul>
        <li><strong>Traditional foods:</strong> Methi laddoos, almond milk generally fine in moderation</li>
        <li><strong>Post-delivery diet:</strong> Focus on nutritious foods, not overly rich/heavy items</li>
        <li><strong>Family support:</strong> Educate family about breastfeeding benefits</li>
        <li><strong>Working mothers:</strong> Know your rights to breastfeeding breaks</li>
      </ul>
      
      <p><strong>Remember:</strong> Breastfeeding is one of the best things you can do for both your health and your baby's health after GDM. Don't hesitate to ask for help!</p>
    `
  },
  
  'postpartum': {
    icon: '🌸',
    title: 'Postpartum Care & Follow-up',
    subtitle: 'After delivery and long-term health',
    content: `
      <h3>Life After GDM: Postpartum Care</h3>
      <p>GDM usually resolves after delivery, but proper follow-up is crucial for your long-term health.</p>
      
      <h4>Immediate Postpartum (First 48 Hours)</h4>
      <ul>
        <li><strong>Blood sugar monitoring:</strong> Continue for 24-48 hours</li>
        <li><strong>Stop diabetes medications:</strong> Usually no longer needed (unless pre-existing diabetes)</li>
        <li><strong>Normal eating:</strong> Can return to regular diet (but stay healthy!)</li>
        <li><strong>Baby monitoring:</strong> Your baby's glucose checked frequently</li>
        <li><strong>Start breastfeeding:</strong> Begin as soon as possible</li>
      </ul>
      
      <h4>First 6 Weeks Postpartum</h4>
      <ul>
        <li>Focus on recovery and newborn care</li>
        <li>Gradual return to physical activity</li>
        <li>Healthy eating (especially if breastfeeding)</li>
        <li>Watch for postpartum depression (higher risk with GDM)</li>
        <li>6-week postpartum checkup with OB/GYN</li>
      </ul>
      
      <h4>Critical: 6-12 Week Glucose Testing</h4>
      <p><strong>MUST DO: 75g OGTT at 6-12 weeks postpartum</strong></p>
      <p>This test determines if you:</p>
      <ul>
        <li><strong>Normal glucose tolerance</strong> - diabetes has resolved</li>
        <li><strong>Prediabetes</strong> - need lifestyle changes and monitoring</li>
        <li><strong>Type 2 diabetes</strong> - need treatment</li>
      </ul>
      
      <p><strong>Don't skip this test!</strong> 5-10% of women still have diabetes after delivery. Early detection is crucial.</p>
      
      <h4>Long-term Follow-up Schedule</h4>
      <ul>
        <li><strong>Years 1-2:</strong> HbA1c or fasting glucose every 6-12 months</li>
        <li><strong>Year 3 onwards:</strong> Screening every 1-3 years for life</li>
        <li><strong>Before next pregnancy:</strong> Test glucose control</li>
        <li><strong>After menopause:</strong> Continue annual screening</li>
      </ul>
      
      <h4>Preventing Type 2 Diabetes</h4>
      <p><strong>Your Risk:</strong> 50-70% chance of developing Type 2 diabetes within 10 years</p>
      
      <p><strong>How to Reduce Risk:</strong></p>
      <ul>
        <li><strong>Weight management:</strong> Return to pre-pregnancy weight or lose 5-10% of body weight</li>
        <li><strong>Breastfeed:</strong> Reduces risk by 30-50%</li>
        <li><strong>Exercise regularly:</strong> 150 minutes/week moderate activity</li>
        <li><strong>Healthy diet:</strong> Continue low-GI eating patterns</li>
        <li><strong>Annual screening:</strong> Early detection if diabetes develops</li>
        <li><strong>Metformin:</strong> May be prescribed for high-risk women</li>
      </ul>
      
      <h4>Mental Health & Emotional Wellbeing</h4>
      <p>Women with GDM have higher risk of postpartum depression:</p>
      <ul>
        <li>Stress from managing GDM during pregnancy</li>
        <li>Anxiety about future diabetes</li>
        <li>Guilt or feeling of failure</li>
        <li>Overwhelm from newborn care plus health concerns</li>
      </ul>
      
      <p><strong>Warning Signs of Postpartum Depression:</strong></p>
      <ul>
        <li>Feeling sad or crying frequently</li>
        <li>Loss of interest in activities</li>
        <li>Difficulty bonding with baby</li>
        <li>Severe anxiety or panic attacks</li>
        <li>Thoughts of harming yourself or baby</li>
      </ul>
      
      <p><strong>Seek help immediately if experiencing these symptoms</strong></p>
      
      <h4>Future Pregnancy Planning</h4>
      <ul>
        <li><strong>Wait at least 18 months:</strong> Allow body to recover</li>
        <li><strong>Pre-conception planning:</strong> Achieve healthy weight, test glucose</li>
        <li><strong>Early screening:</strong> First trimester testing in next pregnancy</li>
        <li><strong>Know your risk:</strong> 30-70% recurrence rate</li>
        <li><strong>Optimize health:</strong> Best prevention is healthy lifestyle</li>
      </ul>
      
      <h4>Advocacy for Your Health</h4>
      <ul>
        <li>Keep records of all GDM-related care</li>
        <li>Inform all future doctors about GDM history</li>
        <li>Don't let doctors dismiss your concerns</li>
        <li>Request regular screening even if asymptomatic</li>
        <li>Share information with daughters (genetic risk)</li>
      </ul>
      
      <h4>Resources for Ongoing Support</h4>
      <ul>
        <li>Join diabetes prevention programs</li>
        <li>Connect with other GDM moms</li>
        <li>Follow Indian Diabetes Association guidelines</li>
        <li>Use apps for tracking lifestyle habits</li>
        <li>Consider joining FOGSI support networks</li>
      </ul>
      
      <p><strong>Remember:</strong> Having GDM was not your fault, but your future health is in your hands. The habits you build now will benefit you for decades to come!</p>
    `
  },
  
  'emotional-health': {
    icon: '🧘‍♀️',
    title: 'Emotional & Mental Health',
    subtitle: 'Managing stress, anxiety, and wellbeing',
    content: `
      <h3>Your Mental and Emotional Wellbeing</h3>
      <p>A GDM diagnosis can trigger many emotions. Taking care of your mental health is just as important as managing blood sugar.</p>
      
      <h4>Common Emotional Responses</h4>
      <p><strong>Initial Diagnosis:</strong></p>
      <ul>
        <li><strong>Shock and disbelief:</strong> "This can't be happening to me"</li>
        <li><strong>Guilt:</strong> "What did I do wrong?" (Nothing! It's not your fault)</li>
        <li><strong>Fear:</strong> "Will my baby be okay?"</li>
        <li><strong>Overwhelm:</strong> "How will I manage all this?"</li>
        <li><strong>Anger:</strong> "Why me? This isn't fair!"</li>
      </ul>
      
      <p><strong>All of these feelings are normal and valid.</strong></p>
      
      <h4>Ongoing Challenges</h4>
      <ul>
        <li><strong>Diet restrictions:</strong> Feeling deprived, especially during celebrations</li>
        <li><strong>Constant monitoring:</strong> Finger pricks, appointments, tests</li>
        <li><strong>Social situations:</strong> Explaining your condition, dealing with judgment</li>
        <li><strong>Family pressure:</strong> Unsolicited advice, cultural conflicts</li>
        <li><strong>Worry about baby:</strong> Constant concern about baby's health</li>
        <li><strong>Fear of future:</strong> Developing Type 2 diabetes</li>
      </ul>
      
      <h4>Managing Stress and Anxiety</h4>
      <p><strong>Practical Techniques:</strong></p>
      <ul>
        <li><strong>Deep breathing:</strong> 4-7-8 technique (breathe in 4, hold 7, out 8)</li>
        <li><strong>Meditation:</strong> Even 5 minutes daily helps</li>
        <li><strong>Prenatal yoga:</strong> Physical and mental benefits</li>
        <li><strong>Journaling:</strong> Write your feelings and concerns</li>
        <li><strong>Progressive muscle relaxation:</strong> Tense and release muscle groups</li>
      </ul>
      
      <p><strong>Cognitive Strategies:</strong></p>
      <ul>
        <li>Focus on what you can control (diet, activity)</li>
        <li>Celebrate small victories (good glucose readings)</li>
        <li>Challenge negative thoughts with facts</li>
        <li>Practice self-compassion - be kind to yourself</li>
        <li>Set realistic expectations</li>
      </ul>
      
      <h4>Building Resilience</h4>
      <ul>
        <li><strong>Information is power:</strong> Learn about GDM from reliable sources</li>
        <li><strong>Build support network:</strong> Partner, family, friends, support groups</li>
        <li><strong>Maintain identity:</strong> You are more than your diagnosis</li>
        <li><strong>Find meaning:</strong> Taking care of yourself = taking care of baby</li>
        <li><strong>Stay present:</strong> One day, one meal, one reading at a time</li>
      </ul>
      
      <h4>When to Seek Professional Help</h4>
      <p><strong>See a mental health professional if you experience:</strong></p>
      <ul>
        <li>Persistent sadness or crying spells</li>
        <li>Loss of interest in activities you enjoyed</li>
        <li>Severe anxiety or panic attacks</li>
        <li>Difficulty sleeping beyond pregnancy-related issues</li>
        <li>Thoughts of harming yourself or baby</li>
        <li>Inability to function in daily life</li>
        <li>Extreme guilt or feelings of worthlessness</li>
      </ul>
      
      <p><strong>Therapy options safe during pregnancy:</strong></p>
      <ul>
        <li>Cognitive Behavioral Therapy (CBT)</li>
        <li>Mindfulness-based therapy</li>
        <li>Support groups (online or in-person)</li>
        <li>Counseling with perinatal psychologist</li>
      </ul>
      
      <h4>Partner and Family Support</h4>
      <p><strong>How others can help:</strong></p>
      <ul>
        <li>Listen without trying to "fix" everything</li>
        <li>Validate her feelings, don't minimize them</li>
        <li>Offer practical help (cooking, appointments)</li>
        <li>Learn about GDM together</li>
        <li>Encourage self-care activities</li>
        <li>Watch for signs of depression/anxiety</li>
      </ul>
      
      <h4>Self-Care Strategies</h4>
      <ul>
        <li><strong>Physical:</strong> Gentle exercise, adequate sleep, prenatal massage</li>
        <li><strong>Emotional:</strong> Talk to trusted friends, express feelings</li>
        <li><strong>Mental:</strong> Read positive birth stories, limit Dr. Google</li>
        <li><strong>Social:</strong> Maintain friendships, join support groups</li>
        <li><strong>Spiritual:</strong> Prayer, meditation, nature walks</li>
        <li><strong>Creative:</strong> Art, music, journaling, preparing nursery</li>
      </ul>
      
      <h4>Managing Guilt and Shame</h4>
      <p><strong>Remember these truths:</strong></p>
      <ul>
        <li>GDM is not caused by eating too much sugar</li>
        <li>It's a hormonal condition, not a personal failing</li>
        <li>You didn't do anything wrong</li>
        <li>Managing GDM makes you a caring, responsible mother</li>
        <li>Asking for help is strength, not weakness</li>
      </ul>
      
      <h4>Positive Affirmations</h4>
      <p>Try repeating these daily:</p>
      <ul>
        <li>"I am doing the best I can for my baby"</li>
        <li>"I am strong and capable"</li>
        <li>"This is temporary - I can handle this"</li>
        <li>"My baby is growing healthy inside me"</li>
        <li>"I deserve support and care"</li>
        <li>"I am more than my diagnosis"</li>
      </ul>
      
      <p><strong>Remember:</strong> Taking care of your mental health is not selfish - it's essential. A healthy, balanced mother is better for baby than a stressed, anxious one. Be gentle with yourself!</p>
    `
  },
  
  'work-life': {
    icon: '💼',
    title: 'Work and Daily Life Management',
    subtitle: 'Balancing GDM with work and routine',
    content: `
      <h3>Managing GDM at Work and in Daily Life</h3>
      <p>You can successfully manage GDM while maintaining your career and daily activities with some planning and adjustments.</p>
      
      <h4>Workplace Considerations</h4>
      <p><strong>Legal Rights (India):</strong></p>
      <ul>
        <li><strong>Maternity leave:</strong> 26 weeks paid leave for first 2 children (12 weeks for others)</li>
        <li><strong>Work-from-home option:</strong> Many companies now offer flexibility</li>
        <li><strong>Medical leave:</strong> For high-risk pregnancy complications</li>
        <li><strong>Reasonable accommodations:</strong> Request if needed for monitoring</li>
      </ul>
      
      <p><strong>When to Inform Your Employer:</strong></p>
      <ul>
        <li>Not legally required to disclose immediately</li>
        <li>Consider informing if you need accommodations</li>
        <li>Inform supervisor if you have frequent medical appointments</li>
        <li>Know that pregnancy discrimination is illegal</li>
      </ul>
      
      <h4>Practical Workplace Strategies</h4>
      <p><strong>Meal Management:</strong></p>
      <ul>
        <li><strong>Pack your own lunch:</strong> Control portions and ingredients</li>
        <li><strong>Keep healthy snacks:</strong> Nuts, fruits, yogurt in desk drawer</li>
        <li><strong>Office celebrations:</strong> Politely decline sweets, bring your own snack</li>
        <li><strong>Business lunches:</strong> Review menu ahead, make healthy choices</li>
        <li><strong>Set phone reminders:</strong> For meal and snack times</li>
      </ul>
      
      <p><strong>Glucose Monitoring at Work:</strong></p>
      <ul>
        <li><strong>Private space:</strong> Use restroom or quiet meeting room</li>
        <li><strong>Discrete testing:</strong> Modern meters are small and quick</li>
        <li><strong>Keep supplies:</strong> Extra strips, lancets, batteries at desk</li>
        <li><strong>Schedule breaks:</strong> For testing around meals</li>
      </ul>
      
      <p><strong>Managing Fatigue:</strong></p>
      <ul>
        <li>Take short breaks every 2 hours</li>
        <li>Walk around office periodically</li>
        <li>Stay hydrated (water bottle at desk)</li>
        <li>Adjust work hours if possible (start earlier, leave earlier)</li>
        <li>Prioritize sleep - adequate rest is crucial</li>
      </ul>
      
      <h4>Office Environment Modifications</h4>
      <ul>
        <li><strong>Ergonomic setup:</strong> Comfortable chair, footrest</li>
        <li><strong>Accessible restroom:</strong> Frequent urination is common</li>
        <li><strong>Temperature control:</strong> Pregnant women tend to feel warmer</li>
        <li><strong>Parking:</strong> Request closer parking spot if available</li>
        <li><strong>Elevators:</strong> Use instead of stairs when tired</li>
      </ul>
      
      <h4>Travel for Work</h4>
      <p><strong>If you must travel:</strong></p>
      <ul>
        <li><strong>Get doctor's clearance:</strong> Especially after 28 weeks</li>
        <li><strong>Pack all supplies:</strong> Double what you think you'll need</li>
        <li><strong>Research local facilities:</strong> Know where hospitals are</li>
        <li><strong>Carry medical records:</strong> Digital copy on phone</li>
        <li><strong>Pack healthy snacks:</strong> For plane/train</li>
        <li><strong>Move frequently:</strong> Walk on plane, stretch during drives</li>
      </ul>
      
      <h4>Managing Stress at Work</h4>
      <ul>
        <li><strong>Communicate boundaries:</strong> Don't overcommit</li>
        <li><strong>Delegate when possible:</strong> Not the time to be superwoman</li>
        <li><strong>Take full lunch break:</strong> Don't work through meals</li>
        <li><strong>Use relaxation apps:</strong> Quick meditation during breaks</li>
        <li><strong>Leave work at work:</strong> When possible</li>
      </ul>
      
      <h4>Social Situations</h4>
      <p><strong>Parties and Celebrations:</strong></p>
      <ul>
        <li><strong>Eat beforehand:</strong> Don't arrive hungry</li>
        <li><strong>Bring a dish:</strong> Something you can eat</li>
        <li><strong>Have a script ready:</strong> "I'm managing my pregnancy diet"</li>
        <li><strong>Focus on people:</strong> Not the food spread</li>
        <li><strong>Polite refusals:</strong> "It looks delicious but I'll pass, thank you"</li>
      </ul>
      
      <p><strong>Handling Questions and Comments:</strong></p>
      <ul>
        <li>"Why aren't you eating?" → "Following doctor's orders for a healthy pregnancy"</li>
        <li>"One piece won't hurt" → "I appreciate the offer but I have to be careful"</li>
        <li>"My cousin had GDM and..." → "Everyone's situation is different"</li>
        <li>"Are you sure you should work?" → "I'm managing well, thanks for your concern"</li>
      </ul>
      
      <h4>Daily Routine Optimization</h4>
      <p><strong>Morning Routine:</strong></p>
      <ul>
        <li>Test fasting glucose first thing</li>
        <li>Eat breakfast within 30 minutes of waking</li>
        <li>Pack lunch, snacks, testing supplies</li>
        <li>Take medications/insulin if prescribed</li>
      </ul>
      
      <p><strong>Evening Routine:</strong></p>
      <ul>
        <li>Plan next day's meals</li>
        <li>Review glucose log, note patterns</li>
        <li>Prep tomorrow's food if possible</li>
        <li>Gentle evening walk after dinner</li>
        <li>Relaxation before bed</li>
      </ul>
      
      <h4>Household Management</h4>
      <ul>
        <li><strong>Meal prep:</strong> Cook in batches on weekends</li>
        <li><strong>Delegate chores:</strong> Share with partner/family</li>
        <li><strong>Simplify:</strong> Now is not the time for perfection</li>
        <li><strong>Accept help:</strong> Let others support you</li>
        <li><strong>Grocery delivery:</strong> Use online services to save energy</li>
      </ul>
      
      <h4>Financial Planning</h4>
      <ul>
        <li>Budget for extra medical costs (testing supplies, appointments)</li>
        <li>Understand insurance coverage</li>
        <li>Plan for maternity leave financially</li>
        <li>Know your benefits (company health insurance)</li>
      </ul>
      
      <h4>When to Consider Modified Work or Leave</h4>
      <p>Discuss with doctor if you experience:</p>
      <ul>
        <li>Difficulty controlling blood sugar despite best efforts</li>
        <li>Other pregnancy complications (preeclampsia, bed rest)</li>
        <li>Extreme fatigue affecting work performance</li>
        <li>Very stressful work worsening glucose control</li>
        <li>Doctor recommends reducing stress/activity</li>
      </ul>
      
      <p><strong>Remember:</strong> Your health and baby's health are the priority. Don't feel guilty about making necessary accommodations at work or in your daily life. This is temporary, and you're doing an amazing job balancing it all!</p>
    `
  },
  
  'financial': {
    icon: '💰',
    title: 'Financial Considerations',
    subtitle: 'Costs, insurance, and resources',
    content: `
      <h3>Managing the Financial Aspect of GDM</h3>
      <p>GDM care involves additional expenses, but with planning and awareness of resources, you can manage costs effectively.</p>
      
      <h4>Expected Costs in India</h4>
      <p><strong>Testing and Monitoring Supplies:</strong></p>
      <ul>
        <li><strong>Glucometer:</strong> ₹500-₹2,500 (one-time cost)</li>
        <li><strong>Test strips:</strong> ₹800-₹1,500 per 50 strips (monthly)</li>
        <li><strong>Lancets:</strong> ₹100-₹300 per 100 (monthly)</li>
        <li><strong>OGTT test:</strong> ₹300-₹800</li>
        <li><strong>HbA1c test:</strong> ₹400-₹1,000 per test</li>
      </ul>
      
      <p><strong>Medical Consultations:</strong></p>
      <ul>
        <li><strong>OB/GYN visits:</strong> ₹500-₹2,000 per visit (weekly/bi-weekly in third trimester)</li>
        <li><strong>Endocrinologist:</strong> ₹800-₹2,500 per visit</li>
        <li><strong>Nutritionist/Dietitian:</strong> ₹500-₹2,000 per session</li>
        <li><strong>Diabetes educator:</strong> ₹500-₹1,500 per session</li>
      </ul>
      
      <p><strong>Medications (if needed):</strong></p>
      <ul>
        <li><strong>Insulin:</strong> ₹200-₹800 per vial/pen (monthly)</li>
        <li><strong>Metformin:</strong> ₹50-₹200 per month (if prescribed postpartum)</li>
        <li><strong>Syringes/pen needles:</strong> ₹100-₹300 per month</li>
      </ul>
      
      <p><strong>Additional Tests:</strong></p>
      <ul>
        <li><strong>Extra ultrasounds:</strong> ₹800-₹2,500 each</li>
        <li><strong>NST (Non-stress test):</strong> ₹500-₹1,500 per session</li>
        <li><strong>Biophysical profile:</strong> ₹1,500-₹3,000</li>
      </ul>
      
      <p><strong>Estimated Total Extra Cost:</strong></p>
      <ul>
        <li><strong>Diet-controlled GDM:</strong> ₹5,000-₹15,000 over pregnancy</li>
        <li><strong>Insulin-requiring GDM:</strong> ₹15,000-₹40,000 over pregnancy</li>
        <li><strong>Note:</strong> Costs vary widely by city and healthcare facility</li>
      </ul>
      
      <h4>Insurance Coverage</h4>
      <p><strong>Health Insurance in India:</strong></p>
      <ul>
        <li>Most policies cover pregnancy-related complications including GDM</li>
        <li><strong>Waiting period:</strong> Usually 2-4 years for maternity coverage</li>
        <li><strong>Coverage limits:</strong> ₹50,000-₹5,00,000 depending on plan</li>
        <li><strong>Check your policy:</strong> Specifically ask about GDM coverage</li>
      </ul>
      
      <p><strong>What's Typically Covered:</strong></p>
      <ul>
        <li>Hospitalization for delivery (normal or C-section)</li>
        <li>Prenatal consultations (some plans)</li>
        <li>Tests and investigations related to GDM</li>
        <li>Medications prescribed during hospital stay</li>
        <li>NICU care if baby needs it</li>
      </ul>
      
      <p><strong>What's Often NOT Covered:</strong></p>
      <ul>
        <li>Glucometer and home testing supplies</li>
        <li>Outpatient consultations (doctor visits)</li>
        <li>Take-home medications</li>
        <li>Nutritionist consultations</li>
      </ul>
      
      <p><strong>Tips for Insurance:</strong></p>
      <ul>
        <li>Get pre-authorization for planned procedures</li>
        <li>Keep all bills and prescriptions</li>
        <li>Submit claims promptly</li>
        <li>Understand your policy's sub-limits</li>
        <li>Consider upgrading coverage if planning pregnancy</li>
      </ul>
      
      <h4>Government Schemes & Support</h4>
      <p><strong>Pradhan Mantri Matru Vandana Yojana (PMMVY):</strong></p>
      <ul>
        <li>₹5,000 cash benefit for first living child</li>
        <li>Available to all pregnant and lactating mothers</li>
        <li>Apply at Anganwadi Center or online</li>
      </ul>
      
      <p><strong>Janani Suraksha Yojana (JSY):</strong></p>
      <ul>
        <li>Cash assistance for institutional delivery</li>
        <li>Particularly for BPL families</li>
        <li>₹1,400 in urban areas, ₹1,600 in rural areas</li>
      </ul>
      
      <p><strong>Ayushman Bharat (PM-JAY):</strong></p>
      <ul>
        <li>₹5 lakh health cover per family per year</li>
        <li>For poor and vulnerable families (bottom 40%)</li>
        <li>Covers secondary and tertiary hospitalization</li>
        <li>Check eligibility at your nearest health center</li>
      </ul>
      
      <p><strong>State-Specific Schemes:</strong></p>
      <ul>
        <li>Many states have additional maternity support programs</li>
        <li>Check with local health department</li>
        <li>Some provide free medicines and tests</li>
      </ul>
      
      <h4>Cost-Saving Strategies</h4>
      <p><strong>Testing Supplies:</strong></p>
      <ul>
        <li><strong>Generic brands:</strong> Often cheaper and equally accurate</li>
        <li><strong>Online purchase:</strong> Compare prices on Amazon, Flipkart, 1mg</li>
        <li><strong>Bulk buying:</strong> Test strips in bulk can save 20-30%</li>
        <li><strong>Prescription assistance:</strong> Some manufacturers offer discounts</li>
        <li><strong>Government facilities:</strong> Subsidized or free supplies at public hospitals</li>
      </ul>
      
      <p><strong>Medical Care:</strong></p>
      <ul>
        <li><strong>Public hospitals:</strong> Significantly cheaper than private</li>
        <li><strong>Charitable hospitals:</strong> Many offer subsidized care</li>
        <li><strong>Package deals:</strong> Some hospitals offer maternity packages</li>
        <li><strong>Generic medications:</strong> Ask doctor for generic prescriptions</li>
      </ul>
      
      <p><strong>Diet and Nutrition:</strong></p>
      <ul>
        <li>Healthy eating doesn't have to be expensive</li>
        <li>Seasonal local vegetables are affordable</li>
        <li>Dal, eggs are inexpensive protein sources</li>
        <li>Avoid expensive "diabetic" branded foods</li>
        <li>Cook at home vs. ordering out</li>
      </ul>
      
      <h4>Workplace Benefits</h4>
      <ul>
        <li><strong>Group health insurance:</strong> Better coverage than individual plans</li>
        <li><strong>Maternity benefits:</strong> Paid leave as per law</li>
        <li><strong>Employer health programs:</strong> Some companies offer health coaching</li>
        <li><strong>Flexible spending accounts:</strong> In some MNCs</li>
      </ul>
      
      <h4>Financial Planning Tips</h4>
      <ul>
        <li><strong>Budget early:</strong> Plan for extra GDM costs</li>
        <li><strong>Emergency fund:</strong> Save for unexpected complications</li>
        <li><strong>Prioritize essentials:</strong> Testing supplies over "nice-to-haves"</li>
        <li><strong>Track expenses:</strong> Monitor what you're spending</li>
        <li><strong>Discuss with partner:</strong> Shared financial planning</li>
      </ul>
      
      <h4>Free or Low-Cost Resources</h4>
      <ul>
        <li><strong>Government hospitals:</strong> Free antenatal care</li>
        <li><strong>PHCs and CHCs:</strong> Basic testing and care</li>
        <li><strong>Medical college hospitals:</strong> Affordable specialist care</li>
        <li><strong>NGO clinics:</strong> Some offer free or subsidized care</li>
        <li><strong>Online resources:</strong> Free education materials (ICMR, WHO)</li>
        <li><strong>Support groups:</strong> Peer support at no cost</li>
      </ul>
      
      <h4>Tax Benefits</h4>
      <ul>
        <li>Medical expenses can be claimed under Section 80D</li>
        <li>Preventive health checkups (₹5,000 limit)</li>
        <li>Keep all medical bills for tax filing</li>
        <li>Maternity expenses deductible in some cases</li>
      </ul>
      
      <p><strong>Remember:</strong> Don't compromise on essential care due to cost concerns. Untreated GDM can lead to complications that are far more expensive. Explore all available resources and schemes. Your health and baby's health are priceless!</p>
    `
  },
  
  'technology': {
    icon: '📱',
    title: 'Technology and Resources',
    subtitle: 'Apps, tools, and reliable information',
    content: `
      <h3>Technology Tools for GDM Management</h3>
      <p>Modern technology can make managing GDM easier, more convenient, and more effective.</p>
      
      <h4>Glucose Monitoring Apps</h4>
      <p><strong>Popular Apps in India:</strong></p>
      <ul>
        <li><strong>mySugr:</strong> User-friendly tracking, cloud sync, reports for doctor</li>
        <li><strong>Glucose Buddy:</strong> Tracks glucose, meals, medications, exercise</li>
        <li><strong>Diabetes:M:</strong> Comprehensive tracking with insulin calculator</li>
        <li><strong>BeatO:</strong> Indian app with dietitian consultation option</li>
        <li><strong>Health Mate (Nokia):</strong> Integrates with smart scales and devices</li>
      </ul>
      
      <p><strong>Features to Look For:</strong></p>
      <ul>
        <li>Easy glucose entry (manual or meter sync)</li>
        <li>Meal and carb tracking</li>
        <li>Medication/insulin logging</li>
        <li>Graphs and trend analysis</li>
        <li>Exportable reports for doctor</li>
        <li>Reminders for testing and medications</li>
        <li>Cloud backup</li>
      </ul>
      
      <h4>Pregnancy and GDM Apps</h4>
      <ul>
        <li><strong>Ovia Pregnancy:</strong> Tracks pregnancy + has GDM section</li>
        <li><strong>BabyCenter:</strong> Week-by-week pregnancy info with GDM articles</li>
        <li><strong>Pregnancy+:</strong> Comprehensive pregnancy tracker</li>
        <li><strong>What to Expect:</strong> Daily articles and pregnancy tracking</li>
      </ul>
      
      <h4>Diet and Nutrition Apps</h4>
      <ul>
        <li><strong>MyFitnessPal:</strong> Extensive Indian food database, carb tracking</li>
        <li><strong>HealthifyMe:</strong> Indian app with Indian foods, AI nutritionist</li>
        <li><strong>Fitterfly:</strong> Specifically designed for diabetes management in India</li>
        <li><strong>GI Glycemic Index:</strong> Search GI values of foods</li>
      </ul>
      
      <h4>Exercise and Activity Apps</h4>
      <ul>
        <li><strong>Google Fit / Apple Health:</strong> Auto-tracks steps and activity</li>
        <li><strong>Prenatal Yoga by Down Dog:</strong> Customized prenatal yoga</li>
        <li><strong>Pregnancy Workouts:</strong> Safe exercises for each trimester</li>
        <li><strong>7 Minute Workout:</strong> Quick, effective workouts</li>
      </ul>
      
      <h4>Smart Glucometers</h4>
      <p><strong>Bluetooth-Enabled Meters (Available in India):</strong></p>
      <ul>
        <li><strong>Accu-Chek Instant:</strong> ₹1,000-₹1,500, syncs with mySugr app</li>
        <li><strong>OneTouch Verio Flex:</strong> Syncs with OneTouch Reveal app</li>
        <li><strong>Contour Next One:</strong> Smart connectivity features</li>
      </ul>
      
      <p><strong>Benefits:</strong></p>
      <ul>
        <li>Automatic data transfer (no manual entry)</li>
        <li>Better pattern recognition</li>
        <li>Easy to share data with doctor</li>
        <li>Less chance of logging errors</li>
      </ul>
      
      <h4>Continuous Glucose Monitors (CGM)</h4>
      <p><strong>Available but Expensive in India:</strong></p>
      <ul>
        <li><strong>FreeStyle Libre:</strong> ₹3,500-₹5,000 per sensor (14 days)</li>
        <li>Worn on arm, scans for readings</li>
        <li>No finger pricks needed</li>
        <li>Shows glucose trends and patterns</li>
        <li>Usually not covered by insurance for GDM</li>
        <li>Consider if frequent hypoglycemia or difficulty controlling</li>
      </ul>
      
      <h4>Meal Planning Tools</h4>
      <ul>
        <li><strong>Diabetes Plate Method app:</strong> Visual portion guide</li>
        <li><strong>Carb Counter:</strong> Indian food carb database</li>
        <li><strong>Recipe apps:</strong> Filter for low-carb, diabetic-friendly</li>
        <li><strong>Pinterest:</strong> Search "GDM Indian recipes"</li>
      </ul>
      
      <h4>Telemedicine Platforms</h4>
      <p>For remote consultations:</p>
      <ul>
        <li><strong>Practo:</strong> Book video consultations with endocrinologists, OB/GYNs</li>
        <li><strong>Apollo 24/7:</strong> Tele-consults with specialists</li>
        <li><strong>Tata 1mg:</strong> Online doctor consultations and medicine delivery</li>
        <li><strong>DocsApp:</strong> Chat or call with doctors</li>
        <li><strong>MFine:</strong> Video consultations and lab tests</li>
      </ul>
      
      <h4>Reliable Online Resources</h4>
      <p><strong>Official Medical Guidelines:</strong></p>
      <ul>
        <li><strong>ICMR (Indian Council of Medical Research):</strong> Indian-specific guidelines</li>
        <li><strong>WHO (World Health Organization):</strong> Global standards</li>
        <li><strong>ACOG (American College of Obstetricians):</strong> Evidence-based info</li>
        <li><strong>FOGSI (Federation of Obstetric & Gynecological Societies of India):</strong> Indian context</li>
        <li><strong>Diabetes India:</strong> Resources in Indian context</li>
      </ul>
      
      <p><strong>Educational Websites:</strong></p>
      <ul>
        <li><strong>CDC Diabetes in Pregnancy:</strong> Comprehensive, reliable</li>
        <li><strong>Mayo Clinic:</strong> Medically reviewed articles</li>
        <li><strong>WebMD:</strong> General health information</li>
        <li><strong>BabyCenter India:</strong> India-specific pregnancy info</li>
      </ul>
      
      <p><strong>Support Communities:</strong></p>
      <ul>
        <li><strong>Reddit r/GestationalDiabetes:</strong> Active global community</li>
        <li><strong>Facebook GDM groups:</strong> Search "Gestational Diabetes India"</li>
        <li><strong>BabyCenter forums:</strong> Pregnancy and GDM discussions</li>
        <li><strong>What to Expect community:</strong> Connect with other moms</li>
      </ul>
      
      <h4>YouTube Channels</h4>
      <ul>
        <li>Search: "Gestational Diabetes Indian diet"</li>
        <li>Search: "GDM meal ideas"</li>
        <li>Search: "Prenatal exercise GDM"</li>
        <li>Verify source credentials before following advice</li>
      </ul>
      
      <h4>Smart Scales</h4>
      <ul>
        <li>Track weight gain (important in GDM)</li>
        <li>Some measure body composition</li>
        <li>Sync data to phone apps</li>
        <li>Withings, Xiaomi, HealthSense available in India</li>
      </ul>
      
      <h4>Reminders and Organization</h4>
      <ul>
        <li><strong>Google Calendar:</strong> Set reminders for testing, appointments, medications</li>
        <li><strong>Alarmed or Medisafe:</strong> Medication reminder apps</li>
        <li><strong>Evernote or OneNote:</strong> Keep all GDM notes, questions for doctor</li>
        <li><strong>Google Keep:</strong> Quick notes, shopping lists</li>
      </ul>
      
      <h4>Warning About Dr. Google</h4>
      <p><strong>Be Cautious:</strong></p>
      <ul>
        <li>Not all online information is accurate</li>
        <li>Avoid random blogs and unverified sources</li>
        <li>Don't self-diagnose complications</li>
        <li>Stick to medical organizations and peer-reviewed sources</li>
        <li>When in doubt, ask your doctor</li>
        <li>Facebook comments are not medical advice</li>
      </ul>
      
      <h4>Data Privacy</h4>
      <ul>
        <li>Read app privacy policies</li>
        <li>Understand what data is collected and shared</li>
        <li>Use secure passwords</li>
        <li>Enable two-factor authentication where available</li>
        <li>Be cautious sharing health data on social media</li>
      </ul>
      
      <h4>Digital Wellbeing</h4>
      <ul>
        <li>Use technology to help, not increase anxiety</li>
        <li>Limit obsessive data checking</li>
        <li>Avoid comparing yourself to others online</li>
        <li>Take breaks from health tracking if overwhelming</li>
        <li>Focus on real-life support in addition to online</li>
      </ul>
      
      <p><strong>Remember:</strong> Technology is a tool to support your GDM management, not replace your healthcare team. Use apps and devices that genuinely help you, but don't feel pressured to use everything. Find what works for you!</p>
    `
  },
  
  'delivery': {
    icon: '🏥',
    title: 'Labor and Delivery Preparation',
    subtitle: 'What to expect and how to plan',
    content: `
      <h3>Preparing for Delivery with GDM</h3>
      <p>Having GDM doesn't mean you can't have a normal, healthy delivery. With proper planning and monitoring, most women with well-controlled GDM deliver healthy babies.</p>
      
      <h4>Timing of Delivery</h4>
      <p><strong>Well-Controlled GDM (Diet only):</strong></p>
      <ul>
        <li>Target delivery: <strong>39-40 weeks</strong> (full term)</li>
        <li>Same as women without GDM</li>
        <li>Can wait for spontaneous labor if all is well</li>
        <li>Reduced risk of complications at full term</li>
      </ul>
      
      <p><strong>Insulin-Requiring GDM:</strong></p>
      <ul>
        <li>Often recommended: <strong>38-39 weeks</strong></li>
        <li>May be induced slightly earlier</li>
        <li>Balances baby's maturity with complication risks</li>
        <li>Decision based on glucose control and baby's condition</li>
      </ul>
      
      <p><strong>Poorly Controlled GDM or Complications:</strong></p>
      <ul>
        <li>May deliver as early as <strong>37-38 weeks</strong></li>
        <li>If macrosomia (very large baby > 4.5 kg)</li>
        <li>If polyhydramnios (excess amniotic fluid)</li>
        <li>If maternal complications develop</li>
      </ul>
      
      <h4>Mode of Delivery</h4>
      <p><strong>Vaginal Delivery:</strong></p>
      <ul>
        <li><strong>Preferred if possible</strong> for well-controlled GDM</li>
        <li>Many women with GDM deliver vaginally successfully</li>
        <li>Faster recovery for mother</li>
        <li>Lower risk of infection</li>
        <li>GDM alone is not a reason for C-section</li>
      </ul>
      
      <p><strong>When C-Section May Be Recommended:</strong></p>
      <ul>
        <li><strong>Macrosomia:</strong> Estimated baby weight > 4.5 kg</li>
        <li><strong>Shoulder dystocia risk:</strong> Baby's shoulders may get stuck</li>
        <li><strong>Previous C-section:</strong> Depending on circumstances</li>
        <li><strong>Other complications:</strong> Unrelated to GDM (e.g., placenta previa)</li>
        <li><strong>Maternal request:</strong> After discussion of risks/benefits</li>
      </ul>
      
      <h4>Induction of Labor</h4>
      <p>You may be offered induction if:</p>
      <ul>
        <li>Reaching recommended delivery week without spontaneous labor</li>
        <li>Baby measuring very large</li>
        <li>Worsening glucose control</li>
        <li>Developing preeclampsia or other complications</li>
      </ul>
      
      <p><strong>Methods of Induction:</strong></p>
      <ul>
        <li><strong>Membrane sweep:</strong> Doctor stretches cervix</li>
        <li><strong>Prostaglandin gel:</strong> Softens and opens cervix</li>
        <li><strong>Balloon catheter:</strong> Mechanical dilation</li>
        <li><strong>Breaking water:</strong> If cervix already dilated</li>
        <li><strong>Pitocin (oxytocin):</strong> IV to start contractions</li>
      </ul>
      
      <h4>Managing Glucose During Labor</h4>
      <p><strong>Diet-Controlled GDM:</strong></p>
      <ul>
        <li>May not need any special interventions</li>
        <li>Glucose checked periodically during labor</li>
        <li>IV fluids may be glucose-free</li>
        <li>Most women maintain normal levels</li>
      </ul>
      
      <p><strong>Insulin-Requiring GDM:</strong></p>
      <ul>
        <li><strong>Stop long-acting insulin</strong> morning of induction/labor</li>
        <li><strong>Hourly glucose checks</strong> during active labor</li>
        <li><strong>IV insulin</strong> if levels rise (rare during labor)</li>
        <li><strong>IV dextrose</strong> if levels drop too low</li>
        <li>Goal: Keep glucose 70-120 mg/dL during labor</li>
      </ul>
      
      <h4>Monitoring During Labor</h4>
      <p><strong>For Mother:</strong></p>
      <ul>
        <li>Continuous or frequent blood pressure monitoring</li>
        <li>Blood glucose checks every 1-2 hours</li>
        <li>Standard labor monitoring (contractions, dilation)</li>
        <li>IV access for fluids/medications if needed</li>
      </ul>
      
      <p><strong>For Baby:</strong></p>
      <ul>
        <li><strong>Continuous fetal monitoring:</strong> Heart rate tracked throughout</li>
        <li>Watching for signs of distress</li>
        <li>Ultrasound if concerns about position or fluid</li>
        <li>Pediatrician may be present at delivery</li>
      </ul>
      
      <h4>What to Pack for Hospital</h4>
      <p><strong>GDM-Specific Items:</strong></p>
      <ul>
        <li>Glucose meter and test strips (backup)</li>
        <li>Insulin and supplies (if applicable)</li>
        <li>Healthy snacks for after delivery</li>
        <li>List of all medications and doses</li>
        <li>Medical records (digital copy on phone)</li>
      </ul>
      
      <p><strong>General Maternity Items:</strong></p>
      <ul>
        <li>Comfortable clothes for labor</li>
        <li>Nursing bras and pads</li>
        <li>Toiletries and personal care items</li>
        <li>Baby clothes and diapers</li>
        <li>Car seat (for hospital discharge)</li>
      </ul>
      
      <h4>Immediately After Delivery</h4>
      <p><strong>For Mother:</strong></p>
      <ul>
        <li><strong>Glucose typically normalizes immediately</strong></li>
        <li><strong>Stop all diabetes medications</strong> (unless pre-existing diabetes)</li>
        <li>Glucose checked 1-2 times in first 24 hours</li>
        <li>Can eat normally (yay!)</li>
        <li>May feel suddenly much better</li>
      </ul>
      
      <p><strong>For Baby:</strong></p>
      <ul>
        <li><strong>Glucose checked</strong> within first 1-2 hours</li>
        <li>Risk of hypoglycemia (low blood sugar)</li>
        <li><strong>Early, frequent feeding</strong> helps prevent low glucose</li>
        <li>May need IV glucose if levels very low</li>
        <li>Usually resolves within 24-48 hours</li>
        <li>Checked for jaundice (more common with GDM)</li>
      </ul>
      
      <h4>Hospital Stay</h4>
      <ul>
        <li><strong>Vaginal delivery:</strong> 24-48 hour stay</li>
        <li><strong>C-section:</strong> 3-4 day stay</li>
        <li>Baby monitored closely for first 24 hours</li>
        <li>Breastfeeding support provided</li>
        <li>Postpartum glucose testing before discharge</li>
      </ul>
      
      <h4>Birth Plan Considerations</h4>
      <p><strong>Discuss with Your Doctor:</strong></p>
      <ul>
        <li>Preferred delivery timing</li>
        <li>Pain management preferences</li>
        <li>Continuous vs. intermittent monitoring</li>
        <li>Immediate skin-to-skin contact</li>
        <li>Delayed cord clamping (if appropriate)</li>
        <li>Who will be in delivery room</li>
        <li>Infant feeding plans</li>
      </ul>
      
      <p><strong>Be Flexible:</strong></p>
      <ul>
        <li>Plans may need to change based on circumstances</li>
        <li>Trust your medical team</li>
        <li>Focus on safe delivery over "perfect" experience</li>
      </ul>
      
      <h4>Questions to Ask Your Doctor</h4>
      <ul>
        <li>What week do you recommend delivery?</li>
        <li>Will you induce or wait for natural labor?</li>
        <li>What are signs I should go to hospital?</li>
        <li>Will I need continuous monitoring?</li>
        <li>How will my glucose be managed during labor?</li>
        <li>Will a pediatrician be present at delivery?</li>
        <li>What happens to baby immediately after birth?</li>
        <li>When can I breastfeed?</li>
      </ul>
      
      <h4>Emergency Situations</h4>
      <p><strong>Go to Hospital Immediately If:</strong></p>
      <ul>
        <li>Water breaks (especially before 37 weeks)</li>
        <li>Regular contractions (5 minutes apart)</li>
        <li>Severe abdominal pain</li>
        <li>Heavy vaginal bleeding</li>
        <li>Severe headache with vision changes</li>
        <li>Baby's movement significantly decreases</li>
        <li>High blood pressure symptoms</li>
      </ul>
      
      <h4>Partner's Role</h4>
      <ul>
        <li>Know the birth plan and mother's preferences</li>
        <li>Help track contractions</li>
        <li>Provide emotional support</li>
        <li>Advocate for mother's needs</li>
        <li>Help with glucose testing if needed</li>
        <li>Be flexible and calm</li>
        <li>Support breastfeeding immediately after birth</li>
      </ul>
      
      <p><strong>Remember:</strong> Every delivery is different. While GDM requires extra monitoring, thousands of women with GDM have safe, healthy deliveries every day. Trust your medical team, stay positive, and know that meeting your baby makes it all worthwhile!</p>
    `

  }
};

// Initialize glucose meter animation
function initGlucoseMeter() {
  const reading = document.getElementById('glucoseReading');
  const fill = document.getElementById('meterFill');
  
  if (reading && fill) {
    let value = 70;
    const targetValue = 95;
    
    const interval = setInterval(() => {
      if (value < targetValue) {
        value += 1;
        reading.textContent = value;
        fill.style.width = (value / 200 * 100) + '%';
      } else {
        clearInterval(interval);
      }
    }, 30);
  }
}

// Scroll to sections
function scrollToJourney() {
  document.getElementById('journey').scrollIntoView({ behavior: 'smooth' });
}

// Show stage details
function showStageDetails(stage) {
  const stageData = {
    'first': {
      title: 'First Trimester Details',
      content: 'Foundation period with focus on healthy habits and early screening for high-risk women...'
    },
    'second': {
      title: 'Second Trimester Details',
      content: 'GDM screening at 24-28 weeks, diagnosis, and beginning management...'
    },
    'third': {
      title: 'Third Trimester Details',
      content: 'Intensive monitoring, insulin adjustment, and delivery preparation...'
    },
    'postpartum': {
      title: 'Postpartum Care',
      content: 'Recovery, glucose testing, and long-term health planning...'
    }
  };
  
  // Could open a modal or expand section here
  console.log('Showing stage:', stage);
}

// Open topic panel
function openTopicPanel(topicId) {
  const panel = document.getElementById('topicPanel');
  const backdrop = document.getElementById('backdrop');
  const panelIcon = document.getElementById('panelIcon');
  const panelTitle = document.getElementById('panelTitle');
  const panelSubtitle = document.getElementById('panelSubtitle');
  const panelContent = document.getElementById('panelContent');
  
  const topic = topicContent[topicId];
  
  if (topic) {
    panelIcon.textContent = topic.icon;
    panelTitle.textContent = topic.title;
    panelSubtitle.textContent = topic.subtitle;
    panelContent.innerHTML = topic.content;
    
    panel.classList.add('active');
    backdrop.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
}

// Close topic panel
function closeTopicPanel() {
  const panel = document.getElementById('topicPanel');
  const backdrop = document.getElementById('backdrop');
  
  panel.classList.remove('active');
  backdrop.classList.remove('active');
  document.body.style.overflow = 'auto';
}

// Meal planner functions
function addToPlate(element, type) {
  element.style.transform = 'scale(0.95)';
  setTimeout(() => {
    element.style.transform = 'scale(1)';
  }, 200);
  
  // Update nutrition summary
  document.getElementById('glucoseImpact').textContent = 'Low';
  document.getElementById('fiberContent').textContent = 'High';
}

function showWarning(element) {
  alert('⚠️ This food should be limited or avoided with GDM. It can cause rapid blood sugar spikes.');
}

// Quiz functionality
function openQuiz() {
  const modal = document.getElementById('quizModal');
  const content = document.getElementById('quizContent');
  
  content.innerHTML = `
    <div style="text-align: center; padding: 2rem;">
      <h3>Coming Soon!</h3>
      <p>Interactive quiz to test your GDM knowledge</p>
    </div>
  `;
  
  modal.classList.add('active');
}

function closeQuiz() {
  const modal = document.getElementById('quizModal');
  modal.classList.remove('active');
}

// Initialize glucose chart
function initGlucoseChart() {
  const canvas = document.getElementById('glucoseChart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;
  
  // Clear canvas
  ctx.clearRect(0, 0, width, height);
  
  // Draw chart background
  ctx.fillStyle = '#f5f7fa';
  ctx.fillRect(0, 0, width, height);
  
  // Draw target zone
  ctx.fillStyle = 'rgba(16, 172, 132, 0.1)';
  ctx.fillRect(0, height * 0.4, width, height * 0.3);
  
  // Draw sample glucose curve
  ctx.strokeStyle = '#ff6b9d';
  ctx.lineWidth = 3;
  ctx.beginPath();
  
  const points = [
    {x: 0, y: 0.6},
    {x: 0.2, y: 0.5},
    {x: 0.4, y: 0.3},
    {x: 0.6, y: 0.4},
    {x: 0.8, y: 0.5},
    {x: 1, y: 0.6}
  ];
  
  points.forEach((point, index) => {
    const x = point.x * width;
    const y = point.y * height;
    if (index === 0) {
      ctx.moveTo(x, y);
    } else {
      ctx.lineTo(x, y);
    }
  });
  
  ctx.stroke();
  
  // Add labels
  ctx.fillStyle = '#555';
  ctx.font = '14px Manrope';
  ctx.fillText('Fasting', 50, height - 20);
  ctx.fillText('After Breakfast', width/2 - 50, height - 20);
  ctx.fillText('Target Range', width - 100, height * 0.55);
}

// Initialize all interactive elements
document.addEventListener('DOMContentLoaded', function() {
  initGlucoseMeter();
  initGlucoseChart();
  
});


// Handle escape key for closing panels
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeTopicPanel();
    closeQuiz();
  }
});

// Smooth scroll behavior
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({
        behavior: 'smooth',
        block: 'start'
      });
    }
  });
});

// ================================
// BODY SIMULATION & LIVE METRICS
// ================================

let currentScenario = 'fasting';
let simulationTimer = null;
let timeElapsed = 0;
let glucoseTrendData = [];

// Scenario configurations
const scenarios = {
  'fasting': {
    title: 'Fasting State',
    description: 'Your body is using stored glucose for energy. Insulin levels are low, and the liver releases glucose to maintain blood sugar levels.',
    glucose: 95,
    insulin: 45,
    hpl: 75,
    cortisol: 60,
    progesterone: 80,
    resistance: 65,
    pancreasStatus: 'Resting',
    liverStatus: 'Releasing Glucose',
    placentaStatus: 'Producing Hormones',
    pancreasActivity: 'Low',
    energyProduction: 'Normal',
    babyGlucose: 'Optimal',
    metabolicStatus: 'Compensating',
    metabolicBar: 65,
    lastEvent: 'Fasting started'
  },
  'after-meal': {
    title: 'After Meal',
    description: 'You just ate a meal. Glucose is entering your bloodstream, triggering insulin release. However, pregnancy hormones are blocking some insulin action, causing higher glucose levels.',
    glucose: 145,
    insulin: 85,
    hpl: 90,
    cortisol: 70,
    progesterone: 85,
    resistance: 85,
    pancreasStatus: 'Working Hard',
    liverStatus: 'Storing Glucose',
    placentaStatus: 'High Hormone Output',
    pancreasActivity: 'Very High',
    energyProduction: 'Elevated',
    babyGlucose: 'Slightly High',
    metabolicStatus: 'Stressed',
    metabolicBar: 45,
    lastEvent: 'Meal consumed 30 min ago'
  },
  'exercise': {
    title: 'During Exercise',
    description: 'Physical activity helps! Your muscles are using glucose for energy without needing insulin. This naturally lowers blood sugar and improves insulin sensitivity.',
    glucose: 105,
    insulin: 50,
    hpl: 70,
    cortisol: 75,
    progesterone: 80,
    resistance: 45,
    pancreasStatus: 'Moderate Activity',
    liverStatus: 'Providing Energy',
    placentaStatus: 'Normal Activity',
    pancreasActivity: 'Moderate',
    energyProduction: 'High (Muscle Usage)',
    babyGlucose: 'Optimal',
    metabolicStatus: 'Improving',
    metabolicBar: 75,
    lastEvent: 'Exercise started 15 min ago'
  },
  'insulin': {
    title: 'After Insulin Dose',
    description: 'Insulin medication is helping glucose enter cells. Blood sugar is decreasing to healthy levels. The pancreas can take a break from overworking.',
    glucose: 100,
    insulin: 95,
    hpl: 75,
    cortisol: 60,
    progesterone: 80,
    resistance: 55,
    pancreasStatus: 'Resting (Insulin Helping)',
    liverStatus: 'Normal Activity',
    placentaStatus: 'Balanced',
    pancreasActivity: 'Supported',
    energyProduction: 'Normal',
    babyGlucose: 'Optimal',
    metabolicStatus: 'Controlled',
    metabolicBar: 85,
    lastEvent: 'Insulin injected 1 hour ago'
  }
};

// Set simulation scenario
function setSimulationScenario(scenario) {
  currentScenario = scenario;
  
  // Update button states
  document.querySelectorAll('.sim-btn').forEach(btn => btn.classList.remove('active'));
  document.getElementById(`btn-${scenario}`).classList.add('active');
  
  // Get scenario data
  const data = scenarios[scenario];
  
  // Update all metrics
  animateValue('currentGlucose', parseInt(document.getElementById('currentGlucose').textContent), data.glucose, 1000);
  animateValue('resistancePercent', parseInt(document.getElementById('resistancePercent').textContent), data.resistance, 1000);
  
  // Update glucose status
  const glucoseStatus = document.getElementById('glucoseStatus');
  if (data.glucose < 95) {
    glucoseStatus.textContent = 'Target Range';
    glucoseStatus.style.background = 'rgba(16, 172, 132, 0.1)';
    glucoseStatus.style.color = '#10ac84';
  } else if (data.glucose < 140) {
    glucoseStatus.textContent = 'Slightly High';
    glucoseStatus.style.background = 'rgba(243, 156, 18, 0.1)';
    glucoseStatus.style.color = '#f39c12';
  } else {
    glucoseStatus.textContent = 'Above Target';
    glucoseStatus.style.background = 'rgba(238, 90, 111, 0.1)';
    glucoseStatus.style.color = '#ee5a6f';
  }
  
  // Update hormones
  updateBar('hplBar', 'hplValue', data.hpl);
  updateBar('cortisolBar', 'cortisolValue', data.cortisol);
  updateBar('progesteroneBar', 'progesteroneValue', data.progesterone);
  updateBar('insulinBar', 'insulinValue', data.insulin);
  
  // Update organ statuses
  document.getElementById('pancreasStatus').textContent = data.pancreasStatus;
  document.getElementById('liverStatus').textContent = data.liverStatus;
  document.getElementById('placentaStatus').textContent = data.placentaStatus;
  
  // Update quick stats
  document.getElementById('bloodGlucose').textContent = `${data.glucose} mg/dL`;
  document.getElementById('pancreasActivity').textContent = data.pancreasActivity;
  document.getElementById('energyProduction').textContent = data.energyProduction;
  document.getElementById('babyGlucose').textContent = data.babyGlucose;
  
  // Update metabolic status
  document.getElementById('metabolicStatus').textContent = data.metabolicStatus;
  document.getElementById('metabolicBar').style.width = data.metabolicBar + '%';
  
  if (data.metabolicBar > 70) {
    document.getElementById('metabolicStatus').className = 'system-status status-good';
    document.getElementById('metabolicBar').style.background = '#10ac84';
  } else {
    document.getElementById('metabolicStatus').className = 'system-status status-warning';
    document.getElementById('metabolicBar').style.background = '#f39c12';
  }
  
  // Update scenario description
  document.getElementById('scenarioTitle').textContent = data.title;
  document.getElementById('scenarioDesc').textContent = data.description;
  document.getElementById('lastEvent').textContent = data.lastEvent;
  
  // Update resistance label
  const resistanceLabel = document.getElementById('resistanceLabel');
  if (data.resistance < 50) {
    resistanceLabel.textContent = 'Low';
  } else if (data.resistance < 75) {
    resistanceLabel.textContent = 'Moderate';
  } else {
    resistanceLabel.textContent = 'High';
  }
  
  // Reset timer
  timeElapsed = 0;
  updateTimeDisplay();
  
  // Redraw charts
  drawResistanceGauge(data.resistance);
  updateGlucoseTrend(data.glucose);
  
  // Animate particles based on scenario
  animateParticles(scenario);
  
  // Redraw body simulation
  drawBodySimulation(scenario);

  updateBodySimulation(scenario);
}

// Animate a value change
function animateValue(elementId, start, end, duration) {
  const element = document.getElementById(elementId);
  const range = end - start;
  const increment = range / (duration / 16);
  let current = start;
  
  const timer = setInterval(() => {
    current += increment;
    if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
      current = end;
      clearInterval(timer);
    }
    element.textContent = Math.round(current);
  }, 16);
}

// Update a bar chart
function updateBar(barId, valueId, percent) {
  const bar = document.getElementById(barId);
  const value = document.getElementById(valueId);
  
  setTimeout(() => {
    bar.style.width = percent + '%';
    value.textContent = percent + '%';
  }, 100);
}

// Draw resistance gauge
function drawResistanceGauge(percent) {
  const canvas = document.getElementById('resistanceGauge');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2 + 20;
  const radius = 70;
  
  // Clear canvas
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // Background arc
  ctx.beginPath();
  ctx.arc(centerX, centerY, radius, Math.PI, 2 * Math.PI);
  ctx.lineWidth = 15;
  ctx.strokeStyle = '#e0e0e0';
  ctx.stroke();
  
  // Colored arc based on percentage
  const angle = Math.PI + (Math.PI * (percent / 100));
  ctx.beginPath();
  ctx.arc(centerX, centerY, radius, Math.PI, angle);
  ctx.lineWidth = 15;
  
  // Color gradient based on resistance level
  const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
  if (percent < 50) {
    gradient.addColorStop(0, '#10ac84');
    gradient.addColorStop(1, '#26de81');
  } else if (percent < 75) {
    gradient.addColorStop(0, '#f39c12');
    gradient.addColorStop(1, '#feca57');
  } else {
    gradient.addColorStop(0, '#ff6b9d');
    gradient.addColorStop(1, '#ee5a6f');
  }
  
  ctx.strokeStyle = gradient;
  ctx.lineCap = 'round';
  ctx.stroke();
}

// Update glucose trend chart
function updateGlucoseTrend(newValue) {
  glucoseTrendData.push(newValue);
  if (glucoseTrendData.length > 10) {
    glucoseTrendData.shift();
  }
  
  drawGlucoseTrendChart();
}

// Draw glucose trend chart
function drawGlucoseTrendChart() {
  const canvas = document.getElementById('glucoseTrendChart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;
  const padding = 20;
  
  // Clear canvas
  ctx.clearRect(0, 0, width, height);
  
  // Draw background
  ctx.fillStyle = '#f9f9f9';
  ctx.fillRect(0, 0, width, height);
  
  // Draw target zone (70-140)
  const minY = height - padding - ((70 / 200) * (height - 2 * padding));
  const maxY = height - padding - ((140 / 200) * (height - 2 * padding));
  
  ctx.fillStyle = 'rgba(16, 172, 132, 0.1)';
  ctx.fillRect(padding, maxY, width - 2 * padding, minY - maxY);
  
  // Draw grid lines
  ctx.strokeStyle = '#e0e0e0';
  ctx.lineWidth = 1;
  
  for (let i = 0; i <= 4; i++) {
    const y = padding + (i * (height - 2 * padding) / 4);
    ctx.beginPath();
    ctx.moveTo(padding, y);
    ctx.lineTo(width - padding, y);
    ctx.stroke();
  }
  
  // Draw data line
  if (glucoseTrendData.length > 1) {
    ctx.strokeStyle = '#ff6b9d';
    ctx.lineWidth = 3;
    ctx.beginPath();
    
    glucoseTrendData.forEach((value, index) => {
      const x = padding + (index / (glucoseTrendData.length - 1)) * (width - 2 * padding);
      const y = height - padding - ((value / 200) * (height - 2 * padding));
      
      if (index === 0) {
        ctx.moveTo(x, y);
      } else {
        ctx.lineTo(x, y);
      }
    });
    
    ctx.stroke();
    
    // Draw points
    glucoseTrendData.forEach((value, index) => {
      const x = padding + (index / (glucoseTrendData.length - 1)) * (width - 2 * padding);
      const y = height - padding - ((value / 200) * (height - 2 * padding));
      
      ctx.fillStyle = '#ff6b9d';
      ctx.beginPath();
      ctx.arc(x, y, 4, 0, 2 * Math.PI);
      ctx.fill();
    });
  }
}

// Animate particles based on scenario
function animateParticles(scenario) {
  const particles = document.querySelectorAll('.sim-particle');
  
  particles.forEach(particle => {
    particle.style.animationDuration = (Math.random() * 2 + 3) + 's';
    particle.style.animationDelay = (Math.random() * 2) + 's';
  });
  
  // Change particle density based on scenario
  const glucoseParticles = document.querySelectorAll('.glucose-particle');
  const insulinParticles = document.querySelectorAll('.insulin-particle');
  
  if (scenario === 'after-meal') {
    // More glucose, more insulin
    glucoseParticles.forEach(p => p.style.opacity = '1');
    insulinParticles.forEach(p => p.style.opacity = '1');
  } else if (scenario === 'exercise') {
    // Less glucose (being used)
    glucoseParticles.forEach(p => p.style.opacity = '0.6');
    insulinParticles.forEach(p => p.style.opacity = '0.7');
  } else if (scenario === 'insulin') {
    // Normal glucose, high insulin
    glucoseParticles.forEach(p => p.style.opacity = '0.7');
    insulinParticles.forEach(p => p.style.opacity = '1');
  } else {
    // Fasting - normal
    glucoseParticles.forEach(p => p.style.opacity = '0.8');
    insulinParticles.forEach(p => p.style.opacity = '0.5');
  }
}

// Draw body simulation on canvas
function drawBodySimulation(scenario) {
  // SVG-based simulation (canvas is replaced with SVG in HTML)
  
  // Get SVG glow elements
  const pancreasGlow = document.getElementById('sim-pancreas-glow');
  const liverGlow = document.getElementById('sim-liver-glow');
  const placentaGlow = document.getElementById('sim-placenta-glow');
  
  // Reset all glows first
  if (pancreasGlow) pancreasGlow.style.opacity = '0';
  if (liverGlow) liverGlow.style.opacity = '0';
  if (placentaGlow) placentaGlow.style.opacity = '0';
  
  // Activate organ glows based on scenario
  switch(scenario) {
    case 'fasting':
      // Fasting state - liver releases stored glucose
      if (liverGlow) {
        liverGlow.style.opacity = '0.7';
        liverGlow.setAttribute('fill', 'rgba(255, 152, 0, 0.4)');
      }
      updateOrganLabels('Liver', 'Releasing Glucose');
      updateOrganLabels('Pancreas', 'Low Insulin Production');
      updateOrganLabels('Placenta', 'Baseline Hormone Levels');
      break;
      
    case 'after-meal':
      // After eating - pancreas works hard, placenta hormones resist insulin
      if (pancreasGlow) {
        pancreasGlow.style.opacity = '0.9';
        pancreasGlow.setAttribute('fill', 'rgba(255, 235, 59, 0.5)');
      }
      if (placentaGlow) {
        placentaGlow.style.opacity = '0.6';
        placentaGlow.setAttribute('fill', 'rgba(236, 64, 122, 0.4)');
      }
      updateOrganLabels('Liver', 'Storing Glucose');
      updateOrganLabels('Pancreas', 'High Insulin Production');
      updateOrganLabels('Placenta', 'Blocking Insulin (Hormones)');
      
      // Add visual particles effect
      animateGlucoseParticles(15);
      break;
      
    case 'exercise':
      // Exercise - muscles use glucose, liver may release some
      if (liverGlow) {
        liverGlow.style.opacity = '0.5';
        liverGlow.setAttribute('fill', 'rgba(16, 172, 132, 0.4)');
      }
      if (pancreasGlow) {
        pancreasGlow.style.opacity = '0.4';
        pancreasGlow.setAttribute('fill', 'rgba(255, 235, 59, 0.3)');
      }
      updateOrganLabels('Liver', 'Supporting Energy Needs');
      updateOrganLabels('Pancreas', 'Moderate Activity');
      updateOrganLabels('Placenta', 'Normal Function');
      
      // Add energy lines effect
      animateEnergyLines();
      break;
      
    case 'insulin':
      // After insulin - pancreas gets help
      if (pancreasGlow) {
        pancreasGlow.style.opacity = '1';
        pancreasGlow.setAttribute('fill', 'rgba(59, 130, 246, 0.5)');
      }
      if (placentaGlow) {
        placentaGlow.style.opacity = '0.4';
        placentaGlow.setAttribute('fill', 'rgba(236, 64, 122, 0.3)');
      }
      updateOrganLabels('Liver', 'Glucose Uptake Increased');
      updateOrganLabels('Pancreas', 'Assisted by External Insulin');
      updateOrganLabels('Placenta', 'Hormone Resistance Overcome');
      break;
      
    default:
      // Normal state
      updateOrganLabels('Liver', 'Normal Function');
      updateOrganLabels('Pancreas', 'Normal Function');
      updateOrganLabels('Placenta', 'Normal Hormone Production');
  }
  
  console.log('Body simulation updated for scenario:', scenario);
}

// Helper function to update organ label text
function updateOrganLabels(organName, statusText) {
  const labelElement = document.getElementById(`${organName.toLowerCase()}Status`);
  if (labelElement) {
    labelElement.textContent = statusText;
  }
}

// Animate glucose particles for "after-meal" scenario
function animateGlucoseParticles(count) {
  const particleSystem = document.getElementById('particleSystem');
  if (!particleSystem) return;
  
  // Show existing glucose particles with extra animation
  const glucoseParticles = particleSystem.querySelectorAll('.glucose-particle');
  glucoseParticles.forEach((particle, index) => {
    particle.style.animation = 'particleFloat 3s ease-in-out infinite';
    particle.style.opacity = '1';
    particle.style.animationDelay = `${index * 0.2}s`;
  });
  
  // Hide them after scenario changes
  setTimeout(() => {
    glucoseParticles.forEach(particle => {
      particle.style.opacity = '0.5';
    });
  }, 3000);
}

// Animate energy lines for "exercise" scenario  
function animateEnergyLines() {
  const particleSystem = document.getElementById('particleSystem');
  if (!particleSystem) return;
  
  // Create temporary energy lines effect
  // You can enhance this by adding temporary SVG lines or using the particle system
  console.log('Energy lines animation triggered');
}

// Tool button handlers
document.addEventListener('DOMContentLoaded', function() {
  // Daily Log button
  const logButtons = document.querySelectorAll('.tool-btn');
  logButtons[0]?.addEventListener('click', function() {
    alert('Daily Glucose Log\n\nRecord:\n• Time and date\n• Blood glucose reading\n• Meals eaten\n• Activity/exercise\n• Medications taken\n• How you feel\n\nTip: Use a dedicated app like MySugr or keep a physical notebook.');
  });
  
  // Weekly Report button
  logButtons[1]?.addEventListener('click', function() {
    alert('Weekly Report Feature\n\nYour report should include:\n• Average glucose by time of day\n• Highest and lowest readings\n• Percentage of readings in target\n• Patterns (weekend vs weekday)\n• Medication adjustments needed\n\nShare this with your doctor at appointments!');
  });
  
  // Reminders button
  logButtons[2]?.addEventListener('click', function() {
    alert('Set Glucose Testing Reminders\n\nRecommended times:\n• 7:00 AM - Fasting test\n• 9:00 AM - After breakfast (1-2 hrs)\n• 1:00 PM - After lunch (1-2 hrs)\n• 7:00 PM - After dinner (1-2 hrs)\n• 10:00 PM - Bedtime (if needed)\n\nUse your phone alarm or diabetes app!');
  });
  
  // Target Ranges button
  logButtons[3]?.addEventListener('click', function() {
    alert('Target Blood Glucose Ranges\n\n✓ Fasting: < 95 mg/dL\n✓ 1-hour after meal: < 140 mg/dL\n✓ 2-hours after meal: < 120 mg/dL\n\nYour doctor may adjust these targets based on your individual needs.');
  });
});

// Open tracker and switch to Compare Foods tab
function openTrackerComparison() {
  // Open the tracker modal
  openSugarTracker();
  
  // Wait for modal to open, then switch to compare tab
  setTimeout(() => {
    switchTrackerTab('compare');
  }, 100);
}



// Update time display
function updateTimeDisplay() {
  const minutes = Math.floor(timeElapsed / 60);
  const seconds = timeElapsed % 60;
  const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
  document.getElementById('timeElapsed').textContent = display;
}

// Start simulation timer
function startSimulationTimer() {
  if (simulationTimer) {
    clearInterval(simulationTimer);
  }
  
  simulationTimer = setInterval(() => {
    timeElapsed++;
    updateTimeDisplay();
    
    // Add some dynamic changes every 10 seconds
    if (timeElapsed % 10 === 0) {
      const currentData = scenarios[currentScenario];
      const variation = Math.random() * 10 - 5;
      const newGlucose = Math.max(70, Math.min(180, currentData.glucose + variation));
      updateGlucoseTrend(newGlucose);
    }
  }, 1000);
}

// Initialize simulation on page load
document.addEventListener('DOMContentLoaded', function() {
  initGlucoseMeter();
  
  // Initialize simulation with default scenario
  setTimeout(() => {
    setSimulationScenario('fasting');
    startSimulationTimer();
  }, 500);
  
  console.log('Body Simulation Initialized');
});

// Daily Log Modal
function openDailyLog() {
  document.getElementById('dailyLogModal').classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeDailyLog() {
  document.getElementById('dailyLogModal').classList.remove('active');
  document.body.style.overflow = 'auto';
}

function saveEntry() {
  const glucose = document.getElementById('glucoseInput').value;
  if (!glucose) {
    alert('Please enter a glucose reading');
    return;
  }
  
  // Provide instant feedback
  const feedback = document.getElementById('instantFeedback');
  const value = parseInt(glucose);
  
  if (value < 95) {
    feedback.innerHTML = `
      <div class="feedback-icon" style="color: #66bb6a;">✓</div>
      <div class="feedback-text">
        <strong style="color: #66bb6a;">Perfect!</strong> This fasting reading is right in your target zone.
      </div>
    `;
    feedback.style.background = 'rgba(102,187,106,0.1)';
    feedback.style.borderColor = '#66bb6a';
  } else if (value < 140) {
    feedback.innerHTML = `
      <div class="feedback-icon" style="color: #ffa726;">⚠</div>
      <div class="feedback-text">
        <strong style="color: #ffa726;">Slightly High</strong> Consider reviewing what you ate and adjusting portion size.
      </div>
    `;
    feedback.style.background = 'rgba(255,167,38,0.1)';
    feedback.style.borderColor = '#ffa726';
  } else {
    feedback.innerHTML = `
      <div class="feedback-icon" style="color: #ef5350;">!</div>
      <div class="feedback-text">
        <strong style="color: #ef5350;">Above Target</strong> Please test again in 1 hour and contact your doctor if it stays high.
      </div>
    `;
    feedback.style.background = 'rgba(239,83,80,0.1)';
    feedback.style.borderColor = '#ef5350';
  }
  
  // Success message
  setTimeout(() => {
    alert('✓ Entry saved successfully!\n\nYour glucose log has been updated. Keep up the great work tracking your health!');
  }, 500);
}

function openWeeklyReport() {
  alert('📊 AI-Powered Weekly Report\n\n✓ 85% of readings in target range\n✓ Average fasting: 92 mg/dL\n✓ Best time: Mornings\n✓ Pattern: Post-lunch slightly elevated\n\n💡 Suggestion: Try reducing rice portion at lunch or adding more vegetables.\n\nFull report available in our mobile app!');
}

function openSmartReminders() {
  alert('🔔 Smart Reminder System\n\nSet up personalized reminders:\n\n⏰ Fasting test: 7:00 AM\n⏰ After breakfast: 9:00 AM\n⏰ After lunch: 2:00 PM\n⏰ After dinner: 8:30 PM\n⏰ Bedtime: 10:00 PM\n\nReminders adapt to your schedule and send gentle notifications to your phone!');
}

function openTargetZones() {
  alert('🎯 Your Personalized Target Zones\n\n✓ Fasting: < 95 mg/dL\n  Your average: 92 mg/dL ✓\n\n✓ 1-hr after meal: < 140 mg/dL\n  Your average: 128 mg/dL ✓\n\n✓ 2-hrs after meal: < 120 mg/dL\n  Your average: 115 mg/dL ✓\n\nYou\'re doing great! Keep up the excellent work!');
}

// Meal Planner Functions
let currentMeal = [];
let currentMealTime = 'breakfast';

function selectMealTime(mealTime) {
  currentMealTime = mealTime;
  document.querySelectorAll('.meal-time-btn').forEach(btn => btn.classList.remove('active'));
  event.target.closest('.meal-time-btn').classList.add('active');
  clearPlate();
}

function clearPlate() {
  currentMeal = [];
  document.getElementById('veggiesDropped').innerHTML = '';
  document.getElementById('proteinDropped').innerHTML = '';
  document.getElementById('carbsDropped').innerHTML = '';
  updateGlucosePrediction();
}

function saveMeal() {
  if (currentMeal.length === 0) {
    alert('Please add some foods to your plate first!');
    return;
  }
  
  const mealSummary = currentMeal.map(food => food.name).join(', ');
  alert(`✓ ${currentMealTime.charAt(0).toUpperCase() + currentMealTime.slice(1)} saved!\n\nYour meal: ${mealSummary}\n\nEstimated glucose impact: Medium\nThis meal is GDM-friendly! 🎉`);
}

function updateGlucosePrediction() {
  const totalGI = currentMeal.reduce((sum, food) => {
    const giValue = food.gi === 'low' ? 30 : food.gi === 'medium' ? 60 : 85;
    return sum + giValue;
  }, 0);
  
  const avgGI = currentMeal.length > 0 ? totalGI / currentMeal.length : 0;
  const impact = avgGI < 40 ? 'low' : avgGI < 65 ? 'medium' : 'high';
  const predictedPeak = 90 + (avgGI * 0.8);
  
  document.getElementById('predictionBar').style.width = (avgGI / 100 * 100) + '%';
  document.getElementById('predictedPeak').textContent = Math.round(predictedPeak) + ' mg/dL';
  document.getElementById('timeToPeak').textContent = avgGI < 40 ? '60-90 min' : avgGI < 65 ? '45-60 min' : '30-45 min';
  
  const statusElement = document.getElementById('mealStatus');
  if (impact === 'low') {
    statusElement.textContent = 'Excellent Choice';
    statusElement.className = 'stat-value status-good';
  } else if (impact === 'medium') {
    statusElement.textContent = 'Good Choice';
    statusElement.className = 'stat-value';
  } else {
    statusElement.textContent = 'Needs Improvement';
    statusElement.className = 'stat-value';
    statusElement.style.color = '#ef5350';
  }
  
  // Update suggestions
  const suggestions = [];
  const hasVeggies = currentMeal.some(f => f.type === 'vegetable');
  const hasProtein = currentMeal.some(f => f.type === 'protein');
  const hasCarbs = currentMeal.some(f => f.type === 'carbs');
  
  if (!hasVeggies) suggestions.push('Add vegetables to slow glucose absorption');
  if (!hasProtein) suggestions.push('Include protein for balanced meal');
  if (hasCarbs && avgGI > 65) suggestions.push('Switch to low-GI carbs like brown rice');
  if (currentMeal.length < 3) suggestions.push('Add more variety for complete nutrition');
  if (impact === 'low') suggestions.push('Perfect balance! This meal supports healthy glucose levels');
  
  document.getElementById('suggestionsList').innerHTML = suggestions.map(s => `<li>${s}</li>`).join('');
}

function loadMealTemplate(templateId) {
  clearPlate();
  
  const templates = {
    breakfast1: [
      {name: 'Oats', type: 'carbs', gi: 'low'},
      {name: 'Egg', type: 'protein', gi: 'low'},
      {name: 'Vegetables', type: 'vegetable', gi: 'low'}
    ],
    lunch1: [
      {name: 'Brown Rice', type: 'carbs', gi: 'low'},
      {name: 'Dal', type: 'protein', gi: 'low'},
      {name: 'Mixed Veggies', type: 'vegetable', gi: 'low'}
    ],
    dinner1: [
      {name: 'Fish', type: 'protein', gi: 'low'},
      {name: 'Roti', type: 'carbs', gi: 'medium'},
      {name: 'Vegetable Curry', type: 'vegetable', gi: 'low'}
    ]
  };
  
  currentMeal = templates[templateId] || [];
  
  currentMeal.forEach(food => {
    const container = food.type === 'vegetable' ? 'veggiesDropped' : 
                     food.type === 'protein' ? 'proteinDropped' : 'carbsDropped';
  document.getElementById(container).innerHTML += `<span class="dropped-food-item">${getFoodEmoji(food.name)}</span>`;
});
  
  updateGlucosePrediction();
}

function getFoodEmoji(name) {
  const emojis = {
    'Oats': '🥣', 'Egg': '🥚', 'Vegetables': '🥦',
    'Brown Rice': '🍚', 'Dal': '🫘', 'Mixed Veggies': '🥗',
    'Fish': '🐟', 'Roti': '🫓', 'Vegetable Curry': '🍛'
  };
  return emojis[name] || '🍽️';
}

// Enable drag and drop for meal planner
document.addEventListener('DOMContentLoaded', function() {
  const draggables = document.querySelectorAll('.draggable-food');
  const dropZones = [
    document.getElementById('plateVeggies'),
    document.getElementById('plateProtein'),
    document.getElementById('plateCarbs')
  ];
  
  if (draggables.length > 0) {
    draggables.forEach(food => {
      food.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', JSON.stringify({
          name: food.querySelector('.food-name').textContent,
          type: food.dataset.type,
          gi: food.dataset.gi,
          emoji: food.querySelector('.food-icon').textContent
        }));
      });
    });
    
    dropZones.forEach(zone => {
      if (!zone) return;
      
      zone.addEventListener('dragover', (e) => {
        e.preventDefault();
        zone.style.transform = 'scale(1.05)';
      });
      
      zone.addEventListener('dragleave', () => {
        zone.style.transform = 'scale(1)';
      });
      
      zone.addEventListener('drop', (e) => {
        e.preventDefault();
        zone.style.transform = 'scale(1)';
        
        const foodData = JSON.parse(e.dataTransfer.getData('text/plain'));
        const targetType = zone.id === 'plateVeggies' ? 'vegetable' :
                          zone.id === 'plateProtein' ? 'protein' : 'carbs';
        
        if (foodData.type !== targetType) {
          alert(`Please drop ${foodData.name} in the ${foodData.type} section!`);
          return;
        }
        
        currentMeal.push(foodData);
        const droppedContainer = zone.querySelector('.dropped-foods');
        droppedContainer.innerHTML += `<span class="dropped-food-item">${foodData.emoji}</span>`;
        
        updateGlucosePrediction();
      });
    });
  }
});

// Success Stories Modal
function openSuccessStories() {
  alert('⭐ Success Stories\n\n"I was diagnosed at 24 weeks and managed with diet alone. Baby born healthy at 3.1 kg!" - Anjali, Delhi\n\n"Exercise after meals was my game-changer. Walking 20 minutes kept my glucose perfect." - Meera, Bangalore\n\n"Don\'t panic! With the right food choices, you\'ve got this!" - Priya, Mumbai\n\nRead 500+ more inspiring stories in our community!');
}

// Find Local Groups
function findLocalGroups() {
  const city = prompt('Enter your city:');
  if (city) {
    alert(`📍 Support Groups in ${city}\n\nWe found 3 groups near you:\n\n1. ${city} GDM Moms Meetup\n   Meets: 2nd Saturday, 4 PM\n   Location: City Hospital\n\n2. ${city} Healthy Pregnancy Group\n   Meets: Every Thursday, 6 PM\n   Location: Community Center\n\n3. Online ${city} GDM Support\n   WhatsApp Group: [Join Link]\n\nContact details sent to your email!`);
  }
}

function generateSmartSuggestions() {
  const suggestions = [];
  const mealContext = analyzeMealContext();
  
  // Missing nutrients
  if (!mealContext.hasVeggies) {
    suggestions.push({
      type: 'critical',
      icon: '⚠️',
      message: 'Add vegetables first - they should fill half your plate!',
      action: 'highlight-vegetables',
      foods: ['Leafy Greens', 'Mixed Veggies', 'Cauliflower']
    });
  }
  
  // Complementary pairings
  if (mealContext.hasRice && !mealContext.hasDal) {
    suggestions.push({
      type: 'pairing',
      icon: '💡',
      message: 'Rice + Dal is a perfect protein combination!',
      action: 'suggest-dal'
    });
  }
  
  // GI balancing
  if (mealContext.avgGI > 60) {
    suggestions.push({
      type: 'warning',
      icon: '🎯',
      message: 'High GI detected. Add more fiber-rich foods to slow absorption',
      foods: ['Leafy Greens', 'Chickpeas', 'Curd']
    });
  }
  
  return suggestions;
}


function addFood(foodId, portion) {
  const portionMultiplier = {
    small: 0.5,
    medium: 1,
    large: 1.5
  };
  
  const food = foodDatabase[foodId];
  const adjustedGI = food.baseGI * portionMultiplier[portion];
  
  // Add to plate with portion indicator
  const foodItem = {
    name: food.name,
    type: food.type,
    gi: food.gi,
    portion: portion,
    calories: food.calories * portionMultiplier[portion]
  };
  
  currentMeal.push(foodItem);
  renderPlate();
  updateGlucosePrediction();
  
  // Visual feedback
  showToast(`Added ${portion} portion of ${food.name}`);
}


function suggestSwaps(foodItem) {
  const swapDatabase = {
    'white-rice': {
      better: ['brown-rice', 'quinoa', 'millet'],
      reason: 'Lower GI and higher fiber',
      giReduction: 25,
      message: '🔄 Swap white rice for brown rice to reduce GI by 25 points!'
    },
    'potato': {
      better: ['sweet-potato', 'cauliflower'],
      reason: 'Lower GI and more nutrients',
      giReduction: 28
    }
  };
  
  return swapDatabase[foodItem];
}

// Add swap buttons to dropped items
function renderPlateWithSwaps() {
  currentMeal.forEach((food, index) => {
    const swap = suggestSwaps(food.id);
    if (swap) {
      // Show swap suggestion badge
      addSwapBadge(food, swap);
    }
  });
}


function calculateMealScore() {
  let score = 0;
  let breakdown = {};
  
  // Vegetable component (40 points max)
  const veggieCount = currentMeal.filter(f => f.type === 'vegetable').length;
  breakdown.veggies = Math.min(veggieCount * 15, 40);
  
  // Plate balance (30 points)
  const balance = calculatePlateBalance();
  breakdown.balance = balance >= 0.9 ? 30 : Math.floor(balance * 30);
  
  // Low GI selection (30 points)
  const avgGI = calculateAverageGI();
  breakdown.gi = avgGI < 40 ? 30 : avgGI < 60 ? 20 : 10;
  
  score = breakdown.veggies + breakdown.balance + breakdown.gi;
  
  // Check achievements
  checkAchievements(score, breakdown);
  
  return {score, breakdown};
}

function checkAchievements(score, breakdown) {
  const achievements = [];
  
  if (breakdown.veggies >= 40) {
    achievements.push({
      id: 'veggie-master',
      title: 'Veggie Master! 🥗',
      description: 'Perfect vegetable portions',
      icon: '🏆'
    });
  }
  
  if (score >= 90) {
    achievements.push({
      id: 'perfect-plate',
      title: 'Perfect Plate! ⭐',
      description: 'Near-perfect GDM meal',
      unlocked: true
    });
  }
  
  displayAchievements(achievements);
}

// SVG fallback version
function drawBodySimulationSVG(scenario) {
  const pancreasGlow = document.getElementById('sim-pancreas-glow');
  const liverGlow = document.getElementById('sim-liver-glow');
  const placentaGlow = document.getElementById('sim-placenta-glow');
  
  // Reset all
  if (pancreasGlow) pancreasGlow.style.opacity = '0';
  if (liverGlow) liverGlow.style.opacity = '0';
  if (placentaGlow) placentaGlow.style.opacity = '0';
  
  // Activate based on scenario
  switch(scenario) {
    case 'fasting':
      if (liverGlow) liverGlow.style.opacity = '0.7';
      break;
    case 'after-meal':
      if (pancreasGlow) pancreasGlow.style.opacity = '0.9';
      if (placentaGlow) placentaGlow.style.opacity = '0.6';
      break;
    case 'exercise':
      if (liverGlow) liverGlow.style.opacity = '0.5';
      break;
    case 'insulin':
      if (pancreasGlow) pancreasGlow.style.opacity = '1';
      break;
  }
}


function drawGlucoseCurve(mealData) {
  const ctx = document.getElementById('glucoseCurve').getContext('2d');
  
  // Calculate curve based on meal GI
  const timePoints = [0, 15, 30, 45, 60, 75, 90, 105, 120];
  const baselineGlucose = 95;
  const avgGI = calculateAverageGI(mealData);
  
  const glucoseValues = timePoints.map(time => {
    if (time === 0) return baselineGlucose;
    
    // Peak at 45-60 min based on GI
    const peakTime = avgGI < 40 ? 75 : avgGI < 60 ? 60 : 45;
    const peakValue = baselineGlucose + (avgGI * 0.8);
    
    // Gaussian-like curve
    const rise = time < peakTime ? 
      baselineGlucose + ((peakValue - baselineGlucose) * (time / peakTime)) :
      peakValue - ((peakValue - baselineGlucose) * ((time - peakTime) / (120 - peakTime)));
    
    return Math.round(rise);
  });
  
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: timePoints.map(t => t + ' min'),
      datasets: [{
        label: 'Your Meal',
        data: glucoseValues,
        borderColor: '#4CAF50',
        backgroundColor: 'rgba(76, 175, 80, 0.1)',
        tension: 0.4
      }, {
        label: 'Target Zone',
        data: timePoints.map(() => 140),
        borderColor: '#FFC107',
        borderDash: [5, 5],
        fill: false
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {position: 'top'},
        title: {display: false}
      },
      scales: {
        y: {
          beginAtZero: false,
          min: 80,
          max: 180,
          title: {display: true, text: 'Blood Glucose (mg/dL)'}
        }
      }
    }
  });
}


// Add visual fill animation as foods are added
function updatePlateFill() {
  const veggieCount = document.querySelectorAll('#veggiesDropped .dropped-food-item').length;
  const proteinCount = document.querySelectorAll('#proteinDropped .dropped-food-item').length;
  const carbsCount = document.querySelectorAll('#carbsDropped .dropped-food-item').length;
  
  // Update background opacity based on items
  document.getElementById('plateVeggies').style.backgroundColor = 
    `rgba(76, 175, 80, ${Math.min(veggieCount * 0.15, 0.6)})`;
  document.getElementById('plateProtein').style.backgroundColor = 
    `rgba(255, 152, 0, ${Math.min(proteinCount * 0.15, 0.6)})`;
  document.getElementById('plateCarbs').style.backgroundColor = 
    `rgba(33, 150, 243, ${Math.min(carbsCount * 0.15, 0.6)})`;
}


function triggerHaptic(type = 'light') {
  if ('vibrate' in navigator) {
    const patterns = {
      light: [10],
      medium: [20],
      heavy: [30],
      success: [10, 50, 10]
    };
    navigator.vibrate(patterns[type] || patterns.light);
  }
}

// Use on interactions
function addFoodWithFeedback(food) {
  addFood(food);
  triggerHaptic('light');
  showToast(`Added ${food.name}`);
}


function saveMealToHistory(meal) {
  const history = JSON.parse(localStorage.getItem('mealHistory') || '[]');
  
  const mealRecord = {
    id: Date.now(),
    timestamp: new Date().toISOString(),
    mealTime: currentMealTime,
    foods: currentMeal,
    score: calculateMealScore(),
    glucoseImpact: calculateAverageGI(),
    favorite: false
  };
  
  history.unshift(mealRecord);
  
  // Keep only last 50 meals
  if (history.length > 50) history.pop();
  
  localStorage.setItem('mealHistory', JSON.stringify(history));
  
  showNotification('Meal saved to history! 📝');
}

function toggleFavorite(mealId) {
  const history = JSON.parse(localStorage.getItem('mealHistory') || '[]');
  const meal = history.find(m => m.id === mealId);
  
  if (meal) {
    meal.favorite = !meal.favorite;
    localStorage.setItem('mealHistory', JSON.stringify(history));
    updateHistoryDisplay();
    
    if (meal.favorite) {
      showNotification('Added to favorites! ⭐');
    }
  }
}


// ===================================
// STREAK TRACKER FUNCTIONALITY
// ===================================

// ===================================
// STREAK TRACKER FUNCTIONALITY
// ===================================

let currentStreak = 0;
let lastMealDate = null;

// Streak milestones
const streakMilestones = {
  3: { message: "3-day streak! You're building momentum! 💪", class: 'milestone-3' },
  7: { message: "1 week streak! Incredible dedication! 🌟", class: 'milestone-7' },
  14: { message: "2 weeks! You're unstoppable! 🚀", class: 'milestone-7' },
  30: { message: "30-day streak! You're a GDM champion! 👑", class: 'milestone-30' },
  60: { message: "60 days! This is your lifestyle now! 🏆", class: 'milestone-30' },
  90: { message: "90-day streak! Legendary! 🎖️", class: 'milestone-30' }
};

function initStreakTracker() {
  // Load streak data from localStorage
  const storedStreak = localStorage.getItem('gdm-streak');
  const storedLastDate = localStorage.getItem('gdm-last-meal-date');
  
  if (storedStreak) {
    currentStreak = parseInt(storedStreak);
  }
  
  if (storedLastDate) {
    lastMealDate = new Date(storedLastDate);
  }
  
  // Check if streak should be maintained or broken
  updateStreakStatus();
  updateStreakDisplay();
}

function updateStreakStatus() {
  if (!lastMealDate) {
    currentStreak = 0;
    return;
  }
  
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const lastDate = new Date(lastMealDate);
  lastDate.setHours(0, 0, 0, 0);
  
  const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));
  
  if (daysDiff > 1) {
    // Streak broken
    currentStreak = 0;
    updateStreakDisplay(true); // frozen state
  }
}

function incrementStreak() {
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  if (!lastMealDate) {
    // First meal ever
    currentStreak = 1;
  } else {
    const lastDate = new Date(lastMealDate);
    lastDate.setHours(0, 0, 0, 0);
    
    const daysDiff = Math.floor((today - lastDate) / (1000 * 60 * 60 * 24));
    
    if (daysDiff === 0) {
      // Same day - don't increment, but update timestamp
    } else if (daysDiff === 1) {
      // Next day - increment streak
      currentStreak++;
      checkStreakMilestone(currentStreak);
    } else {
      // Gap - reset streak
      currentStreak = 1;
    }
  }
  
  lastMealDate = new Date();
  
  // Save to localStorage
  localStorage.setItem('gdm-streak', currentStreak);
  localStorage.setItem('gdm-last-meal-date', lastMealDate.toISOString());
  
  updateStreakDisplay();
}

function updateStreakDisplay(frozen = false) {
  const streakCountEl = document.getElementById('streakCount');
  const streakMessageEl = document.getElementById('streakMessage');
  const streakProgressFillEl = document.getElementById('streakProgressFill');
  const streakNextGoalEl = document.getElementById('streakNextGoal');
  const streakTracker = document.querySelector('.streak-tracker');
  
  if (!streakCountEl) return;
  
  // Animate count
  animateValue('streakCount', parseInt(streakCountEl.textContent) || 0, currentStreak, 800);
  
  // Update message
  let message = '';
  let messageClass = '';
  
  if (frozen) {
    message = "Streak broken! Start again today! 💔";
    streakTracker.classList.add('frozen');
    streakTracker.classList.remove('milestone-3', 'milestone-7', 'milestone-30');
  } else if (currentStreak === 0) {
    message = "Start building healthy habits!";
    streakTracker.classList.remove('frozen', 'milestone-3', 'milestone-7', 'milestone-30');
  } else if (currentStreak === 1) {
    message = "Great start! Come back tomorrow! 🌱";
    messageClass = 'motivational';
    streakTracker.classList.remove('frozen', 'milestone-3', 'milestone-7', 'milestone-30');
  } else {
    // Check for milestone messages
    const milestone = streakMilestones[currentStreak];
    if (milestone) {
      message = milestone.message;
      messageClass = 'motivational';
      streakTracker.classList.add(milestone.class);
      streakTracker.classList.add('celebrating');
      
      // Remove celebration class after animation
      setTimeout(() => {
        streakTracker.classList.remove('celebrating');
      }, 600);
    } else {
      message = `${currentStreak} days strong! Keep it up! 🔥`;
      messageClass = 'motivational';
    }
  }
  
  streakMessageEl.textContent = message;
  streakMessageEl.className = 'streak-message ' + messageClass;
  
  // Update progress bar to next milestone
  const nextMilestone = getNextMilestone(currentStreak);
  if (nextMilestone) {
    const progress = (currentStreak / nextMilestone) * 100;
    streakProgressFillEl.style.width = progress + '%';
    streakNextGoalEl.textContent = `Next: ${nextMilestone} days 🎯`;
  } else {
    streakProgressFillEl.style.width = '100%';
    streakNextGoalEl.textContent = 'Max level reached! 🏆';
  }
}

function getNextMilestone(currentStreak) {
  const milestones = Object.keys(streakMilestones).map(Number).sort((a, b) => a - b);
  
  for (let milestone of milestones) {
    if (currentStreak < milestone) {
      return milestone;
    }
  }
  
  return null; // Max level reached
}

function checkStreakMilestone(streak) {
  const milestone = streakMilestones[streak];
  
  if (milestone) {
    // Show special notification
    setTimeout(() => {
      showStreakMilestoneNotification(streak, milestone.message);
    }, 500);
  }
}

function showStreakMilestoneNotification(days, message) {
  const notification = document.createElement('div');
  notification.className = 'streak-milestone-notification';
  notification.innerHTML = `
    <div class="milestone-content">
      <div class="milestone-icon">🔥</div>
      <div class="milestone-text">
        <h3>${days}-Day Streak!</h3>
        <p>${message}</p>
      </div>
      <div class="milestone-confetti">
        ${Array(20).fill('').map(() => '<span class="confetti-piece">✨</span>').join('')}
      </div>
    </div>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => notification.classList.add('show'), 100);
  
  // Trigger confetti
  triggerConfetti();
  
  setTimeout(() => {
    notification.classList.remove('show');
    setTimeout(() => notification.remove(), 300);
  }, 4000);
}

// Initialize streak tracker on page load
document.addEventListener('DOMContentLoaded', function() {
  initStreakTracker();
});

// Update the saveMeal function to increment streak
const originalSaveMealWithStreak = window.saveMeal;
window.saveMeal = function() {
  if (currentMeal.length === 0) {
    alert('Please add some foods to your plate first!');
    return;
  }
  
  // Call original saveMeal logic
  if (originalSaveMealWithStreak) {
    originalSaveMealWithStreak();
  }
  
  // Increment streak
  incrementStreak();
  
  const mealSummary = currentMeal.map(food => food.name).join(', ');
  const { totalScore } = calculateMealScore();
  
  alert(`✓ Meal saved!\nScore: ${totalScore}/100\nStreak: ${currentStreak} day${currentStreak !== 1 ? 's' : ''}! 🔥\n\nYour meal: ${mealSummary}`);
};


// ===================================
// DIETARY FILTERS SYSTEM
// ===================================

let activeFilters = [];

function toggleFilter(filterType) {
  const filterBtn = document.querySelector(`[data-filter="${filterType}"]`);
  
  if (activeFilters.includes(filterType)) {
    // Remove filter
    activeFilters = activeFilters.filter(f => f !== filterType);
    filterBtn.classList.remove('active');
  } else {
    // Add filter
    activeFilters.push(filterType);
    filterBtn.classList.add('active');
  }
  
  applyFilters();
}

function applyFilters() {
  const allFoodItems = document.querySelectorAll('.food-item');
  
  if (activeFilters.length === 0) {
    // Show all items
    allFoodItems.forEach(item => {
      item.style.display = '';
    });
    return;
  }
  
  allFoodItems.forEach(item => {
    const foodName = item.querySelector('.food-name').textContent.toLowerCase();
    let shouldShow = false;
    
    // Define filter logic
    if (activeFilters.includes('vegetarian')) {
      const nonVegItems = ['fish', 'chicken', 'mutton', 'eggs'];
      shouldShow = shouldShow || !nonVegItems.some(nv => foodName.includes(nv));
    }
    
    if (activeFilters.includes('non-veg')) {
      const nonVegItems = ['fish', 'chicken', 'mutton', 'eggs'];
      shouldShow = shouldShow || nonVegItems.some(nv => foodName.includes(nv));
    }
    
    if (activeFilters.includes('vegan')) {
      const nonVeganItems = ['curd', 'yogurt', 'paneer', 'milk', 'ghee', 'eggs', 'fish', 'chicken'];
      shouldShow = shouldShow || !nonVeganItems.some(nv => foodName.includes(nv));
    }
    
    if (activeFilters.includes('gluten-free')) {
      const glutenItems = ['roti', 'bread', 'wheat', 'pasta', 'noodles'];
      shouldShow = shouldShow || !glutenItems.some(g => foodName.includes(g));
    }
    
    if (activeFilters.includes('dairy-free')) {
      const dairyItems = ['curd', 'yogurt', 'paneer', 'milk', 'ghee', 'cheese'];
      shouldShow = shouldShow || !dairyItems.some(d => foodName.includes(d));
    }
    
    item.style.display = shouldShow ? '' : 'none';
  });
}


// ===================================
// CUISINE SELECTOR SYSTEM
// ===================================

function updateFoodOptions() {
  const cuisineStyle = document.getElementById('cuisineStyle').value;
  const allFoodItems = document.querySelectorAll('.food-item');
  
  // Define cuisine-specific foods
  const cuisineMap = {
    'north': ['roti', 'paneer', 'chole', 'rajma', 'paratha', 'aloo', 'dal'],
    'south': ['idli', 'dosa', 'sambar', 'rice', 'coconut', 'curry leaves', 'upma'],
    'east': ['fish', 'rice', 'mustard', 'posto', 'shukto'],
    'west': ['dhokla', 'pav', 'bhaji', 'thepla', 'vada pav'],
    'fusion': ['quinoa', 'avocado', 'smoothie', 'multigrain']
  };
  
  if (cuisineStyle === 'all') {
    allFoodItems.forEach(item => {
      item.style.display = '';
    });
    return;
  }
  
  const cuisineItems = cuisineMap[cuisineStyle] || [];
  
  allFoodItems.forEach(item => {
    const foodName = item.querySelector('.food-name').textContent.toLowerCase();
    const matches = cuisineItems.some(cuisine => foodName.includes(cuisine));
    item.style.display = matches ? '' : 'none';
  });
}


// ===================================
// GLUCOSE TIMELINE CHART
// ===================================

function drawGlucoseCurve() {
  const canvas = document.getElementById('glucoseCurve');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  const width = canvas.width;
  const height = canvas.height;
  
  // Clear canvas
  ctx.clearRect(0, 0, width, height);
  
  // Calculate predicted values based on current meal
  const avgGI = calculateAverageGI();
  const peakGlucose = 95 + (avgGI * 0.8); // Simplified calculation
  
  // Define glucose curve points (time in minutes, glucose level)
  const points = [
    { time: 0, glucose: 95 },      // Fasting
    { time: 30, glucose: 95 + (peakGlucose - 95) * 0.5 },
    { time: 60, glucose: peakGlucose },  // Peak at 1 hour
    { time: 90, glucose: peakGlucose - (peakGlucose - 110) * 0.6 },
    { time: 120, glucose: 110 }    // 2-hour reading
  ];
  
  // Draw background zones
  ctx.fillStyle = 'rgba(76, 175, 80, 0.1)'; // Safe zone (green)
  ctx.fillRect(0, height - (140 / 200 * height), width, height);
  
  ctx.fillStyle = 'rgba(255, 167, 38, 0.1)'; // Caution zone (orange)
  ctx.fillRect(0, height - (160 / 200 * height), width, (160 - 140) / 200 * height);
  
  ctx.fillStyle = 'rgba(244, 67, 54, 0.1)'; // Danger zone (red)
  ctx.fillRect(0, 0, width, height - (160 / 200 * height));
  
  // Draw grid lines
  ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
  ctx.lineWidth = 1;
  for (let i = 0; i <= 200; i += 20) {
    const y = height - (i / 200 * height);
    ctx.beginPath();
    ctx.moveTo(0, y);
    ctx.lineTo(width, y);
    ctx.stroke();
  }
  
  // Draw glucose curve
  ctx.beginPath();
  ctx.strokeStyle = '#ec407a';
  ctx.lineWidth = 3;
  
  points.forEach((point, index) => {
    const x = (point.time / 120) * width;
    const y = height - (point.glucose / 200 * height);
    
    if (index === 0) {
      ctx.moveTo(x, y);
    } else {
      ctx.lineTo(x, y);
    }
  });
  
  ctx.stroke();
  
  // Draw points
  points.forEach(point => {
    const x = (point.time / 120) * width;
    const y = height - (point.glucose / 200 * height);
    
    ctx.beginPath();
    ctx.arc(x, y, 6, 0, Math.PI * 2);
    ctx.fillStyle = '#ec407a';
    ctx.fill();
    ctx.strokeStyle = 'white';
    ctx.lineWidth = 2;
    ctx.stroke();
  });
  
  // Update markers
  document.querySelector('.marker.one-hour').textContent = `1hr: ${Math.round(peakGlucose)}`;
  document.querySelector('.marker.two-hour').textContent = `2hr: ${Math.round(points[4].glucose)}`;
}

function calculateAverageGI() {
  if (currentMeal.length === 0) return 40;
  
  const totalGI = currentMeal.reduce((sum, food) => {
    const giValue = food.gi === 'low' ? 30 : food.gi === 'medium' ? 60 : 85;
    return sum + giValue;
  }, 0);
  
  return totalGI / currentMeal.length;
}


// ===================================
// MEAL HISTORY SYSTEM
// ===================================

let mealHistory = JSON.parse(localStorage.getItem('mealHistory')) || [];

function saveMealToHistory() {
  if (currentMeal.length === 0) {
    alert('Please add items to your plate first!');
    return;
  }
  
  const mealData = {
    id: Date.now(),
    date: new Date().toISOString(),
    items: [...currentMeal],
    score: calculateMealScore().totalScore,
    timestamp: Date.now(),
    isFavorite: false
  };
  
  mealHistory.unshift(mealData);
  localStorage.setItem('mealHistory', JSON.stringify(mealHistory));
  
  displayMealHistory();
  showNotification('Meal saved to history! 📝');
}

function displayMealHistory(filter = 'all') {
  const historyContainer = document.getElementById('mealHistory');
  if (!historyContainer) return;
  
  let filteredHistory = [...mealHistory];
  
  // Apply filters
  if (filter === 'today') {
    const today = new Date().setHours(0, 0, 0, 0);
    filteredHistory = filteredHistory.filter(meal => 
      new Date(meal.date).setHours(0, 0, 0, 0) === today
    );
  } else if (filter === 'week') {
    const weekAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);
    filteredHistory = filteredHistory.filter(meal => meal.timestamp > weekAgo);
  } else if (filter === 'favorites') {
    filteredHistory = filteredHistory.filter(meal => meal.isFavorite);
  }
  
  if (filteredHistory.length === 0) {
    historyContainer.innerHTML = `
      <div class="history-empty">
        <span class="empty-icon">📝</span>
        <p>No meals found. Start building your first meal!</p>
      </div>
    `;
    return;
  }
  
  historyContainer.innerHTML = filteredHistory.map(meal => {
    const date = new Date(meal.date);
    const dateStr = date.toLocaleDateString('en-IN', { 
      day: 'numeric', 
      month: 'short', 
      year: 'numeric' 
    });
    const timeStr = date.toLocaleTimeString('en-IN', { 
      hour: '2-digit', 
      minute: '2-digit' 
    });
    
    return `
      <div class="history-item" data-meal-id="${meal.id}">
        <div class="history-header">
          <div class="history-date">
            <span class="date-icon">📅</span>
            <span>${dateStr} at ${timeStr}</span>
          </div>
          <div class="history-actions">
            <button class="favorite-btn ${meal.isFavorite ? 'active' : ''}" 
                    onclick="toggleFavorite(${meal.id})">
              ${meal.isFavorite ? '⭐' : '☆'}
            </button>
            <button class="reload-btn" onclick="loadMeal(${meal.id})"
                    title="Load this meal">
              🔄
            </button>
            <button class="delete-btn" onclick="deleteMeal(${meal.id})"
                    title="Delete">
              🗑️
            </button>
          </div>
        </div>
        
        <div class="history-items">
          ${meal.items.map(item => `
            <span class="history-food-tag">
              ${item.emoji} ${item.name}
            </span>
          `).join('')}
        </div>
        
        <div class="history-footer">
          <div class="history-score">
            <span class="score-label">Score:</span>
            <span class="score-value ${getScoreClass(meal.score)}">${meal.score}/100</span>
          </div>
        </div>
      </div>
    `;
  }).join('');
}

function filterHistory(filter) {
  // Update active button
  document.querySelectorAll('.history-filters button').forEach(btn => {
    btn.classList.remove('active');
  });
  event.target.classList.add('active');
  
  displayMealHistory(filter);
}

function toggleFavorite(mealId) {
  const meal = mealHistory.find(m => m.id === mealId);
  if (meal) {
    meal.isFavorite = !meal.isFavorite;
    localStorage.setItem('mealHistory', JSON.stringify(mealHistory));
    displayMealHistory();
  }
}

function loadMeal(mealId) {
  const meal = mealHistory.find(m => m.id === mealId);
  if (meal) {
    clearPlate();
    meal.items.forEach(item => {
      currentMeal.push(item);
    });
    updatePlateDisplay();
    updatePrediction();
    showNotification('Meal loaded! 🍽️');
  }
}

function deleteMeal(mealId) {
  if (confirm('Are you sure you want to delete this meal?')) {
    mealHistory = mealHistory.filter(m => m.id !== mealId);
    localStorage.setItem('mealHistory', JSON.stringify(mealHistory));
    displayMealHistory();
    showNotification('Meal deleted');
  }
}

function getScoreClass(score) {
  if (score >= 80) return 'excellent';
  if (score >= 60) return 'good';
  if (score >= 40) return 'fair';
  return 'needs-improvement';
}

function showNotification(message) {
  // You can implement a toast notification here
  console.log(message);
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
  displayMealHistory();
});


// Update your existing saveMeal() function to call saveMealToHistory()

// Call this function whenever the meal changes
// Add this to your existing addFood() and clearPlate() functions:
// drawGlucoseCurve();



function showNotification(message) {
  // Remove existing notifications
  const existing = document.querySelector('.notification-toast');
  if (existing) existing.remove();
  
  // Create notification
  const toast = document.createElement('div');
  toast.className = 'notification-toast';
  toast.textContent = message;
  document.body.appendChild(toast);
  
  // Auto-remove after 3 seconds
  setTimeout(() => {
    toast.style.animation = 'slideInUp 0.3s ease reverse';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}


// ===================================
// SHARE MEAL FUNCTIONALITY
// ===================================

function shareMeal() {
  if (currentMeal.length === 0) {
    alert('Please add some foods to your plate before sharing!');
    return;
  }
  
  // Create backdrop if doesn't exist
  let backdrop = document.querySelector('.share-backdrop');
  if (!backdrop) {
    backdrop = document.createElement('div');
    backdrop.className = 'share-backdrop';
    backdrop.onclick = closeShareModal;
    document.body.appendChild(backdrop);
  }
  
  // Show modal and backdrop
  const modal = document.getElementById('shareModal');
  if (modal) {
    // Add close button if doesn't exist
    if (!modal.querySelector('.share-modal-close')) {
      const closeBtn = document.createElement('button');
      closeBtn.className = 'share-modal-close';
      closeBtn.innerHTML = '✕';
      closeBtn.onclick = closeShareModal;
      modal.insertBefore(closeBtn, modal.firstChild);
    }
    
    // Generate preview
    generateSharePreview();
    
    // Show modal with animation
    modal.classList.add('active');
    backdrop.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
}

function closeShareModal() {
  const modal = document.getElementById('shareModal');
  const backdrop = document.querySelector('.share-backdrop');
  
  if (modal) modal.classList.remove('active');
  if (backdrop) backdrop.classList.remove('active');
  document.body.style.overflow = '';
}

function generateSharePreview() {
  const previewContainer = document.getElementById('sharePreview');
  if (!previewContainer) return;
  
  const mealTime = currentMealTime.charAt(0).toUpperCase() + currentMealTime.slice(1);
  const date = new Date().toLocaleDateString('en-IN', { 
    day: 'numeric', 
    month: 'short', 
    year: 'numeric' 
  });
  
  const scoreResult = calculateMealScore();
  const avgGI = calculateAverageGI();
  const impact = avgGI < 40 ? 'Low' : avgGI < 65 ? 'Medium' : 'High';
  
  previewContainer.innerHTML = `
    <div class="share-preview-content">
      <div class="share-preview-header">
        <div class="share-preview-icon">🍽️</div>
        <div class="share-preview-title">
          <h4>My ${mealTime} - GDM Friendly</h4>
          <p>${date}</p>
        </div>
      </div>
      
      <div class="share-preview-foods">
        ${currentMeal.map(food => `
          <span class="share-food-tag">
            ${food.emoji} ${food.name}
          </span>
        `).join('')}
      </div>
      
      <div class="share-preview-score">
        <div class="share-stat">
          <span class="share-stat-value">${scoreResult.totalScore}</span>
          <span class="share-stat-label">Score</span>
        </div>
        <div class="share-stat">
          <span class="share-stat-value">${impact}</span>
          <span class="share-stat-label">GI Impact</span>
        </div>
        <div class="share-stat">
          <span class="share-stat-value">${currentMeal.length}</span>
          <span class="share-stat-label">Items</span>
        </div>
      </div>
    </div>
  `;
}

function shareViaWhatsApp() {
  const mealText = generateShareText();
  const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(mealText)}`;
  window.open(whatsappUrl, '_blank');
  closeShareModal();
  showShareSuccess('Shared to WhatsApp! 💬');
}

function downloadMealImage() {
  // For now, copy text. You can implement canvas-based image generation later
  const mealText = generateShareText();
  
  // Create a simple alert or notification
  alert('📷 Image download feature coming soon!\n\nFor now, you can:\n1. Take a screenshot\n2. Share via text using other options');
  
  showShareSuccess('Tip: Take a screenshot to share as image! 📸');
}

function copyMealLink() {
  const mealText = generateShareText();
  
  // Copy to clipboard
  if (navigator.clipboard) {
    navigator.clipboard.writeText(mealText).then(() => {
      closeShareModal();
      showShareSuccess('Meal details copied! 🔗');
    }).catch(() => {
      fallbackCopyToClipboard(mealText);
    });
  } else {
    fallbackCopyToClipboard(mealText);
  }
}

function fallbackCopyToClipboard(text) {
  const textArea = document.createElement('textarea');
  textArea.value = text;
  textArea.style.position = 'fixed';
  textArea.style.left = '-999999px';
  document.body.appendChild(textArea);
  textArea.select();
  
  try {
    document.execCommand('copy');
    closeShareModal();
    showShareSuccess('Meal details copied! 🔗');
  } catch (err) {
    alert('Failed to copy. Please try again.');
  }
  
  document.body.removeChild(textArea);
}

function emailMeal() {
  const mealText = generateShareText();
  const subject = `My GDM-Friendly ${currentMealTime.charAt(0).toUpperCase() + currentMealTime.slice(1)}`;
  const mailtoUrl = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(mealText)}`;
  
  window.location.href = mailtoUrl;
  closeShareModal();
  showShareSuccess('Opening email client... ✉️');
}

function generateShareText() {
  const mealTime = currentMealTime.charAt(0).toUpperCase() + currentMealTime.slice(1);
  const date = new Date().toLocaleDateString('en-IN', { 
    day: 'numeric', 
    month: 'long', 
    year: 'numeric' 
  });
  
  const scoreResult = calculateMealScore();
  const avgGI = calculateAverageGI();
  const impact = avgGI < 40 ? 'Low' : avgGI < 65 ? 'Medium' : 'High';
  
  const foodList = currentMeal.map(food => `${food.emoji} ${food.name}`).join(', ');
  
  return `🍽️ My GDM-Friendly ${mealTime}
📅 ${date}

Foods: ${foodList}

📊 Meal Score: ${scoreResult.totalScore}/100
📈 Glucose Impact: ${impact}
🥗 Items: ${currentMeal.length}

Created with Nari Swasthya GDM Meal Planner 💕
#GestationalDiabetes #HealthyPregnancy #GDMFriendly`;
}

function showShareSuccess(message) {
  // Remove existing success notifications
  const existing = document.querySelector('.share-success');
  if (existing) existing.remove();
  
  // Create success notification
  const notification = document.createElement('div');
  notification.className = 'share-success';
  notification.innerHTML = `
    <span class="share-success-icon">✓</span>
    <span>${message}</span>
  `;
  document.body.appendChild(notification);
  
  // Auto-remove after 3 seconds
  setTimeout(() => {
    notification.style.animation = 'slideInUp 0.3s ease reverse';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// Close modal on ESC key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeShareModal();
  }
});


// ===================================
// FOOD INFO TOOLTIPS SYSTEM
// ===================================

function showFoodInfo(foodId) {
  // Create backdrop if doesn't exist
  let backdrop = document.querySelector('.tooltip-backdrop');
  if (!backdrop) {
    backdrop = document.createElement('div');
    backdrop.className = 'tooltip-backdrop';
    backdrop.onclick = closeFoodInfo;
    document.body.appendChild(backdrop);
  }
  
  // Get the tooltip element
  const tooltip = document.getElementById(`tooltip-${foodId}`);
  
  if (tooltip) {
    // Show tooltip and backdrop
    tooltip.classList.add('active');
    backdrop.classList.add('active');
    document.body.style.overflow = 'hidden';
  } else {
    console.warn(`Tooltip for ${foodId} not found. Creating dynamic tooltip...`);
    createDynamicTooltip(foodId);
  }
}

function closeFoodInfo() {
  // Close all tooltips
  const tooltips = document.querySelectorAll('.food-info-tooltip');
  tooltips.forEach(tooltip => {
    tooltip.classList.remove('active');
  });
  
  // Hide backdrop
  const backdrop = document.querySelector('.tooltip-backdrop');
  if (backdrop) {
    backdrop.classList.remove('active');
  }
  
  document.body.style.overflow = '';
}

// Dynamic tooltip creation for foods without predefined tooltips
function createDynamicTooltip(foodId) {
  // Food database with nutritional info
  
  
  const foodData = foodDatabase[foodId];
  
  if (!foodData) {
    alert('Nutritional information coming soon!');
    return;
  }
  
  // Create tooltip HTML
  const tooltipHTML = `
    <div class="food-info-tooltip active" id="tooltip-${foodId}">
      <div class="tooltip-header">
        <h4>${foodData.emoji} ${foodData.name}</h4>
        <button class="close-tooltip" onclick="closeFoodInfo()">×</button>
      </div>
      <div class="tooltip-body">
        <div class="nutrient-info">
          <span class="label">GI:</span>
          <span class="value">${foodData.gi}</span>
        </div>
        <div class="nutrient-info">
          <span class="label">Fiber:</span>
          <span class="value">${foodData.fiber}</span>
        </div>
        <div class="nutrient-info">
          <span class="label">Benefits:</span>
          <ul>
            ${foodData.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
          </ul>
        </div>
        <div class="portion-guide">
          <h5>Serving Guide:</h5>
          <div class="portion-visual">
            <p>${foodData.serving}</p>
          </div>
        </div>
        <div class="recipe-links">
          <h5>Try These Recipes:</h5>
          ${foodData.recipes.map(recipe => 
            `<a href="${recipe.link}">${recipe.name}</a>`
          ).join('')}
        </div>
      </div>
    </div>
  `;
  
  // Add to body
  document.body.insertAdjacentHTML('beforeend', tooltipHTML);
  
  // Show backdrop
  let backdrop = document.querySelector('.tooltip-backdrop');
  if (!backdrop) {
    backdrop = document.createElement('div');
    backdrop.className = 'tooltip-backdrop';
    backdrop.onclick = closeFoodInfo;
    document.body.appendChild(backdrop);
  }
  backdrop.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// Close tooltip on ESC key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeFoodInfo();
  }
});

// Prevent tooltip from closing when clicking inside it
document.addEventListener('click', function(e) {
  if (e.target.closest('.food-info-tooltip')) {
    e.stopPropagation();
  }
});


// Daily Tips Rotation
const dailyTips = [
  "Did you know? Eating vegetables first can reduce glucose spikes by 30%!",
  "Tip: A 15-minute walk after meals can lower blood sugar by 20-25%.",
  "Remember: Drinking water before meals helps control portion sizes.",
  "Fact: Cinnamon may help improve insulin sensitivity naturally.",
  "Pro tip: Split larger meals into 5-6 smaller ones throughout the day.",
  "Reminder: Stress management is as important as diet for blood sugar control.",
  "Did you know? Adequate sleep (7-9 hours) helps regulate blood glucose.",
  "Tip: Pairing protein with carbs slows down sugar absorption.",
  "Fact: Regular monitoring helps you understand your body's patterns.",
  "Remember: You're not alone - 3-25% of pregnancies face GDM in India."
];

function rotateDailyTip() {
  const tipElement = document.getElementById('dailyTip');
  if (tipElement) {
    const randomTip = dailyTips[Math.floor(Math.random() * dailyTips.length)];
    tipElement.style.opacity = '0';
    setTimeout(() => {
      tipElement.textContent = randomTip;
      tipElement.style.opacity = '1';
    }, 300);
  }
}

// Change tip every 10 seconds
setInterval(rotateDailyTip, 10000);

// ===================================
// SUGAR TRACKER FUNCTIONALITY
// ===================================

let glucoseData = [];
let selectedReadingType = null;
let currentChart = null;

// Baby size reference by week
const babySizes = {
  1: 'poppy seed', 8: 'raspberry', 12: 'lime', 16: 'avocado',
  20: 'banana', 24: 'corn', 28: 'eggplant', 32: 'jicama',
  36: 'papaya', 40: 'watermelon'
};

function openSugarTracker() {
  console.log('Opening Sugar Tracker...'); // Debug log
  
  const modal = document.getElementById('sugarTrackerModal');
  const backdrop = document.getElementById('trackerBackdrop');
  
  console.log('Modal element:', modal); // Debug log
  console.log('Backdrop element:', backdrop); // Debug log
  
  if (modal && backdrop) {
    modal.classList.add('active');
    backdrop.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // Load saved data
    try {
      loadGlucoseData();
      updateWeekInfo();
      setToday();
      renderTrendChart();
      renderHistoryTable();
      generateInsights();
      console.log('Sugar Tracker opened successfully!'); // Debug log
    } catch (error) {
      console.error('Error initializing tracker:', error);
    }
  } else {
    console.error('Modal or backdrop not found!'); // Debug log
    if (!modal) console.error('sugarTrackerModal element is missing');
    if (!backdrop) console.error('trackerBackdrop element is missing');
  }
}

function closeSugarTracker() {
  const modal = document.getElementById('sugarTrackerModal');
  const backdrop = document.getElementById('trackerBackdrop');
  
  if (modal && backdrop) {
    modal.classList.remove('active');
    backdrop.classList.remove('active');
    document.body.style.overflow = '';
  }
}

function updateWeekInfo() {
  const weekSlider = document.getElementById('weekSlider');
  const weekNumber = document.getElementById('currentWeekNumber');
  const babySize = document.getElementById('babySize');
  
  if (weekSlider) {
    weekSlider.addEventListener('input', function() {
      const week = parseInt(this.value);
      if (weekNumber) weekNumber.textContent = week;
      
      // Find closest baby size
      const sizeWeeks = Object.keys(babySizes).map(Number).sort((a, b) => a - b);
      const closestWeek = sizeWeeks.reduce((prev, curr) => {
        return Math.abs(curr - week) < Math.abs(prev - week) ? curr : prev;
      });
      
      if (babySize) babySize.textContent = babySizes[closestWeek];
    });
  }
}

function setToday() {
  const dateInput = document.getElementById('entryDate');
  if (dateInput) {
    const today = new Date().toISOString().split('T')[0];
    dateInput.value = today;
  }
}

function selectReadingType(type) {
  selectedReadingType = type;
  
  // Update UI
  document.querySelectorAll('.reading-type-btn').forEach(btn => {
    btn.classList.remove('selected');
  });
  
  const selectedBtn = document.querySelector(`[data-type="${type}"]`);
  if (selectedBtn) {
    selectedBtn.classList.add('selected');
  }
}

function setQuickValue(value) {
  const input = document.getElementById('glucoseValue');
  if (input) {
    input.value = value;
    input.focus();
  }
}

function saveGlucoseEntry() {
  const dateInput = document.getElementById('entryDate');
  const glucoseInput = document.getElementById('glucoseValue');
  const notesInput = document.getElementById('entryNotes');
  
  if (!selectedReadingType) {
    alert('Please select a reading type (Fasting, Post-Breakfast, etc.)');
    return;
  }
  
  if (!glucoseInput || !glucoseInput.value) {
    alert('Please enter a glucose value');
    return;
  }
  
  const value = parseFloat(glucoseInput.value);
  if (value < 40 || value > 300) {
    alert('Please enter a realistic value between 40-300 mg/dL');
    return;
  }
  
  // Create entry
  const entry = {
    id: Date.now(),
    date: dateInput.value,
    time: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }),
    type: selectedReadingType,
    value: value,
    notes: notesInput.value || '',
    week: parseInt(document.getElementById('weekSlider').value)
  };
  
  // Add to data
  glucoseData.push(entry);
  saveGlucoseData();
  
  // Show success message
  showSuccessNotification('✅ Reading saved successfully!');
  
  // Reset form
  glucoseInput.value = '';
  notesInput.value = '';
  selectedReadingType = null;
  document.querySelectorAll('.reading-type-btn').forEach(btn => {
    btn.classList.remove('selected');
  });
  
  // Update displays
  renderTrendChart();
  renderHistoryTable();
  generateInsights();
}

function loadGlucoseData() {
  const saved = localStorage.getItem('gdm_glucose_data');
  if (saved) {
    glucoseData = JSON.parse(saved);
  }
}

function saveGlucoseData() {
  localStorage.setItem('gdm_glucose_data', JSON.stringify(glucoseData));
}

function renderTrendChart() {
  const canvas = document.getElementById('trendChart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  
  // Destroy existing chart
  if (currentChart) {
    currentChart.destroy();
  }
  
  // Get last 7 days of data
  const today = new Date();
  const last7Days = [];
  for (let i = 6; i >= 0; i--) {
    const date = new Date(today);
    date.setDate(date.getDate() - i);
    last7Days.push(date.toISOString().split('T')[0]);
  }
  
  // Aggregate data by date
  const dataByDate = {};
  last7Days.forEach(date => {
    dataByDate[date] = glucoseData
      .filter(entry => entry.date === date)
      .map(entry => entry.value);
  });
  
  // Calculate averages
  const avgValues = last7Days.map(date => {
    const values = dataByDate[date];
    if (values.length === 0) return null;
    return values.reduce((a, b) => a + b, 0) / values.length;
  });
  
  // Create chart (simplified version - you can use Chart.js library for better charts)
  const labels = last7Days.map(date => {
    const d = new Date(date);
    return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
  });
  
  // Update stats
  const validValues = avgValues.filter(v => v !== null);
  if (validValues.length > 0) {
    const avg = (validValues.reduce((a, b) => a + b, 0) / validValues.length).toFixed(1);
    document.getElementById('avgGlucose').textContent = avg + ' mg/dL';
    
    // Calculate in-range percentage
    const inRange = glucoseData.filter(entry => {
      if (entry.type === 'fasting') return entry.value < 95;
      return entry.value < 140;
    }).length;
    
    const percent = glucoseData.length > 0 ? ((inRange / glucoseData.length) * 100).toFixed(0) : 0;
    document.getElementById('inRangePercent').textContent = percent + '%';
  }
  
  document.getElementById('totalReadings').textContent = glucoseData.length;
  
  // Note: For a real chart, integrate Chart.js library
  // This is a placeholder - you should add Chart.js via CDN in HTML
}

function renderHistoryTable() {
  const tbody = document.getElementById('historyTableBody');
  if (!tbody) return;
  
  if (glucoseData.length === 0) {
    tbody.innerHTML = '<tr class="no-data-row"><td colspan="7">No readings yet. Start tracking above! 👆</td></tr>';
    return;
  }
  
  // Sort by date (newest first)
  const sorted = [...glucoseData].sort((a, b) => {
    return new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time);
  });
  
  tbody.innerHTML = sorted.map(entry => {
    // Determine status
    let status = 'normal';
    let statusText = 'Normal';
    
    if (entry.type === 'fasting') {
      if (entry.value >= 95) {
        status = 'high';
        statusText = 'High';
      }
    } else {
      if (entry.value >= 140) {
        status = 'high';
        statusText = 'High';
      } else if (entry.value < 70) {
        status = 'low';
        statusText = 'Low';
      }
    }
    
    const typeLabels = {
      fasting: '🌅 Fasting',
      breakfast: '🍳 Post-Breakfast',
      lunch: '🍽️ Post-Lunch',
      dinner: '🌙 Post-Dinner'
    };
    
    return `
      <tr>
        <td>${new Date(entry.date).toLocaleDateString()}</td>
        <td>${entry.time}</td>
        <td>${typeLabels[entry.type] || entry.type}</td>
        <td><strong>${entry.value}</strong> mg/dL</td>
        <td><span class="status-badge status-${status}">${statusText}</span></td>
        <td>${entry.notes || '-'}</td>
        <td><button class="delete-btn" onclick="deleteEntry(${entry.id})">Delete</button></td>
      </tr>
    `;
  }).join('');
}

function deleteEntry(id) {
  if (confirm('Are you sure you want to delete this reading?')) {
    glucoseData = glucoseData.filter(entry => entry.id !== id);
    saveGlucoseData();
    renderHistoryTable();
    renderTrendChart();
    generateInsights();
    showSuccessNotification('Reading deleted');
  }
}

function generateInsights() {
  const section = document.getElementById('insightsSection');
  const list = document.getElementById('insightsList');
  
  if (!section || !list || glucoseData.length < 3) {
    if (section) section.style.display = 'none';
    return;
  }
  
  section.style.display = 'block';
  const insights = [];
  
  // Pattern detection
  const fastingReadings = glucoseData.filter(e => e.type === 'fasting');
  const highFasting = fastingReadings.filter(e => e.value >= 95);
  
  if (highFasting.length > fastingReadings.length * 0.5 && fastingReadings.length >= 3) {
    insights.push({
      title: 'Fasting Levels Need Attention',
      message: 'More than half of your fasting readings are above target. Consider having a protein-rich snack before bed.'
    });
  }
  
  // Check for patterns
  const postMeal = glucoseData.filter(e => e.type !== 'fasting');
  const highPostMeal = postMeal.filter(e => e.value >= 140);
  
  if (highPostMeal.length > postMeal.length * 0.5 && postMeal.length >= 3) {
    insights.push({
      title: 'Post-Meal Spikes Detected',
      message: 'Consider reducing carb portions and adding more protein and vegetables to your meals.'
    });
  }
  
  // Positive feedback
  const recentReadings = glucoseData.slice(-7);
  const allInRange = recentReadings.every(entry => {
    if (entry.type === 'fasting') return entry.value < 95;
    return entry.value < 140;
  });
  
  if (allInRange && recentReadings.length >= 5) {
    insights.push({
      title: '🎉 Excellent Control!',
      message: 'All your recent readings are within target range. Keep up the great work!'
    });
  }
  
  list.innerHTML = insights.map(insight => `
    <div class="insight-card">
      <h4>${insight.title}</h4>
      <p>${insight.message}</p>
    </div>
  `).join('');
}

function filterTrend(filter) {
  // Update active button
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  event.target.classList.add('active');
  
  // Re-render chart with filter
  // (implement filtering logic here)
  renderTrendChart();
}


function updateBodySimulation(scenario) {
  // SVG-based updates instead
  const pancreasGlow = document.getElementById('sim-pancreas-glow');
  const liverGlow = document.getElementById('sim-liver-glow');
  const placentaGlow = document.getElementById('sim-placenta-glow');
  
  // Reset all glows
  if (pancreasGlow) pancreasGlow.style.opacity = '0';
  if (liverGlow) liverGlow.style.opacity = '0';
  if (placentaGlow) placentaGlow.style.opacity = '0';
  
  // Activate based on scenario
  switch(scenario) {
    case 'fasting':
      if (liverGlow) liverGlow.style.opacity = '0.6';
      break;
    case 'after-meal':
      if (pancreasGlow) pancreasGlow.style.opacity = '0.8';
      if (placentaGlow) placentaGlow.style.opacity = '0.5';
      break;
    case 'exercise':
      if (liverGlow) liverGlow.style.opacity = '0.4';
      break;
    case 'insulin':
      if (pancreasGlow) pancreasGlow.style.opacity = '1';
      break;
  }
}


function showSuccessNotification(message) {
  const notification = document.createElement('div');
  notification.className = 'share-success';
  notification.innerHTML = `
    <span class="share-success-icon">✓</span>
    <span>${message}</span>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, 3000);
}

// Close on ESC key
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeSugarTracker();
  }
});


// Add smooth transition to tip text
document.addEventListener('DOMContentLoaded', function() {
  const tipElement = document.getElementById('dailyTip');
  if (tipElement) {
    tipElement.style.transition = 'opacity 0.3s ease';
  }
});


// ========================================
// TRACK MY LEVELS - MEAL PLANNER SECTION
// ========================================

let glucoseReadings = [];

// Initialize tracker
document.addEventListener('DOMContentLoaded', function() {
  loadReadings();
  setCurrentDateTime();
  updateTrackerStats();
});

// Toggle tracker visibility
function toggleTracker() {
  const content = document.getElementById('trackContent');
  const btn = document.getElementById('toggleTrackerBtn');
  
  if (content && btn) {
    content.classList.toggle('collapsed');
    btn.classList.toggle('collapsed');
  }
}

// Set current date and time
function setCurrentDateTime() {
  const dateInput = document.getElementById('trackDate');
  const timeInput = document.getElementById('trackTime');
  
  if (dateInput && timeInput) {
    const now = new Date();
    dateInput.value = now.toISOString().split('T')[0];
    timeInput.value = now.toTimeString().slice(0, 5);
  }
}

// Monitor glucose input for real-time feedback
document.addEventListener('DOMContentLoaded', function() {
  const glucoseInput = document.getElementById('trackGlucose');
  const typeSelect = document.getElementById('trackType');
  const hint = document.getElementById('glucoseHint');
  
  if (glucoseInput && hint) {
    glucoseInput.addEventListener('input', function() {
      const value = parseFloat(this.value);
      const type = typeSelect?.value || '';
      
      if (isNaN(value) || value <= 0) {
        hint.className = 'input-hint';
        return;
      }
      
      let status = '';
      let message = '';
      
      if (type === 'fasting') {
        if (value < 95) {
          status = 'normal';
          message = '✓ Perfect! Within fasting target (< 95 mg/dL)';
        } else if (value < 105) {
          status = 'high';
          message = '⚠ Slightly elevated. Monitor and consult doctor.';
        } else {
          status = 'high';
          message = '❌ Above target. Please contact your doctor.';
        }
      } else if (type.includes('post')) {
        if (value < 140) {
          status = 'normal';
          message = '✓ Excellent! Within post-meal target (< 140 mg/dL)';
        } else if (value < 160) {
          status = 'high';
          message = '⚠ Elevated. Consider adjusting portion sizes.';
        } else {
          status = 'high';
          message = '❌ Too high. Contact your doctor.';
        }
      } else {
        if (value < 140) {
          status = 'normal';
          message = '✓ Good reading!';
        } else {
          status = 'high';
          message = '⚠ Elevated reading';
        }
      }
      
      hint.className = 'input-hint show ' + status;
      hint.textContent = message;
    });
  }
});

// Save reading
function saveReading() {
  const date = document.getElementById('trackDate')?.value;
  const time = document.getElementById('trackTime')?.value;
  const type = document.getElementById('trackType')?.value;
  const glucose = document.getElementById('trackGlucose')?.value;
  const meal = document.getElementById('trackMeal')?.value;
  const notes = document.getElementById('trackNotes')?.value;
  
  // Validation
  if (!date || !time || !type || !glucose) {
    alert('⚠️ Please fill in all required fields:\n• Date\n• Time\n• Reading Type\n• Glucose Level');
    return;
  }
  
  const glucoseValue = parseFloat(glucose);
  if (isNaN(glucoseValue) || glucoseValue < 40 || glucoseValue > 400) {
    alert('⚠️ Please enter a valid glucose reading between 40-400 mg/dL');
    return;
  }
  
  // Create reading object
  const reading = {
    id: Date.now(),
    date: date,
    time: time,
    type: type,
    glucose: glucoseValue,
    meal: meal.trim(),
    notes: notes.trim(),
    timestamp: new Date(`${date}T${time}`).getTime()
  };
  
  // Add to array
  glucoseReadings.unshift(reading); // Add to beginning
  
  // Save to localStorage
  saveReadings();
  
  // Update UI
  updateTrackerStats();
  renderReadingsTable();
  generateInsights();
  
  // Show success message
  showSuccessMessage('✅ Reading saved successfully!');
  
  // Clear form
  clearTrackForm();
  
  // Set new date/time
  setCurrentDateTime();
}

// Clear form
function clearTrackForm() {
  document.getElementById('trackType').value = '';
  document.getElementById('trackGlucose').value = '';
  document.getElementById('trackMeal').value = '';
  document.getElementById('trackNotes').value = '';
  
  const hint = document.getElementById('glucoseHint');
  if (hint) {
    hint.className = 'input-hint';
    hint.textContent = '';
  }
}

// Update tracker statistics
function updateTrackerStats() {
  const today = new Date().toISOString().split('T')[0];
  const todayReadings = glucoseReadings.filter(r => r.date === today);
  
  // Today's count
  document.getElementById('todayCount').textContent = todayReadings.length;
  
  // In range count
  const inRange = todayReadings.filter(r => {
    if (r.type === 'fasting') return r.glucose < 95;
    return r.glucose < 140;
  }).length;
  document.getElementById('inRangeCount').textContent = inRange;
  
  // Average reading
  if (todayReadings.length > 0) {
    const avg = todayReadings.reduce((sum, r) => sum + r.glucose, 0) / todayReadings.length;
    document.getElementById('avgReading').textContent = avg.toFixed(0);
  } else {
    document.getElementById('avgReading').textContent = '--';
  }
}

// Render readings table
function renderReadingsTable() {
  const tbody = document.getElementById('readingsTableBody');
  if (!tbody) return;
  
  if (glucoseReadings.length === 0) {
    tbody.innerHTML = `
      <tr class="no-data-row">
        <td colspan="8">
          <div class="no-data-message">
            <span class="no-data-icon">📊</span>
            <p>No readings yet. Add your first reading above!</p>
          </div>
        </td>
      </tr>
    `;
    return;
  }
  
  // Show only last 10 readings
  const recentReadings = glucoseReadings.slice(0, 10);
  
  tbody.innerHTML = recentReadings.map(reading => {
    // Determine status
    let status = 'normal';
    let statusText = 'Normal';
    
    if (reading.type === 'fasting') {
      if (reading.glucose >= 95) {
        status = 'high';
        statusText = 'High';
      }
    } else if (reading.type.includes('post')) {
      if (reading.glucose >= 140) {
        status = 'high';
        statusText = 'High';
      }
    } else {
      if (reading.glucose >= 140) {
        status = 'high';
        statusText = 'High';
      } else if (reading.glucose < 70) {
        status = 'low';
        statusText = 'Low';
      }
    }
    
    // Format type
    const typeLabels = {
      'fasting': '🌅 Fasting',
      'post-breakfast': '🍳 Post-Breakfast',
      'pre-lunch': '🕐 Pre-Lunch',
      'post-lunch': '🍽️ Post-Lunch',
      'pre-dinner': '🕔 Pre-Dinner',
      'post-dinner': '🌙 Post-Dinner',
      'bedtime': '😴 Bedtime',
      'other': '⭐ Other'
    };
    
    const typeLabel = typeLabels[reading.type] || reading.type;
    
    return `
      <tr>
        <td>${new Date(reading.date).toLocaleDateString('en-IN', { day: '2-digit', month: 'short' })}</td>
        <td>${reading.time}</td>
        <td>${typeLabel}</td>
        <td><strong>${reading.glucose}</strong> mg/dL</td>
        <td><span class="status-badge-track status-${status}-track">${statusText}</span></td>
        <td>${reading.meal || '-'}</td>
        <td>${reading.notes || '-'}</td>
        <td>
          <button class="delete-reading-btn" onclick="deleteReading(${reading.id})">
            Delete
          </button>
        </td>
      </tr>
    `;
  }).join('');
}

// Delete reading
function deleteReading(id) {
  if (confirm('Are you sure you want to delete this reading?')) {
    glucoseReadings = glucoseReadings.filter(r => r.id !== id);
    saveReadings();
    updateTrackerStats();
    renderReadingsTable();
    generateInsights();
    showSuccessMessage('Reading deleted');
  }
}

// Clear all readings
function clearAllReadings() {
  if (confirm('⚠️ Are you sure you want to delete ALL readings?\n\nThis cannot be undone!')) {
    glucoseReadings = [];
    saveReadings();
    updateTrackerStats();
    renderReadingsTable();
    document.getElementById('trackInsights').style.display = 'none';
    showSuccessMessage('All readings cleared');
  }
}

// Save to localStorage
function saveReadings() {
  localStorage.setItem('gdm_meal_tracker_readings', JSON.stringify(glucoseReadings));
}

// Load from localStorage
function loadReadings() {
  const saved = localStorage.getItem('gdm_meal_tracker_readings');
  if (saved) {
    try {
      glucoseReadings = JSON.parse(saved);
      renderReadingsTable();
    } catch (e) {
      console.error('Error loading readings:', e);
      glucoseReadings = [];
    }
  }
}

// Export readings
function exportReadings() {
  if (glucoseReadings.length === 0) {
    alert('No readings to export!');
    return;
  }
  
  // Create CSV content
  let csv = 'Date,Time,Type,Glucose (mg/dL),Meal,Notes\n';
  
  glucoseReadings.forEach(reading => {
    const typeLabels = {
      'fasting': 'Fasting',
      'post-breakfast': 'Post-Breakfast',
      'pre-lunch': 'Pre-Lunch',
      'post-lunch': 'Post-Lunch',
      'pre-dinner': 'Pre-Dinner',
      'post-dinner': 'Post-Dinner',
      'bedtime': 'Bedtime',
      'other': 'Other'
    };
    
    csv += `${reading.date},${reading.time},${typeLabels[reading.type] || reading.type},${reading.glucose},"${reading.meal}","${reading.notes}"\n`;
  });
  
  // Create download link
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `glucose-readings-${new Date().toISOString().split('T')[0]}.csv`;
  a.click();
  window.URL.revokeObjectURL(url);
  
  showSuccessMessage('✅ Readings exported successfully!');
}

// Generate insights
function generateInsights() {
  const insightsSection = document.getElementById('trackInsights');
  const insightsGrid = document.getElementById('insightsGrid');
  
  if (!insightsSection || !insightsGrid || glucoseReadings.length < 3) {
    if (insightsSection) insightsSection.style.display = 'none';
    return;
  }
  
  insightsSection.style.display = 'block';
  const insights = [];
  
  // Pattern: High fasting levels
  const fastingReadings = glucoseReadings.filter(r => r.type === 'fasting');
  const highFasting = fastingReadings.filter(r => r.glucose >= 95);
  
  if (fastingReadings.length >= 3 && highFasting.length > fastingReadings.length * 0.5) {
    insights.push({
      title: 'Fasting Levels Pattern',
      message: 'Your fasting readings are frequently above target. Try a protein-rich snack before bed (e.g., handful of nuts, cheese, boiled egg).'
    });
  }
  
  // Pattern: Post-meal spikes
  const postMealReadings = glucoseReadings.filter(r => r.type.includes('post'));
  const highPostMeal = postMealReadings.filter(r => r.glucose >= 140);
  
  if (postMealReadings.length >= 3 && highPostMeal.length > postMealReadings.length * 0.5) {
    insights.push({
      title: 'Post-Meal Spikes Detected',
      message: 'Consider reducing carb portions, eating vegetables first, and taking a 15-minute walk after meals.'
    });
  }
  
  // Positive feedback
  const recent = glucoseReadings.slice(0, 5);
  const allGood = recent.every(r => {
    if (r.type === 'fasting') return r.glucose < 95;
    return r.glucose < 140;
  });
  
  if (allGood && recent.length >= 5) {
    insights.push({
      title: '🎉 Excellent Control!',
      message: 'All your recent readings are within target range. Keep up the amazing work with your diet and lifestyle!'
    });
  }
  
  // Render insights
  if (insights.length > 0) {
    insightsGrid.innerHTML = insights.map(insight => `
      <div class="insight-card-track">
        <h5>${insight.title}</h5>
        <p>${insight.message}</p>
      </div>
    `).join('');
  } else {
    insightsSection.style.display = 'none';
  }
}

// Show success message
function showSuccessMessage(message) {
  const notification = document.createElement('div');
  notification.className = 'share-success';
  notification.innerHTML = `
    <span class="share-success-icon">✓</span>
    <span>${message}</span>
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, 3000);
}


// Scroll to specific topic sections
function scrollToTopic(topicId) {
  const topicMap = {
    'monitoring': 'topic-14', // Blood Sugar Monitoring
    'nutrition': 'topic-1',   // Diet & Nutrition
    'exercise': 'topic-2',    // Exercise
    'treatment': 'topic-15',  // Treatment Options
    'baby-health': 'topic-18' // Baby's Health
  };
  
  const targetId = topicMap[topicId];
  if (targetId) {
    const element = document.getElementById(targetId);
    if (element) {
      element.scrollIntoView({ behavior: 'smooth', block: 'center' });
      element.classList.add('highlight-pulse');
      setTimeout(() => element.classList.remove('highlight-pulse'), 2000);
    }
  }
}

// =========================================
// PARTICLE CANVAS ANIMATION - Neural Network
// =========================================
const particleCanvas = document.getElementById('particleCanvas');
if (particleCanvas) {
  const ctx = particleCanvas.getContext('2d');
  
  function resizeCanvas() {
    particleCanvas.width = particleCanvas.offsetWidth;
    particleCanvas.height = particleCanvas.offsetHeight;
  }
  
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);
  
  const particles = [];
  const particleCount = 80;
  
  class Particle {
    constructor() {
      this.x = Math.random() * particleCanvas.width;
      this.y = Math.random() * particleCanvas.height;
      this.vx = (Math.random() - 0.5) * 0.5;
      this.vy = (Math.random() - 0.5) * 0.5;
      this.radius = Math.random() * 2 + 1;
    }
    
    update() {
      this.x += this.vx;
      this.y += this.vy;
      
      if (this.x < 0 || this.x > particleCanvas.width) this.vx *= -1;
      if (this.y < 0 || this.y > particleCanvas.height) this.vy *= -1;
    }
    
    draw() {
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(236, 64, 122, 0.6)';
      ctx.fill();
    }
  }
  
  for (let i = 0; i < particleCount; i++) {
    particles.push(new Particle());
  }
  
  function connectParticles() {
    for (let i = 0; i < particles.length; i++) {
      for (let j = i + 1; j < particles.length; j++) {
        const dx = particles[i].x - particles[j].x;
        const dy = particles[i].y - particles[j].y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < 100) {
          ctx.beginPath();
          ctx.strokeStyle = `rgba(236, 64, 122, ${0.2 * (1 - distance / 100)})`;
          ctx.lineWidth = 1;
          ctx.moveTo(particles[i].x, particles[i].y);
          ctx.lineTo(particles[j].x, particles[j].y);
          ctx.stroke();
        }
      }
    }
  }
  
  function animateParticles() {
    ctx.clearRect(0, 0, particleCanvas.width, particleCanvas.height);
    
    particles.forEach(particle => {
      particle.update();
      particle.draw();
    });
    
    connectParticles();
    
    requestAnimationFrame(animateParticles);
  }
  
  animateParticles();
}


let selectedMealType = '';
let selectedFoods = [];
let currentFilter = 'all';
let compareSlotA = null;
let compareSlotB = null;
let mealEntries = [];

// Initialize tracker
function initializeTracker() {
  loadMealEntries();
  updateHistoryTab();
  updateQuickStats();
}

// Switch Tabs
function switchTrackerTab(tabName) {
  // Remove active class from all tabs and content
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
  
  // Add active class to selected tab
  document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
  document.getElementById(`tab-${tabName}`).classList.add('active');
}

// Set current date/time
function setNow() {
  const now = new Date();
  const formatted = now.toISOString().slice(0, 16);
  document.getElementById('mealDateTime').value = formatted;
  updateLivePreview();
}

// Select Meal Type
function selectMealType(type) {
  selectedMealType = type;
  document.querySelectorAll('.meal-type-card').forEach(card => {
    card.classList.remove('selected');
  });
  document.querySelector(`[data-type="${type}"]`).classList.add('selected');
  updateLivePreview();
}

// Set Glucose Value
function setGlucose(value) {
  document.getElementById('glucoseReading').value = value;
  updateGlucoseStatus(value);
  updateLivePreview();
}

// Update Glucose Status
function updateGlucoseStatus(value) {
  const statusEl = document.getElementById('glucoseStatus');
  if (!value) {
    statusEl.classList.remove('show');
    return;
  }
  
  statusEl.classList.add('show');
  statusEl.classList.remove('normal', 'high', 'low');
  
  if (selectedMealType === 'fasting') {
    if (value < 95) {
      statusEl.textContent = '✓ Normal';
      statusEl.classList.add('normal');
    } else {
      statusEl.textContent = '⚠ High';
      statusEl.classList.add('high');
    }
  } else {
    if (value < 140) {
      statusEl.textContent = '✓ Normal';
      statusEl.classList.add('normal');
    } else {
      statusEl.textContent = '⚠ High';
      statusEl.classList.add('high');
    }
  }
}

// Food Search Inline
function searchFoodsInline() {
  const query = document.getElementById('foodSearchInput').value.toLowerCase();
  const suggestionsEl = document.getElementById('foodSuggestions');
  
  if (query.length < 2) {
    suggestionsEl.classList.remove('show');
    return;
  }
  
  const matches = foodDatabase.filter(food => 
    food.name.toLowerCase().includes(query)
  ).slice(0, 8);
  
  if (matches.length === 0) {
    suggestionsEl.classList.remove('show');
    return;
  }
  
  suggestionsEl.innerHTML = matches.map(food => `
    <div class="food-suggestion-item" onclick="addFoodToMeal('${food.name}')">
      <div class="food-name-gi">
        <div class="food-name">${food.icon} ${food.name}</div>
        <div class="food-gi">GI: ${food.gi} • Carbs: ${food.carbs}g</div>
      </div>
      <span class="gi-badge gi-${food.impact}">${food.impact.toUpperCase()}</span>
    </div>
  `).join('');
  
  suggestionsEl.classList.add('show');
}

// Add Food to Meal
function addFoodToMeal(foodName) {
  if (!selectedFoods.includes(foodName)) {
    selectedFoods.push(foodName);
    updateSelectedFoods();
    document.getElementById('foodSearchInput').value = '';
    document.getElementById('foodSuggestions').classList.remove('show');
    updateLivePreview();
  }
}

// Update Selected Foods Display
function updateSelectedFoods() {
  const container = document.getElementById('selectedFoods');
  if (selectedFoods.length === 0) {
    container.innerHTML = '';
    return;
  }
  
  container.innerHTML = selectedFoods.map(food => `
    <div class="food-chip">
      <span>${food}</span>
      <button class="remove-food" onclick="removeFoodFromMeal('${food}')">×</button>
    </div>
  `).join('');
}

// Remove Food from Meal
function removeFoodFromMeal(foodName) {
  selectedFoods = selectedFoods.filter(f => f !== foodName);
  updateSelectedFoods();
  updateLivePreview();
}

// Update Live Preview
function updateLivePreview() {
  const previewEl = document.getElementById('entryPreview');
  const datetime = document.getElementById('mealDateTime').value;
  const glucose = document.getElementById('glucoseReading').value;
  const notes = document.getElementById('mealNotes').value;
  
  if (!selectedMealType && !glucose && selectedFoods.length === 0) {
    previewEl.innerHTML = `
      <div class="preview-placeholder">
        <div class="placeholder-icon">📝</div>
        <p>Start filling the form to see preview</p>
      </div>
    `;
    return;
  }
  
  const mealIcons = {
    fasting: '🌅',
    breakfast: '🍳',
    lunch: '🍽️',
    snack: '🥗',
    dinner: '🌙'
  };
  
  const mealNames = {
    fasting: 'Fasting',
    breakfast: 'Breakfast',
    lunch: 'Lunch',
    snack: 'Snack',
    dinner: 'Dinner'
  };
  
  previewEl.innerHTML = `
    <div class="preview-content">
      <div class="preview-header">
        <div class="preview-meal-type">
          <span>${mealIcons[selectedMealType] || '🍽️'}</span>
          <span>${mealNames[selectedMealType] || 'Meal'}</span>
        </div>
        <div class="preview-datetime">${datetime ? new Date(datetime).toLocaleString() : 'Not set'}</div>
      </div>
      ${glucose ? `
        <div class="preview-glucose">
          <div class="preview-glucose-value">${glucose} mg/dL</div>
        </div>
      ` : ''}
      ${selectedFoods.length > 0 ? `
        <div class="preview-foods">
          <div class="preview-foods-title">Foods:</div>
          <div class="entry-food-chips">
            ${selectedFoods.map(f => `<span class="entry-food-chip">${f}</span>`).join('')}
          </div>
        </div>
      ` : ''}
      ${notes ? `
        <div class="preview-notes">"${notes}"</div>
      ` : ''}
    </div>
  `;
}

// Save Meal Entry
function saveMealEntry() {
  const datetime = document.getElementById('mealDateTime').value;
  const glucose = document.getElementById('glucoseReading').value;
  const notes = document.getElementById('mealNotes').value;
  
  if (!selectedMealType || !glucose) {
    alert('Please select meal type and enter glucose reading');
    return;
  }
  
  const entry = {
    id: Date.now(),
    datetime: datetime || new Date().toISOString(),
    type: selectedMealType,
    glucose: parseInt(glucose),
    foods: [...selectedFoods],
    notes: notes
  };
  
  mealEntries.unshift(entry);
  saveMealEntries();
  
  // Show success message
  showSuccessToast('Entry saved successfully! 🎉');
  
  // Clear form
  clearMealForm();
  
  // Update other tabs
  updateHistoryTab();
  updateQuickStats();
}

// Clear Meal Form
function clearMealForm() {
  document.getElementById('mealDateTime').value = '';
  document.getElementById('glucoseReading').value = '';
  document.getElementById('mealNotes').value = '';
  document.getElementById('foodSearchInput').value = '';
  selectedMealType = '';
  selectedFoods = [];
  document.querySelectorAll('.meal-type-card').forEach(card => card.classList.remove('selected'));
  updateSelectedFoods();
  updateLivePreview();
  document.getElementById('glucoseStatus').classList.remove('show');
}

// Search Foods (Main Search Tab)
function performFoodSearch() {
  const query = document.getElementById('foodSearchMain').value.toLowerCase();
  const resultsEl = document.getElementById('searchResultsGrid');
  
  let foods = currentFilter === 'all' 
    ? foodDatabase 
    : foodDatabase.filter(f => f.category === currentFilter);
  
  if (query.length >= 2) {
    foods = foods.filter(f => f.name.toLowerCase().includes(query));
  }
  
  if (foods.length === 0) {
    resultsEl.innerHTML = `
      <div class="search-placeholder">
        <div class="placeholder-icon-large">🔍</div>
        <h4>No foods found</h4>
        <p>Try a different search term or category</p>
      </div>
    `;
    return;
  }
  
  resultsEl.innerHTML = foods.map(food => `
    <div class="food-card">
      <div class="food-card-header">
        <div>
          <div class="food-card-title">${food.icon} ${food.name}</div>
          <div class="food-card-category">${food.category}</div>
        </div>
        <span class="gi-badge gi-${food.impact}">${food.impact.toUpperCase()}</span>
      </div>
      <div class="food-card-stats">
        <div class="food-stat">
          <div class="stat-value-food">${food.gi}</div>
          <div class="stat-label-food">Glycemic Index</div>
        </div>
        <div class="food-stat">
          <div class="stat-value-food">${food.carbs}g</div>
          <div class="stat-label-food">Carbs/100g</div>
        </div>
      </div>
      <div class="food-card-footer">
        <span class="impact-label">Blood Sugar Impact: <strong>${food.impact.toUpperCase()}</strong></span>
        <button class="add-to-compare" onclick="quickAddToCompare('${food.name}')">+ Compare</button>
      </div>
    </div>
  `).join('');
}

// Filter Food Category
function filterFoodCategory(category) {
  currentFilter = category;
  document.querySelectorAll('.filter-chip').forEach(chip => chip.classList.remove('active'));
  document.querySelector(`[data-filter="${category}"]`).classList.add('active');
  performFoodSearch();
}

// Quick Add to Compare
function quickAddToCompare(foodName) {
  if (!compareSlotA) {
    compareSlotA = foodDatabase.find(f => f.name === foodName);
    document.getElementById('compareA').value = foodName;
    displayCompareFood('A', compareSlotA);
  } else if (!compareSlotB) {
    compareSlotB = foodDatabase.find(f => f.name === foodName);
    document.getElementById('compareB').value = foodName;
    displayCompareFood('B', compareSlotB);
  }
  
  if (compareSlotA && compareSlotB) {
    displayComparison();
    switchTrackerTab('compare');
  }
}

// Search for Compare
function searchForCompare(slot) {
  const query = document.getElementById(`compare${slot}`).value.toLowerCase();
  const suggestionsEl = document.getElementById(`suggestions${slot}`);
  
  if (!suggestionsEl) {
    console.error(`Suggestions element not found: suggestions${slot}`);
    return;
  }
  
  if (query.length < 2) {
    suggestionsEl.classList.remove('show');
    return;
  }
  
  // Convert foodDatabase object to array
  const foodArray = Object.values(foodDatabase);
  
  const matches = foodArray.filter(food => 
    food.name.toLowerCase().includes(query)
  ).slice(0, 6);
  
  if (matches.length === 0) {
    suggestionsEl.innerHTML = '<div class="food-suggestion-item no-match">No foods found</div>';
    suggestionsEl.classList.add('show');
    return;
  }
  
  suggestionsEl.innerHTML = matches.map(food => `
    <div class="food-suggestion-item" onclick="selectCompareFood('${slot}', '${food.name}')">
      <div class="food-name-gi">
        <div class="food-name">${food.emoji || food.icon || '🍽️'} ${food.name}</div>
        <div class="food-gi">GI: ${food.gi} • Carbs: ${food.carbsPerServing || food.carbs}g</div>
      </div>
    </div>
  `).join('');
  
  suggestionsEl.classList.add('show');
}

// Select Compare Food
// Select Compare Food
function selectCompareFood(slot, foodName) {
  // Convert object to array to use .find()
  const foodArray = Object.values(foodDatabase);
  const food = foodArray.find(f => f.name === foodName);
  
  if (!food) {
    console.error('Food not found:', foodName);
    return;
  }
  
  if (slot === 'A') {
    compareSlotA = food;
  } else {
    compareSlotB = food;
  }
  
  const inputEl = document.getElementById(`compare${slot}`);
  const suggestionsEl = document.getElementById(`suggestions${slot}`);
  
  if (inputEl) inputEl.value = foodName;
  if (suggestionsEl) suggestionsEl.classList.remove('show');
  
  displayCompareFood(slot, food);
  
  if (compareSlotA && compareSlotB) {
    displayComparison();
  }
}


// Display Compare Food
// Display Compare Food
function displayCompareFood(slot, food) {
  const containerEl = document.getElementById(`selected${slot}`);
  
  if (!containerEl) {
    console.error(`Container not found: selected${slot}`);
    return;
  }
  
  // Determine impact level based on GI
  let impact = 'low';
  if (food.gi > 70) impact = 'high';
  else if (food.gi > 55) impact = 'medium';
  
  containerEl.innerHTML = `
    <div class="comparison-food-detail">
      <div class="comparison-food-icon">${food.emoji || food.icon || '🍽️'}</div>
      <div class="comparison-food-name">${food.name}</div>
      <span class="gi-badge gi-${impact}">${impact.toUpperCase()} Impact</span>
    </div>
  `;
}


// Display Comparison Results
function displayComparison() {
  const resultsEl = document.getElementById('comparisonResults');
  
  if (!resultsEl) {
    console.error('comparisonResults element not found');
    return;
  }
  
  if (!compareSlotA || !compareSlotB) return;
  
  // Check if both foods are proteins (type or gi = 0)
  const bothProteins = (compareSlotA.type === 'protein' || compareSlotA.gi === 0) && 
                       (compareSlotB.type === 'protein' || compareSlotB.gi === 0);
  
  // Determine winner based on food type
  let winner, winnerFood, loserFood, winReason;
  
  if (bothProteins) {
    // For proteins, compare by protein content (higher is better)
    winner = compareSlotA.protein > compareSlotB.protein ? 'A' : 'B';
    winnerFood = winner === 'A' ? compareSlotA : compareSlotB;
    loserFood = winner === 'A' ? compareSlotB : compareSlotA;
    winReason = 'protein';
  } else {
    // For carbs, compare by GI (lower is better)
    winner = compareSlotA.gi < compareSlotB.gi ? 'A' : (compareSlotB.gi < compareSlotA.gi ? 'B' : 'tie');
    winnerFood = winner === 'A' ? compareSlotA : compareSlotB;
    loserFood = winner === 'A' ? compareSlotB : compareSlotA;
    winReason = 'gi';
  }
  
  // Build comparison HTML based on food type
  let metricsHTML = '';
  
  if (bothProteins) {
    // Protein-specific metrics
    metricsHTML = `
      <div class="metric-row">
        <span class="metric-label">Protein</span>
        <div class="metric-values">
          <span class="metric-value ${winner === 'A' ? 'winner' : ''}">${compareSlotA.protein}g</span>
          <span class="vs-text">vs</span>
          <span class="metric-value ${winner === 'B' ? 'winner' : ''}">${compareSlotB.protein}g</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Calories</span>
        <div class="metric-values">
          <span class="metric-value">${compareSlotA.calories || 'N/A'}</span>
          <span class="vs-text">vs</span>
          <span class="metric-value">${compareSlotB.calories || 'N/A'}</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Carbs</span>
        <div class="metric-values">
          <span class="metric-value">${compareSlotA.carbsPerServing || 0}g</span>
          <span class="vs-text">vs</span>
          <span class="metric-value">${compareSlotB.carbsPerServing || 0}g</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Blood Sugar Impact</span>
        <div class="metric-values">
          <span class="metric-value success">✓ None</span>
          <span class="vs-text">vs</span>
          <span class="metric-value success">✓ None</span>
        </div>
      </div>
    `;
  } else {
    // Carb-specific metrics (original logic)
    metricsHTML = `
      <div class="metric-row">
        <span class="metric-label">Glycemic Index</span>
        <div class="metric-values">
          <span class="metric-value ${winner === 'A' ? 'winner' : ''}">${compareSlotA.gi}</span>
          <span class="vs-text">vs</span>
          <span class="metric-value ${winner === 'B' ? 'winner' : ''}">${compareSlotB.gi}</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Carbs (per serving)</span>
        <div class="metric-values">
          <span class="metric-value">${compareSlotA.carbsPerServing || 0}g</span>
          <span class="vs-text">vs</span>
          <span class="metric-value">${compareSlotB.carbsPerServing || 0}g</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Fiber</span>
        <div class="metric-values">
          <span class="metric-value ${compareSlotA.fiber > compareSlotB.fiber ? 'winner' : ''}">${compareSlotA.fiber}g</span>
          <span class="vs-text">vs</span>
          <span class="metric-value ${compareSlotB.fiber > compareSlotA.fiber ? 'winner' : ''}">${compareSlotB.fiber}g</span>
        </div>
      </div>
      
      <div class="metric-row">
        <span class="metric-label">Protein</span>
        <div class="metric-values">
          <span class="metric-value">${compareSlotA.protein}g</span>
          <span class="vs-text">vs</span>
          <span class="metric-value">${compareSlotB.protein}g</span>
        </div>
      </div>
    `;
  }
  
  // Generate verdict message
  let verdictMessage = '';
  if (bothProteins) {
    if (winner === 'tie' || compareSlotA.protein === compareSlotB.protein) {
      verdictMessage = `Both ${compareSlotA.name} and ${compareSlotB.name} are excellent protein choices with no blood sugar impact. Choose based on your preference and nutritional goals.`;
    } else {
      verdictMessage = `${winnerFood.name} has ${winnerFood.protein - loserFood.protein}g more protein per serving (${winnerFood.protein}g vs ${loserFood.protein}g), making it the better choice for protein intake. Both have zero impact on blood sugar levels.`;
    }
  } else {
    verdictMessage = `${winnerFood.name} has a lower glycemic index (${winnerFood.gi} vs ${loserFood.gi}) and will cause a slower rise in blood sugar levels, making it the better choice for glucose control.`;
  }
  
  resultsEl.innerHTML = `
    <div class="comparison-grid">
      <div class="comparison-metrics">
        ${metricsHTML}
      </div>
      
      <div class="comparison-verdict">
        <div class="verdict-title">
          🏆 Better Choice: ${winnerFood.emoji || winnerFood.icon || ''} ${winnerFood.name}
        </div>
        <div class="verdict-text">
          ${verdictMessage}
        </div>
        ${winnerFood.benefits && winnerFood.benefits.length > 0 ? `
          <div class="verdict-benefits">
            <strong>Benefits:</strong>
            <ul>
              ${winnerFood.benefits.map(b => `<li>${b}</li>`).join('')}
            </ul>
          </div>
        ` : ''}
      </div>
    </div>
  `;
}

// Modal-specific compare functions
let modalCompareSlotA = null;
let modalCompareSlotB = null;

function searchForModalCompare(slot) {
  const query = document.getElementById(`modalCompare${slot}`).value.toLowerCase();
  const suggestionsEl = document.getElementById(`modalSuggestions${slot}`);
  
  if (query.length < 2) {
    suggestionsEl.classList.remove('show');
    return;
  }
  
  const matches = foodDatabase.filter(food => 
    food.name.toLowerCase().includes(query)
  ).slice(0, 6);
  
  if (matches.length === 0) {
    suggestionsEl.classList.remove('show');
    return;
  }
  
  suggestionsEl.innerHTML = matches.map(food => `
    <div class="food-suggestion-item" onclick="selectModalCompareFood('${slot}', '${food.name}')">
      <div class="food-name-gi">
        <div class="food-name">${food.icon} ${food.name}</div>
        <div class="food-gi">GI: ${food.gi} • Carbs: ${food.carbs}g</div>
      </div>
    </div>
  `).join('');
  
  suggestionsEl.classList.add('show');
}

function selectModalCompareFood(slot, foodName) {
  const food = foodDatabase.find(f => f.name === foodName);
  if (slot === 'A') {
    modalCompareSlotA = food;
  } else {
    modalCompareSlotB = food;
  }
  
  document.getElementById(`modalCompare${slot}`).value = foodName;
  document.getElementById(`modalSuggestions${slot}`).classList.remove('show');
  displayModalCompareFood(slot, food);
  
  if (modalCompareSlotA && modalCompareSlotB) {
    displayModalComparison();
  }
}

function displayModalCompareFood(slot, food) {
  const containerEl = document.getElementById(`modalSelected${slot}`);
  containerEl.innerHTML = `
    <div class="comparison-food-detail">
      <div class="comparison-food-icon">${food.icon}</div>
      <div class="comparison-food-name">${food.name}</div>
      <span class="gi-badge gi-${food.impact}">${food.impact.toUpperCase()} Impact</span>
    </div>
  `;
}

function displayModalComparison() {
  const resultsEl = document.getElementById('modalComparisonResults');
  
  if (!modalCompareSlotA || !modalCompareSlotB) return;
  
  const winner = modalCompareSlotA.gi < modalCompareSlotB.gi ? 'A' : 'B';
  const winnerFood = winner === 'A' ? modalCompareSlotA : modalCompareSlotB;
  
  resultsEl.innerHTML = `
    <div class="comparison-grid">
      <div class="comparison-metrics">
        <div class="metric-row">
          <span class="metric-label">Glycemic Index</span>
          <div class="metric-values">
            <span class="metric-value ${winner === 'A' ? 'winner' : ''}">${modalCompareSlotA.gi}</span>
            <span class="metric-value ${winner === 'B' ? 'winner' : ''}">${modalCompareSlotB.gi}</span>
          </div>
        </div>
        <div class="metric-row">
          <span class="metric-label">Carbs (per 100g)</span>
          <div class="metric-values">
            <span class="metric-value">${modalCompareSlotA.carbs}g</span>
            <span class="metric-value">${modalCompareSlotB.carbs}g</span>
          </div>
        </div>
        <div class="metric-row">
          <span class="metric-label">Blood Sugar Impact</span>
          <div class="metric-values">
            <span class="metric-value">${modalCompareSlotA.impact.toUpperCase()}</span>
            <span class="metric-value">${modalCompareSlotB.impact.toUpperCase()}</span>
          </div>
        </div>
      </div>
      
      <div class="comparison-verdict">
        <div class="verdict-title">🏆 Better Choice: ${winnerFood.name}</div>
        <div class="verdict-text">
          ${winnerFood.name} has a lower glycemic index (${winnerFood.gi}) 
          and will cause a ${winnerFood.impact} blood sugar impact.
        </div>
      </div>
    </div>
  `;
}



// Update History Tab
function updateHistoryTab() {
  const timelineEl = document.getElementById('historyTimeline');
  
  if (mealEntries.length === 0) {
    timelineEl.innerHTML = `
      <div class="search-placeholder">
        <div class="placeholder-icon-large">📋</div>
        <h4>No entries yet</h4>
        <p>Start logging your meals to see your history here</p>
      </div>
    `;
    return;
  }
  
  // Group by date
  const grouped = {};
  mealEntries.forEach(entry => {
    const date = new Date(entry.datetime).toLocaleDateString();
    if (!grouped[date]) grouped[date] = [];
    grouped[date].push(entry);
  });
  
  const mealIcons = {
    fasting: '🌅',
    breakfast: '🍳',
    lunch: '🍽️',
    snack: '🥗',
    dinner: '🌙'
  };
  
  timelineEl.innerHTML = Object.keys(grouped).map(date => {
    const dayEntries = grouped[date];
    const avgGlucose = Math.round(dayEntries.reduce((sum, e) => sum + e.glucose, 0) / dayEntries.length);
    const inRange = dayEntries.filter(e => {
      if (e.type === 'fasting') return e.glucose < 95;
      return e.glucose < 140;
    }).length;
    
    return `
      <div class="history-day-group">
        <div class="day-header">
          <div class="day-title">📅 ${date}</div>
          <div class="day-summary">
            <span>${dayEntries.length} entries</span>
            <span>Avg: ${avgGlucose} mg/dL</span>
            <span>${inRange}/${dayEntries.length} in range</span>
          </div>
        </div>
        <div class="history-entries">
          ${dayEntries.map(entry => {
            const time = new Date(entry.datetime).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
            const status = entry.type === 'fasting' 
              ? (entry.glucose < 95 ? 'normal' : 'high')
              : (entry.glucose < 140 ? 'normal' : 'high');
            
            return `
              <div class="history-entry-card">
                <div class="entry-header-row">
                  <div class="entry-time-type">
                    <span class="entry-icon">${mealIcons[entry.type]}</span>
                    <span class="entry-time">${time}</span>
                    <span class="entry-type">${entry.type.charAt(0).toUpperCase() + entry.type.slice(1)}</span>
                  </div>
                  <div class="entry-glucose-display">
                    <span class="entry-glucose-value">${entry.glucose}</span>
                    <span class="entry-status-badge status-${status}">
                      ${status === 'normal' ? '✓ Normal' : '⚠ High'}
                    </span>
                  </div>
                </div>
                ${entry.foods && entry.foods.length > 0 ? `
                  <div class="entry-foods-row">
                    <div class="entry-foods-label">Foods:</div>
                    <div class="entry-food-chips">
                      ${entry.foods.map(f => `<span class="entry-food-chip">${f}</span>`).join('')}
                    </div>
                  </div>
                ` : ''}
                ${entry.notes ? `
                  <div class="entry-notes">"${entry.notes}"</div>
                ` : ''}
                <div class="entry-actions">
                  <button class="entry-action-btn delete" onclick="deleteEntry(${entry.id})">🗑️ Delete</button>
                </div>
              </div>
            `;
          }).join('')}
        </div>
      </div>
    `;
  }).join('');
}

// Update Quick Stats
function updateQuickStats() {
  const today = new Date().toLocaleDateString();
  const todayEntries = mealEntries.filter(e => 
    new Date(e.datetime).toLocaleDateString() === today
  );
  
  document.getElementById('todayReadingsCount').textContent = todayEntries.length;
  
  const inRange = todayEntries.filter(e => {
    if (e.type === 'fasting') return e.glucose < 95;
    return e.glucose < 140;
  }).length;
  
  document.getElementById('inRangeToday').textContent = inRange;
  
  if (todayEntries.length > 0) {
    const avg = Math.round(todayEntries.reduce((sum, e) => sum + e.glucose, 0) / todayEntries.length);
    document.getElementById('avgToday').textContent = avg;
  }
  
  // Update history stats
  document.getElementById('totalEntries').textContent = mealEntries.length;
  
  const allInRange = mealEntries.filter(e => {
    if (e.type === 'fasting') return e.glucose < 95;
    return e.glucose < 140;
  }).length;
  
  const percent = mealEntries.length > 0 
    ? Math.round((allInRange / mealEntries.length) * 100) 
    : 0;
  
  document.getElementById('inRangePercent').textContent = percent + '%';
  
  if (mealEntries.length > 0) {
    const avgAll = Math.round(mealEntries.reduce((sum, e) => sum + e.glucose, 0) / mealEntries.length);
    document.getElementById('avgGlucoseAll').textContent = avgAll + ' mg/dL';
  }
}

// Delete Entry
function deleteEntry(id) {
  if (confirm('Are you sure you want to delete this entry?')) {
    mealEntries = mealEntries.filter(e => e.id !== id);
    saveMealEntries();
    updateHistoryTab();
    updateQuickStats();
    showSuccessToast('Entry deleted');
  }
}



// Export History as CSV
function exportHistory() {

 if (mealEntries.length === 0) {
    alert('No data to export');
    return;
  }
  
  const csv = [
    ['Date', 'Time', 'Type', 'Glucose (mg/dL)', 'Foods', 'Notes'].join(','),
    ...mealEntries.map(e => {
      const date = new Date(e.datetime);
      return [
        date.toLocaleDateString(),
        date.toLocaleTimeString(),
        e.type,
        e.glucose,
        e.foods.join('; '),
        e.notes || ''
      ].join(',');
    })
  ].join('\n');
  

  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = `glucose-history-${new Date().toISOString().split('T')[0]}.csv`;
  a.click();

  showSuccessToast('History exported! 📤');
}

// Clear All History
function clearAllHistory() {
  if (confirm('Are you sure you want to delete all entries? This cannot be undone.')) {
    mealEntries = [];
    saveMealEntries();
    updateHistoryTab();
    updateQuickStats();
    showSuccessToast('All entries cleared');
  }
}

// Filter History
function filterHistory() {
  // Implement search functionality
  const query = document.getElementById('historySearch').value.toLowerCase();
  // Filter and update display
}

// Filter History by Date
function filterHistoryByDate() {
  // Implement date range filtering
  const range = document.getElementById('dateRangeFilter').value;
  // Filter and update display
}

// Save/Load Meal Entries
function saveMealEntries() {
  localStorage.setItem('gdm_meal_entries_v2', JSON.stringify(mealEntries));
}

function loadMealEntries() {
  const saved = localStorage.getItem('gdm_meal_entries_v2');
  if (saved) {
    mealEntries = JSON.parse(saved);
  }
}

// Show Success Toast
function showSuccessToast(message) {
  // Create and show a temporary success message
  const toast = document.createElement('div');
  toast.style.cssText = `
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: linear-gradient(135deg, #66bb6a, #4caf50);
    color: white;
    padding: 1rem 2rem;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    z-index: 10002;
    font-weight: 600;
    animation: slideIn 0.3s ease;
  `;
  toast.textContent = message;
  document.body.appendChild(toast);

  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// Initialize on page load
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeTracker);
} else {
  initializeTracker();
}

// Listen for glucose input changes
document.addEventListener('DOMContentLoaded', () => {
  const glucoseInput = document.getElementById('glucoseReading');
  if (glucoseInput) {
    glucoseInput.addEventListener('input', (e) => {
      updateGlucoseStatus(e.target.value);
    });
  }
});

</script>

<style>
  :root {
    --bg-footer:    #1e1a1e;
    --bg-bottom:    #161316;
    --pink-primary: #e8517a;
    --pink-soft:    #f0748e;
    --text-main-f:  #c9bfc9;
    --text-muted-f: #7c7080;
    --divider-f:    rgba(232,81,122,0.18);
    --font-display-f:'Playfair Display', Georgia, serif;
    --font-body-f:  'Manrope', sans-serif;
  }
  footer.ns-footer {
    background: var(--bg-footer);
    color: var(--text-main-f);
    font-family: var(--font-body-f);
    border-top: 1px solid var(--divider-f);
  }
  .footer-main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 56px 32px 48px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 40px;
  }
  .footer-col h3 {
    font-family: var(--font-display-f);
    font-size: 1.05rem;
    font-weight: 600;
    color: var(--pink-primary);
    margin-bottom: 18px;
    letter-spacing: 0.01em;
  }
  .footer-col p {
    font-size: 0.875rem;
    line-height: 1.75;
    color: var(--text-main-f);
    font-weight: 300;
  }
  .footer-col ul { list-style: none; }
  .footer-col ul li {
    font-size: 0.875rem;
    color: var(--text-main-f);
    padding: 5px 0;
    font-weight: 300;
    position: relative;
    padding-left: 14px;
    transition: color 0.2s;
  }
  .footer-col ul li::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: var(--pink-primary);
    opacity: 0.5;
  }
  .footer-col ul li:hover { color: var(--pink-soft); }
  .disclaimer-text { font-size: 0.875rem; line-height: 1.75; color: var(--text-main-f); font-weight: 300; }
  .emergency-alert { font-size: 0.875rem; line-height: 1.7; color: var(--pink-primary); font-weight: 500; }
  .emergency-alert strong { font-weight: 600; }
  .footer-meta {
    border-top: 1px solid var(--divider-f);
    max-width: 1200px;
    margin: 0 auto;
    padding: 28px 32px;
    text-align: center;
  }
  .footer-meta .meta-line { font-size: 0.8rem; color: var(--text-muted-f); letter-spacing: 0.04em; margin-bottom: 10px; }
  .footer-meta .meta-line .sep { color: var(--pink-primary); margin: 0 6px; }
  .footer-meta .tagline { font-size: 0.82rem; color: var(--text-muted-f); display: flex; align-items: center; justify-content: center; gap: 6px; }
  .footer-meta .tagline .heart { color: var(--pink-primary); font-size: 1rem; animation: footerPulse 2s ease-in-out infinite; }
  @keyframes footerPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.25); opacity: 0.8; } }
  .footer-bottom { background: var(--bg-bottom); border-top: 1px solid rgba(255,255,255,0.04); }
  .footer-bottom-inner { max-width: 1200px; margin: 0 auto; padding: 22px 32px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
  .footer-links { display: flex; gap: 36px; flex-wrap: wrap; justify-content: center; }
  .footer-links a { font-size: 0.82rem; color: var(--text-muted-f); text-decoration: none; letter-spacing: 0.03em; transition: color 0.2s; }
  .footer-links a:hover { color: var(--pink-soft); }
  .footer-copy { font-size: 0.78rem; color: var(--text-muted-f); opacity: 0.7; letter-spacing: 0.02em; }
  @media (max-width: 900px) { .footer-main { grid-template-columns: repeat(2,1fr); gap: 32px; } }
  @media (max-width: 540px) { .footer-main { grid-template-columns: 1fr; padding: 40px 20px 32px; } .footer-meta { padding: 20px; } .footer-bottom-inner { padding: 18px 20px; } .footer-links { gap: 20px; } }
</style>

<footer class="ns-footer" aria-label="Site footer">
  <div class="footer-main">
    <div class="footer-col">
      <h3>About This Guide</h3>
      <p>Comprehensive, evidence-based information synthesized from WHO, ACOG, ICMR guidelines, peer-reviewed research, and NFHS-5 data (724,115+ women).</p>
    </div>
    <div class="footer-col">
      <h3>Evidence Sources</h3>
      <ul>
        <li>World Health Organization</li>
        <li>ACOG Guidelines</li>
        <li>ICMR India</li>
        <li>NFHS-5 Survey</li>
      </ul>
    </div>
    <div class="footer-col">
      <h3>Important Disclaimer</h3>
      <p class="disclaimer-text">This provides general information only. Each pregnancy is unique. Medical decisions should be made with qualified healthcare providers who can assess your individual circumstances.</p>
    </div>
    <div class="footer-col">
      <h3>Emergency</h3>
      <p class="emergency-alert">Heavy bleeding, fever, chest pain, or severe abdominal pain require immediate medical attention. <strong>Don't delay.</strong></p>
    </div>
  </div>
  <div class="footer-meta">
    <p class="meta-line">Last Updated: February 2026 <span class="sep">|</span> Evidence-Based <span class="sep">•</span> Comprehensive <span class="sep">•</span> Empowering</p>
    <p class="tagline"><span class="heart">🩷</span> Dedicated to empowering every mother</p>
  </div>
  <div class="footer-bottom">
    <div class="footer-bottom-inner">
      <nav class="footer-links" aria-label="Legal and support links">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms of Service</a>
        <a href="#">Contact Support</a>
      </nav>
      <p class="footer-copy">&copy; 2026 Nari Swasthya. Empowering Women's Health.</p>
    </div>
  </div>
</footer>

<script>
/* ═══════════════════════════════════════════════════════════════════
   MEAL SCORE ENGINE — FULL IMPLEMENTATION
   Replaces all previous partial/conflicting score functions.
   ═══════════════════════════════════════════════════════════════════ */

// ── Achievement Definitions ──────────────────────────────────────
const ACHIEVEMENTS_DEF = [
  {
    id: 'first-bite',
    icon: '🍽️',
    name: 'First Bite!',
    desc: 'Add your first food',
    condition: s => s.totalFoods >= 1
  },
  {
    id: 'veggie-queen',
    icon: '🥗',
    name: 'Veggie Queen',
    desc: '3+ vegetables on plate',
    condition: s => s.veggieCount >= 3
  },
  {
    id: 'protein-pro',
    icon: '💪',
    name: 'Protein Pro',
    desc: 'Added protein to plate',
    condition: s => s.proteinCount >= 1
  },
  {
    id: 'gi-champion',
    icon: '📉',
    name: 'GI Champion',
    desc: 'All low-GI choices',
    condition: s => s.totalFoods >= 2 && s.avgGI < 45
  },
  {
    id: 'balanced',
    icon: '⚖️',
    name: 'Balance Master',
    desc: 'Perfect plate proportions',
    condition: s => s.hasAll3Groups && s.veggieRatio >= 0.4 && s.veggieRatio <= 0.65
  },
  {
    id: 'variety',
    icon: '🌈',
    name: 'Variety Star',
    desc: '5+ different foods',
    condition: s => s.totalFoods >= 5
  },
  {
    id: 'great-meal',
    icon: '⭐',
    name: 'Great Meal!',
    desc: 'Score 80 or above',
    condition: s => s.totalScore >= 80
  },
  {
    id: 'perfect-plate',
    icon: '🏆',
    name: 'Perfect Plate!',
    desc: 'Score 90 or above',
    condition: s => s.totalScore >= 90
  },
  {
    id: 'meal-saver',
    icon: '💾',
    name: 'Meal Saver',
    desc: 'Save your first meal',
    condition: s => s.savedMeals >= 1
  },
  {
    id: 'three-a-day',
    icon: '🔥',
    name: 'Three a Day!',
    desc: 'Save 3 meals in total',
    condition: s => s.savedMeals >= 3
  }
];

let _unlockedAchs  = new Set(JSON.parse(localStorage.getItem('ms_ach') || '[]'));
let _savedMeals    = parseInt(localStorage.getItem('ms_saves') || '0');
let _prevScore     = 0;

// ── Score Colour / Grade helpers ─────────────────────────────────
function _scoreTier(score) {
  if (score >= 90) return { tier: 'perfect',  grade: 'A+', label: 'Perfect! 🌟',          fill: 'url(#scoreGradientPerfect)', valueColor: '#e65100' };
  if (score >= 80) return { tier: 'great',    grade: 'A',  label: 'Great Choice! 👍',      fill: 'url(#scoreGradientGreat)',   valueColor: '#2e7d32' };
  if (score >= 65) return { tier: 'good',     grade: 'B',  label: 'Good Start! 💪',        fill: 'url(#scoreGradientGood)',    valueColor: '#558b2f' };
  if (score >= 45) return { tier: 'fair',     grade: 'C',  label: 'Keep Improving! 📈',    fill: 'url(#scoreGradientFair)',    valueColor: '#f57f17' };
  if (score > 0)   return { tier: 'poor',     grade: 'D',  label: 'Needs Work! 🔧',        fill: 'url(#scoreGradientPoor)',    valueColor: '#bf360c' };
  return              { tier: '',         grade: '—',  label: 'Add foods to your plate', fill: 'url(#scoreGradientGreat)',  valueColor: '#2e7d32' };
}

// ── Main Score Calculation ────────────────────────────────────────
function _computeScore() {
  // currentMeal is defined in the original meal planner code
  const meal = (typeof currentMeal !== 'undefined') ? currentMeal : [];

  const veggies  = meal.filter(f => f.type === 'vegetable');
  const proteins  = meal.filter(f => f.type === 'protein');
  const carbs     = meal.filter(f => f.type === 'carbs');
  const total     = meal.length;

  // Helper: gi string → numeric estimate
  const giNum = f => {
    const raw = String(f.gi || '').toLowerCase();
    if (raw === 'low')    return 35;
    if (raw === 'medium') return 62;
    if (raw === 'high')   return 82;
    const n = parseFloat(raw);
    return isNaN(n) ? 55 : n;
  };

  const giValues = meal.map(giNum);
  const avgGI    = total > 0 ? giValues.reduce((a,b) => a+b, 0) / total : 0;
  const veggieRatio = total > 0 ? veggies.length / total : 0;
  const hasAll3 = veggies.length > 0 && proteins.length > 0 && carbs.length > 0;

  // 1. Vegetable Power (0–30)
  const veggieScore = Math.min(veggies.length * 12, 30);

  // 2. Plate Balance (0–25)
  let balanceScore = 0;
  if (hasAll3) {
    balanceScore = (veggieRatio >= 0.4 && veggieRatio <= 0.65) ? 25 : 17;
  } else if (veggies.length > 0 || proteins.length > 0) {
    balanceScore = 8;
  }

  // 3. GI Control (0–25)
  let giScore = 0;
  if (total > 0) {
    if (avgGI < 40)      giScore = 25;
    else if (avgGI < 55) giScore = 20;
    else if (avgGI < 65) giScore = 14;
    else if (avgGI < 75) giScore = 8;
    else                 giScore = 3;
  }

  // 4. Protein Adequacy (0–10)
  const proteinScore = proteins.length >= 2 ? 10 : proteins.length === 1 ? 7 : 0;

  // 5. Variety Bonus (0–10)
  const uniqueTypes = new Set(meal.map(f => (f.type || '') + (f.name || ''))).size;
  const varietyScore = Math.min(uniqueTypes * 2, 10);

  const totalScore = veggieScore + balanceScore + giScore + proteinScore + varietyScore;

  return {
    totalScore, veggieScore, balanceScore, giScore, proteinScore, varietyScore,
    avgGI, veggieRatio, hasAll3Groups: hasAll3,
    veggieCount: veggies.length, proteinCount: proteins.length,
    carbCount: carbs.length, totalFoods: total,
    savedMeals: _savedMeals
  };
}

// ── Animated counter ─────────────────────────────────────────────
function _animateCount(el, from, to, durationMs) {
  if (!el) return;
  const start = performance.now();
  const range = to - from;
  function step(now) {
    const p = Math.min((now - start) / durationMs, 1);
    const ease = 1 - Math.pow(1 - p, 3); // ease-out-cubic
    el.textContent = Math.round(from + range * ease);
    if (p < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

// ── Next-action tip ──────────────────────────────────────────────
function _nextAction(stats) {
  const { totalFoods, veggieCount, proteinCount, carbCount, avgGI, totalScore } = stats;
  if (totalFoods === 0) return { type: 'info', msg: 'Drag foods onto your plate or click portion buttons to begin!' };
  if (veggieCount === 0) return { type: 'alert', msg: '⚠️ Add vegetables first — they should fill half your plate and help control glucose!' };
  if (proteinCount === 0) return { type: 'warn', msg: '💪 Add a protein source (dal, eggs, fish) to balance your plate and keep you full.' };
  if (carbCount === 0)    return { type: 'warn', msg: '🍚 Add a low-GI carb (brown rice, whole wheat roti) to complete your meal.' };
  if (avgGI > 65)         return { type: 'warn', msg: '📉 Average GI is high. Swap to brown rice, oats, or add more vegetables to lower it.' };
  if (veggieCount < 2)    return { type: 'info', msg: '🥦 Add one more vegetable to reach Veggie Queen status and boost your score!' };
  if (totalScore >= 90)   return { type: 'info', msg: '🌟 Incredible! This is a near-perfect GDM-friendly meal. Your baby thanks you!' };
  if (totalScore >= 80)   return { type: 'info', msg: '👍 Excellent meal! Adding one more vegetable could push you to a perfect score.' };
  return { type: 'info', msg: '🎯 Good progress! Add more vegetables or switch to lower-GI carbs to improve your score.' };
}

// ── Render achievements grid ──────────────────────────────────────
function _renderAchievements(stats, newlyUnlocked) {
  const grid = document.getElementById('achievementsGrid');
  if (!grid) return;

  grid.innerHTML = ACHIEVEMENTS_DEF.map(a => {
    const unlocked = _unlockedAchs.has(a.id);
    const isNew    = newlyUnlocked.includes(a.id);
    return `
      <div class="ach-badge ${unlocked ? 'unlocked' : 'locked'} ${isNew ? 'just-unlocked' : ''}"
           title="${a.desc}">
        <span class="ach-icon">${a.icon}</span>
        <span class="ach-name">${a.name}</span>
        <span class="ach-desc">${unlocked ? '✓ Earned' : a.desc}</span>
      </div>`;
  }).join('');
}

// ── Toast notification for new achievement ────────────────────────
function _showAchNotification(ach) {
  const el = document.createElement('div');
  el.className = 'ach-notification';
  el.innerHTML = `
    <span class="ach-notif-icon">${ach.icon}</span>
    <div class="ach-notif-body">
      <strong>Achievement Unlocked!</strong>
      <p>${ach.name}</p>
    </div>`;
  document.body.appendChild(el);
  setTimeout(() => el.classList.add('show'), 50);
  setTimeout(() => {
    el.classList.remove('show');
    setTimeout(() => el.remove(), 400);
  }, 3500);
}

// ── Nutrition snapshot labels ─────────────────────────────────────
function _snapGILabel(gi) {
  if (gi === 0) return { text: '—', cls: '' };
  if (gi < 45)  return { text: 'Low 🟢', cls: 'good' };
  if (gi < 65)  return { text: 'Med 🟡', cls: 'warn' };
  return               { text: 'High 🔴', cls: 'alert' };
}

// ── Main update function (called every time meal changes) ─────────
function updateMealScore() {
  const stats = _computeScore();
  const { totalScore, veggieScore, balanceScore, giScore, proteinScore, varietyScore,
          avgGI, totalFoods } = stats;

  const CIRC = 2 * Math.PI * 66; // 414.69 px

  // Score arc
  const arc = document.getElementById('scoreCircle');
  const pulseRing = document.getElementById('scorePulseRing');
  const tier = _scoreTier(totalScore);

  if (arc) {
    arc.style.strokeDashoffset = CIRC - (totalScore / 100) * CIRC;
    arc.setAttribute('stroke', tier.fill);
  }
  if (pulseRing) {
    pulseRing.style.opacity = totalFoods > 0 ? '1' : '0';
    pulseRing.setAttribute('stroke', tier.fill.includes('Perfect') ? '#ffd700' :
                                      tier.fill.includes('Great')   ? '#66bb6a' :
                                      tier.fill.includes('Good')    ? '#ffc107' :
                                      tier.fill.includes('Fair')    ? '#ff9800' : '#ef5350');
  }

  // Animated counter
  const scoreEl = document.getElementById('mealScore');
  if (scoreEl) _animateCount(scoreEl, _prevScore, totalScore, 900);
  const valueEl = document.querySelector('.score-value');
  if (valueEl) valueEl.style.color = tier.valueColor;

  // Rating label
  const ratingEl = document.getElementById('scoreRating');
  if (ratingEl) {
    ratingEl.textContent = tier.label;
    ratingEl.className = 'score-rating' + (tier.tier ? ` tier-${tier.tier}` : '');
  }

  // Score change indicator
  const changeEl = document.getElementById('scoreChange');
  if (changeEl) {
    const diff = totalScore - _prevScore;
    if (diff > 0) { changeEl.textContent = `▲ +${diff} pts`; changeEl.className = 'score-change positive'; }
    else if (diff < 0) { changeEl.textContent = `▼ ${diff} pts`; changeEl.className = 'score-change negative'; }
    else { changeEl.textContent = ''; changeEl.className = 'score-change'; }
    setTimeout(() => { if (changeEl) changeEl.textContent = ''; }, 2500);
  }

  // Grade badge
  const gradeEl = document.getElementById('scoreGrade');
  if (gradeEl) {
    gradeEl.textContent = tier.grade;
    gradeEl.className = 'score-grade-badge' +
      (tier.grade === 'A+' ? ' grade-A-plus' :
       tier.grade === 'A'  ? ' grade-A' :
       tier.grade === 'B'  ? ' grade-B' :
       tier.grade === 'C'  ? ' grade-C' :
       tier.grade === 'D'  ? ' grade-D' :
       tier.grade === 'F'  ? ' grade-F' : '');
  }

  // Breakdown bars & points
  const setBP = (barId, ptsId, val, maxVal) => {
    const b = document.getElementById(barId);
    const p = document.getElementById(ptsId);
    if (b) b.style.width = maxVal > 0 ? (val / maxVal * 100) + '%' : '0%';
    if (p) p.textContent = val;
  };
  setBP('veggieBar',  'veggiePoints',  veggieScore,  30);
  setBP('balanceBar', 'balancePoints', balanceScore, 25);
  setBP('giBar',      'giPoints',      giScore,      25);
  setBP('proteinBar', 'proteinPoints', proteinScore, 10);
  setBP('varietyBar', 'varietyPoints', varietyScore, 10);

  // Nutrition snapshot
  const snapGI  = _snapGILabel(Math.round(avgGI));
  const gi_el   = document.getElementById('snapGI');
  const pr_el   = document.getElementById('snapProtein');
  const fi_el   = document.getElementById('snapFiber');
  const fo_el   = document.getElementById('snapFoods');
  if (gi_el) { gi_el.textContent = totalFoods > 0 ? Math.round(avgGI) : '—'; gi_el.className = 'snap-value ' + snapGI.cls; }
  if (pr_el) {
    const pStr = stats.proteinCount === 0 ? 'None' : stats.proteinCount === 1 ? 'Low' : 'Good';
    pr_el.textContent = totalFoods > 0 ? pStr : '—';
    pr_el.className = 'snap-value ' + (stats.proteinCount >= 2 ? 'good' : stats.proteinCount === 1 ? 'warn' : 'alert');
  }
  if (fi_el) {
    const fStr = stats.veggieCount >= 3 ? 'High' : stats.veggieCount >= 1 ? 'Med' : 'Low';
    fi_el.textContent = totalFoods > 0 ? fStr : '—';
    fi_el.className = 'snap-value ' + (stats.veggieCount >= 3 ? 'good' : stats.veggieCount >= 1 ? 'warn' : 'alert');
  }
  if (fo_el) fo_el.textContent = totalFoods;

  // Next action tip
  const na = _nextAction(stats);
  const naBox = document.getElementById('scoreNextAction');
  const naTxt = document.getElementById('nextActionText');
  if (naBox) naBox.className = 'score-next-action ' + (na.type !== 'info' ? na.type : '');
  if (naTxt) naTxt.textContent = na.msg;

  // Achievements
  const newlyUnlocked = [];
  ACHIEVEMENTS_DEF.forEach(a => {
    if (!_unlockedAchs.has(a.id) && a.condition(stats)) {
      _unlockedAchs.add(a.id);
      newlyUnlocked.push(a.id);
    }
  });
  if (newlyUnlocked.length) {
    localStorage.setItem('ms_ach', JSON.stringify([..._unlockedAchs]));
    newlyUnlocked.forEach((id, i) => {
      const def = ACHIEVEMENTS_DEF.find(a => a.id === id);
      if (def) setTimeout(() => _showAchNotification(def), i * 600);
    });
  }
  _renderAchievements(stats, newlyUnlocked);

  // Confetti for perfect score (first time)
  if (totalScore >= 90 && _prevScore < 90) _triggerConfetti();

  _prevScore = totalScore;
}

// ── Confetti ─────────────────────────────────────────────────────
function _triggerConfetti() {
  const colors = ['#ffd700','#4caf50','#2196f3','#ff9800','#e91e63','#9c27b0'];
  for (let i = 0; i < 60; i++) {
    setTimeout(() => {
      const c = document.createElement('div');
      c.style.cssText = `
        position:fixed;width:${6+Math.random()*8}px;height:${6+Math.random()*8}px;
        background:${colors[Math.floor(Math.random()*colors.length)]};
        left:${Math.random()*100}%;top:-12px;z-index:99999;
        border-radius:${Math.random()>0.5?'50%':'2px'};pointer-events:none;
        animation:confetti-fall ${2+Math.random()*2}s linear forwards;`;
      document.body.appendChild(c);
      setTimeout(() => c.remove(), 4000);
    }, i * 40);
  }
}

// ── Hook into every path that changes currentMeal ────────────────

// (A) Override updateGlucosePrediction — it is called by drag-drop, templates, and clearPlate
(function() {
  const _origUGP = window.updateGlucosePrediction;
  window.updateGlucosePrediction = function() {
    if (typeof _origUGP === 'function') _origUGP.apply(this, arguments);
    try { updateMealScore(); } catch(e) {}
  };
})();

// (B) Fix addFood — called with (id, type, gi, name, emoji, portion) from buttons
(function() {
  window.addFood = function(foodId, typeOrPortion, gi, name, emoji, portion) {
    // Detect call convention: 6-arg (id,type,gi,name,emoji,portion) vs 2-arg (id,portion)
    let foodType, giLabel, foodName, foodEmoji, foodPortion;
    if (portion !== undefined) {
      // 6-arg call
      foodType    = typeOrPortion;
      giLabel     = gi;
      foodName    = name;
      foodEmoji   = emoji;
      foodPortion = portion;
    } else {
      // 2-arg call or unknown — try to resolve from foodDatabase
      foodPortion = typeOrPortion || 'medium';
      const db = (typeof foodDatabase !== 'undefined') ? foodDatabase : {};
      const fd = db[foodId] || {};
      foodType  = fd.type  || 'carbs';
      giLabel   = fd.gi    !== undefined ? (fd.gi < 55 ? 'low' : fd.gi < 70 ? 'medium' : 'high') : 'medium';
      foodName  = fd.name  || foodId;
      foodEmoji = fd.emoji || '🍽️';
    }

    // Clamp duplicate additions (max 4 of same type per zone)
    if (typeof currentMeal !== 'undefined') {
      const same = currentMeal.filter(f => f.type === foodType).length;
      if (same >= 4) {
        _showToast(`Plate zone for "${foodType}" is full!`, 'warn');
        return;
      }
    }

    const item = { id: foodId, name: foodName, type: foodType, gi: giLabel, emoji: foodEmoji, portion: foodPortion };

    if (typeof currentMeal !== 'undefined') currentMeal.push(item);

    // Render the food emoji into the correct dropped-foods container
    const containerId = foodType === 'vegetable' ? 'veggiesDropped' :
                        foodType === 'protein'   ? 'proteinDropped'  : 'carbsDropped';
    const container = document.getElementById(containerId);
    if (container) {
      const span = document.createElement('span');
      span.className = 'dropped-food-item';
      span.textContent = foodEmoji;
      span.title = foodName + (foodPortion ? ` (${foodPortion})` : '');
      span.style.cursor = 'pointer';
      span.onclick = () => _removeFood(item, span);
      container.appendChild(span);
    }

    // Plate zone colour fill
    _updatePlateFill();

    // Wizard hook
    if (typeof wizardOpen !== 'undefined' && wizardOpen && typeof updateWizardProgress === 'function') {
      try { updateWizardProgress(); } catch(e) {}
    }

    // Update everything
    if (typeof updateGlucosePrediction === 'function') updateGlucosePrediction();
    else updateMealScore();

    _showToast(`Added ${foodName} 🎉`, 'success');
  };
})();

// ── Remove individual food from plate ────────────────────────────
function _removeFood(item, spanEl) {
  if (typeof currentMeal !== 'undefined') {
    const idx = currentMeal.findIndex(f => f.id === item.id && f.type === item.type && f.name === item.name);
    if (idx !== -1) currentMeal.splice(idx, 1);
  }
  if (spanEl && spanEl.parentNode) spanEl.parentNode.removeChild(spanEl);
  _updatePlateFill();
  if (typeof updateGlucosePrediction === 'function') updateGlucosePrediction();
  else updateMealScore();
}

// ── Plate zone tint ───────────────────────────────────────────────
function _updatePlateFill() {
  const meal = (typeof currentMeal !== 'undefined') ? currentMeal : [];
  const vc = meal.filter(f=>f.type==='vegetable').length;
  const pc = meal.filter(f=>f.type==='protein').length;
  const cc = meal.filter(f=>f.type==='carbs').length;
  const pv = document.getElementById('plateVeggies');
  const pp = document.getElementById('plateProtein');
  const pc2= document.getElementById('plateCarbs');
  if (pv)  pv.style.backgroundColor  = `rgba(76,175,80,${Math.min(vc*0.16,0.55)})`;
  if (pp)  pp.style.backgroundColor  = `rgba(255,152,0,${Math.min(pc*0.16,0.55)})`;
  if (pc2) pc2.style.backgroundColor = `rgba(33,150,243,${Math.min(cc*0.16,0.55)})`;
}

// ── Override clearPlate to also reset score ───────────────────────
(function() {
  const _orig = window.clearPlate;
  window.clearPlate = function() {
    if (typeof _orig === 'function') _orig.apply(this, arguments);
    _prevScore = 0;
    _updatePlateFill();
    updateMealScore();
  };
})();

// ── Override saveMeal to count saves & show score nicely ──────────
(function() {
  window.saveMeal = function() {
    const meal = (typeof currentMeal !== 'undefined') ? currentMeal : [];
    if (meal.length === 0) {
      _showToast('Add some foods to your plate first! 🍽️', 'warn');
      return;
    }
    const stats = _computeScore();
    _savedMeals++;
    localStorage.setItem('ms_saves', _savedMeals);

    // Check meal-saver / three-a-day achievements
    ACHIEVEMENTS_DEF.forEach(a => {
      if (!_unlockedAchs.has(a.id) && a.condition({ ...stats, savedMeals: _savedMeals })) {
        _unlockedAchs.add(a.id);
        localStorage.setItem('ms_ach', JSON.stringify([..._unlockedAchs]));
        _showAchNotification(ACHIEVEMENTS_DEF.find(d => d.id === a.id));
      }
    });
    _renderAchievements({ ...stats, savedMeals: _savedMeals }, []);

    const foods = meal.map(f => f.emoji + ' ' + f.name).join(', ');
    const tier  = _scoreTier(stats.totalScore);
    alert(
      `✅ Meal saved!\n\n` +
      `Score: ${stats.totalScore}/100  ${tier.grade}\n` +
      `Rating: ${tier.label}\n\n` +
      `Foods: ${foods}\n\n` +
      `Avg GI: ${Math.round(stats.avgGI)}  •  ` +
      `Protein: ${stats.proteinCount > 0 ? 'Yes ✓' : 'Missing ⚠️'}  •  ` +
      `Veggies: ${stats.veggieCount}`
    );
  };
})();

// ── Also hook drag-drop to trigger score after drop ───────────────
document.addEventListener('drop', function() {
  setTimeout(() => { try { updateMealScore(); } catch(e) {} }, 50);
}, true);

// ── Mini toast utility ────────────────────────────────────────────
function _showToast(msg, type) {
  const t = document.createElement('div');
  const bg = type === 'success' ? 'linear-gradient(135deg,#2e7d32,#43a047)' :
             type === 'warn'    ? 'linear-gradient(135deg,#f57f17,#ffa000)' :
             'linear-gradient(135deg,#1565c0,#1e88e5)';
  t.style.cssText = `
    position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);
    background:${bg};color:#fff;padding:10px 22px;border-radius:50px;
    font-size:.85rem;font-weight:700;z-index:99998;
    box-shadow:0 4px 16px rgba(0,0,0,0.25);
    opacity:0;transition:all .35s cubic-bezier(.34,1.56,.64,1);pointer-events:none;`;
  t.textContent = msg;
  document.body.appendChild(t);
  requestAnimationFrame(() => { t.style.opacity = '1'; t.style.transform = 'translateX(-50%) translateY(0)'; });
  setTimeout(() => {
    t.style.opacity = '0';
    t.style.transform = 'translateX(-50%) translateY(10px)';
    setTimeout(() => t.remove(), 380);
  }, 2800);
}

// ── Initialise on DOM ready ───────────────────────────────────────
function _initMealScore() {
  _renderAchievements({ totalFoods:0, veggieCount:0, proteinCount:0, carbCount:0,
                        avgGI:0, veggieRatio:0, hasAll3Groups:false, totalScore:0,
                        savedMeals:_savedMeals }, []);
  updateMealScore();
}
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', _initMealScore);
} else {
  _initMealScore();
}
</script>


<script>
/* Mobile menu toggle */
function toggleMobile(){
  const menu=document.getElementById('mobileMenu');
  const b1=document.getElementById('hb1'),b2=document.getElementById('hb2'),b3=document.getElementById('hb3');
  const open=menu.classList.toggle('open');
  if(open){
    b1.style.cssText='transform:rotate(45deg) translate(4px,4px);';
    b2.style.cssText='opacity:0;';
    b3.style.cssText='transform:rotate(-45deg) translate(4px,-4px);';
  } else {
    b1.style.cssText=''; b2.style.cssText=''; b3.style.cssText='';
  }
}
document.addEventListener('click',function(e){
  const menu=document.getElementById('mobileMenu');
  const btn=document.getElementById('hamburgerBtn');
  if(menu&&menu.classList.contains('open')&&!menu.contains(e.target)&&!btn.contains(e.target)){
    menu.classList.remove('open');
    document.getElementById('hb1').style.cssText='';
    document.getElementById('hb2').style.cssText='';
    document.getElementById('hb3').style.cssText='';
  }
});
</script>
</body>
</html>
