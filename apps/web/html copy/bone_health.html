<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Women's Bone & Joint Health â€“ Interactive Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>

<style>
  /* BONE & JOINT HEALTH - FINAL STYLES */

:root {
  --pink: #ec407a;
  --deep-pink: #d81b60;
  --lavender: #ede7f6;
  --bg: #faf5fb;
  --card-bg: #ffffff;
  --text-main: #212121;
  --text-soft: #555;
  --border-soft: #e0e0e0;
  --chip-bg: #f3e5f5;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  margin: 0;
  font-family: 'Manrope', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: var(--bg);
  color: var(--text-main);
  line-height: 1.5;
}

/* ===================== HEADER ===================== */
    .site-header{
      background:rgba(255,255,255,0.95);
      backdrop-filter:blur(24px);
      -webkit-backdrop-filter:blur(24px);
      padding:0;
      box-shadow:0 2px 24px rgba(236,64,122,0.09);
      position:sticky;top:0;z-index:1000;
      border-bottom:1px solid rgba(236,64,122,0.08);
    }

    /* Floating Hearts Background Animation */
    .site-header::before {
      content: 'ðŸ’— âœ¨ ðŸŒ¸ ðŸ’• â­ ðŸ¦‹ ðŸ’— âœ¨ ðŸŒ¸ ðŸ’•';
      position: absolute;
      top: 0;
      left: -100%;
      width: 200%;
      height: 100%;
      display: flex;
      align-items: center;
      font-size: 1.2rem;
      gap: 3rem;
      opacity: 0.08;
      animation: float-emojis 40s linear infinite;
      pointer-events: none;
      white-space: nowrap;
    }

    @keyframes float-emojis {
      0% { transform: translateX(0); }
      100% { transform: translateX(50%); }
    }

    /* Sparkle Effect on Hover */
    .site-header::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
        rgba(236, 64, 122, 0.1) 0%, 
        transparent 25%);
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .site-header:hover::after {
      opacity: 1;
    }

    .nav-container{
      max-width:1400px;margin:0 auto;
      padding:0 1.5rem;
      display:flex;justify-content:space-between;align-items:center;
      height:64px;
    }
    .logo{display:flex;align-items:center;gap:.65rem;flex-shrink:0;}
    .logo-icon{
      width:40px;height:40px;border-radius:12px;
      background:linear-gradient(135deg,#ec407a,#ad1457);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 4px 14px rgba(236,64,122,0.35);flex-shrink:0;
    }
    .logo-icon svg{width:22px;height:22px;fill:white;}
    .logo-text{display:flex;flex-direction:column;gap:0;}
    .logo-text a{
      text-decoration:none;font-family:'Playfair Display',serif;
      font-weight:900;font-size:1.25rem;line-height:1.1;
      background:linear-gradient(135deg,#ec407a,#ad1457);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    }
    .logo-text span{
      font-size:.62rem;color:#555;font-family:'Manrope',sans-serif;
      font-weight:500;letter-spacing:.1em;text-transform:uppercase;
    }
    .main-nav{display:flex;align-items:center;gap:.2rem;}
    .nav-item{position:relative;}
    .nav-link{
      display:flex;align-items:center;gap:.3rem;
      text-decoration:none;color:#212121;
      font-weight:500;font-size:.875rem;
      padding:.55rem .75rem;border-radius:8px;
      transition:all .25s;white-space:nowrap;
      cursor:pointer;background:none;border:none;font-family:inherit;
    }
    .nav-link:hover,.nav-link.active{color:#d81b60;background:rgba(236,64,122,0.06);}
    .nav-link .chevron{font-size:.6rem;transition:transform .25s;color:#555;margin-top:1px;}
    .nav-item:hover .chevron{transform:rotate(180deg);}
    .nav-dropdown{
      position:absolute;top:calc(100% + 8px);left:50%;
      transform:translateX(-50%) translateY(-6px);
      min-width:220px;background:white;border-radius:16px;
      box-shadow:0 16px 50px rgba(0,0,0,0.12),0 4px 16px rgba(236,64,122,0.1);
      border:1px solid rgba(236,64,122,0.1);padding:.5rem;
      opacity:0;pointer-events:none;
      transition:all .25s cubic-bezier(.23,1.01,.32,1);z-index:200;
    }
    .nav-dropdown::before{
      content:'';position:absolute;top:-6px;left:50%;transform:translateX(-50%);
      border:6px solid transparent;border-bottom-color:white;
      border-top:none;filter:drop-shadow(0 -2px 4px rgba(0,0,0,0.06));
    }
    .nav-item:hover .nav-dropdown,.nav-item:focus-within .nav-dropdown{
      opacity:1;pointer-events:all;transform:translateX(-50%) translateY(0);
    }
    .dd-item{
      display:flex;align-items:center;gap:.75rem;
      padding:.65rem .9rem;border-radius:10px;
      text-decoration:none;color:#212121;font-size:.85rem;font-weight:500;transition:all .2s;
    }
    .dd-item:hover{background:rgba(236,64,122,0.07);color:#d81b60;padding-left:1.1rem;}
    .dd-icon{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:.8rem;flex-shrink:0;}
    .dd-sep{height:1px;background:#e0e0e0;margin:.3rem .5rem;}
    /* Flyout submenu â€” appears to the right of the parent row */
    .dd-has-flyout{position:relative;}
    .dd-has-flyout>.dd-flyout-arrow{font-size:.6rem;color:#aaa;margin-left:auto;transition:transform .2s;}
    .dd-flyout{
      display:none;position:absolute;top:0;left:calc(100% + 4px);
      min-width:190px;background:white;border-radius:12px;
      box-shadow:0 12px 36px rgba(0,0,0,0.12),0 4px 12px rgba(236,64,122,0.1);
      border:1px solid rgba(236,64,122,0.12);padding:.4rem;z-index:300;
    }
    .dd-has-flyout:hover>.dd-flyout,
    .dd-has-flyout:focus-within>.dd-flyout{display:block;}
    .dd-has-flyout:hover{background:rgba(236,64,122,0.07);color:#d81b60;}
    .dd-flyout .dd-item{padding:.55rem .8rem;font-size:.82rem;}
    .dd-flyout .dd-item:hover{background:rgba(236,64,122,0.07);color:#d81b60;padding-left:1rem;}
    .nav-actions{display:flex;gap:.6rem;align-items:center;}
    .btn-nav{
      padding:.46rem 1.1rem;border-radius:50px;text-decoration:none;
      font-weight:600;font-size:.82rem;transition:all .3s;border:none;cursor:pointer;
      font-family:inherit;display:inline-flex;align-items:center;gap:.4rem;
    }
    .btn-nav.outline{
      background:linear-gradient(135deg,#ec407a,#ad1457);
      color:#fff;box-shadow:0 4px 15px rgba(236,64,122,0.3);
    }
    .btn-nav.outline:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(236,64,122,0.4);color:#fff;}
    .btn-nav.primary{border:1.5px solid #d81b60;color:#d81b60;background:#fff;}
    .btn-nav.primary:hover{background:rgba(236,64,122,0.05);}
    .hamburger{
      display:none;width:38px;height:38px;border-radius:10px;
      background:none;border:1.5px solid #e0e0e0;
      align-items:center;justify-content:center;cursor:pointer;
      flex-direction:column;gap:4px;padding:8px;
    }
    .hamburger span{display:block;height:2px;background:#212121;border-radius:2px;transition:all .3s;}
    .mobile-menu{
      display:none;position:fixed;inset:0;top:64px;
      background:rgba(255,255,255,0.98);backdrop-filter:blur(20px);
      z-index:999;padding:1.5rem;overflow-y:auto;
    }
    .mm-action-btn{display:inline-flex !important;}
    .mobile-menu.open{display:block;}
    .mm-link{
      display:flex;align-items:center;gap:.75rem;
      padding:.85rem 1rem;border-radius:12px;
      text-decoration:none;color:#212121;font-weight:500;font-size:1rem;
      transition:all .2s;border-bottom:1px solid #e0e0e0;
    }
    .mm-link:hover{color:#d81b60;background:rgba(236,64,122,0.05);}
    .mm-section{font-size:.72rem;font-weight:700;color:#555;text-transform:uppercase;letter-spacing:.1em;padding:.6rem 1rem .3rem;}
    @media(max-width:1060px){
      .main-nav{display:none;}
      .hamburger{display:flex;}
      .nav-actions .btn-nav{display:none;}
    }


/* PAGE SHELL */
.page-shell {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 0 4rem;
}

h1, h2, h3, h4 {
  font-family: 'Playfair Display', Georgia, serif;
  margin: 0 0 0.5rem;
}

/* ==========================================
   PAGE-SPECIFIC STICKY NAVIGATION
   ========================================== */

.page-nav {
  background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);
  border-bottom: 2px solid #ec407a;
  box-shadow: 0 2px 8px rgba(236, 64, 122, 0.15);
  position: sticky;
  top: 64px; /* Stick below main header */
  z-index: 999;
  transition: all 0.3s ease;
}

.page-nav.scrolled {
  box-shadow: 0 4px 12px rgba(236, 64, 122, 0.25);
}

.page-nav-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 2rem;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.page-nav-link {
  padding: 1rem 1.5rem;
  color: #880e4f;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.9rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.3s ease;
  border-bottom: 3px solid transparent;
  position: relative;
}

.page-nav-link:hover {
  color: #ec407a;
  background: rgba(255, 255, 255, 0.5);
  border-bottom-color: #ec407a;
}

.page-nav-link.active {
  color: #ec407a;
  border-bottom-color: #ec407a;
  background: rgba(255, 255, 255, 0.7);
}

.page-nav-link i {
  font-size: 1rem;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .page-nav {
    top: 60px;
  }
  
  .page-nav-container {
    padding: 0 1rem;
    gap: 0.25rem;
  }
  
  .page-nav-link {
    padding: 0.75rem 1rem;
    font-size: 0.85rem;
  }
  
  .page-nav-link i {
    font-size: 0.9rem;
  }
}

@media (max-width: 480px) {
  .page-nav-link span {
    display: none; /* Hide text on very small screens, show only icons */
  }
  
  .page-nav-link {
    padding: 0.75rem;
  }
}

/* HERO SECTION */
.hero {
  position: relative;
  display: grid;
  grid-template-columns: 1.15fr 0.85fr;
  gap: 3rem;
  align-items: center;
  min-height: 88vh;
  padding: 4rem 2.5rem 3.5rem;
  border-radius: 0;
  background: radial-gradient(ellipse 70% 70% at 60% 40%, rgba(236,64,122,0.07) 0%, transparent 70%),
              radial-gradient(ellipse 50% 60% at 5% 85%, rgba(124,58,237,0.05) 0%, transparent 60%),
              linear-gradient(160deg, #fdf2f7 0%, #f8eef8 40%, #fff 100%);
  overflow: hidden;
  margin-bottom: 0;
  max-width: 100%;
}
.hero::before {
  content: '';
  position: absolute; inset: 0;
  background: radial-gradient(ellipse 80% 55% at 55% 45%, rgba(236,64,122,0.06) 0%, transparent 68%);
  pointer-events: none; z-index: 0;
}
#heroBoneCanvas {
  position: absolute; inset: 0; width: 100%; height: 100%;
  pointer-events: none; z-index: 0; opacity: 0.55;
}
@media (max-width: 900px) {
  .hero {
    grid-template-columns: 1fr;
    min-height: auto;
    padding: 3rem 1.5rem 2.5rem;
  }
  .hero-visual { order: -1; }
}
@media (max-width: 640px) {
  .hero { padding: 2rem 1rem 2rem; }
}

/* Hero left text */
.hero-left { position: relative; z-index: 2; }

/* Hero title: journeys.html style */
.hero-title-3d {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: clamp(2.6rem, 5.2vw, 4.4rem);
  font-weight: 900;
  line-height: 1.07;
  margin-bottom: 1.3rem;
  background: linear-gradient(135deg, #212121 0%, #444 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}
.title-emphasis {
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 50%, #ad1457 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  animation: title-shimmer 3s ease-in-out infinite;
  filter: drop-shadow(0 2px 10px rgba(236,64,122,.32));
}
@keyframes title-shimmer {
  0%,100%{filter: brightness(1) drop-shadow(0 2px 10px rgba(236,64,122,.32));}
  50%{filter: brightness(1.3) drop-shadow(0 5px 18px rgba(236,64,122,.5));}
}

/* Keep gradient-text for inline uses */
.gradient-text {
  background: linear-gradient(135deg, #ec407a, #d81b60);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero-subtitle {
  color: var(--text-soft);
  font-size: 0.88rem;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  margin-bottom: 1.2rem;
  display: inline-flex; align-items: center; gap: 0.5rem;
  background: rgba(236,64,122,0.09);
  border: 1px solid rgba(236,64,122,0.2);
  color: var(--deep-pink);
  padding: 0.4rem 1rem; border-radius: 50px;
  animation: badge-glow 3s ease-in-out infinite;
}
@keyframes badge-glow {
  0%,100%{box-shadow: 0 0 0 0 rgba(236,64,122,0);}
  50%{box-shadow: 0 0 16px 3px rgba(236,64,122,0.16);}
}

.hero p {
  color: var(--text-soft);
  margin-bottom: 1.4rem;
  font-size: 1.05rem;
  line-height: 1.8;
  max-width: 520px;
}

.hero-badges {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.hero-badge {
  font-size: 0.78rem;
  padding: 0.2rem 0.6rem;
  border-radius: 999px;
  background: rgba(236,64,122,0.08);
  color: var(--deep-pink);
  border: 1px solid rgba(236,64,122,0.25);
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
}

.hero-cta-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-top: 0.75rem;
}

.btn-primary, .btn-secondary {
  border-radius: 999px;
  padding: 0.55rem 1.2rem;
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  transition: all 0.3s;
}

.btn-primary {
  background: var(--deep-pink);
  color: #fff;
}

.btn-primary:hover {
  background: var(--pink);
  transform: translateY(-2px);
}

.btn-secondary {
  background: transparent;
  color: var(--deep-pink);
  border: 1px solid rgba(216,27,96,0.35);
}

.btn-secondary:hover {
  background: rgba(236,64,122,0.08);
}

/* Hero visual â€” live canvas */
.hero-visual {
  position: relative;
  z-index: 2;
  width: 100%;
  min-height: 480px;
  display: flex;
  justify-content: center;
  align-items: center;
}
.bone-canvas-wrap {
  position: relative;
  width: 100%;
  height: 480px;
  max-width: 520px;
  margin: 0 auto;
}
#boneOrbitCanvas {
  width: 100%;
  height: 100%;
  display: block;
}
@media (max-width: 900px) {
  .hero-visual { min-height: 320px; }
  .bone-canvas-wrap { height: 320px; }
}
@media (max-width: 640px) {
  .hero-visual { min-height: 260px; }
  .bone-canvas-wrap { height: 260px; }
}

/* TIMELINE SECTION */
.timeline-section {
  padding: 5rem 2rem;
  background: white;
}

.section-header {
  text-align: center;
  margin-bottom: 3rem;
}

.section-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: rgba(236,64,122,0.08);
  border: 1px solid rgba(236,64,122,0.18);
  padding: 0.38rem 0.95rem;
  border-radius: 50px;
  font-weight: 700;
  font-size: 0.76rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--deep-pink);
  margin-bottom: 0.8rem;
}

.section-title {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: clamp(1.9rem, 4vw, 3.1rem);
  font-weight: 900;
  line-height: 1.13;
  margin: 0.6rem 0 0.75rem;
  color: var(--text-main);
}
.section-title .em,
.section-title .section-em {
  background: linear-gradient(135deg, #ec407a, #ad1457);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}

.section-subtitle {
  font-size: 1.05rem;
  color: var(--text-soft);
  max-width: 640px;
  margin: 0 auto;
  line-height: 1.8;
}

.timeline-container {
  max-width: 1400px;
  margin: 0 auto;
}

.phase-selector {
  display: flex;
  gap: 1rem;
  margin-bottom: 3rem;
  overflow-x: auto;
}

.phase-btn {
  flex: 1;
  min-width: 160px;
  padding: 1.5rem;
  background: white;
  border: 2px solid var(--border-soft);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s;
  text-align: center;
}

.phase-btn:hover {
  border-color: var(--deep-pink);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.phase-btn.active {
  background: linear-gradient(135deg, #ec407a, #d81b60);
  color: white;
  border-color: var(--deep-pink);
}

.phase-btn.critical {
  border-color: var(--critical);
}

.phase-btn.critical.active {
  background: linear-gradient(135deg, #f44336, #d32f2f);
}

.phase-age {
  font-size: 1.3rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
}

.phase-name {
  font-size: 0.9rem;
  opacity: 0.9;
}

.phase-icon {
  font-size: 1.5rem;
  margin-top: 0.5rem;
}

/* HORMONE VISUAL PANEL */
.hormone-visual-panel {
  display: grid;
  grid-template-columns: 1.5fr 1fr;
  gap: 2rem;
  background: linear-gradient(135deg, #f3e5f5, #fce4ec);
  border-radius: 20px;
  padding: 2rem;
}

.chart-area {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
}

.chart-title-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
}

.chart-title-bar h3 {
  font-size: 1.3rem;
  color: var(--text-main);
}

.chart-controls {
  display: flex;
  gap: 0.5rem;
}

.chart-btn {
  padding: 0.5rem 1rem;
  border: 2px solid var(--border-soft);
  background: white;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  transition: all 0.3s;
}

.chart-btn.active {
  background: var(--deep-pink);
  color: white;
  border-color: var(--deep-pink);
}

.hormone-chart {
  width: 100%;
  height: auto;
}

.estrogen-line {
  stroke-linecap: round;
}

.bone-line {
  stroke-linecap: round;
}

.chart-legend {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin-top: 1rem;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
}

.legend-line {
  width: 30px;
  height: 4px;
  border-radius: 2px;
}

.legend-line.estrogen {
  background: #4caf50;
}

.legend-line.bone {
  background: #ff9800;
}

/* METRICS PANEL */
.metrics-panel {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
}

.phase-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border-soft);
}

.phase-icon-large {
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 2rem;
}

.phase-title-block h3 {
  font-size: 1.5rem;
  margin-bottom: 0.2rem;
}

.phase-title-block p {
  color: var(--text-soft);
  font-size: 0.9rem;
}

.gauges-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin-bottom: 2rem;
}

.gauge-card {
  background: #fafafa;
  padding: 1rem;
  border-radius: 10px;
  text-align: center;
}

.gauge-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-soft);
}

.gauge-visual {
  margin: 1rem 0;
}

.circular-gauge {
  width: 100%;
  height: auto;
}

.gauge-label {
  font-size: 0.8rem;
  color: var(--text-soft);
  font-weight: 600;
}

.insights-box {
  background: #f3e5f5;
  padding: 1.5rem;
  border-radius: 10px;
  margin-bottom: 1rem;
}

.insights-box h4 {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--deep-pink);
  margin-bottom: 1rem;
}

.insights-box ul {
  list-style: none;
  padding: 0;
}

.insights-box li {
  padding: 0.5rem 0;
  padding-left: 1.5rem;
  position: relative;
  color: var(--text-soft);
}

.insights-box li::before {
  content: "â†’";
  position: absolute;
  left: 0;
  color: var(--deep-pink);
  font-weight: 700;
}

.risk-alert {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-radius: 10px;
  background: #e8f5e9;
  border-left: 4px solid #4caf50;
}

.risk-alert.moderate {
  background: #fff3e0;
  border-left-color: #ff9800;
}

.risk-alert.high {
  background: #ffebee;
  border-left-color: #f44336;
}

.alert-icon {
  font-size: 2rem;
  color: #4caf50;
}

.risk-alert.moderate .alert-icon {
  color: #ff9800;
}

.risk-alert.high .alert-icon {
  color: #f44336;
}

.alert-title {
  font-weight: 700;
  font-size: 1rem;
}

.alert-message {
  font-size: 0.9rem;
  color: var(--text-soft);
}

/* SECTION BLOCKS */
.section-block {
  padding: 4rem 0 3rem 0;
  margin-top: 2rem;
}

.section-title-row {
  text-align: center;
  margin-bottom: 3rem;
  padding: 2rem 1rem;
}

.section-title-row h2 {
  font-family: 'Playfair Display', Georgia, serif;
  font-size: clamp(1.9rem, 4vw, 3.1rem);
  font-weight: 900;
  line-height: 1.13;
  margin: 0.6rem 0 0.75rem;
  color: var(--text-main);
}
.section-title-row h2 .em {
  background: linear-gradient(135deg, #ec407a, #ad1457);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
}

.section-tagline {
  font-size: 0.85rem;
  color: var(--text-soft);
}

.card {
  background: var(--card-bg);
  border-radius: 18px;
  padding: 1.1rem 1.2rem;
  box-shadow: 0 10px 28px rgba(0,0,0,0.06);
  border: 1px solid rgba(0,0,0,0.03);
}

/* PHASE TABS */
.phase-tabs {
  display: flex;
  gap: 0.6rem;
  margin-bottom: 1rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
}

.phase-tab {
  flex: 1;
  min-width: 120px;
  padding: 0.75rem 1rem;
  background: white;
  border: 2px solid var(--border-soft);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s;
  text-align: center;
}

.phase-tab:hover {
  border-color: var(--deep-pink);
  transform: translateY(-2px);
}

.phase-tab.active {
  background: var(--deep-pink);
  color: white;
  border-color: var(--deep-pink);
}

.phase-tab.critical-tab {
  border-color: #f44336;
}

.phase-tab.critical-tab.active {
  background: #f44336;
}

.tab-age {
  font-size: 1.1rem;
  font-weight: 700;
  margin-bottom: 0.2rem;
}

.tab-name {
  font-size: 0.8rem;
  opacity: 0.9;
}

/* JOURNEY CARD */
.journey-card {
  padding: 1.5rem;
}

.journey-svg {
  width: 100%;
  height: auto;
  margin-bottom: 1.5rem;
}

.phase-info {
  display: grid;
  gap: 1rem;
}

.phase-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border-soft);
}

.phase-icon {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #ec407a, #d81b60);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 1.5rem;
}

.phase-header h3 {
  font-size: 1.3rem;
}

.metrics-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
}

@media (max-width: 700px) {
  .metrics-grid {
    grid-template-columns: 1fr;
  }
}

.metric-item {
  background: #fafafa;
  padding: 0.8rem;
  border-radius: 8px;
}

.metric-label {
  font-size: 0.8rem;
  color: var(--text-soft);
  margin-bottom: 0.4rem;
}

.metric-bar {
  height: 8px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 0.4rem;
}

.metric-fill {
  height: 100%;
  border-radius: 10px;
  transition: width 0.5s ease;
}

.metric-fill.estrogen {
  background: linear-gradient(90deg, #4caf50, #81c784);
}

.metric-fill.bone {
  background: linear-gradient(90deg, #ff9800, #ffb74d);
}

.metric-fill.joint {
  background: linear-gradient(90deg, #9c27b0, #ba68c8);
}

.metric-text {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-main);
}

.insights-box {
  background: var(--chip-bg);
  padding: 1rem;
  border-radius: 10px;
}

.insights-box h4 {
  color: var(--deep-pink);
  margin-bottom: 0.5rem;
  font-size: 1rem;
}

.insights-box ul {
  list-style: none;
  padding: 0;
}

.insights-box li {
  padding: 0.3rem 0;
  padding-left: 1.2rem;
  position: relative;
  font-size: 0.9rem;
  color: var(--text-soft);
}

.insights-box li::before {
  content: "â†’";
  position: absolute;
  left: 0;
  color: var(--deep-pink);
  font-weight: 700;
}

.risk-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.6rem 1rem;
  border-radius: 999px;
  font-weight: 600;
  font-size: 0.9rem;
  background: #e8f5e9;
  color: #2e7d32;
}

.risk-badge.moderate {
  background: #fff3e0;
  color: #e65100;
}

.risk-badge.high {
  background: #ffebee;
  color: #c62828;
}

/* TOPICS GRID */
.topics-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

@media (max-width: 700px) {
  .topics-grid {
    grid-template-columns: 1fr;
  }
}

/* ==========================================
   ENHANCED TOPIC CARDS
   ========================================== */

.topic-card {
  background: white;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  border: 2px solid transparent;
}

.topic-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 35px rgba(236,64,122,0.15);
  border-color: rgba(236,64,122,0.2);
}

.topic-card.expanded {
  border-color: var(--deep-pink);
  box-shadow: 0 12px 40px rgba(236,64,122,0.2);
}

.topic-card.critical-topic {
  border-left: 5px solid #f44336;
}

.topic-card.completed-animation {
  animation: completePulse 0.6s ease;
}

@keyframes completePulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); box-shadow: 0 0 30px rgba(76,175,80,0.4); }
}

/* Card Header Area */
.topic-card-header {
  padding: 1rem 1.2rem 0.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.topic-number {
  width: 50px;
  height: 50px;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  position: relative;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.topic-number span {
  font-size: 1.5rem;
}

.topic-num-text {
  font-size: 0.7rem;
  opacity: 0.9;
  margin-top: -2px;
}

.topic-category-badge {
  padding: 0.35rem 0.9rem;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.critical-badge {
  padding: 0.35rem 0.9rem;
  background: linear-gradient(135deg, #ff5252 0%, #f44336 100%);
  color: white;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.3rem;
  animation: pulseBadge 2s infinite;
}

@keyframes pulseBadge {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

/* Main Topic Header */
.topic-header {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem 1.2rem;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
}

.topic-header:hover {
  background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);
}

.topic-header::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 4px;
  background: var(--deep-pink);
  transform: scaleY(0);
  transition: transform 0.3s;
}

.topic-header:hover::before {
  transform: scaleY(1);
}

.topic-icon-new {
  width: 52px;
  height: 52px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  flex-shrink: 0;
  transition: all 0.3s;
}

.topic-header:hover .topic-icon-new {
  transform: scale(1.1) rotate(5deg);
}

.topic-icon-new.critical-icon {
  background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%) !important;
  color: #f44336 !important;
}

.topic-info {
  flex: 1;
  min-width: 200px;
}

.topic-info h3 {
  font-size: 1.15rem;
  margin-bottom: 0.3rem;
  color: var(--text-main);
  font-weight: 700;
  line-height: 1.3;
}

.topic-summary {
  font-size: 0.9rem;
  color: var(--text-soft);
  margin: 0;
  line-height: 1.5;
}

.topic-action-area {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 0.5rem;
}

.read-time {
  font-size: 0.75rem;
  color: #999;
  display: flex;
  align-items: center;
  gap: 0.3rem;
  padding: 0.25rem 0.6rem;
  background: #f5f5f5;
  border-radius: 12px;
}

.expand-icon {
  font-size: 1.3rem;
  color: var(--deep-pink);
  transition: all 0.4s;
}

.expand-icon.expanded {
  transform: rotate(180deg);
  color: #4caf50;
}

/* Content Area */
.topic-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.topic-content.active {
  max-height: 3000px;
}

.content-section {
  padding: 1.2rem 1.5rem 1.5rem;
  border-top: 2px solid #f5f5f5;
  background: linear-gradient(to bottom, #fafafa 0%, white 100%);
}

.content-section h4 {
  color: var(--deep-pink);
  margin-bottom: 0.7rem;
  margin-top: 1rem;
  font-size: 1rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.content-section h4:first-child {
  margin-top: 0;
}

.content-section h4::before {
  content: '';
  width: 4px;
  height: 20px;
  background: var(--deep-pink);
  border-radius: 2px;
}

/* Footer Actions */
.topic-footer-actions {
  display: flex;
  gap: 0.75rem;
  margin-top: 1.5rem;
  padding-top: 1rem;
  border-top: 1px solid #eeeeee;
  flex-wrap: wrap;
}

.topic-action-btn {
  padding: 0.65rem 1.2rem;
  background: linear-gradient(135deg, #ec407a 0%, #d81b60 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  font-size: 0.85rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: all 0.3s;
  box-shadow: 0 3px 10px rgba(236,64,122,0.3);
}

.topic-action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(236,64,122,0.4);
}

.topic-action-btn.secondary {
  background: white;
  color: var(--deep-pink);
  border: 2px solid var(--deep-pink);
  box-shadow: none;
}

.topic-action-btn.secondary:hover {
  background: var(--deep-pink);
  color: white;
}

/* Viewed Indicator */
.topic-viewed-indicator {
  position: absolute;
  top: 1rem;
  right: 1rem;
  padding: 0.4rem 0.8rem;
  background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
  color: white;
  border-radius: 20px;
  font-size: 0.75rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.3rem;
  box-shadow: 0 3px 10px rgba(76,175,80,0.3);
  z-index: 10;
  animation: slideInRight 0.4s ease;
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.compact-list {
  list-style: none;
  padding: 0;
}

.compact-list li {
  padding: 0.25rem 0;
  padding-left: 1rem;
  position: relative;
  font-size: 0.88rem;
  color: var(--text-soft);
  line-height: 1.5;
}

.compact-list li::before {
  content: "â€¢";
  position: absolute;
  left: 0;
  color: var(--deep-pink);
  font-weight: 700;
}

.two-column-list {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

@media (max-width: 600px) {
  .two-column-list {
    grid-template-columns: 1fr;
  }
}

.severity-section {
  margin-bottom: 1rem;
  padding: 0.8rem;
  border-radius: 8px;
}

.severity-section.mild {
  background: #e8f5e9;
}

.severity-section.moderate {
  background: #fff3e0;
}

.severity-section.critical {
  background: #ffebee;
}

.severity-section h4 {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.emergency-banner {
  background: #f44336;
  color: white;
  padding: 0.8rem;
  border-radius: 8px;
  text-align: center;
  font-weight: 700;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.critical-list li {
  color: #c62828;
  font-weight: 600;
}

/* SIMULATION */
.simulation-grid {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 1.5rem;
}

@media (max-width: 900px) {
  .simulation-grid {
    grid-template-columns: 1fr;
  }
}

.sim-controls h4 {
  margin-bottom: 0.8rem;
  color: var(--deep-pink);
}

.stage-btns {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
  margin-bottom: 1.5rem;
}

.stage-btn {
  padding: 0.7rem 1rem;
  background: white;
  border: 2px solid var(--border-soft);
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.6rem;
  transition: all 0.3s;
  font-size: 0.9rem;
}

.stage-btn:hover {
  border-color: var(--deep-pink);
}

.stage-btn.active {
  background: var(--deep-pink);
  color: white;
  border-color: var(--deep-pink);
}

.stage-btn.treatment-btn {
  border-color: #4caf50;
  color: #2e7d32;
}

.stage-btn.treatment-btn:hover {
  border-color: #2e7d32;
  background: #f1f8f4;
}

.stage-btn.treatment-btn.active {
  background: linear-gradient(135deg, #66bb6a, #43a047);
  color: white;
  border-color: #43a047;
}

.stage-btn.treatment-btn.active i {
  animation: pillPulse 2s ease-in-out infinite;
}

/* Treatment-specific animations */
.treatment-glow {
  filter: drop-shadow(0 0 20px rgba(76, 175, 80, 0.4));
  animation: treatmentPulse 3s ease-in-out infinite;
}

@keyframes treatmentPulse {
  0%, 100% { 
    filter: drop-shadow(0 0 15px rgba(76, 175, 80, 0.3)); 
  }
  50% { 
    filter: drop-shadow(0 0 30px rgba(76, 175, 80, 0.7)); 
  }
}

/* Impact and benefit indicators */
.impact-indicator,
.treatment-benefit {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.6rem;
  margin: 0.4rem 0;
  background: #fafafa;
  border-radius: 8px;
  font-size: 0.9rem;
  line-height: 1.5;
}

.impact-indicator {
  border-left: 3px solid #f44336;
}

.treatment-benefit {
  border-left: 3px solid #4caf50;
}

.impact-indicator i {
  color: #f44336;
  margin-top: 0.2rem;
  font-size: 0.85rem;
}

.treatment-benefit i {
  color: #4caf50;
  margin-top: 0.2rem;
  font-size: 0.85rem;
}

.patient-info-box {
  padding: 1rem;
  border-radius: 10px;
  background: #f5f5f5;
  border-left: 4px solid #2196f3;
}

.patient-info-box.good {
  background: #e8f5e9;
  border-left-color: #4caf50;
}

.patient-info-box.critical {
  background: #ffebee;
  border-left-color: #f44336;
}

.patient-info-box h5 {
  margin: 0 0 0.5rem 0;
  font-size: 0.95rem;
  color: #333;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.patient-info-box p {
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.6;
  color: #555;
}


@keyframes pillPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.15); }
}

/* Prevent content overflow in simulation display */
.sim-display {
  min-height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden; /* ADD THIS */
  position: relative; /* ADD THIS */
}

.sim-display .card {
  width: 100%;
  max-width: 100%;
  overflow: visible;
}
.sim-empty {
  text-align: center;
  color: var(--text-soft);
}

.sim-empty i {
  font-size: 3rem;
  color: var(--deep-pink);
  margin-bottom: 1rem;
  display: block;
}

/* FOOTER */
/* footer styles handled in separate block at end of body */

/* BODY PART SELECTOR */
.body-part-btn {
  width: 100%;
  padding: 0.8rem 1rem;
  background: white;
  border: 2px solid var(--border-soft);
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  transition: all 0.3s;
  font-size: 0.9rem;
  margin-bottom: 0.6rem;
}

.body-part-btn:hover {
  border-color: var(--deep-pink);
  background: #fafafa;
}

.body-part-btn.active {
  background: var(--deep-pink);
  color: white;
  border-color: var(--deep-pink);
}

.body-part-btn i {
  font-size: 1.2rem;
}

/* VISUALIZATION CONTAINER */
/* Prevent overlap between title and 3D content */
.viz-container {
  margin-top: 2rem;
  padding-top: 1rem;
}


.viz-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border-soft);
}


.viz-container .viz-header {
  margin-bottom: 2rem;
  padding-bottom: 1rem;
}



.viz-header h3 {
  font-size: 1.5rem;
  color: var(--text-main);
}

.stage-tag {
  padding: 0.5rem 1rem;
  border-radius: 50px;
  font-weight: 600;
  font-size: 0.9rem;
  text-transform: uppercase;
}

.stage-tag.healthy {
  background: #e8f5e9;
  color: #2e7d32;
}

.stage-tag.early {
  background: #fff3e0;
  color: #e65100;
}

.stage-tag.advanced {
  background: #ffebee;
  color: #c62828;
}

.viz-svg-container {
  background: linear-gradient(135deg, #f5f5f5, #fafafa);
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;
}

/* Add proper spacing between visualization and info */
.viz-stats {
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 2px solid var(--border-soft);
}

.viz-stat-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.viz-stat-card {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid var(--border-soft);
}

.viz-stat-label {
  font-size: 0.85rem;
  color: var(--text-soft);
  margin-bottom: 0.3rem;
  display: block;
}

.viz-stat-value {
  font-size: 1.1rem;
  font-weight: 700;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  padding: 0.8rem 0;
  border-bottom: 1px solid rgba(0,0,0,0.05);
}

.stat-row:last-child {
  border-bottom: none;
}

.stat-good {
  color: #4caf50;
  font-weight: 700;
}

.stat-moderate {
  color: #ff9800;
  font-weight: 700;
}

.stat-critical {
  color: #f44336;
  font-weight: 700;
}

/* Fix description overflow */
.viz-description {
  background: white;
  padding: 1.5rem;
  border-radius: 10px;
  border-left: 4px solid var(--deep-pink);
  max-width: 100%;
  overflow-wrap: break-word;
  word-wrap: break-word;
}

.viz-description h4 {
  color: var(--deep-pink);
  margin-bottom: 1rem;
  font-size: 1.1rem;
}

.viz-description p {
  color: var(--text-soft);
  line-height: 1.7;
  margin-bottom: 0;
}
/* RISK ALERT VARIATIONS */
.risk-alert {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-radius: 10px;
  margin-top: 1.5rem;
}

.risk-alert.low {
  background: #e8f5e9;
}

.risk-alert.moderate {
  background: #fff3e0;
}

.risk-alert.high {
  background: #ffebee;
}

.alert-icon {
  font-size: 2rem;
}

.risk-alert.low .alert-icon {
  color: #2e7d32;
}

.risk-alert.moderate .alert-icon {
  color: #e65100;
}

.risk-alert.high .alert-icon {
  color: #c62828;
}

.alert-content {
  flex: 1;
}

.alert-title {
  font-weight: 700;
  font-size: 1rem;
  margin-bottom: 0.2rem;
}

.risk-alert.low .alert-title {
  color: #2e7d32;
}

.risk-alert.moderate .alert-title {
  color: #e65100;
}

.risk-alert.high .alert-title {
  color: #c62828;
}

.alert-message {
  font-size: 0.9rem;
  color: var(--text-soft);
}

/* RESPONSIVE UPDATES */
@media (max-width: 1100px) {
  .hormone-visual-panel {
    grid-template-columns: 1fr;
  }
  
  .gauges-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 600px) {
  .gauges-grid {
    grid-template-columns: 1fr;
  }
  
  .phase-selector {
    flex-direction: column;
  }
  
  .phase-btn {
    min-width: auto;
  }
}

/* ============================================
   BODY DIAGRAM STYLES
   ============================================ */

.body-diagram-container {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start; /* Changed from center */
  padding: 2rem;
  padding-top: 3rem; /* Add extra top padding */
  min-height: 500px; /* Add minimum height */
}

.body-diagram {
  position: relative;
  width: 100%;
  max-width: 300px;
  margin: 0 auto 2rem;
}

.skeleton-svg {
  width: 100%;
  height: auto;
  filter: drop-shadow(0 4px 12px rgba(0,0,0,0.1));
}

/* Back to body button */
.back-to-body-btn {
  padding: 0.5rem 1rem;
  background: white;
  border: 2px solid var(--deep-pink);
  border-radius: 8px;
  color: var(--deep-pink);
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.9rem;
}

.back-to-body-btn:hover {
  background: var(--deep-pink);
  color: white;
  transform: translateX(-3px);
}

.back-to-body-btn i {
  transition: transform 0.3s;
}

.back-to-body-btn:hover i {
  transform: translateX(-3px);
}

/* Update viz-header to accommodate back button */
.viz-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border-soft);
  flex-wrap: wrap;
  gap: 1rem;
}

.viz-header h3 {
  flex: 1;
  min-width: 200px;
}


.clickable-bone {
  cursor: pointer;
  transition: all 0.3s ease;
}

.clickable-bone:hover {
  fill: #ec407a;
  stroke: #d81b60;
  stroke-width: 4;
  filter: drop-shadow(0 0 10px rgba(236,64,122,0.6));
}

.body-hotspot {
  cursor: pointer;
  transition: all 0.3s ease;
}

.body-hotspot:hover {
  fill: rgba(236,64,122,0.6);
}

.body-labels {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.label {
  position: absolute;
  background: rgba(255,255,255,0.95);
  padding: 0.3rem 0.6rem;
  border-radius: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--deep-pink);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border: 1px solid rgba(236,64,122,0.3);
  white-space: nowrap;
}

.body-diagram-hint {
  text-align: center;
  color: var(--text-soft);
  font-size: 0.9rem;
}

.body-diagram-hint i {
  display: block;
  font-size: 2rem;
  color: var(--deep-pink);
  margin-bottom: 0.5rem;
  animation: pointPulse 2s ease-in-out infinite;
}

@keyframes pointPulse {
  0%, 100% { transform: scale(1); opacity: 0.7; }
  50% { transform: scale(1.1); opacity: 1; }
}

/* Active state for selected body parts */
.body-hotspot.active {
  fill: rgba(236,64,122,0.8);
}

.clickable-bone.active {
  fill: #ec407a;
  stroke: #d81b60;
  stroke-width: 4;
}

/* Visualization container when shown */
#vizContainerMain {
  width: 100%;
  height: 100%;
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Responsive adjustments */
@media (max-width: 900px) {
  .body-diagram {
    max-width: 250px;
  }
  
  .label {
    font-size: 0.7rem;
    padding: 0.25rem 0.5rem;
  }
}


/* ============================================
   ENHANCED 3D VISUALIZATION EFFECTS
   ============================================ */

/* Patient-friendly info boxes */
.patient-info-box {
  background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
  border-left: 4px solid #ff9800;
  padding: 1rem;
  border-radius: 8px;
  margin: 1.5rem 0; /* Increased from 1rem */
  margin-top: 2rem; /* Add extra top margin */
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  clear: both; /* Prevent float overlap */
}

.patient-info-box h5 {
  color: #e65100;
  font-size: 0.95rem;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.patient-info-box p {
  color: #555;
  font-size: 0.85rem;
  line-height: 1.6;
  margin: 0;
}

.patient-info-box.critical {
  background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
  border-left-color: #f44336;
}

.patient-info-box.critical h5 {
  color: #c62828;
}

.patient-info-box.good {
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
  border-left-color: #4caf50;
}

.patient-info-box.good h5 {
  color: #2e7d32;
}

/* Impact indicators for disease spread */
.impact-indicator {
  background: rgba(244, 67, 54, 0.1);
  border: 2px dashed #f44336;
  padding: 0.8rem; /* Increased from 0.6rem */
  border-radius: 8px;
  margin: 0.8rem 0; /* Increased from 0.5rem */
  font-size: 0.85rem;
  color: #d32f2f;
  display: flex;
  align-items: flex-start; /* Changed from center */
  gap: 0.5rem;
  animation: warningPulse 2s ease-in-out infinite;
  line-height: 1.5; /* Add line height */
  clear: both; /* Prevent overlap */
}

@keyframes warningPulse {
  0%, 100% { 
    background: rgba(244, 67, 54, 0.1);
    border-color: #f44336;
  }
  50% { 
    background: rgba(244, 67, 54, 0.2);
    border-color: #d32f2f;
  }
}

.impact-indicator i {
  font-size: 1.2rem;
}

/* Treatment benefit indicators */
.treatment-benefit {
  background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
  border: 2px solid #4caf50;
  padding: 0.8rem; /* Increased from 0.6rem */
  border-radius: 8px;
  margin: 0.8rem 0; /* Increased from 0.5rem */
  font-size: 0.85rem;
  color: #2e7d32;
  display: flex;
  align-items: flex-start; /* Changed from center */
  gap: 0.5rem;
  animation: healingGlow 3s ease-in-out infinite;
  line-height: 1.5; /* Add line height */
  clear: both; /* Prevent overlap */
}

@keyframes healingGlow {
  0%, 100% { 
    box-shadow: 0 0 0 rgba(76, 175, 80, 0);
  }
  50% { 
    box-shadow: 0 0 20px rgba(76, 175, 80, 0.4);
  }
}

.treatment-benefit i {
  font-size: 1.2rem;
  color: #43a047;
}

/* Simple language labels */
.simple-label {
  background: white;
  padding: 0.4rem 0.8rem;
  border-radius: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  border: 2px solid;
  display: inline-block;
  margin: 0.2rem;
}

.simple-label.danger {
  color: #c62828;
  border-color: #f44336;
  background: #ffebee;
}

.simple-label.warning {
  color: #e65100;
  border-color: #ff9800;
  background: #fff3e0;
}

.simple-label.safe {
  color: #2e7d32;
  border-color: #4caf50;
  background: #e8f5e9;
}

/* 3D rotation animation for severe cases */
.rotating-view {
  animation: rotate3D 10s ease-in-out infinite;
  transform-style: preserve-3d;
}

@keyframes rotate3D {
  0% { transform: perspective(1200px) rotateY(-3deg) rotateX(2deg); }
  25% { transform: perspective(1200px) rotateY(3deg) rotateX(-1deg); }
  50% { transform: perspective(1200px) rotateY(-2deg) rotateX(3deg); }
  75% { transform: perspective(1200px) rotateY(4deg) rotateX(-2deg); }
  100% { transform: perspective(1200px) rotateY(-3deg) rotateX(2deg); }
}

/* Breathing animation for healthy bones */
.breathing-animation {
  animation: breathe 4s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

/* Pulsing animation for diseased areas */
.disease-pulse {
  animation: diseasePulse 2s ease-in-out infinite;
}

@keyframes diseasePulse {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.1); }
}

/* Treatment glow effect */
.treatment-glow {
  filter: drop-shadow(0 0 15px rgba(76, 175, 80, 0.6));
  animation: treatmentPulse 3s ease-in-out infinite;
}

@keyframes treatmentPulse {
  0%, 100% { filter: drop-shadow(0 0 15px rgba(76, 175, 80, 0.4)); }
  50% { filter: drop-shadow(0 0 25px rgba(76, 175, 80, 0.8)); }
}


/* Depth layers for 3D effect */
.depth-layer-1 {
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
}

.depth-layer-2 {
  filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
}

.depth-layer-3 {
  filter: drop-shadow(0 12px 24px rgba(0,0,0,0.4));
}

/* Spread visualization lines */
.spread-line {
  stroke-dasharray: 5, 5;
  animation: spreadFlow 2s linear infinite;
}

@keyframes spreadFlow {
  0% { stroke-dashoffset: 0; }
  100% { stroke-dashoffset: 10; }
}


/* SVG Text Label Improvements */
svg text {
  pointer-events: none; /* Prevent text from blocking interactions */
  user-select: none; /* Prevent text selection */
}

/* Ensure SVG containers have proper spacing */
svg {
  display: block;
  max-width: 100%;
  height: auto;
  margin-bottom: 1.5rem;
}

/* Fix for inline SVG labels */
.simple-label {
  background: white;
  padding: 0.4rem 0.8rem;
  border-radius: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  border: 2px solid;
  display: inline-block;
  margin: 0.3rem; /* Increased from 0.2rem */
  white-space: nowrap;
  z-index: 10;
  position: relative;
}



/* Realistic body part scaling */
.body-part-realistic {
  transform-origin: center;
  transition: transform 0.3s ease;
}

.body-part-realistic:hover {
  transform: scale(1.05);
}

/* Cartilage degradation visualization */
.cartilage-layer {
  animation: cartilageDegrade 3s ease-in-out infinite;
}

@keyframes cartilageDegrade {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 0.4; }
}

/* Bone density particles */
.density-particle {
  animation: particleFloat 4s ease-in-out infinite;
}

@keyframes particleFloat {
  0%, 100% { 
    transform: translateY(0) scale(1);
    opacity: 0.6;
  }
  50% { 
    transform: translateY(-5px) scale(1.2);
    opacity: 1;
  }
}

/* ==========================================
   MOBILE RESPONSIVE - TOPIC CARDS
   ========================================== */

@media (max-width: 768px) {
  .topic-card-header {
    padding: 0.75rem 1rem 0.4rem;
  }
  
  .topic-number {
    width: 45px;
    height: 45px;
  }
  
  .topic-number span {
    font-size: 1.3rem;
  }
  
  .topic-category-badge {
    font-size: 0.7rem;
    padding: 0.3rem 0.7rem;
  }
  
  .critical-badge {
    font-size: 0.7rem;
    padding: 0.3rem 0.7rem;
  }
  
  .topic-header {
    padding: 0.75rem 1rem;
    flex-wrap: wrap;
  }
  
  .topic-icon-new {
    width: 45px;
    height: 45px;
    font-size: 1.3rem;
  }
  
  .topic-info h3 {
    font-size: 1rem;
  }
  
  .topic-summary {
    font-size: 0.85rem;
  }
  
  .topic-action-area {
    width: 100%;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    margin-top: 0.5rem;
  }
  
  .content-section {
    padding: 1rem;
  }
  
  .topic-footer-actions {
    flex-direction: column;
  }
  
  .topic-action-btn {
    width: 100%;
    justify-content: center;
  }
  
  .topic-viewed-indicator {
    position: static;
    margin: 0.5rem 1rem;
    width: fit-content;
  }
}

@media (max-width: 480px) {
  .section-title-row h2 {
    font-size: 1.8rem !important;
  }
  
  .section-tagline {
    font-size: 0.95rem !important;
  }
  
  .topic-card {
    border-radius: 16px;
  }
  
  .read-time {
    font-size: 0.7rem;
  }
}


/* ================================
   3D WOMAN BODY VISUALIZATIONS
   ================================ */

.woman-body-3d {
  position: relative;
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
}

.body-annotations {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.annotation {
  position: absolute;
  transform: translate(-50%, -50%);
  pointer-events: all;
  cursor: pointer;
  z-index: 10;
}

.annotation-dot {
  width: 16px;
  height: 16px;
  background: radial-gradient(circle, #66bb6a, #43a047);
  border: 3px solid white;
  border-radius: 50%;
  box-shadow: 0 0 15px rgba(102, 187, 106, 0.6);
  animation: pulse-dot 2s infinite;
}

@keyframes pulse-dot {
  0%, 100% { transform: scale(1); box-shadow: 0 0 15px rgba(102, 187, 106, 0.6); }
  50% { transform: scale(1.3); box-shadow: 0 0 25px rgba(102, 187, 106, 0.9); }
}

.annotation-label {
  position: absolute;
  top: 25px;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  padding: 8px 14px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  text-align: center;
  color: var(--text-main);
  border: 2px solid #66bb6a;
}

.annotation-detail {
  font-size: 11px;
  color: #66bb6a;
  font-weight: 700;
}

.normal-immunity-text,
.breakdown-explanation,
.attack-explanation {
  margin-top: 30px;
  padding: 20px;
  background: linear-gradient(135deg, #f3e5f5, #e1f5fe);
  border-left: 5px solid var(--pink);
  border-radius: 12px;
  font-size: 15px;
  line-height: 1.8;
}

.normal-immunity-text h4,
.breakdown-explanation h4,
.attack-explanation h4 {
  font-family: 'Manrope', sans-serif;
  color: var(--deep-pink);
  margin-bottom: 12px;
  font-size: 18px;
}

.normal-immunity-text p,
.breakdown-explanation p,
.attack-explanation p {
  margin-bottom: 10px;
}

.breakdown-body-container,
.attack-body-3d {
  position: relative;
  width: 100%;
  max-width: 500px;
  margin: 30px auto;
}

.attack-indicators {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.attack-pulse {
  position: absolute;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle, rgba(239, 83, 80, 0.8), transparent);
  border-radius: 50%;
  animation: attack-pulse 1.5s infinite;
}

@keyframes attack-pulse {
  0% { transform: scale(0.5); opacity: 1; }
  100% { transform: scale(2.5); opacity: 0; }
}

/* Disease Body Visualizations */
.disease-body-canvas {
  display: block;
  margin: 15px auto;
  border-radius: 12px;
  background: linear-gradient(180deg, #faf5fb, #ffffff);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.disease-body-text {
  background: rgba(255,255,255,0.8);
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
  font-size: 13px;
  line-height: 1.6;
}

.disease-body-text ul {
  margin: 10px 0;
  padding-left: 20px;
}

.disease-body-text li {
  margin-bottom: 8px;
}

.disease-body-text strong {
  color: var(--deep-pink);
  font-weight: 700;
}

.body-explain {
  margin-top: 12px;
  padding: 12px;
  background: linear-gradient(135deg, #fff3e0, #ffe0b2);
  border-left: 4px solid #ff9800;
  border-radius: 6px;
  font-weight: 600;
  font-size: 14px;
}

/* =====================================================
   COMPREHENSIVE MOBILE RESPONSIVENESS
   ===================================================== */

/* --- Page Shell padding on mobile --- */
@media (max-width: 768px) {
  .page-shell {
    padding: 0 0 2rem;
  }
}

/* --- Hero section --- */
@media (max-width: 640px) {
  .hero {
    min-height: auto;
    padding: 1.5rem 1rem 2rem;
  }
  .hero p {
    font-size: 0.95rem;
    max-width: 100%;
  }
  .hero-cta-row {
    flex-direction: column;
    gap: 0.5rem;
  }
  .btn-primary, .btn-secondary {
    width: 100%;
    justify-content: center;
    padding: 0.7rem 1rem;
  }
  .hero-badges {
    gap: 0.4rem;
  }
  .hero-badge {
    font-size: 0.72rem;
  }
}

/* --- Timeline / hormone section --- */
@media (max-width: 768px) {
  .timeline-section {
    padding: 3rem 1rem;
  }
  .section-header {
    margin-bottom: 1.5rem;
  }
  .phase-selector {
    gap: 0.5rem;
    padding-bottom: 0.5rem;
  }
  .phase-btn {
    min-width: 110px;
    padding: 1rem 0.75rem;
  }
  .phase-age {
    font-size: 1.1rem;
  }
  .phase-name {
    font-size: 0.8rem;
  }
  .chart-title-bar {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  .chart-title-bar h3 {
    font-size: 1.05rem;
  }
  .chart-controls {
    width: 100%;
  }
  .chart-btn {
    flex: 1;
    font-size: 0.78rem;
    padding: 0.4rem 0.6rem;
  }
  .chart-legend {
    gap: 1rem;
    font-size: 0.82rem;
  }
  .hormone-visual-panel {
    gap: 1rem;
  }
  .chart-area, .metrics-panel {
    padding: 1.25rem;
  }
  .gauges-grid {
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
  }
  .gauge-card {
    padding: 0.6rem;
  }
  .phase-title-block h3 {
    font-size: 1.1rem;
  }
}

@media (max-width: 480px) {
  .gauges-grid {
    grid-template-columns: 1fr;
    gap: 0.4rem;
  }
  .gauge-header {
    font-size: 0.72rem;
    gap: 0.25rem;
  }
  .gauge-label {
    font-size: 0.7rem;
  }
  .phase-icon-large {
    width: 48px;
    height: 48px;
    font-size: 1.5rem;
  }
  .insights-box {
    padding: 0.75rem;
  }
  .insights-box li {
    font-size: 0.83rem;
  }
}

/* --- Section blocks --- */
@media (max-width: 768px) {
  .section-block {
    padding: 2.5rem 1rem 1.5rem;
  }
  .section-title-row {
    padding: 1.5rem 1rem;
    margin-bottom: 1.5rem;
  }
  .section-subtitle {
    font-size: 0.95rem;
  }
}

/* --- Topics grid --- */
@media (max-width: 768px) {
  .topics-grid {
    grid-template-columns: 1fr;
    padding: 0 1rem;
  }
}

/* --- Progress tracker --- */
@media (max-width: 480px) {
  .topics-grid ~ div,
  .section-block > div[style*="max-width: 900px"] {
    margin-left: 1rem;
    margin-right: 1rem;
  }
}

/* --- Simulation / 3D section --- */
@media (max-width: 768px) {
  .simulation-grid {
    padding: 0 1rem;
  }
  .section-title-row + .simulation-grid,
  .section-title-row ~ .simulation-grid {
    padding: 0 1rem;
  }
  .stage-btns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
  }
  .stage-btn {
    font-size: 0.82rem;
    padding: 0.6rem 0.75rem;
  }
  .sim-display {
    min-height: 300px;
  }
  .body-diagram {
    max-width: 200px;
  }
  .body-labels .label {
    font-size: 0.65rem;
    padding: 0.2rem 0.4rem;
  }
  .label-spine { left: 155px !important; }
  .label-hip   { left: 155px !important; }
  .label-knee  { left: 160px !important; }
  .label-wrist { left: 5px !important; }
  .body-diagram-container {
    padding: 1rem;
    min-height: 400px;
  }
}

@media (max-width: 480px) {
  .stage-btns {
    grid-template-columns: 1fr;
  }
  .sim-controls.card, .sim-display.card {
    border-radius: 12px;
  }
}

/* --- Viz container --- */
@media (max-width: 768px) {
  .viz-svg-container {
    padding: 1rem;
  }
  .viz-header h3 {
    font-size: 1.1rem;
  }
  .viz-stat-row {
    grid-template-columns: 1fr;
  }
  .viz-description {
    padding: 1rem;
  }
  .viz-description h4 {
    font-size: 1rem;
  }
}

/* --- Topic cards inner content --- */
@media (max-width: 480px) {
  .topic-info {
    min-width: 0;
  }
  .two-column-list {
    grid-template-columns: 1fr;
  }
}

/* --- Page-level section wrapper padding --- */
@media (max-width: 768px) {
  .page-shell .timeline-container {
    padding: 0 1rem;
  }
  .page-shell .timeline-section {
    padding-left: 0;
    padding-right: 0;
  }
  .timeline-section .section-header {
    padding: 0 1rem;
  }
  .timeline-container .phase-selector {
    padding: 0;
  }
  .timeline-container .hormone-visual-panel {
    padding: 0;
  }
}

/* --- Simulation section wrapper --- */
@media (max-width: 768px) {
  section[id="simulationSection"],
  .section-title-row + .simulation-grid {
    padding-left: 0;
    padding-right: 0;
  }
  .simulation-grid {
    margin: 0 1rem;
  }
}

/* --- Quick action footer bar inside topics --- */
@media (max-width: 480px) {
  .section-block > div[style*="max-width: 900px"] {
    margin-left: 0.75rem !important;
    margin-right: 0.75rem !important;
  }
}

/* --- Risk alert --- */
@media (max-width: 480px) {
  .risk-alert {
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
  }
  .alert-icon {
    font-size: 1.6rem;
  }
}

/* --- General card spacing on mobile --- */
@media (max-width: 768px) {
  .card {
    border-radius: 14px;
  }
}

/* --- Ensure no horizontal overflow --- */
@media (max-width: 768px) {
  body {
    overflow-x: hidden;
  }
  .page-shell {
    overflow-x: hidden;
  }
  svg {
    max-width: 100%;
  }
}

/* --- Page nav scrollable on mobile --- */
@media (max-width: 768px) {
  .page-nav-container {
    flex-wrap: nowrap;
    overflow-x: auto;
    justify-content: flex-start;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .page-nav-container::-webkit-scrollbar {
    display: none;
  }
  .page-nav-link {
    flex-shrink: 0;
  }
}

/* --- Section title row on mobile --- */
@media (max-width: 480px) {
  .section-title-row p {
    font-size: 0.9rem;
    padding: 0 0.5rem;
  }
  .section-badge {
    font-size: 0.7rem;
    padding: 0.3rem 0.75rem;
  }
}

/* --- Hormone visual panel on small --- */
@media (max-width: 900px) {
  .hormone-visual-panel {
    grid-template-columns: 1fr;
  }
}

/* --- Fix simulation section top padding --- */
#simulationSection,
div:has(> .simulation-grid) {
  padding: 0;
}

/* --- Hero title font size on very small --- */
@media (max-width: 380px) {
  .hero-title-3d {
    font-size: 2rem;
  }
  .hero-subtitle {
    font-size: 0.78rem;
  }
  .hero p {
    font-size: 0.88rem;
  }
}

</style>
<body>

<!-- ===== HEADER ===== -->
  <header class="site-header">
    <div class="nav-container">
      <!-- Logo -->
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="white">
            <circle cx="12" cy="5.5" r="2.8"/>
            <path d="M9.3 4.8 Q9.1 2.5 12 2.2 Q14.9 2.5 14.7 4.8" opacity="0.7"/>
            <path d="M9.5 13.2 Q9 10.5 10 9.3 Q11 8.6 12 8.6 Q13 8.6 14 9.3 Q15 10.5 14.5 13.2Z"/>
            <path d="M9.5 13.2 Q7.2 13.8 6.8 16.2 Q7.8 16.4 8.8 15Z" opacity="0.85"/>
            <path d="M14.5 13.2 Q16.8 13.8 17.2 16.2 Q16.2 16.4 15.2 15Z" opacity="0.85"/>
            <path d="M8.8 15 Q8.2 17.5 9.5 19.5 Q11 21 12 21 Q13 21 14.5 19.5 Q15.8 17.5 15.2 15Z"/>
          </svg>
        </div>
        <div class="logo-text">
          <a href="index.html">Nari Swasthya</a>
          <span>Women's Complete Health</span>
        </div>
      </div>

      <nav class="main-nav" aria-label="Main navigation">
        <div class="nav-item"><a href="index.html" class="nav-link">Home</a></div>

        <!-- Journeys dropdown -->
        <div class="nav-item">
          <button class="nav-link" aria-haspopup="true">Journeys <i class="fa-solid fa-chevron-down chevron"></i></button>
          <div class="nav-dropdown">
            <a href="journeys.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
              <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;"><i class="fa-solid fa-map"></i></div>
              <div><strong style="display:block;font-size:.82rem;color:#d81b60;">View Full Journeys</strong><span style="font-size:.73rem;color:#555;">Browse all her journeys</span></div>
            </a>
            <div class="dd-sep"></div>
            <a href="conceiving.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Conceiving</strong><span style="font-size:.73rem;color:#555;">Preparation &amp; planning</span></div></a>
            <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-dna"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:#555;">Cycle &amp; ovulation</span></div></a>
            <!-- Pregnancy Journey with flyout sub-items -->
            <div class="dd-item dd-has-flyout">
              <div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-baby-carriage"></i></div>
              <a href="pregnancy_journey.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Pregnancy Journey</strong><span style="font-size:.73rem;color:#555;">Week by week guide</span></a>
              <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
              <div class="dd-flyout">
                <a href="normal_delivery.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-circle-check"></i></div><div><strong style="display:block;font-size:.82rem;">Normal Delivery</strong><span style="font-size:.73rem;color:#555;">Vaginal birth guide</span></div></a>
                <a href="csection.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-hospital"></i></div><div><strong style="display:block;font-size:.82rem;">C-Section</strong><span style="font-size:.73rem;color:#555;">Surgical birth info</span></div></a>
                <a href="pregnancy_loss.html" class="dd-item"><div class="dd-icon" style="background:#fafafa;color:#9e9e9e;"><i class="fa-solid fa-hands-holding-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy Loss</strong><span style="font-size:.73rem;color:#555;">Support &amp; care</span></div></a>
              </div>
            </div>
            <a href="antenatal_care.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-clipboard-list"></i></div><div><strong style="display:block;font-size:.82rem;">Antenatal Care</strong><span style="font-size:.73rem;color:#555;">ANC visits &amp; checklist</span></div></a>
            <!-- NCD with flyout sub-items -->
            <div class="dd-item dd-has-flyout">
              <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
              <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:#555;">Diabetes, hypertension &amp; more</span></a>
              <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
              <div class="dd-flyout">
                <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:#555;">Manage blood sugar</span></div></a>
                <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:#555;">Blood pressure care</span></div></a>
                <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:#555;">Simulation journey</span></div></a>
              </div>
            </div>
            <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Newborn &amp; Postpartum</strong><span style="font-size:.73rem;color:#555;">4th trimester care</span></div></a>
            <a href="breastfeeding_journey.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57c00;"><i class="fa-solid fa-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Breastfeeding</strong><span style="font-size:.73rem;color:#555;">Latch, supply, nutrition</span></div></a>
            <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-fire-flame-curved"></i></div><div><strong style="display:block;font-size:.82rem;">Menopause</strong><span style="font-size:.73rem;color:#555;">Perimenopause &amp; beyond</span></div></a>
          </div>
        </div>

        <!-- Services dropdown (active) -->
        <div class="nav-item">
          <button class="nav-link active" aria-haspopup="true">Services <i class="fa-solid fa-chevron-down chevron"></i></button>
          <div class="nav-dropdown">
            <a href="services.html" class="dd-item" style="background:linear-gradient(135deg,rgba(236,64,122,0.08),rgba(173,20,87,0.04));border-radius:10px;margin-bottom:.3rem;">
              <div class="dd-icon" style="background:linear-gradient(135deg,#ec407a,#ad1457);color:white;"><i class="fa-solid fa-grid-2"></i></div>
              <div><strong style="display:block;font-size:.82rem;color:#d81b60;">Services Available</strong><span style="font-size:.73rem;color:#555;">Browse all our services</span></div>
            </a>
            <div class="dd-sep"></div>
            <a href="symptom_checker.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-stethoscope"></i></div><div><strong style="display:block;font-size:.82rem;">Symptom Checker</strong><span style="font-size:.73rem;color:#555;">AI-powered diagnosis</span></div></a>
            <a href="dashboard.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-gauge-high"></i></div><div><strong style="display:block;font-size:.82rem;">My Dashboard</strong><span style="font-size:.73rem;color:#555;">Track your health</span></div></a>
            <a href="screening.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-magnifying-glass-plus"></i></div><div><strong style="display:block;font-size:.82rem;">Health Screening</strong><span style="font-size:.73rem;color:#555;">Cancer &amp; preventive</span></div></a>
            <a href="vaccination.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-syringe"></i></div><div><strong style="display:block;font-size:.82rem;">Vaccination</strong><span style="font-size:.73rem;color:#555;">Immunization schedule</span></div></a>
            <a href="otc.html" class="dd-item"><div class="dd-icon" style="background:#e0f7fa;color:#006064;"><i class="fa-solid fa-pills"></i></div><div><strong style="display:block;font-size:.82rem;">OTC Medicine Guide</strong><span style="font-size:.73rem;color:#555;">Safe self-care options</span></div></a>
            <a href="government_schemes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#e65100;"><i class="fa-solid fa-landmark"></i></div><div><strong style="display:block;font-size:.82rem;">Govt Schemes</strong><span style="font-size:.73rem;color:#555;">Benefits you deserve</span></div></a>
            <a href="insurance.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#1b5e20;"><i class="fa-solid fa-shield-halved"></i></div><div><strong style="display:block;font-size:.82rem;">Insurance</strong><span style="font-size:.73rem;color:#555;">Coverage &amp; claims guide</span></div></a>
          </div>
        </div>

        <div class="nav-item"><a href="stories.html" class="nav-link">Stories</a></div>
        <div class="nav-item"><a href="about.html" class="nav-link">About Us</a></div>

        <!-- Additional Info dropdown -->
        <div class="nav-item">
          <button class="nav-link" aria-haspopup="true">Additional Info <i class="fa-solid fa-chevron-down chevron"></i></button>
          <div class="nav-dropdown" style="min-width:240px;">
            <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:#555;text-transform:uppercase;letter-spacing:.08em;">Health Topics</div>
            <a href="fertility.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ec407a;"><i class="fa-solid fa-seedling"></i></div><div><strong style="display:block;font-size:.82rem;">Fertility</strong><span style="font-size:.73rem;color:#555;">Cycle, conceiving &amp; IVF</span></div></a>
            <a href="pregnancy_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#7b1fa2;"><i class="fa-solid fa-baby-carriage"></i></div><div><strong style="display:block;font-size:.82rem;">Pregnancy</strong><span style="font-size:.73rem;color:#555;">All trimesters covered</span></div></a>
            <a href="newborn_postpartum_care.html" class="dd-item"><div class="dd-icon" style="background:#e3f2fd;color:#1565c0;"><i class="fa-solid fa-baby"></i></div><div><strong style="display:block;font-size:.82rem;">Motherhood</strong><span style="font-size:.73rem;color:#555;">Newborn &amp; postpartum</span></div></a>
            <a href="menopause.html" class="dd-item"><div class="dd-icon" style="background:#e8f5e9;color:#2e7d32;"><i class="fa-solid fa-spa"></i></div><div><strong style="display:block;font-size:.82rem;">Wellness</strong><span style="font-size:.73rem;color:#555;">Menopause, bone, mental</span></div></a>
            <div class="dd-sep"></div>
            <a href="community.html" class="dd-item"><div class="dd-icon" style="background:#ede7f6;color:#4527a0;"><i class="fa-solid fa-users"></i></div><div><strong style="display:block;font-size:.82rem;">Community</strong><span style="font-size:.73rem;color:#555;">Share &amp; connect</span></div></a>
            <div class="dd-sep"></div>
            <div style="padding:.4rem .9rem .2rem;font-size:.7rem;font-weight:700;color:#555;text-transform:uppercase;letter-spacing:.08em;">Specialised Care</div>
            <!-- NCD with flyout sub-items â€” first item -->
            <div class="dd-item dd-has-flyout">
              <div class="dd-icon" style="background:#e8eaf6;color:#283593;"><i class="fa-solid fa-heart-pulse"></i></div>
              <a href="ncd_pregnancy.html" style="text-decoration:none;color:inherit;flex:1;"><strong style="display:block;font-size:.82rem;">Non Communicable Diseases</strong><span style="font-size:.73rem;color:#555;">Diabetes, hypertension &amp; more</span></a>
              <i class="fa-solid fa-chevron-right dd-flyout-arrow"></i>
              <div class="dd-flyout">
                <a href="gestational_diabetes.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-droplet"></i></div><div><strong style="display:block;font-size:.82rem;">Gestational Diabetes</strong><span style="font-size:.73rem;color:#555;">Manage blood sugar</span></div></a>
                <a href="preeclampsia_education.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#c2185b;"><i class="fa-solid fa-heart-circle-exclamation"></i></div><div><strong style="display:block;font-size:.82rem;">Preeclampsia</strong><span style="font-size:.73rem;color:#555;">Blood pressure care</span></div></a>
                <a href="cancer_simulation_journey.html" class="dd-item"><div class="dd-icon" style="background:#f3e5f5;color:#6a1b9a;"><i class="fa-solid fa-ribbon"></i></div><div><strong style="display:block;font-size:.82rem;">Cancer</strong><span style="font-size:.73rem;color:#555;">Simulation journey</span></div></a>
              </div>
            </div>
            <a href="bone_health.html" class="dd-item"><div class="dd-icon" style="background:#fce4ec;color:#ad1457;"><i class="fa-solid fa-bone"></i></div><div><strong style="display:block;font-size:.82rem;">Bone Health</strong><span style="font-size:.73rem;color:#555;">Osteoporosis prevention</span></div></a>
            <a href="depression.html" class="dd-item"><div class="dd-icon" style="background:#fff8e1;color:#f57f17;"><i class="fa-solid fa-brain"></i></div><div><strong style="display:block;font-size:.82rem;">Mental Health</strong><span style="font-size:.73rem;color:#555;">Anxiety, depression, support</span></div></a>
            <a href="loss_support.html" class="dd-item"><div class="dd-icon" style="background:#fafafa;color:#9e9e9e;"><i class="fa-solid fa-hands-holding-heart"></i></div><div><strong style="display:block;font-size:.82rem;">Loss Support</strong><span style="font-size:.73rem;color:#555;">You are never alone</span></div></a>
          </div>
        </div>
      </nav>

      <!-- Right: Sign In + Contact Us -->
      <div class="nav-actions">
        <a class="btn-nav outline" href="login.html"><i class="fa-regular fa-user"></i> Sign In</a>
        <a class="btn-nav primary" href="contact.html"><i class="fa-solid fa-envelope"></i> Contact Us</a>
        <button class="hamburger" id="hamburgerBtn" aria-label="Menu" onclick="toggleMobile()">
          <span id="hb1"></span><span id="hb2"></span><span id="hb3"></span>
        </button>
      </div>
    </div>
  </header>


<!-- Mobile Menu -->
  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="mm-section">Navigation</div>
    <a href="index.html" class="mm-link"><i class="fa-solid fa-house" style="color:#d81b60;width:20px;"></i> Home</a>
    <div class="mm-section">Journeys</div>
    <a href="conceiving.html" class="mm-link"><i class="fa-solid fa-seedling" style="color:#d81b60;width:20px;"></i> Conceiving</a>
    <a href="fertility.html" class="mm-link"><i class="fa-solid fa-dna" style="color:#d81b60;width:20px;"></i> Fertility</a>
    <a href="pregnancy_journey.html" class="mm-link"><i class="fa-solid fa-baby-carriage" style="color:#d81b60;width:20px;"></i> Pregnancy Journey</a>
    <a href="normal_delivery.html" class="mm-link" style="padding-left:2.5rem;font-size:.88rem;"><i class="fa-solid fa-circle-check" style="color:#ec407a;width:20px;"></i> Normal Delivery</a>
    <a href="csection.html" class="mm-link" style="padding-left:2.5rem;font-size:.88rem;"><i class="fa-solid fa-circle-check" style="color:#ec407a;width:20px;"></i> C-Section</a>
    <a href="pregnancy_loss.html" class="mm-link" style="padding-left:2.5rem;font-size:.88rem;"><i class="fa-solid fa-circle-check" style="color:#9e9e9e;width:20px;"></i> Pregnancy Loss</a>
    <a href="antenatal_care.html" class="mm-link"><i class="fa-solid fa-clipboard-list" style="color:#d81b60;width:20px;"></i> Antenatal Care</a>
    <a href="newborn_postpartum_care.html" class="mm-link"><i class="fa-solid fa-baby" style="color:#d81b60;width:20px;"></i> Newborn &amp; Postpartum</a>
    <a href="breastfeeding_journey.html" class="mm-link"><i class="fa-solid fa-heart" style="color:#d81b60;width:20px;"></i> Breastfeeding</a>
    <a href="menopause.html" class="mm-link"><i class="fa-solid fa-fire-flame-curved" style="color:#d81b60;width:20px;"></i> Menopause</a>
    <div class="mm-section">Services</div>
    <a href="symptom_checker.html" class="mm-link"><i class="fa-solid fa-stethoscope" style="color:#d81b60;width:20px;"></i> Symptom Checker</a>
    <a href="dashboard.html" class="mm-link"><i class="fa-solid fa-gauge-high" style="color:#d81b60;width:20px;"></i> My Dashboard</a>
    <a href="screening.html" class="mm-link"><i class="fa-solid fa-magnifying-glass-plus" style="color:#d81b60;width:20px;"></i> Health Screening</a>
    <a href="government_schemes.html" class="mm-link"><i class="fa-solid fa-landmark" style="color:#d81b60;width:20px;"></i> Govt Schemes</a>
    <a href="insurance.html" class="mm-link"><i class="fa-solid fa-shield-halved" style="color:#1b5e20;width:20px;"></i> Insurance</a>
    <div class="mm-section">Specialised Care</div>
    <a href="bone_health.html" class="mm-link"><i class="fa-solid fa-bone" style="color:#ad1457;width:20px;"></i> Bone Health</a>
    <a href="depression.html" class="mm-link"><i class="fa-solid fa-brain" style="color:#f57f17;width:20px;"></i> Mental Health</a>
    <a href="loss_support.html" class="mm-link"><i class="fa-solid fa-hands-holding-heart" style="color:#9e9e9e;width:20px;"></i> Loss Support</a>
    <a href="ncd_pregnancy.html" class="mm-link"><i class="fa-solid fa-heart-pulse" style="color:#283593;width:20px;"></i> Non Communicable Diseases</a>
    <a href="gestational_diabetes.html" class="mm-link" style="padding-left:2.5rem;font-size:.88rem;"><i class="fa-solid fa-circle-check" style="color:#283593;width:20px;"></i> Gestational Diabetes</a>
    <a href="preeclampsia_education.html" class="mm-link" style="padding-left:2.5rem;font-size:.88rem;"><i class="fa-solid fa-circle-check" style="color:#283593;width:20px;"></i> Preeclampsia</a>
    <div class="mm-section">More</div>
    <a href="stories.html" class="mm-link"><i class="fa-solid fa-book-open" style="color:#d81b60;width:20px;"></i> Stories</a>
    <a href="community.html" class="mm-link"><i class="fa-solid fa-users" style="color:#d81b60;width:20px;"></i> Community</a>
    <a href="about.html" class="mm-link"><i class="fa-solid fa-circle-info" style="color:#d81b60;width:20px;"></i> About Us</a>
    <div style="display:flex;gap:.75rem;margin-top:1rem;padding:.5rem;">
      <a href="login.html" class="btn-nav outline mm-action-btn" style="flex:1;justify-content:center;"><i class="fa-regular fa-user"></i> Sign In</a>
      <a href="contact.html" class="btn-nav primary mm-action-btn" style="flex:1;justify-content:center;"><i class="fa-solid fa-envelope"></i> Contact Us</a>
    </div>
  </div>



<div class="page-shell">
  
  <!-- HERO SECTION -->
  <section class="hero" id="heroSection">
    <canvas id="heroBoneCanvas"></canvas>
    <div class="hero-left">
      <div class="hero-subtitle"><i class="fa-solid fa-bone"></i> Women's Skeletal Health</div>
      <h1 class="hero-title-3d">
        Your Bones,<br/>
        <span class="title-emphasis">Your Strength,</span><br/>
        Your Story
      </h1>
      <p>From puberty through menopause and beyondâ€”discover how hormones shape your skeletal health. Every decade tells a chapter. Learn to read yours.</p>

      <div class="hero-badges">
        <span class="hero-badge"><i class="fas fa-female"></i> 1 in 3 Women Affected</span>
        <span class="hero-badge"><i class="fas fa-chart-line"></i> 20% Bone Loss at Menopause</span>
        <span class="hero-badge"><i class="fas fa-heartbeat"></i> Preventable</span>
      </div>

      <div class="hero-cta-row">
        <button class="btn-primary" onclick="scrollToSectionSafe('timelineSection')">
          <i class="fas fa-play-circle"></i> Start Journey
        </button>
        <button class="btn-secondary" onclick="scrollToSectionSafe('topicsSection')">
          <i class="fas fa-book"></i> Explore Topics
        </button>
        <button class="btn-primary" onclick="scrollToSectionSafe('simulationSection')">
          <i class="fas fa-cube"></i> 3D Visualizations
        </button>
      </div>
    </div>

    <div class="hero-visual">
      <div class="bone-canvas-wrap">
        <canvas id="boneOrbitCanvas"></canvas>
      </div>
    </div>
  </section>

  <!-- HORMONE JOURNEY TIMELINE -->
  <section class="timeline-section" id="timelineSection">
    <div class="section-header">
      <span class="section-badge">
        <i class="fas fa-clock"></i> Your Life's Hormonal Map
      </span>
      <h2 class="section-title">Hormone Journey <span class="section-em">Through Life</span></h2>
      <p class="section-subtitle">
        Watch how estrogen, bone density, and joint health evolve from teens to post-menopauseâ€”
        with live data, interactive controls, and critical intervention windows highlighted.
      </p>
    </div>

    <div class="timeline-container">
      <!-- Phase Selector -->
      <div class="phase-selector">
        <button class="phase-btn active" data-phase="teens" onclick="switchPhase('teens')">
          <div class="phase-age">12-19</div>
          <div class="phase-name">Building Foundation</div>
          <div class="phase-icon"><i class="fas fa-seedling"></i></div>
        </button>
        <button class="phase-btn" data-phase="twenties" onclick="switchPhase('twenties')">
          <div class="phase-age">20-39</div>
          <div class="phase-name">Peak Strength</div>
          <div class="phase-icon"><i class="fas fa-mountain"></i></div>
        </button>
        <button class="phase-btn" data-phase="forties" onclick="switchPhase('forties')">
          <div class="phase-age">40-50</div>
          <div class="phase-name">Transition Begins</div>
          <div class="phase-icon"><i class="fas fa-exchange-alt"></i></div>
        </button>
        <button class="phase-btn critical" data-phase="menopause" onclick="switchPhase('menopause')">
          <div class="phase-age">50-60</div>
          <div class="phase-name">Critical Window</div>
          <div class="phase-icon"><i class="fas fa-exclamation-triangle"></i></div>
        </button>
        <button class="phase-btn" data-phase="postmeno" onclick="switchPhase('postmeno')">
          <div class="phase-age">60+</div>
          <div class="phase-name">Maintenance Era</div>
          <div class="phase-icon"><i class="fas fa-shield-alt"></i></div>
        </button>
      </div>

      <!-- Enhanced Visualization Panel -->
      <div class="hormone-visual-panel">
        <!-- Left: Animated Chart -->
        <div class="chart-area">
          <div class="chart-title-bar">
            <h3>Estrogen & Bone Density Curves</h3>
            <div class="chart-controls">
              <button class="chart-btn active" onclick="toggleChart('estrogen')">
                <i class="fas fa-heartbeat"></i> Estrogen
              </button>
              <button class="chart-btn active" onclick="toggleChart('bone')">
                <i class="fas fa-bone"></i> Bone
              </button>
            </div>
          </div>

          <svg viewBox="0 0 900 350" class="hormone-chart" id="mainChart">
            <defs>
              <linearGradient id="estrogenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#4caf50" stop-opacity="0.8"/>
                <stop offset="100%" stop-color="#4caf50" stop-opacity="0.1"/>
              </linearGradient>
              <linearGradient id="boneGradChart" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="#ff9800" stop-opacity="0.8"/>
                <stop offset="100%" stop-color="#ff9800" stop-opacity="0.1"/>
              </linearGradient>
            </defs>

            <!-- Grid -->
            <g class="grid" opacity="0.2">
              <line x1="50" y1="50" x2="850" y2="50" stroke="#ccc" stroke-width="1"/>
              <line x1="50" y1="100" x2="850" y2="100" stroke="#ccc" stroke-width="1"/>
              <line x1="50" y1="150" x2="850" y2="150" stroke="#ccc" stroke-width="1"/>
              <line x1="50" y1="200" x2="850" y2="200" stroke="#ccc" stroke-width="1"/>
              <line x1="50" y1="250" x2="850" y2="250" stroke="#ccc" stroke-width="1"/>
              <line x1="50" y1="300" x2="850" y2="300" stroke="#ccc" stroke-width="1"/>
            </g>

            <!-- Y-axis labels -->
            <text x="35" y="55" text-anchor="end" fill="#666" font-size="12">100%</text>
            <text x="35" y="155" text-anchor="end" fill="#666" font-size="12">50%</text>
            <text x="35" y="305" text-anchor="end" fill="#666" font-size="12">0%</text>

            <!-- Estrogen line -->
            <path id="estrogenLine" d="M 150,180 L 360,80 L 540,120 L 720,260 L 850,280" 
                  fill="none" stroke="#4caf50" stroke-width="4" stroke-linecap="round"/>
            <path d="M 150,180 L 360,80 L 540,120 L 720,260 L 850,280 L 850,300 L 150,300 Z" 
                  fill="url(#estrogenGrad)" opacity="0.3"/>

            <!-- Bone density line -->
            <path id="boneLine" d="M 150,200 L 360,50 L 540,80 L 720,180 L 850,220" 
                  fill="none" stroke="#ff9800" stroke-width="4" stroke-linecap="round"/>
            <path d="M 150,200 L 360,50 L 540,80 L 720,180 L 850,220 L 850,300 L 150,300 Z" 
                  fill="url(#boneGradChart)" opacity="0.3"/>

            <!-- Age Labels -->
            <text x="150" y="330" text-anchor="middle" fill="#666" font-size="14" font-weight="600">TEENS</text>
            <text x="360" y="330" text-anchor="middle" fill="#666" font-size="14" font-weight="600">20-39</text>
            <text x="540" y="330" text-anchor="middle" fill="#666" font-size="14" font-weight="600">40-50</text>
            <text x="720" y="330" text-anchor="middle" fill="#666" font-size="14" font-weight="600">50-60</text>

            <!-- Critical Zone Highlight -->
            <rect x="630" y="40" width="200" height="270" fill="#ffebee" opacity="0.3" rx="8"/>
            <text x="730" y="25" text-anchor="middle" fill="#f44336" font-size="12" font-weight="700">
              DANGER ZONE
            </text>
          </svg>

          <div class="chart-legend">
            <div class="legend-item">
              <div class="legend-line estrogen"></div>
              <span>Estrogen Level</span>
            </div>
            <div class="legend-item">
              <div class="legend-line bone"></div>
              <span>Bone Mineral Density</span>
            </div>
          </div>
        </div>

        <!-- Right: Live Metrics Panel -->
        <div class="metrics-panel" id="metricsPanel">
          <div class="phase-header">
            <div class="phase-icon-large">
              <i class="fas fa-seedling" id="phaseIconLarge"></i>
            </div>
            <div class="phase-title-block">
              <h3 id="phaseTitle">Building Foundation</h3>
              <p id="phaseAge">Ages 12-19</p>
            </div>
          </div>

          <!-- Live Gauges -->
          <div class="gauges-grid">
            <div class="gauge-card">
              <div class="gauge-header">
                <i class="fas fa-heartbeat"></i>
                <span>Estrogen</span>
              </div>
              <div class="gauge-visual">
                <svg viewBox="0 0 120 120" class="circular-gauge">
                  <circle cx="60" cy="60" r="50" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                  <circle id="estrogenGauge" cx="60" cy="60" r="50" fill="none" stroke="#4caf50" 
                          stroke-width="10" stroke-dasharray="314" stroke-dashoffset="188"
                          transform="rotate(-90 60 60)" stroke-linecap="round"/>
                  <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="700" fill="#4caf50" id="estrogenPercent">40%</text>
                </svg>
              </div>
              <div class="gauge-label" id="estrogenStatus">Rising</div>
            </div>

            <div class="gauge-card">
              <div class="gauge-header">
                <i class="fas fa-bone"></i>
                <span>Bone Density</span>
              </div>
              <div class="gauge-visual">
                <svg viewBox="0 0 120 120" class="circular-gauge">
                  <circle cx="60" cy="60" r="50" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                  <circle id="boneGauge" cx="60" cy="60" r="50" fill="none" stroke="#ff9800" 
                          stroke-width="10" stroke-dasharray="314" stroke-dashoffset="172"
                          transform="rotate(-90 60 60)" stroke-linecap="round"/>
                  <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="700" fill="#ff9800" id="bonePercent">45%</text>
                </svg>
              </div>
              <div class="gauge-label" id="boneStatus">Building</div>
            </div>

            <div class="gauge-card">
              <div class="gauge-header">
                <i class="fas fa-joint"></i>
                <span>Joint Health</span>
              </div>
              <div class="gauge-visual">
                <svg viewBox="0 0 120 120" class="circular-gauge">
                  <circle cx="60" cy="60" r="50" fill="none" stroke="#e0e0e0" stroke-width="10"/>
                  <circle id="jointGauge" cx="60" cy="60" r="50" fill="none" stroke="#9c27b0" 
                          stroke-width="10" stroke-dasharray="314" stroke-dashoffset="31"
                          transform="rotate(-90 60 60)" stroke-linecap="round"/>
                  <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="700" fill="#9c27b0" id="jointPercent">90%</text>
                </svg>
              </div>
              <div class="gauge-label" id="jointStatus">Excellent</div>
            </div>
          </div>

          <!-- Key Insights -->
          <div class="insights-box">
            <h4><i class="fas fa-lightbulb"></i> What's Happening Now</h4>
            <ul id="insightsList">
              <li>Estrogen levels rising to adult levels</li>
              <li>90% of peak bone mass achieved by age 18</li>
              <li>Critical window for calcium (1,300mg/day)</li>
              <li>Weight-bearing exercise builds lifelong strength</li>
            </ul>
          </div>

          <!-- Risk Alert -->
          <div class="risk-alert low" id="riskAlert">
            <div class="alert-icon"><i class="fas fa-shield-alt"></i></div>
            <div class="alert-content">
              <div class="alert-title">Low Risk Period</div>
              <div class="alert-message">Optimal time to invest in bone health</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 10 ESSENTIAL TOPICS -->
  <section class="section-block" id="topicsSection">
    <div class="section-title-row">
      <span class="section-badge">
        <i class="fas fa-map-marked-alt"></i> Your Complete Bone Health Roadmap
      </span>
      <h2>Everything You <span class="em">Need to Know</span></h2>
      <span class="section-tagline" style="display: block; margin-top: 0.5rem; font-size: 1.05rem; color: #666; font-weight: 500;">
        10 Essential Topics â€¢ Explained Simply â€¢ Actionable Steps
      </span>
      <p style="max-width: 700px; margin: 1.2rem auto 0; color: #555; font-size: 1rem; line-height: 1.7;">
        Navigate your bone health journey with confidence. Each topic breaks down complex medical information into simple, 
        easy-to-understand insightsâ€”no medical degree required! Click any card to dive deeper.
      </p>
    </div>

    <!-- Progress Tracker -->
    <div style="max-width: 900px; margin: 2rem auto; padding: 1.5rem; background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%); border-radius: 16px; box-shadow: 0 4px 12px rgba(236,64,122,0.1); box-sizing: border-box; width: calc(100% - 2rem);">
      <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
        <div style="flex: 1; min-width: 200px;">
          <div style="font-size: 0.85rem; color: #880e4f; font-weight: 600; margin-bottom: 0.5rem;">
            <i class="fas fa-check-circle"></i> YOUR LEARNING PROGRESS
          </div>
          <div style="background: white; height: 12px; border-radius: 20px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);">
            <div id="progressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4caf50 0%, #66bb6a 100%); transition: width 0.6s ease; border-radius: 20px;"></div>
          </div>
          <div style="font-size: 0.75rem; color: #666; margin-top: 0.5rem;">
            <span id="progressText">0 of 10 topics explored</span>
          </div>
        </div>
        <div style="text-align: center; padding: 0.75rem 1.5rem; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
          <div style="font-size: 2rem; font-weight: 700; color: #ec407a;" id="progressPercent">0%</div>
          <div style="font-size: 0.7rem; color: #666; text-transform: uppercase; letter-spacing: 0.5px;">Complete</div>
        </div>
      </div>
    </div>

    <!-- Interactive Topic Cards Grid -->
    <div class="topics-grid" id="topicsGrid">
      <!-- Topics will be generated by JavaScript -->
    </div>

    <!-- Quick Action Footer -->
    <div style="max-width: 900px; margin: 3rem auto 0; padding: 2rem; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-radius: 16px; border-left: 5px solid #ff9800; box-shadow: 0 4px 12px rgba(255,152,0,0.15); box-sizing: border-box; width: calc(100% - 2rem);">
      <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
        <div style="flex: 0 0 60px;">
          <i class="fas fa-lightbulb" style="font-size: 3rem; color: #f57c00;"></i>
        </div>
        <div style="flex: 1; min-width: 250px;">
          <h4 style="margin: 0 0 0.5rem 0; color: #e65100; font-size: 1.1rem;">
            <i class="fas fa-star"></i> Pro Tip: Start Here!
          </h4>
          <p style="margin: 0; color: #555; font-size: 0.95rem; line-height: 1.6;">
            New to bone health? Begin with <strong>"Understanding the Diseases"</strong> then explore <strong>"The Estrogen Connection"</strong> 
            to understand why women are uniquely affected. Then check your <strong>"Risk Factors"</strong> to personalize your journey.
          </p>
        </div>
        <button onclick="scrollToTopic(1)" style="padding: 0.75rem 1.5rem; background: #ff9800; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; white-space: nowrap; box-shadow: 0 2px 8px rgba(255,152,0,0.3); transition: all 0.3s; flex-shrink: 0;">
          <i class="fas fa-rocket"></i> Start Learning
        </button>
      </div>
    </div>
  </section>

  <!-- 3D SIMULATION -->
<section id="simulationSection" style="padding: 4rem 0 3rem;">
<div class="section-title-row" style="padding: 0 1.5rem 2rem;">
      <span class="section-badge"><i class="fas fa-cube"></i> 3D Interactive Explorer</span>
      <h2>Interactive Bone <span class="em">&amp; Joint Explorer</span></h2>
      <span class="section-tagline" style="display: block; margin-top: 0.5rem; font-size: 1.05rem; color: #666; font-weight: 500;">Ultra-Realistic 3D Visualizations</span>
      <p style="max-width: 600px; margin: 1rem auto 0; color: #666; font-size: 0.95rem; line-height: 1.75;">
        Click on body parts to see detailed 3D models showing bone density, cartilage health, and treatment effects
      </p>
    </div>

    <div class="simulation-grid" style="max-width: 1400px; margin: 0 auto; padding: 0 1.5rem;">
      <div class="sim-controls card">
        <h4>Select Stage</h4>
        <div class="stage-btns">
          <button class="stage-btn active" onclick="setStage('healthy')">
            <i class="fas fa-check-circle"></i> Healthy
          </button>
          <button class="stage-btn" onclick="setStage('early')">
            <i class="fas fa-exclamation-circle"></i> Early Degeneration
          </button>
          <button class="stage-btn" onclick="setStage('advanced')">
            <i class="fas fa-times-circle"></i> Advanced Disease
          </button>
          <button class="stage-btn treatment-btn" onclick="setStage('treatment')">
            <i class="fas fa-pills"></i> With Treatment
          </button>
        </div>
        
        <div class="treatment-info-box" style="margin-top: 1rem; padding: 0.8rem; background: #e8f5e9; border-radius: 8px; display: none;" id="treatmentInfoBox">
          <h5 style="color: #2e7d32; margin-bottom: 0.5rem; font-size: 0.9rem;">
            <i class="fas fa-info-circle"></i> Treatment Benefits
          </h5>
          <p style="font-size: 0.8rem; color: #555; margin: 0; line-height: 1.5;">
            See how medications can strengthen bones, reduce fracture risk by 50-70%, and slow disease progression.
          </p>
        </div>
        
        <h4 style="margin-top:1.5rem">Body Parts</h4>
        <div id="bodySelector"></div>
      </div>

      <div class="sim-display card" id="simDisplay">
        <!-- Interactive Body Diagram -->
        <div class="body-diagram-container" id="bodyDiagramContainer">
          <div class="body-diagram">
            <svg viewBox="0 0 300 600" class="skeleton-svg">
              <!-- Skull -->
              <ellipse cx="150" cy="50" rx="35" ry="45" fill="#f5f5f5" stroke="#d81b60" stroke-width="2"/>
              
              <!-- Spine -->
              <rect x="145" y="90" width="10" height="200" fill="#e0e0e0" stroke="#d81b60" stroke-width="2" rx="5"/>
              
              <!-- Ribs -->
              <ellipse cx="150" cy="120" rx="50" ry="30" fill="none" stroke="#d81b60" stroke-width="2"/>
              <ellipse cx="150" cy="150" rx="55" ry="35" fill="none" stroke="#d81b60" stroke-width="2"/>
              <ellipse cx="150" cy="180" rx="50" ry="30" fill="none" stroke="#d81b60" stroke-width="2"/>
              
              <!-- Pelvis/Hips -->
              <ellipse cx="150" cy="280" rx="60" ry="40" fill="#f5f5f5" stroke="#d81b60" stroke-width="3" 
                       class="clickable-bone" data-part="hip"/>
              
              <!-- Left Arm -->
              <line x1="120" y1="110" x2="80" y2="180" stroke="#d81b60" stroke-width="3"/>
              <line x1="80" y1="180" x2="60" y2="250" stroke="#d81b60" stroke-width="3"/>
              <circle cx="60" cy="260" r="8" fill="#f5f5f5" stroke="#d81b60" stroke-width="2" 
                      class="clickable-bone" data-part="wrist"/>
              
              <!-- Right Arm -->
              <line x1="180" y1="110" x2="220" y2="180" stroke="#d81b60" stroke-width="3"/>
              <line x1="220" y1="180" x2="240" y2="250" stroke="#d81b60" stroke-width="3"/>
              <circle cx="240" cy="260" r="8" fill="#f5f5f5" stroke="#d81b60" stroke-width="2" 
                      class="clickable-bone" data-part="wrist"/>
              
              <!-- Left Leg -->
              <line x1="130" y1="310" x2="120" y2="420" stroke="#d81b60" stroke-width="4"/>
              <circle cx="120" cy="435" r="12" fill="#f5f5f5" stroke="#d81b60" stroke-width="3" 
                      class="clickable-bone" data-part="knee"/>
              <line x1="120" y1="445" x2="110" y2="550" stroke="#d81b60" stroke-width="3"/>
              
              <!-- Right Leg -->
              <line x1="170" y1="310" x2="180" y2="420" stroke="#d81b60" stroke-width="4"/>
              <circle cx="180" cy="435" r="12" fill="#f5f5f5" stroke="#d81b60" stroke-width="3" 
                      class="clickable-bone" data-part="knee"/>
              <line x1="180" y1="445" x2="190" y2="550" stroke="#d81b60" stroke-width="3"/>

              <!-- Clickable Hotspots with pulsing animation -->
              <circle cx="150" cy="150" r="20" fill="rgba(236,64,122,0.3)" 
                      class="body-hotspot hotspot-spine" data-part="spine">
                <animate attributeName="r" values="20;25;20" dur="2s" repeatCount="indefinite"/>
              </circle>
              <circle cx="150" cy="280" r="25" fill="rgba(236,64,122,0.3)" 
                      class="body-hotspot hotspot-hip" data-part="hip">
                <animate attributeName="r" values="25;30;25" dur="2s" repeatCount="indefinite"/>
              </circle>
              <circle cx="150" cy="435" r="18" fill="rgba(236,64,122,0.3)" 
                      class="body-hotspot hotspot-knee" data-part="knee">
                <animate attributeName="r" values="18;23;18" dur="2s" repeatCount="indefinite"/>
              </circle>
              <circle cx="60" cy="260" r="12" fill="rgba(236,64,122,0.3)" 
                      class="body-hotspot hotspot-wrist" data-part="wrist">
                <animate attributeName="r" values="12;16;12" dur="2s" repeatCount="indefinite"/>
              </circle>
            </svg>

            <div class="body-labels">
              <div class="label label-spine" style="top: 150px; left: 180px;">Spine</div>
              <div class="label label-hip" style="top: 280px; left: 180px;">Hip</div>
              <div class="label label-knee" style="top: 435px; left: 200px;">Knee</div>
              <div class="label label-wrist" style="top: 260px; left: 20px;">Wrist</div>
            </div>
          </div>
          
          <div class="body-diagram-hint">
            <i class="fas fa-hand-pointer"></i>
            <p>Click on highlighted body parts or use the buttons on the left</p>
          </div>
        </div>

        <!-- Visualization Container (shown when part selected) -->
        <div class="viz-container" id="vizContainerMain" style="display: none;">
          <!-- Content will be populated by JavaScript -->
        </div>
      </div>
      
    </div>
  </section>

  <!-- FOOTER -->
  <style>
    :root {
      --bg-footer:    #1e1a1e;
      --bg-bottom:    #161316;
      --pink-primary: #e8517a;
      --pink-soft:    #f0748e;
      --text-main-f:  #c9bfc9;
      --text-muted-f: #7c7080;
      --divider-f:    rgba(232,81,122,0.18);
      --font-display-f:'Playfair Display', Georgia, serif;
      --font-body-f:  'Manrope', sans-serif;
    }
    footer.ns-footer {
      background: var(--bg-footer);
      color: var(--text-main-f);
      font-family: var(--font-body-f);
      border-top: 1px solid var(--divider-f);
    }
    .footer-main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 56px 32px 48px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 40px;
    }
    .footer-col h3 {
      font-family: var(--font-display-f);
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--pink-primary);
      margin-bottom: 18px;
      letter-spacing: 0.01em;
    }
    .footer-col p {
      font-size: 0.875rem;
      line-height: 1.75;
      color: var(--text-main-f);
      font-weight: 300;
    }
    .footer-col ul { list-style: none; }
    .footer-col ul li {
      font-size: 0.875rem;
      color: var(--text-main-f);
      padding: 5px 0;
      font-weight: 300;
      position: relative;
      padding-left: 14px;
      transition: color 0.2s;
    }
    .footer-col ul li::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 5px;
      height: 5px;
      border-radius: 50%;
      background: var(--pink-primary);
      opacity: 0.5;
    }
    .footer-col ul li:hover { color: var(--pink-soft); }
    .disclaimer-text { font-size: 0.875rem; line-height: 1.75; color: var(--text-main-f); font-weight: 300; }
    .emergency-alert { font-size: 0.875rem; line-height: 1.7; color: var(--pink-primary); font-weight: 500; }
    .emergency-alert strong { font-weight: 600; }
    .footer-meta {
      border-top: 1px solid var(--divider-f);
      max-width: 1200px;
      margin: 0 auto;
      padding: 28px 32px;
      text-align: center;
    }
    .footer-meta .meta-line { font-size: 0.8rem; color: var(--text-muted-f); letter-spacing: 0.04em; margin-bottom: 10px; }
    .footer-meta .meta-line .sep { color: var(--pink-primary); margin: 0 6px; }
    .footer-meta .tagline { font-size: 0.82rem; color: var(--text-muted-f); display: flex; align-items: center; justify-content: center; gap: 6px; }
    .footer-meta .tagline .heart { color: var(--pink-primary); font-size: 1rem; animation: footerPulse 2s ease-in-out infinite; }
    @keyframes footerPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.25); opacity: 0.8; } }
    .footer-bottom { background: var(--bg-bottom); border-top: 1px solid rgba(255,255,255,0.04); }
    .footer-bottom-inner { max-width: 1200px; margin: 0 auto; padding: 22px 32px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .footer-links { display: flex; gap: 36px; flex-wrap: wrap; justify-content: center; }
    .footer-links a { font-size: 0.82rem; color: var(--text-muted-f); text-decoration: none; letter-spacing: 0.03em; transition: color 0.2s; }
    .footer-links a:hover { color: var(--pink-soft); }
    .footer-copy { font-size: 0.78rem; color: var(--text-muted-f); opacity: 0.7; letter-spacing: 0.02em; }
    @media (max-width: 900px) { .footer-main { grid-template-columns: repeat(2,1fr); gap: 32px; } }
    @media (max-width: 540px) { .footer-main { grid-template-columns: 1fr; padding: 40px 20px 32px; } .footer-meta { padding: 20px; } .footer-bottom-inner { padding: 18px 20px; } .footer-links { gap: 20px; } }
  </style>

  <footer class="ns-footer" aria-label="Site footer">
    <div class="footer-main">
      <div class="footer-col">
        <h3>About This Guide</h3>
        <p>Comprehensive, evidence-based information synthesized from WHO, ACOG, ICMR guidelines, peer-reviewed research, and NFHS-5 data (724,115+ women).</p>
      </div>
      <div class="footer-col">
        <h3>Evidence Sources</h3>
        <ul>
          <li>World Health Organization</li>
          <li>ACOG Guidelines</li>
          <li>ICMR India</li>
          <li>NFHS-5 Survey</li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Important Disclaimer</h3>
        <p class="disclaimer-text">This provides general information only. Each pregnancy is unique. Medical decisions should be made with qualified healthcare providers who can assess your individual circumstances.</p>
      </div>
      <div class="footer-col">
        <h3>Emergency</h3>
        <p class="emergency-alert">Heavy bleeding, fever, chest pain, or severe abdominal pain require immediate medical attention. <strong>Don't delay.</strong></p>
      </div>
    </div>
    <div class="footer-meta">
      <p class="meta-line">Last Updated: February 2026 <span class="sep">|</span> Evidence-Based <span class="sep">â€¢</span> Comprehensive <span class="sep">â€¢</span> Empowering</p>
      <p class="tagline"><span class="heart">ðŸ©·</span> Dedicated to empowering every mother</p>
    </div>
    <div class="footer-bottom">
      <div class="footer-bottom-inner">
        <nav class="footer-links" aria-label="Legal and support links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
          <a href="#">Contact Support</a>
        </nav>
        <p class="footer-copy">&copy; 2026 Nari Swasthya. Empowering Women's Health.</p>
      </div>
    </div>
  </footer>

    <script>
/* Mobile menu toggle */
function toggleMobile(){
  const menu=document.getElementById('mobileMenu');
  const b1=document.getElementById('hb1'),b2=document.getElementById('hb2'),b3=document.getElementById('hb3');
  const open=menu.classList.toggle('open');
  if(open){
    b1.style.cssText='transform:rotate(45deg) translate(4px,4px);';
    b2.style.cssText='opacity:0;';
    b3.style.cssText='transform:rotate(-45deg) translate(4px,-4px);';
  } else {
    b1.style.cssText=''; b2.style.cssText=''; b3.style.cssText='';
  }
}
document.addEventListener('click',function(e){
  const menu=document.getElementById('mobileMenu');
  const btn=document.getElementById('hamburgerBtn');
  if(menu&&menu.classList.contains('open')&&!menu.contains(e.target)&&!btn.contains(e.target)){
    menu.classList.remove('open');
    document.getElementById('hb1').style.cssText='';
    document.getElementById('hb2').style.cssText='';
    document.getElementById('hb3').style.cssText='';
  }
});
  </script>

</div>

<script src="bone-health-women.js"></script>
  <script>
    (function initHeaderSparkle() {
      const header = document.querySelector('.site-header');
      if (!header) return;
      header.addEventListener('mousemove', (e) => {
        const rect = header.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        header.style.setProperty('--mouse-x', `${x}%`);
        header.style.setProperty('--mouse-y', `${y}%`);
      });
    })();
  </script>
</body>
<script>
  
  // BONE & JOINT HEALTH - COMPLETE JAVASCRIPT WITH FIXES

// ==========================================
// UTILITY FUNCTIONS
// ==========================================

function scrollToSection(sectionId) {
  const element = document.getElementById(sectionId);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

// Prevent title overlap by adjusting scroll position
function scrollToSectionSafe(sectionId) {
  const element = document.getElementById(sectionId);
  if (element) {
    const headerOffset = 120;
    const elementPosition = element.getBoundingClientRect().top;
    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
    
    window.scrollTo({
      top: offsetPosition,
      behavior: 'smooth'
    });
  }
}

// ==========================================
// PHASE DATA
// ==========================================
const phaseData = {
  teens: {
    name: "Building Foundation",
    age: "Ages 12-19",
    icon: "seedling",
    estrogen: { percent: 40, label: "Rising" },
    bone: { percent: 45, label: "Building" },
    joint: { percent: 90, label: "Excellent" },
    risk: "low",
    insights: [
      "Estrogen levels rising to adult levels",
      "Peak bone mass building (90% achieved by age 18)",
      "Critical time for calcium (1,300 mg/day) and exercise",
      "Weight-bearing activities strengthen bones for life",
      "Every calcium-rich meal deposits into bone bank"
    ]
  },
  twenties: {
    name: "Peak Strength",
    age: "Ages 20-39",
    icon: "mountain",
    estrogen: { percent: 95, label: "Peak Levels" },
    bone: { percent: 100, label: "Maximum Density" },
    joint: { percent: 95, label: "Optimal" },
    risk: "low",
    insights: [
      "Peak bone mass achieved around age 30",
      "Estrogen at highestâ€”protects bones and cartilage",
      "Bone remodeling balanced (formation = breakdown)",
      "Joints cushioned with thick articular cartilage",
      "Pregnancy/breastfeeding temporarily affect density"
    ]
  },
  forties: {
    name: "Transition Begins",
    age: "Ages 40-50",
    icon: "exchange-alt",
    estrogen: { percent: 70, label: "Declining" },
    bone: { percent: 85, label: "Early Loss" },
    joint: { percent: 75, label: "Good" },
    risk: "moderate",
    insights: [
      "Estrogen begins fluctuating and declining",
      "Bone breakdown starts exceeding formation",
      "Early cartilage wear in weight-bearing joints",
      "May notice morning stiffness in joints",
      "URGENT: Intensify preventive measures NOW",
      "Consider baseline bone density screening"
    ]
  },
  menopause: {
    name: "Critical Window",
    age: "Ages 50-60",
    icon: "exclamation-triangle",
    estrogen: { percent: 25, label: "Dramatic Drop" },
    bone: { percent: 65, label: "Rapid Loss" },
    joint: { percent: 55, label: "Declining" },
    risk: "high",
    insights: [
      "âš ï¸ DANGER ZONE: Estrogen drops 90% in first years",
      "Rapid bone loss: 2-5% per year (first 5-7 years)",
      "20% of bone density can be lost in this period",
      "Cartilage breakdown accelerates without estrogen",
      "Joint pain and stiffness become common",
      "Fracture risk rising significantly",
      "START TREATMENT IMMEDIATELY if osteopenia detected"
    ]
  },
  postmeno: {
    name: "Maintenance Era",
    age: "Ages 60+",
    icon: "shield-alt",
    estrogen: { percent: 15, label: "Minimal" },
    bone: { percent: 50, label: "Continued Loss" },
    joint: { percent: 40, label: "Compromised" },
    risk: "high",
    insights: [
      "Bone loss continues at slower rate (1% per year)",
      "Cumulative effect: bones very porous and brittle",
      "High fracture risk from minor falls or activities",
      "Multiple joints affected by osteoarthritis",
      "Fall prevention becomes #1 priority",
      "âœ… Treatment STILL works! Can improve density 5-10%",
      "Every year countsâ€”never too late to start"
    ]
  },

   treatment: {
    name: "With Treatment",
    age: "Any Age with Therapy",
    icon: "pills",
    estrogen: { percent: 25, label: "Stabilized" },
    bone: { percent: 75, label: "Improving" },
    joint: { percent: 65, label: "Protected" },
    risk: "moderate",
    insights: [
      "âœ… Medications slow bone loss by 50-70%",
      "âœ… Can INCREASE bone density 5-10% over 3-5 years",
      "âœ… Fracture risk reduced by 50-70%",
      "Bisphosphonates stop bone-destroying cells",
      "Calcium + Vitamin D strengthen bone-building",
      "Exercise + medication = best results",
      "Treatment works at ANY age - never too late!"
    ]
  }

};

let currentPhase = 'teens';

// ==========================================
// PHASE SWITCHING FUNCTION (FIXED)
// ==========================================
function switchPhase(phase) {
  currentPhase = phase;
  const data = phaseData[phase];
  
  // Update phase button states
  document.querySelectorAll('.phase-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  const activeBtn = document.querySelector(`.phase-btn[data-phase="${phase}"]`);
  if (activeBtn) {
    activeBtn.classList.add('active');
  }
  
  // Update phase header
  document.getElementById('phaseTitle').textContent = data.name;
  document.getElementById('phaseAge').textContent = data.age;
  document.getElementById('phaseIconLarge').className = `fas fa-${data.icon}`;
  
  // Update gauges with animation
  updateGauge('estrogen', data.estrogen.percent, '#4caf50');
  updateGauge('bone', data.bone.percent, '#ff9800');
  updateGauge('joint', data.joint.percent, '#9c27b0');
  
  // Update gauge labels
  document.getElementById('estrogenPercent').textContent = data.estrogen.percent + '%';
  document.getElementById('estrogenStatus').textContent = data.estrogen.label;
  
  document.getElementById('bonePercent').textContent = data.bone.percent + '%';
  document.getElementById('boneStatus').textContent = data.bone.label;
  
  document.getElementById('jointPercent').textContent = data.joint.percent + '%';
  document.getElementById('jointStatus').textContent = data.joint.label;
  
  // Update insights
  const insightsList = document.getElementById('insightsList');
  insightsList.innerHTML = data.insights.map(insight => `<li>${insight}</li>`).join('');
  
  // Update risk alert
  const riskAlert = document.getElementById('riskAlert');
  riskAlert.className = `risk-alert ${data.risk}`;
  
  const riskContent = {
    low: {
      icon: 'shield-alt',
      title: 'Low Risk Period',
      message: 'Optimal time to invest in bone health'
    },
    moderate: {
      icon: 'exclamation-circle',
      title: 'Moderate Risk - Take Action',
      message: 'Begin preventive measures now'
    },
    high: {
      icon: 'exclamation-triangle',
      title: 'HIGH RISK - Critical Period',
      message: 'Immediate medical consultation recommended'
    }
  };
  
  const risk = riskContent[data.risk];
  riskAlert.innerHTML = `
    <div class="alert-icon"><i class="fas fa-${risk.icon}"></i></div>
    <div class="alert-content">
      <div class="alert-title">${risk.title}</div>
      <div class="alert-message">${risk.message}</div>
    </div>
  `;
}

// Helper function to update circular gauges
function updateGauge(type, percent, color) {
  const gauge = document.getElementById(type + 'Gauge');
  const circumference = 2 * Math.PI * 50; // radius = 50
  const offset = circumference - (percent / 100) * circumference;
  
  gauge.style.stroke = color;
  gauge.style.strokeDashoffset = offset;
  gauge.style.transition = 'stroke-dashoffset 1s ease-in-out';
}

// Chart toggle function
let chartVisible = { estrogen: true, bone: true };

function toggleChart(type) {
  chartVisible[type] = !chartVisible[type];
  
  const line = document.getElementById(type + 'Line');
  if (line) {
    line.style.opacity = chartVisible[type] ? '1' : '0.2';
  }
  
  // Toggle button state
  const buttons = document.querySelectorAll('.chart-btn');
  buttons.forEach(btn => {
    if (btn.textContent.toLowerCase().includes(type)) {
      if (chartVisible[type]) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    }
  });
}

// ==========================================
// TOPICS DATA AND INITIALIZATION
// ==========================================
const topicsData = [
  {
    id: 1,
    icon: 'microscope',
    title: 'Understanding the Diseases',
    summary: 'What happens inside your bones and joints',
    content: `
      <h4>Osteoporosis: The Silent Bone Thief</h4>
      <ul class="compact-list">
        <li>Bones become porous, weak, and brittle</li>
        <li>Honeycomb structure develops with holes and spaces</li>
        <li>No symptoms until fracture occurs ("silent disease")</li>
        <li>Affects 1 in 3 women over 50</li>
      </ul>
      <h4 style="margin-top:1rem">Osteoarthritis: Cartilage Breakdown</h4>
      <ul class="compact-list">
        <li>Protective cartilage cushion wears away</li>
        <li>Bones start rubbing directly against each other</li>
        <li>Causes pain, stiffness, swelling, bone spurs</li>
        <li>Most common in knees, hips, hands, spine</li>
      </ul>
    `
  },
  {
    id: 2,
    icon: 'venus',
    title: 'The Estrogen Connection',
    summary: 'How hormones protect your skeleton',
    content: `
      <h4>Estrogen's Protective Role</h4>
      <ul class="compact-list">
        <li>Directly inhibits bone-breaking cells (osteoclasts)</li>
        <li>Maintains cartilage thickness and joint lubrication</li>
        <li>Regulates calcium absorption and bone formation</li>
        <li>Protects against inflammation in joints</li>
      </ul>
      <h4 style="margin-top:1rem">When Estrogen Drops (Menopause)</h4>
      <ul class="compact-list">
        <li>Bone breakdown accelerates dramatically</li>
        <li>Can lose 20% bone density in first 5-7 years</li>
        <li>Joint cartilage degenerates faster</li>
        <li>This is WHY women are 4x more likely than men</li>
      </ul>
    `
  },
  {
    id: 3,
    icon: 'exclamation-triangle',
    title: 'Risk Factors',
    summary: 'What puts you in danger',
    critical: true,
    content: `
      <h4>Non-Modifiable Risks</h4>
      <ul class="compact-list">
        <li>Being female (4x higher risk than men)</li>
        <li>Age over 50 / Post-menopausal status</li>
        <li>Family history of osteoporosis or fractures</li>
        <li>Small, thin body frame (BMI < 19)</li>
        <li>Asian or Caucasian ethnicity</li>
      </ul>
      <h4 style="margin-top:1rem">Modifiable Risks (YOU CAN CHANGE THESE!)</h4>
      <ul class="compact-list">
        <li>Calcium/Vitamin D deficiency</li>
        <li>Sedentary lifestyle / lack of exercise</li>
        <li>Smoking and excessive alcohol</li>
        <li>Low body weight / eating disorders</li>
        <li>Certain medications (steroids, antacids)</li>
      </ul>
    `
  },
  {
    id: 4,
    icon: 'stethoscope',
    title: 'Screening & Diagnosis',
    summary: 'How to detect problems early',
    content: `
      <h4>DEXA Scan (Bone Density Test)</h4>
      <ul class="compact-list">
        <li>Gold standard for measuring bone density</li>
        <li>Painless, low-radiation X-ray scan</li>
        <li>Gives T-score: -1 to -2.5 = osteopenia, < -2.5 = osteoporosis</li>
        <li>Recommended for all women 65+, or 50+ with risk factors</li>
      </ul>
      <h4 style="margin-top:1rem">When to Get Screened</h4>
      <ul class="compact-list">
        <li>Age 65+ (routine screening)</li>
        <li>Post-menopausal with risk factors</li>
        <li>Fracture from minor fall</li>
        <li>Long-term steroid use</li>
      </ul>
    `
  },
  {
    id: 5,
    icon: 'pills',
    title: 'Medical Treatments',
    summary: 'Medications that can help',
    content: `
      <h4>Bisphosphonates (Most Common)</h4>
      <ul class="compact-list">
        <li>Slow bone breakdown (Alendronate, Risedronate)</li>
        <li>Can increase density 5-10% over 3-5 years</li>
        <li>Reduce fracture risk by 50%</li>
        <li>Side effects: GI issues, rare jaw problems</li>
      </ul>
      <h4 style="margin-top:1rem">Other Options</h4>
      <ul class="compact-list">
        <li>Hormone Replacement Therapy (HRT)</li>
        <li>RANK ligand inhibitors (Denosumab)</li>
        <li>Anabolic agents (Teriparatide - builds new bone)</li>
        <li>SERMs (Selective Estrogen Receptor Modulators)</li>
      </ul>
    `
  },
  {
    id: 6,
    icon: 'carrot',
    title: 'Nutrition Essentials',
    summary: 'Foods that build strong bones',
    content: `
      <h4>Calcium (1,200-1,500 mg/day)</h4>
      <ul class="compact-list">
        <li>Dairy: milk, yogurt, cheese</li>
        <li>Leafy greens: kale, collard greens, broccoli</li>
        <li>Fortified foods: orange juice, cereals, tofu</li>
        <li>Fish with bones: sardines, salmon</li>
      </ul>
      <h4 style="margin-top:1rem">Vitamin D (800-1,000 IU/day)</h4>
      <ul class="compact-list">
        <li>Sunlight exposure (15-20 min/day)</li>
        <li>Fatty fish: salmon, mackerel, tuna</li>
        <li>Egg yolks, fortified milk</li>
        <li>Supplements if levels low</li>
      </ul>
    `
  },
  {
    id: 7,
    icon: 'dumbbell',
    title: 'Exercise Programs',
    summary: 'Movement that strengthens bones',
    content: `
      <h4>Weight-Bearing Exercises</h4>
      <ul class="compact-list">
        <li>Walking, jogging, dancing, stair climbing</li>
        <li>Tennis, hiking, aerobics</li>
        <li>Forces bones to work against gravity</li>
        <li>Aim for 30 min, 5 days/week</li>
      </ul>
      <h4 style="margin-top:1rem">Resistance Training</h4>
      <ul class="compact-list">
        <li>Free weights, resistance bands, machines</li>
        <li>Builds muscle which pulls on bones</li>
        <li>2-3 sessions per week</li>
        <li>Focus on major muscle groups</li>
      </ul>
      <h4 style="margin-top:1rem">Balance & Flexibility</h4>
      <ul class="compact-list">
        <li>Yoga, tai chi, pilates</li>
        <li>Prevents falls and fractures</li>
        <li>Improves posture and coordination</li>
      </ul>
    `
  },
  {
    id: 8,
    icon: 'heartbeat',
    title: 'Lifestyle Modifications',
    summary: 'Daily habits that protect your bones',
    content: `
      <h4>Do These</h4>
      <ul class="compact-list">
        <li>Maintain healthy weight (BMI 18.5-24.9)</li>
        <li>Get adequate sleep (7-9 hours)</li>
        <li>Manage stress (chronic stress depletes bones)</li>
        <li>Stay socially active and engaged</li>
      </ul>
      <h4 style="margin-top:1rem">Avoid These</h4>
      <ul class="compact-list">
        <li>Smoking (doubles fracture risk)</li>
        <li>Excessive alcohol (>2 drinks/day)</li>
        <li>High caffeine intake (>4 cups coffee/day)</li>
        <li>Excessive salt (increases calcium loss)</li>
      </ul>
    `
  },
  {
    id: 9,
    icon: 'shield-alt',
    title: 'Fall Prevention',
    summary: 'Protecting yourself from fractures',
    content: `
      <h4>Home Safety Modifications</h4>
      <ul class="compact-list">
        <li>Remove tripping hazards (rugs, cords, clutter)</li>
        <li>Install grab bars in bathroom</li>
        <li>Improve lighting (especially stairs, hallways)</li>
        <li>Use non-slip mats in shower/tub</li>
        <li>Keep frequently used items within reach</li>
      </ul>
      <h4 style="margin-top:1rem">Personal Precautions</h4>
      <ul class="compact-list">
        <li>Wear proper footwear (no loose slippers)</li>
        <li>Use assistive devices if needed (cane, walker)</li>
        <li>Review medications with doctor (some cause dizziness)</li>
        <li>Get vision and hearing checked regularly</li>
      </ul>
    `
  },
  {
    id: 10,
    icon: 'hospital',
    title: 'When to Seek Help',
    summary: 'Warning signs requiring medical attention',
    critical: true,
    content: `
      <div class="emergency-banner">
        <i class="fas fa-exclamation-triangle"></i>
        SEEK IMMEDIATE MEDICAL ATTENTION
      </div>
      <h4>Emergency Symptoms</h4>
      <ul class="compact-list critical-list">
        <li>Sudden, severe back pain</li>
        <li>Loss of height (>1.5 inches)</li>
        <li>Stooped posture developing</li>
        <li>Fracture from minor fall or injury</li>
        <li>Inability to bear weight on limb</li>
      </ul>
      <h4 style="margin-top:1rem">Schedule Appointment For</h4>
      <ul class="compact-list">
        <li>Persistent joint pain lasting >6 weeks</li>
        <li>Morning stiffness >30 minutes</li>
        <li>Joint swelling or warmth</li>
        <li>Decreased range of motion</li>
        <li>Family history + age >50</li>
      </ul>
    `
  }
];

// Track which topics have been viewed
const viewedTopics = new Set();

// Define topic categories for better organization
const topicCategories = {
  1: { category: 'Foundation', color: '#2196f3', emoji: 'ðŸ“š' },
  2: { category: 'Foundation', color: '#2196f3', emoji: 'ðŸ§¬' },
  3: { category: 'Assessment', color: '#ff9800', emoji: 'âš ï¸' },
  4: { category: 'Assessment', color: '#ff9800', emoji: 'ðŸ”' },
  5: { category: 'Treatment', color: '#9c27b0', emoji: 'ðŸ’Š' },
  6: { category: 'Lifestyle', color: '#4caf50', emoji: 'ðŸ¥—' },
  7: { category: 'Lifestyle', color: '#4caf50', emoji: 'ðŸ’ª' },
  8: { category: 'Lifestyle', color: '#4caf50', emoji: 'â¤ï¸' },
  9: { category: 'Prevention', color: '#f44336', emoji: 'ðŸ›¡ï¸' },
  10: { category: 'Prevention', color: '#f44336', emoji: 'ðŸš¨' }
};

function initTopics() {
  const grid = document.getElementById('topicsGrid');
  if (!grid) return;
  
  grid.innerHTML = topicsData.map(topic => {
    const meta = topicCategories[topic.id];
    const isCritical = topic.critical ? 'critical-topic' : '';
    
    return `
    <div class="topic-card ${isCritical}" data-topic-id="${topic.id}">
      <div class="topic-card-header">
        <div class="topic-number" style="background: ${meta.color};">
          <span>${meta.emoji}</span>
          <div class="topic-num-text">${topic.id}</div>
        </div>
        <div class="topic-category-badge" style="background: ${meta.color}20; color: ${meta.color};">
          ${meta.category}
        </div>
        ${topic.critical ? '<div class="critical-badge"><i class="fas fa-exclamation-circle"></i> Important</div>' : ''}
      </div>
      
      <div class="topic-header" onclick="toggleTopic(${topic.id})">
        <div class="topic-icon-new ${topic.critical ? 'critical-icon' : ''}" style="background: ${meta.color}15; color: ${meta.color};">
          <i class="fas fa-${topic.icon}"></i>
        </div>
        <div class="topic-info">
          <h3>${topic.title}</h3>
          <p class="topic-summary">${topic.summary}</p>
        </div>
        <div class="topic-action-area">
          <div class="read-time">
            <i class="fas fa-clock"></i> 2 min
          </div>
          <i class="fas fa-chevron-down expand-icon" id="icon-${topic.id}"></i>
        </div>
      </div>
      
      <div class="topic-content" id="content-${topic.id}">
        <div class="content-section">
          ${topic.content}
          <div class="topic-footer-actions">
            <button class="topic-action-btn" onclick="markAsRead(${topic.id})">
              <i class="fas fa-check"></i> Mark as Read
            </button>
            <button class="topic-action-btn secondary" onclick="shareTopicInfo(${topic.id})">
              <i class="fas fa-share-alt"></i> Share
            </button>
          </div>
        </div>
      </div>
      
      <div class="topic-viewed-indicator" id="viewed-${topic.id}" style="display: none;">
        <i class="fas fa-check-circle"></i> Completed
      </div>
    </div>
  `}).join('');
  
  updateProgress();
}

function toggleTopic(id) {
  const content = document.getElementById(`content-${id}`);
  const icon = document.getElementById(`icon-${id}`);
  const card = document.querySelector(`[data-topic-id="${id}"]`);
  
  if (content.classList.contains('active')) {
    content.classList.remove('active');
    icon.classList.remove('expanded');
    card.classList.remove('expanded');
  } else {
    // Mark as viewed when opened
    viewedTopics.add(id);
    updateProgress();
    
    content.classList.add('active');
    icon.classList.add('expanded');
    card.classList.add('expanded');
    
    // Smooth scroll to the card
    setTimeout(() => {
      card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }, 100);
  }
}

function markAsRead(id) {
  viewedTopics.add(id);
  const indicator = document.getElementById(`viewed-${id}`);
  if (indicator) {
    indicator.style.display = 'flex';
  }
  updateProgress();
  
  // Show a little celebration animation
  const card = document.querySelector(`[data-topic-id="${id}"]`);
  card.classList.add('completed-animation');
  setTimeout(() => card.classList.remove('completed-animation'), 1000);
}

function updateProgress() {
  const total = topicsData.length;
  const viewed = viewedTopics.size;
  const percentage = Math.round((viewed / total) * 100);
  
  const progressBar = document.getElementById('progressBar');
  const progressText = document.getElementById('progressText');
  const progressPercent = document.getElementById('progressPercent');
  
  if (progressBar) progressBar.style.width = `${percentage}%`;
  if (progressText) progressText.textContent = `${viewed} of ${total} topics explored`;
  if (progressPercent) progressPercent.textContent = `${percentage}%`;
  
  // Update viewed indicators
  viewedTopics.forEach(topicId => {
    const indicator = document.getElementById(`viewed-${topicId}`);
    if (indicator) indicator.style.display = 'flex';
  });
}

function scrollToTopic(id) {
  const card = document.querySelector(`[data-topic-id="${id}"]`);
  if (card) {
    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // Auto-open the topic
    setTimeout(() => {
      if (!document.getElementById(`content-${id}`).classList.contains('active')) {
        toggleTopic(id);
      }
    }, 500);
  }
}

function shareTopicInfo(id) {
  const topic = topicsData.find(t => t.id === id);
  if (topic && navigator.share) {
    navigator.share({
      title: topic.title,
      text: topic.summary,
      url: window.location.href
    }).catch(() => {
      // Fallback: copy to clipboard
      const url = window.location.href;
      navigator.clipboard.writeText(`${topic.title}: ${topic.summary}\n${url}`);
      alert('Link copied to clipboard!');
    });
  } else {
    alert('Share this page to help others learn about bone health!');
  }
}

// ==========================================
// 3D SIMULATION - ENHANCED VERSION
// ==========================================

let currentStage = 'healthy';
let currentBodyPart = null;

const bodyParts = [
  { id: 'spine', name: 'Spine', icon: 'spine' },
  { id: 'hip', name: 'Hip Joint', icon: 'bone' },
  { id: 'knee', name: 'Knee', icon: 'walking' },
  { id: 'wrist', name: 'Wrist', icon: 'hand-paper' }
];

function initBodySelector() {
  const selector = document.getElementById('bodySelector');
  if (!selector) return;
  
  selector.innerHTML = bodyParts.map(part => `
    <button class="body-part-btn" onclick="selectBodyPart('${part.id}')">
      <i class="fas fa-${part.icon}"></i>
      <span>${part.name}</span>
    </button>
  `).join('');
}

function setStage(stage) {
  currentStage = stage;
  
  // Update stage buttons
  document.querySelectorAll('.stage-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  if (event && event.target) {
    event.target.closest('.stage-btn').classList.add('active');
  }
  
  // Refresh visualization if a body part is selected
  if (currentBodyPart) {
    // Re-trigger visualization with new stage
    const bodyContainer = document.getElementById('bodyDiagramContainer');
    const vizContainer = document.getElementById('vizContainerMain');
    
    // If visualization is showing, update it
    if (vizContainer && vizContainer.style.display !== 'none') {
      selectBodyPartFromDiagram(currentBodyPart);
    }
  }


}
// ==========================================
// BODY DIAGRAM INTEGRATION
// ==========================================

function initBodyDiagram() {
  const bodyDiagram = document.querySelector('.body-diagram');
  if (!bodyDiagram) return;
  
  // Add click handlers to all clickable elements
  const clickableElements = bodyDiagram.querySelectorAll('.clickable-bone, .body-hotspot');
  
  clickableElements.forEach(element => {
    element.addEventListener('click', function(e) {
      e.stopPropagation();
      const partId = this.getAttribute('data-part');
      if (partId) {
        selectBodyPartFromDiagram(partId);
      }
    });
  });
}

function selectBodyPartFromDiagram(partId) {
  currentBodyPart = partId;
  
  // Update body part button states to match
  document.querySelectorAll('.body-part-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Find and activate matching button
  const matchingBtn = Array.from(document.querySelectorAll('.body-part-btn'))
    .find(btn => btn.textContent.toLowerCase().includes(partId) || 
                 btn.onclick?.toString().includes(partId));
  if (matchingBtn) {
    matchingBtn.classList.add('active');
  }
  
  // Update body diagram visual feedback
  updateBodyDiagramSelection(partId);
  
  // Hide body diagram, show visualization
  const bodyContainer = document.getElementById('bodyDiagramContainer');
  const vizContainer = document.getElementById('vizContainerMain');
  
  if (bodyContainer && vizContainer) {
    bodyContainer.style.display = 'none';
    vizContainer.style.display = 'block';
    
    // Generate and display visualization
    const visualization = generate3DVisualization(partId, currentStage);
    vizContainer.innerHTML = `
      <div class="viz-header">
        <h3>${visualization.title}</h3>
        <span class="stage-tag ${currentStage}">${currentStage.toUpperCase()}</span>
        <button class="back-to-body-btn" onclick="returnToBodyDiagram()">
          <i class="fas fa-arrow-left"></i> Back to Body
        </button>
      </div>
      <div class="viz-svg-container">
        ${visualization.svg}
      </div>
      <div class="viz-stats">
        <div class="stat-row">
          <span>Bone Mineral Density:</span>
          <strong class="${visualization.stats.bmdClass}">${visualization.stats.bmd}</strong>
        </div>
        <div class="stat-row">
          <span>Fracture Risk:</span>
          <strong class="${visualization.stats.riskClass}">${visualization.stats.risk}</strong>
        </div>
        <div class="stat-row">
          <span>Cartilage Status:</span>
          <strong class="${visualization.stats.cartClass}">${visualization.stats.cartilage}</strong>
        </div>
      </div>
      <div class="viz-description">
        <h4>Clinical Assessment</h4>
        <p>${visualization.description}</p>
      </div>
    `;
  }
}

function updateBodyDiagramSelection(partId) {
  // Remove active class from all body parts
  document.querySelectorAll('.clickable-bone, .body-hotspot').forEach(el => {
    el.classList.remove('active');
  });
  
  // Add active class to selected parts
  document.querySelectorAll(`[data-part="${partId}"]`).forEach(el => {
    el.classList.add('active');
  });
}

function returnToBodyDiagram() {
  const bodyContainer = document.getElementById('bodyDiagramContainer');
  const vizContainer = document.getElementById('vizContainerMain');
  
  if (bodyContainer && vizContainer) {
    bodyContainer.style.display = 'flex';
    vizContainer.style.display = 'none';
  }
  
  // Clear selection
  currentBodyPart = null;
  document.querySelectorAll('.body-part-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  document.querySelectorAll('.clickable-bone, .body-hotspot').forEach(el => {
    el.classList.remove('active');
  });
}


function selectBodyPart(partId) {
  currentBodyPart = partId;
  
  // Update body part buttons
  document.querySelectorAll('.body-part-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  if (event && event.target) {
    event.target.closest('.body-part-btn').classList.add('active');
  }
  
  // Update body diagram selection
  updateBodyDiagramSelection(partId);
  
  // Hide body diagram, show visualization
  const bodyContainer = document.getElementById('bodyDiagramContainer');
  const vizContainer = document.getElementById('vizContainerMain');
  
  if (bodyContainer) bodyContainer.style.display = 'none';
  if (vizContainer) vizContainer.style.display = 'block';
  
  // Generate and display visualization
  const display = vizContainer || document.getElementById('simDisplay');
  const visualization = generate3DVisualization(partId, currentStage);
  
  display.innerHTML = `
    <div class="viz-header">
      <h3>${visualization.title}</h3>
      <span class="stage-tag ${currentStage}">${currentStage === 'treatment' ? 'WITH TREATMENT' : currentStage.toUpperCase()}</span>
      <button class="back-to-body-btn" onclick="returnToBodyDiagram()">
        <i class="fas fa-arrow-left"></i> Back to Body
      </button>
    </div>
    <div class="viz-svg-container">
      ${visualization.svg}
    </div>
    <div class="viz-stats">
      <div class="stat-row">
        <span>Bone Mineral Density:</span>
        <strong class="${visualization.stats.bmdClass}">${visualization.stats.bmd}</strong>
      </div>
      <div class="stat-row">
        <span>Fracture Risk:</span>
        <strong class="${visualization.stats.riskClass}">${visualization.stats.risk}</strong>
      </div>
      <div class="stat-row">
        <span>Cartilage Status:</span>
        <strong class="${visualization.stats.cartClass}">${visualization.stats.cartilage}</strong>
      </div>
    </div>
    <div class="viz-description">
      <h4>Clinical Assessment</h4>
      <p>${visualization.description}</p>
    </div>
    ${visualization.patientInfo || ''}
  `;
}

function generate3DVisualization(partId, stage) {
  switch(partId) {
    case 'spine':
      return generateSpine3D(stage);
    case 'hip':
      return generateHip3D(stage);
    case 'knee':
      return generateKnee3D(stage);
    case 'wrist':
      return generateWrist3D(stage);
    default:
      return { svg: '', title: '', description: '', stats: {} };
  }
}

// ==========================================
// 3D VISUALIZATION GENERATORS
// ==========================================

function generateSpine3D(stage) {
  const colors = {
    healthy: { bone: '#f8bbd0', core: '#ec407a', fracture: '#4caf50' },
    early: { bone: '#ffcc80', core: '#ff9800', fracture: '#ff9800' },
    advanced: { bone: '#ef9a9a', core: '#e53935', fracture: '#d32f2f' },
    treatment: { bone: '#c8e6c9', core: '#66bb6a', fracture: '#4caf50' }
  };
  
  const c = colors[stage];
  const compression = stage === 'healthy' ? 0 : stage === 'early' ? 8 : stage === 'advanced' ? 18 : 5;
  const porosity = stage === 'healthy' ? 0 : stage === 'early' ? 15 : stage === 'advanced' ? 35 : 10;
  
  // Patient-friendly descriptions
  const patientInfo = {
    healthy: {
      title: "Strong, Dense Spine Bones",
      description: "Your vertebrae (spine bones) are solid and strong - like a stack of sturdy building blocks. The bone is thick and dense, with no weak spots.",
      simple: "Think of it like a brand new brick - solid all the way through!",
      riskInfo: "Very low chance of spine breaking from normal activities"
    },
    early: {
      title: "Bones Getting Weaker (Osteopenia)",
      description: "Your spine bones are starting to lose density - developing small holes inside like a sponge. The bones are thinner and starting to compress slightly.",
      simple: "Like a brick that's starting to get tiny holes - still strong, but not as solid",
      riskInfo: "Moderate risk - heavy lifting or falls could cause fractures"
    },
    advanced: {
      title: "Very Weak Bones (Osteoporosis)",
      description: "Your vertebrae have lost a lot of bone material - they're very porous and fragile. Some vertebrae may have already collapsed, making you shorter.",
      simple: "Like a brick that's full of holes - could break from just bending over or coughing",
      riskInfo: "HIGH RISK - Simple activities like hugging can cause fractures",
      impacts: [
        "Lost 1-3 inches of height from collapsed vertebrae",
        "Chronic back pain from compression fractures",
        "Stooped posture (dowager's hump)",
        "Can spread: Hip and wrist fractures become more likely"
      ]
    },
    treatment: {
      title: "Healing with Treatment",
      description: "Medications are helping rebuild bone density and preventing further loss. The bone-destroying cells are being blocked while bone-building cells work harder.",
      simple: "Like repairing that holey brick - filling in the holes and making it stronger!",
      riskInfo: "Risk REDUCED by 50-70% with proper treatment",
      benefits: [
        "Medications stop bone loss in 6-12 months",
        "Bone density can improve 5-10% over 3-5 years",
        "Spine fracture risk reduced by 70%",
        "You can rebuild strength at ANY age!"
      ]
    }
  };
  
  const info = patientInfo[stage];
  
  const svg = `
  <svg viewBox="0 0 450 565" style="width:100%;height:100%;" class="${stage === 'advanced' ? 'rotating-view' : stage === 'healthy' ? 'breathing-animation' : ''}">      <defs>
        <radialGradient id="bone3D_${stage}">
          <stop offset="0%" stop-color="#fff" stop-opacity="0.6"/>
          <stop offset="50%" stop-color="${c.bone}"/>
          <stop offset="100%" stop-color="${c.core}"/>
        </radialGradient>
        <filter id="glow3D_${stage}">
          <feGaussianBlur stdDeviation="5"/>
          <feMerge>
            <feMergeNode/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
        <filter id="shadow3D_${stage}">
          <feDropShadow dx="4" dy="4" stdDeviation="4" flood-opacity="0.4"/>
        </filter>
        <filter id="deepShadow">
          <feDropShadow dx="6" dy="6" stdDeviation="6" flood-opacity="0.5"/>
        </filter>
      </defs>
      
      <!-- Title with patient-friendly language -->
      <rect x="10" y="15" width="430" height="65" fill="white" rx="10" filter="url(#shadow3D_${stage})"/>
      <text x="225" y="40" font-size="18" fill="${c.core}" font-weight="700" text-anchor="middle">
        ${info.title}
      </text>
      <text x="225" y="62" font-size="12" fill="#666" text-anchor="middle" font-style="italic">
        ${info.simple}
      </text>
      
      <!-- Vertebrae Stack with enhanced 3D -->
      ${[0, 1, 2, 3].map((i, idx) => {
        const y = 130 + i * 85;  // Moved down by 15 points
        const height = 65 - compression;
        const isCompressed = stage === 'advanced' && i === 2;
        
        return `
          <g class="depth-layer-${Math.min(i + 1, 3)}">
            <!-- Deep shadow for 3D depth -->
            <ellipse cx="230" cy="${y + 8}" rx="70" ry="22" fill="#000" opacity="0.3" 
                     filter="url(#deepShadow)"/>
            
            <!-- Vertebral Body -->
            <ellipse cx="225" cy="${y - height/2}" rx="65" ry="20" 
                     fill="url(#bone3D_${stage})" stroke="${c.core}" stroke-width="3" 
                     filter="url(#shadow3D_${stage})"/>
            <rect x="160" y="${y - height/2}" width="130" height="${height}" 
                  fill="url(#bone3D_${stage})" stroke="${c.core}" stroke-width="3" rx="8"/>
            <ellipse cx="225" cy="${y + height/2}" rx="65" ry="20" 
                     fill="${c.bone}" stroke="${c.core}" stroke-width="3"/>
            
            <!-- 3D Highlight for depth -->
            <ellipse cx="200" cy="${y - height/4}" rx="30" ry="15" fill="#fff" opacity="0.5"/>
            <ellipse cx="205" cy="${y}" rx="25" ry="12" fill="#fff" opacity="0.3"/>
            
            ${stage === 'treatment' ? `
              <!-- Treatment healing glow -->
              <ellipse cx="225" cy="${y}" rx="70" ry="${height/2 + 5}" 
                       fill="none" stroke="#4caf50" stroke-width="2" opacity="0.6">
                <animate attributeName="opacity" values="0.3;0.8;0.3" dur="2s" repeatCount="indefinite"/>
              </ellipse>
              <!-- Medication particles strengthening bone -->
              ${Array.from({length: 8}, (_, j) => {
                const angle = (j * 45) * Math.PI / 180;
                const px = 225 + Math.cos(angle) * 55;
                const py = y + Math.sin(angle) * (height/2 + 5);
                return `
                  <circle cx="${px}" cy="${py}" r="3" fill="#4caf50" opacity="0.8">
                    <animate attributeName="r" values="2;4;2" dur="${1.5 + j * 0.1}s" repeatCount="indefinite"/>
                    <animate attributeName="opacity" values="0.5;1;0.5" dur="${1.5 + j * 0.1}s" repeatCount="indefinite"/>
                  </circle>
                `;
              }).join('')}
            ` : ''}
            
            ${stage !== 'healthy' && stage !== 'treatment' ? `
              <!-- Porosity visualization - holes in bone -->
              ${Array.from({length: porosity}, (_, j) => {
                const px = 170 + Math.random() * 110;
                const py = y - height/2 + Math.random() * height;
                const size = 2 + Math.random() * 3;
                return `
                  <circle cx="${px}" cy="${py}" r="${size}" fill="${c.fracture}" opacity="0.6">
                    <animate attributeName="opacity" values="0.4;0.8;0.4" dur="${1.5+Math.random()}s" repeatCount="indefinite"/>
                  </circle>
                `;
              }).join('')}
              
              <!-- Simple label showing bone holes -->
              ${i === 1 ? `
                <line x1="280" y1="${y}" x2="320" y2="${y - 20}" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>
                <rect x="320" y="${y - 40}" width="110" height="35" fill="#fff3e0" rx="6" stroke="#ff9800" stroke-width="2"/>
                <text x="375" y="${y - 28}" font-size="10" fill="#e65100" font-weight="700" text-anchor="middle">
                  Tiny holes forming
                </text>
                <text x="375" y="${y - 16}" font-size="8" fill="#e65100" text-anchor="middle">
                  (bone getting weak)
                </text>
              ` : ''}
            ` : ''}
            
            ${isCompressed ? `
              <!-- Compression fracture with clear visualization -->
              <path d="M 170,${y} Q 225,${y+12} 280,${y}" stroke="#d32f2f" stroke-width="4" 
                    fill="none" opacity="0.9" stroke-dasharray="6,4">
                <animate attributeName="opacity" values="0.7;1;0.7" dur="1.5s" repeatCount="indefinite"/>
              </path>
              <path d="M 180,${y-8} L 270,${y+8}" stroke="#d32f2f" stroke-width="3" 
                    opacity="0.8" stroke-linecap="round"/>
              <path d="M 190,${y-12} L 260,${y+12}" stroke="#d32f2f" stroke-width="3" 
                    opacity="0.7" stroke-linecap="round"/>
              
              <!-- Arrow pointing to fracture -->
              <line x1="100" y1="${y}" x2="155" y2="${y}" stroke="#d32f2f" stroke-width="2" marker-end="url(#arrowRed)"/>
              <rect x="20" y="${y - 25}" width="75" height="50" fill="#ffebee" rx="6" stroke="#d32f2f" stroke-width="2"/>
              <text x="57" y="${y - 10}" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">
                COLLAPSED
              </text>
              <text x="57" y="${y}" font-size="8" fill="#c62828" text-anchor="middle">
                vertebra
              </text>
              <text x="57" y="${y + 10}" font-size="7" fill="#c62828" text-anchor="middle">
                (crushed bone)
              </text>
            ` : ''}
            
            ${i === 0 && stage === 'healthy' ? `
              <!-- Label for healthy bone -->
              <line x1="280" y1="${y}" x2="320" y2="${y - 20}" stroke="#4caf50" stroke-width="2"/>
              <rect x="320" y="${y - 40}" width="110" height="35" fill="#e8f5e9" rx="6" stroke="#4caf50" stroke-width="2"/>
              <text x="375" y="${y - 28}" font-size="10" fill="#2e7d32" font-weight="700" text-anchor="middle">
                Solid & Dense
              </text>
              <text x="375" y="${y - 16}" font-size="8" fill="#2e7d32" text-anchor="middle">
                (no weak spots)
              </text>
            ` : ''}
            
            <!-- Intervertebral Disc -->
            ${i < 3 ? `
              <ellipse cx="225" cy="${y + height/2 + 12}" rx="58" ry="${stage === 'advanced' ? '6' : '8'}" 
                       fill="${stage === 'advanced' ? '#bdbdbd' : stage === 'treatment' ? '#90caf9' : '#64b5f6'}" 
                       opacity="${stage === 'advanced' ? '0.4' : '0.7'}" 
                       stroke="#666" stroke-width="1.5"/>
              ${i === 1 ? `
                <text x="100" y="${y + height/2 + 16}" font-size="8" fill="#666" font-style="italic">
                  Cushion disc
                </text>
              ` : ''}
            ` : ''}
          </g>
        `;
      }).join('')}
      
      ${stage === 'advanced' ? `
        <!-- Disease spread indicator -->
        <g>
         <line x1="225" y1="465" x2="225" y2="495" class="spread-line" stroke="#f44336" stroke-width="3"/>
          <line x1="225" y1="495" x2="180" y2="525" class="spread-line" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)"/>
          <line x1="225" y1="495" x2="270" y2="525" class="spread-line" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)"/>
          
          <rect x="130" y="520" width="60" height="28" fill="#ffebee" rx="4" stroke="#f44336" stroke-width="2"/>
          <text x="160" y="535" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">Hip at risk</text>
          
          <rect x="260" y="520" width="70" height="28" fill="#ffebee" rx="4" stroke="#f44336" stroke-width="2"/>
          <text x="295" y="535" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">Wrist at risk</text>
        </g>
      ` : ''}
      
      <!-- Arrow markers -->
      <defs>
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#ff9800"/>
        </marker>
        <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#f44336"/>
        </marker>
        <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#4caf50"/>
        </marker>
      </defs>
    </svg>
  `;
  
  return {
    svg,
    title: info.title,
    description: info.description,
    patientInfo: `
      <div class="patient-info-box ${stage === 'healthy' ? 'good' : stage === 'treatment' ? 'good' : stage === 'advanced' ? 'critical' : ''}">
        <h5><i class="fas fa-user-md"></i> In Simple Terms</h5>
        <p>${info.simple}</p>
      </div>
      <div class="patient-info-box" style="margin-top: 1rem;">
        <h5><i class="fas fa-exclamation-triangle"></i> Your Fracture Risk</h5>
        <p>${info.riskInfo}</p>
      </div>
      ${info.impacts ? `
        <div style="margin-top: 1rem;">
          <h5 style="color: #c62828; margin-bottom: 0.5rem;">
            <i class="fas fa-heartbeat"></i> How This Affects Your Life:
          </h5>
          ${info.impacts.map(impact => `
            <div class="impact-indicator">
              <i class="fas fa-arrow-right"></i>
              <span>${impact}</span>
            </div>
          `).join('')}
        </div>
      ` : ''}
      ${info.benefits ? `
        <div style="margin-top: 1rem;">
          <h5 style="color: #2e7d32; margin-bottom: 0.5rem;">
            <i class="fas fa-plus-circle"></i> How Treatment Helps:
          </h5>
          ${info.benefits.map(benefit => `
            <div class="treatment-benefit">
              <i class="fas fa-check-circle"></i>
              <span>${benefit}</span>
            </div>
          `).join('')}
        </div>
      ` : ''}
    `,
    stats: {
      bmd: stage === 'healthy' ? 'Normal (T-score: +0.5)' : stage === 'early' ? 'Osteopenia (T-score: -1.9)' : stage === 'treatment' ? 'Improving (T-score: -2.2)' : 'Osteoporosis (T-score: -3.2)',
      bmdClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      risk: stage === 'healthy' ? 'Very Low (3%)' : stage === 'early' ? 'Moderate (25%)' : stage === 'treatment' ? 'Reduced to 15%' : 'Very High (65%)',
      riskClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      cartilage: stage === 'healthy' ? 'Excellent - Full Disc Height' : stage === 'early' ? 'Mild Degeneration' : stage === 'treatment' ? 'Stabilized' : 'Severe Degeneration',
      cartClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical'
    }
  };
}

function generateHip3D(stage) {
  const colors = {
    healthy: { bone: '#f8bbd0', core: '#ec407a', cartilage: '#64b5f6', fracture: '#4caf50', porosity: '#ff9800' },
    early: { bone: '#ffcc80', core: '#ff9800', cartilage: '#81c784', fracture: '#ff9800', porosity: '#f57c00' },
    advanced: { bone: '#ef9a9a', core: '#e53935', cartilage: '#e0e0e0', fracture: '#d32f2f', porosity: '#b71c1c' },
    treatment: { bone: '#c8e6c9', core: '#66bb6a', cartilage: '#81d4fa', fracture: '#4caf50', porosity: '#4caf50' }
  };
  
  const c = colors[stage];
  const cartilage = stage === 'healthy' ? 8 : stage === 'early' ? 4 : stage === 'advanced' ? 0 : 6;
  
  const patientInfo = {
    healthy: {
      title: "Strong Hip Joint",
      description: "Your hip joint has a thick cushion (cartilage) protecting the bones. The ball fits smoothly in the socket - no bone touching bone.",
      simple: "Like a well-oiled ball bearing - smooth movement, no grinding",
      riskInfo: "Very low chance of hip fracture from normal falls"
    },
    early: {
      title: "Hip Starting to Wear Out",
      description: "Your cartilage cushion is thinning - bones are getting closer together. You may feel stiffness in the morning or after sitting.",
      simple: "Like a car tire that's worn down halfway - still works but not as smooth",
      riskInfo: "Moderate risk - bad falls could break the hip",
      impacts: [
        "Morning stiffness lasting 20-30 minutes",
        "Pain when walking long distances",
        "Difficulty putting on shoes or socks"
      ]
    },
    advanced: {
      title: "Severe Hip Damage",
      description: "No cartilage left - bone grinding directly on bone. The hip is very fragile and could break from a simple fall.",
      simple: "Like two rough stones grinding together - very painful and easily broken",
      riskInfo: "CRITICAL - Even minor falls can shatter the hip",
      impacts: [
        "Constant pain, even at rest",
        "Severe difficulty walking or standing",
        "Hip replacement surgery often needed",
        "If hip breaks: 20% chance of death within a year",
        "Can spread: Muscle weakness affects other joints"
      ]
    },
    treatment: {
      title: "Hip Protected by Treatment",
      description: "Medications are strengthening the hip bone and protecting remaining cartilage. Inflammation is reduced, pain is less.",
      simple: "Like adding protective coating to those stones - less grinding, less pain",
      riskInfo: "Fracture risk reduced by 40-50%",
      benefits: [
        "Hip bone density increases 6-8% in 2 years",
        "Pain reduced by 50-70% with medication",
        "Better mobility and quality of life",
        "May delay or avoid hip replacement surgery"
      ]
    }
  };
  
  const info = patientInfo[stage];
  
  const svg = `
    <svg viewBox="0 0 450 480" style="width:100%;height:100%;" class="${stage === 'healthy' ? 'breathing-animation' : stage === 'advanced' ? 'rotating-view' : stage === 'treatment' ? 'treatment-glow' : ''}">
      <defs>
        <radialGradient id="hipBone3D_${stage}">
          <stop offset="0%" stop-color="#fff" stop-opacity="0.5"/>
          <stop offset="50%" stop-color="${c.bone}"/>
          <stop offset="100%" stop-color="${c.core}"/>
        </radialGradient>
        <linearGradient id="cartGrad_${stage}" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" stop-color="${c.cartilage}" stop-opacity="0.8"/>
          <stop offset="100%" stop-color="${c.cartilage}" stop-opacity="0.3"/>
        </linearGradient>
        <filter id="glow3D_${stage}">
          <feGaussianBlur stdDeviation="6"/>
          <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
        <filter id="shadow3D_${stage}">
          <feDropShadow dx="5" dy="5" stdDeviation="5" flood-opacity="0.4"/>
        </filter>
      </defs>
      
      <!-- Title -->
      <rect x="10" y="10" width="430" height="60" fill="white" rx="10" filter="url(#shadow3D_${stage})"/>
      <text x="225" y="35" font-size="18" fill="${c.core}" font-weight="700" text-anchor="middle">
        ${info.title}
      </text>
      <text x="225" y="55" font-size="12" fill="#666" text-anchor="middle" font-style="italic">
        ${info.simple}
      </text>
      
     <!-- Pelvis (Socket) - Deep 3D shadow -->
      <ellipse cx="230" cy="225" rx="92" ry="77".../>  <!-- 210 â†’ 225 -->

      <!-- Pelvis outer shell -->
      <ellipse cx="225" cy="220" rx="88" ry="73".../>  <!-- 205 â†’ 220 -->

      <!-- Socket interior -->
      <ellipse cx="225" cy="220" rx="65" ry="55".../>  <!-- 205 â†’ 220 -->
            
      ${cartilage > 0 ? `
        <!-- Articular cartilage on femur with realistic animation -->
        <ellipse cx="200" cy="${230 + cartilage/2}" rx="22" ry="${cartilage}" 
                 fill="${c.cartilage}" opacity="${stage === 'advanced' ? '0.2' : stage === 'early' ? '0.5' : '0.8'}" 
                 stroke="${c.cartilage}" stroke-width="2"
                 class="${stage !== 'healthy' && stage !== 'treatment' ? 'cartilage-layer' : ''}">
          ${stage === 'healthy' ? `<animate attributeName="ry" values="${cartilage};${cartilage + 0.5};${cartilage}" dur="4s" repeatCount="indefinite"/>` : ''}
        </ellipse>
        <ellipse cx="240" cy="${230 + cartilage/2}" rx="22" ry="${cartilage}" 
                 fill="${c.cartilage}" opacity="${stage === 'advanced' ? '0.2' : stage === 'early' ? '0.5' : '0.8'}" 
                 stroke="${c.cartilage}" stroke-width="2"
                 class="${stage !== 'healthy' && stage !== 'treatment' ? 'cartilage-layer' : ''}">
          ${stage === 'healthy' ? `<animate attributeName="ry" values="${cartilage};${cartilage + 0.5};${cartilage}" dur="4s" repeatCount="indefinite"/>` : ''}
        </ellipse>
      ` : ''}
      
      <!-- Ball (Femoral head) shadow -->
      <circle cx="228" cy="248" r="55" fill="#000" opacity="0.3"/>
      
      <!-- Ball of hip joint -->
      <circle cx="225" cy="245" r="52" fill="url(#hipBone3D_${stage})" stroke="${c.core}" stroke-width="4"
              filter="url(#shadow3D_${stage})">
        <animate attributeName="opacity" values="0.9;1;0.9" dur="2.5s" repeatCount="indefinite"/>
      </circle>
      
      ${cartilage > 0 ? `
        <!-- Cartilage on ball -->
        <circle cx="225" cy="245" r="${52 + cartilage/2}" 
                fill="none" stroke="url(#cartGrad_${stage})" stroke-width="${cartilage}" opacity="0.8"/>
      ` : ''}
      
      <!-- 3D highlight on ball -->
      <ellipse cx="208" cy="228" rx="22" ry="17" fill="#fff" opacity="0.6"/>
      <ellipse cx="215" cy="235" rx="15" ry="12" fill="#fff" opacity="0.4"/>
      
      <!-- Femoral neck (thigh bone connecting to hip) -->
      <ellipse cx="255" cy="285" rx="34" ry="67" fill="url(#hipBone3D_${stage})" 
               stroke="${c.core}" stroke-width="4" transform="rotate(25 255 285)"
               filter="url(#shadow3D_${stage})"/>
      
            ${stage === 'treatment' ? `
        <!-- Treatment healing glow around hip joint -->
        <ellipse cx="225" cy="245" rx="85" ry="85" 
                 fill="none" stroke="#4caf50" stroke-width="4" opacity="0.7">
          <animate attributeName="opacity" values="0.4;0.9;0.4" dur="2.5s" repeatCount="indefinite"/>
          <animate attributeName="stroke-width" values="3;5;3" dur="2.5s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Secondary protective glow -->
        <ellipse cx="225" cy="245" rx="95" ry="95" 
                 fill="none" stroke="#66bb6a" stroke-width="2" opacity="0.5">
          <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Inner bone density improvement in femoral head -->
        <circle cx="225" cy="245" r="40" 
                fill="#c8e6c9" opacity="0.4">
          <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3.5s" repeatCount="indefinite"/>
          <animate attributeName="r" values="38;42;38" dur="3.5s" repeatCount="indefinite"/>
        </circle>
        
        <!-- Medication particles orbiting hip joint -->
        ${Array.from({length: 16}, (_, i) => {
          const angle = (i * 22.5) * Math.PI / 180;
          const px = 225 + Math.cos(angle) * 75;
          const py = 245 + Math.sin(angle) * 75;
          const delay = i * 0.15;
          return `
            <circle cx="${px}" cy="${py}" r="3.5" fill="#4caf50" opacity="0.9">
              <animate attributeName="r" values="2.5;5;2.5" dur="${2.5 + delay}s" repeatCount="indefinite" begin="${delay}s"/>
              <animate attributeName="opacity" values="0.6;1;0.6" dur="${2.5 + delay}s" repeatCount="indefinite" begin="${delay}s"/>
              <animateTransform attributeName="transform" type="rotate" 
                                from="0 225 245" to="360 225 245" 
                                dur="12s" repeatCount="indefinite"/>
            </circle>
          `;
        }).join('')}
        
        <!-- Bone strengthening indicators in femoral neck -->
        <rect x="245" y="270" width="35" height="50" 
              fill="#c8e6c9" opacity="0.5" rx="4" transform="rotate(25 255 285)">
          <animate attributeName="opacity" values="0.3;0.7;0.3" dur="3s" repeatCount="indefinite"/>
        </rect>
        
        <!-- Treatment label -->
        <line x1="310" y1="245" x2="350" y2="230" stroke="#4caf50" stroke-width="2"/>
        <rect x="350" y="215" width="85" height="32" fill="#e8f5e9" rx="6" stroke="#4caf50" stroke-width="2"/>
        <text x="392" y="228" font-size="9" fill="#2e7d32" font-weight="700" text-anchor="middle">
          Healing
        </text>
        <text x="392" y="238" font-size="8" fill="#2e7d32" text-anchor="middle">
          (bone growing!)
        </text>
      ` : ''}
      
      ${stage !== 'healthy' && stage !== 'treatment' ? `
        <!-- Bone porosity waves -->
        ${Array.from({length: stage === 'early' ? 3 : 6}, (_, i) => {
          const r = 52 + (i * 12);
          const op = 0.4 - (i * 0.06);
          return `
            <circle cx="225" cy="245" r="${r}" fill="none" 
                    stroke="${c.porosity}" stroke-width="${2.5 - i * 0.3}" opacity="${op}">
              <animate attributeName="r" values="${r*0.9};${r*1.15};${r*0.9}" dur="3s" repeatCount="indefinite"/>
            </circle>
          `;
        }).join('')}
        
        <!-- Bone loss particles -->
        ${Array.from({length: stage === 'early' ? 10 : 20}, (_, i) => {
          const angle = Math.random() * 2 * Math.PI;
          const dist = 52 * (0.5 + Math.random() * 0.5);
          const x = 225 + Math.cos(angle) * dist;
          const y = 245 + Math.sin(angle) * dist;
          const size = 2 + Math.random() * 3;
          return `
            <circle cx="${x}" cy="${y}" r="${size}" fill="${c.porosity}" opacity="0.6">
              <animate attributeName="r" values="${size};${size*1.5};${size}" dur="${1.2+Math.random()*0.8}s" repeatCount="indefinite"/>
            </circle>
          `;
        }).join('')}
      ` : ''}
      
      ${stage === 'advanced' ? `
        <!-- Bone spurs (extra bone growth from friction) -->
        <path d="M 180,210 L 165,205 L 180,220 Z" fill="#bdbdbd" stroke="#757575" stroke-width="2"/>
        <path d="M 270,210 L 285,205 L 270,220 Z" fill="#bdbdbd" stroke="#757575" stroke-width="2"/>
        
        <!-- Label for bone spurs -->
        <line x1="285" y1="210" x2="320" y2="190" stroke="#757575" stroke-width="2"/>
        <rect x="320" y="175" width="90" height="28" fill="#f5f5f5" rx="4" stroke="#757575" stroke-width="2"/>
        <text x="365" y="192" font-size="9" fill="#424242" font-weight="700" text-anchor="middle">
          Bone spurs
        </text>
        
        <!-- Inflammation halo -->
        <circle cx="225" cy="225" r="70" fill="${c.fracture}" opacity="0.3" filter="url(#glow3D_${stage})">
          <animate attributeName="r" values="65;75;65" dur="2s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.25;0.4;0.25" dur="2s" repeatCount="indefinite"/>
        </circle>
        
        <!-- Fracture risk zone -->
        <rect x="240" y="270" width="60" height="40" fill="none" stroke="${c.fracture}" stroke-width="3" stroke-dasharray="5,3">
          <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite"/>
        </rect>
        <text x="270" y="295" font-size="10" fill="${c.fracture}" font-weight="700" text-anchor="middle">
          WEAK
        </text>
        <text x="270" y="305" font-size="8" fill="${c.fracture}" text-anchor="middle">
          Fracture zone
        </text>
        
        <!-- Spread to other areas -->
        <line x1="225" y1="340" x2="150" y2="390" class="spread-line" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)"/>
        <line x1="225" y1="340" x2="300" y2="390" class="spread-line" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)"/>
        
        <rect x="105" y="385" width="90" height="30" fill="#ffebee" rx="4" stroke="#f44336" stroke-width="2"/>
        <text x="150" y="403" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">
          Knee affected
        </text>
        
        <rect x="255" y="385" width="90" height="30" fill="#ffebee" rx="4" stroke="#f44336" stroke-width="2"/>
        <text x="300" y="403" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">
          Back affected
        </text>
      ` : ''}
      
      ${stage === 'healthy' ? `
        <!-- Healthy joint indicators -->
        <line x1="300" y1="235" x2="340" y2="220" stroke="#4caf50" stroke-width="2"/>
        <rect x="340" y="205" width="100" height="28" fill="#e8f5e9" rx="4" stroke="#4caf50" stroke-width="2"/>
        <text x="390" y="222" font-size="9" fill="#2e7d32" font-weight="700" text-anchor="middle">
          Perfect fit!
        </text>
      ` : ''}
      
      <!-- Arrow markers -->
      <defs>
        <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#f44336"/>
        </marker>
      </defs>
    </svg>
  `;
  
  return {
    svg,
    title: info.title,
    description: info.description,
    patientInfo: `
      <div class="patient-info-box ${stage === 'healthy' ? 'good' : stage === 'treatment' ? 'good' : stage === 'advanced' ? 'critical' : ''}">
        <h5><i class="fas fa-user-md"></i> In Simple Terms</h5>
        <p>${info.simple}</p>
      </div>
      <div class="patient-info-box" style="margin-top: 1rem;">
        <h5><i class="fas fa-exclamation-triangle"></i> Your Fracture Risk</h5>
        <p>${info.riskInfo}</p>
      </div>
      ${info.impacts ? `
        <div style="margin-top: 1rem;">
          <h5 style="color: #c62828; margin-bottom: 0.5rem;">
            <i class="fas fa-heartbeat"></i> How This Affects Your Life:
          </h5>
          ${info.impacts.map(impact => `
            <div class="impact-indicator">
              <i class="fas fa-arrow-right"></i>
              <span>${impact}</span>
            </div>
          `).join('')}
        </div>
      ` : ''}
      ${info.benefits ? `
        <div style="margin-top: 1rem;">
          <h5 style="color: #2e7d32; margin-bottom: 0.5rem;">
            <i class="fas fa-plus-circle"></i> How Treatment Helps:
          </h5>
          ${info.benefits.map(benefit => `
            <div class="treatment-benefit">
              <i class="fas fa-check-circle"></i>
              <span>${benefit}</span>
            </div>
          `).join('')}
        </div>
      ` : ''}
    `,
    stats: {
      bmd: stage === 'healthy' ? 'Normal (T-score: +0.8)' : stage === 'early' ? 'Osteopenia (T-score: -1.8)' : stage === 'treatment' ? 'Improving (T-score: -2.0)' : 'Severe (T-score: -3.5)',
      bmdClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      risk: stage === 'healthy' ? 'Very Low (2%)' : stage === 'early' ? 'Moderate (20%)' : stage === 'treatment' ? 'Reduced to 12%' : 'Very High (60%)',
      riskClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      cartilage: stage === 'healthy' ? 'Excellent - 8mm' : stage === 'early' ? 'Thinning - 4mm' : stage === 'treatment' ? 'Protected - 6mm' : 'Bone-on-Bone',
      cartClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical'
    }
  };
}

function generateKnee3D(stage) {
  const colors = {
    healthy: { bone: '#f8bbd0', core: '#ec407a', cartilage: '#64b5f6', fracture: '#4caf50', porosity: '#ff9800' },
    early: { bone: '#ffcc80', core: '#ff9800', cartilage: '#81c784', fracture: '#ff9800', porosity: '#f57c00' },
    advanced: { bone: '#ef9a9a', core: '#e53935', cartilage: '#e0e0e0', fracture: '#d32f2f', porosity: '#b71c1c' },
    treatment: { bone: '#c8e6c9', core: '#66bb6a', cartilage: '#81d4fa', fracture: '#4caf50', porosity: '#4caf50' }
  };


  const patientInfo = {
  healthy: {
    title: "Strong, Flexible Knee",
    description: "Your knee bones are separated by a thick cushion of cartilage - like a pillow between them. Movement is smooth and pain-free.",
    simple: "Think of it like a well-oiled hinge with thick padding - bends smoothly!",
    riskInfo: "Very low risk of knee problems or fractures"
  },
  early: {
    title: "Knee Starting to Wear Down",
    description: "Your cartilage cushion is getting thinner - the gap between bones is narrowing. You might feel stiffness after sitting or in the morning.",
    simple: "Like a hinge where the padding is wearing thin - getting stiff and creaky",
    riskInfo: "Moderate risk - stairs and squatting may become difficult",
    impacts: [
      "Morning stiffness lasting 30+ minutes",
      "Pain going up/down stairs",
      "Swelling after activity",
      "Grinding or clicking sounds in knee"
    ]
  },
  advanced: {
    title: "Severe Knee Damage (Bone-on-Bone)",
    description: "No cartilage left - your bones are grinding directly against each other. This causes severe pain, especially when walking or standing.",
    simple: "Like two rough surfaces rubbing together - extremely painful",
    riskInfo: "SEVERE - Knee replacement surgery often needed",
    impacts: [
      "Constant pain, even when resting",
      "Extreme difficulty walking or climbing stairs",
      "Knee may 'give out' unexpectedly",
      "Significant loss of mobility and independence",
      "Can spread: Affects hip and back due to altered gait"
    ]
  },
  treatment: {
    title: "Knee Protected by Treatment",
    description: "Anti-inflammatory medications are reducing swelling and pain. Physical therapy is strengthening muscles around the knee to protect it.",
    simple: "Like adding lubricant to that hinge - less friction, less pain!",
    riskInfo: "Pain reduced by 60-80% with treatment",
    benefits: [
      "Inflammation reduced significantly in 4-8 weeks",
      "Pain relief allows you to exercise and strengthen muscles",
      "Medications slow cartilage breakdown",
      "May delay knee replacement by 5-10 years",
      "Improved walking ability and quality of life"
    ]
  }
};

  const info = patientInfo[stage];


  
  const c = colors[stage];
  const cartilage = stage === 'healthy' ? 6 : stage === 'early' ? 3 : 0;
  const space = stage === 'healthy' ? 10 : stage === 'early' ? 5 : 0;
  
  const svg = `
    <svg viewBox="0 0 450 500" style="width:100%;height:100%;" class="${stage === 'healthy' ? 'breathing-animation' : stage === 'advanced' ? 'rotating-view' : stage === 'treatment' ? 'treatment-glow' : ''}">
      <defs>
        <radialGradient id="kneeBone3D">
          <stop offset="0%" stop-color="#fff" stop-opacity="0.5"/>
          <stop offset="50%" stop-color="${c.bone}"/>
          <stop offset="100%" stop-color="${c.core}"/>
        </radialGradient>
        <filter id="glow3D">
          <feGaussianBlur stdDeviation="5"/>
          <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
      </defs>
      
      <!-- Femur (thigh bone) shadow -->
      <rect x="183" y="83" width="84" height="155" rx="8" fill="#000" opacity="0.15"/>
      
      <!-- Femur (thigh bone) -->
      <rect x="180" y="80" width="80" height="150" rx="8" fill="url(#kneeBone3D)" 
            stroke="${c.core}" stroke-width="4" filter="url(#shadow3D)"/>
      
      <!-- Femoral condyles (rounded ends) -->
      <ellipse cx="200" cy="230" rx="22" ry="25" fill="url(#kneeBone3D)" stroke="${c.core}" stroke-width="3"/>
      <ellipse cx="240" cy="230" rx="22" ry="25" fill="url(#kneeBone3D)" stroke="${c.core}" stroke-width="3"/>
      
      ${cartilage > 0 ? `
        <!-- Articular cartilage on femur -->
        <ellipse cx="200" cy="${230 + cartilage/2}" rx="22" ry="${cartilage}" 
                 fill="${c.cartilage}" opacity="0.8" stroke="${c.cartilage}" stroke-width="2"/>
        <ellipse cx="240" cy="${230 + cartilage/2}" rx="22" ry="${cartilage}" 
                 fill="${c.cartilage}" opacity="0.8" stroke="${c.cartilage}" stroke-width="2"/>
      ` : ''}
      
      <!-- Joint space / synovial fluid -->
      ${space > 0 ? `
        <ellipse cx="220" cy="${240 + space}" rx="50" ry="${space}" 
                 fill="${c.fluid}" opacity="0.4" filter="url(#glow3D)">
          <animate attributeName="opacity" values="0.3;0.5;0.3" dur="2s" repeatCount="indefinite"/>
        </ellipse>
      ` : ''}
      
      <!-- Meniscus (cartilage pads) -->
      <ellipse cx="200" cy="${240 + space}" rx="18" ry="6" fill="${c.meniscus}" 
               opacity="${stage === 'advanced' ? '0.3' : '0.7'}" stroke="${c.core}" stroke-width="2"/>
      <ellipse cx="240" cy="${240 + space}" rx="18" ry="6" fill="${c.meniscus}" 
               opacity="${stage === 'advanced' ? '0.3' : '0.7'}" stroke="${c.core}" stroke-width="2"/>
      
      ${stage === 'advanced' ? `
        <!-- Meniscus tears -->
        <path d="M 195,${240 + space} L 205,${240 + space + 8}" stroke="${c.core}" 
              stroke-width="2" opacity="0.8"/>
        <path d="M 235,${240 + space} L 245,${240 + space + 8}" stroke="${c.core}" 
              stroke-width="2" opacity="0.8"/>
      ` : ''}
      
      <!-- Tibia (shin bone) shadow -->
      <rect x="183" y="${253 + space}" width="84" height="165" rx="8" fill="#000" opacity="0.15"/>
      
      <!-- Tibia (shin bone) -->
      <rect x="180" y="${250 + space}" width="80" height="160" rx="8" fill="url(#kneeBone3D)" 
            stroke="${c.core}" stroke-width="4"/>
      
      ${cartilage > 0 ? `
        <!-- Articular cartilage on tibia -->
        <rect x="180" y="${250 + space}" width="80" height="${cartilage}" 
              fill="${c.cartilage}" opacity="0.8" stroke="${c.cartilage}" stroke-width="2"/>
      ` : ''}
      
      <!-- Patella (kneecap) shadow -->
      <ellipse cx="173" cy="243" rx="25" ry="35" fill="#000" opacity="0.15"/>
      
      <!-- Patella (kneecap) -->
      <ellipse cx="170" cy="240" rx="23" ry="33" fill="url(#kneeBone3D)" 
               stroke="${c.core}" stroke-width="3" filter="url(#shadow3D)"/>
      
      ${stage !== 'healthy' ? `
        <!-- Inflammation/swelling -->
        <ellipse cx="220" cy="${240 + space}" rx="65" ry="45" 
                 fill="${stage === 'advanced' ? '#ff5722' : '#ffa726'}" 
                 opacity="${stage === 'advanced' ? '0.35' : '0.2'}" filter="url(#glow3D)">
          <animate attributeName="rx" values="60;70;60" dur="2.5s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="${stage === 'advanced' ? '0.3;0.4;0.3' : '0.15;0.25;0.15'}" 
                   dur="2.5s" repeatCount="indefinite"/>
        </ellipse>
      ` : ''}
      
      ${stage === 'advanced' ? `
        <!-- Bone spurs (osteophytes) -->
        <path d="M 180,${240 + space} L 168,${238 + space} L 180,${248 + space} Z" 
              fill="#c8c8c8" stroke="#999" stroke-width="2"/>
        <path d="M 260,${240 + space} L 272,${238 + space} L 260,${248 + space} Z" 
              fill="#c8c8c8" stroke="#999" stroke-width="2"/>
        
        <!-- Erosion marks -->
        ${Array.from({length: 8}, (_, i) => {
          const x = 185 + i * 8;
          const y = 230 + Math.random() * 10;
          return `<circle cx="${x}" cy="${y}" r="2.5" fill="${c.core}" opacity="0.6"/>`;
        }).join('')}
      ` : ''}


      <!-- Anatomical labels for patient education -->
      ${stage === 'healthy' ? `
        <!-- Label for cartilage cushion -->
        <line x1="280" y1="${240 + space}" x2="320" y2="${220 + space}" stroke="#64b5f6" stroke-width="2"/>
        <rect x="320" y="${205 + space}" width="110" height="32" fill="#e3f2fd" rx="6" stroke="#64b5f6" stroke-width="2"/>
        <text x="375" y="${218 + space}" font-size="9" fill="#1976d2" font-weight="700" text-anchor="middle">
          Thick Cushion
        </text>
        <text x="375" y="${228 + space}" font-size="8" fill="#1976d2" text-anchor="middle">
          (protects bones)
        </text>
      ` : ''}

      ${stage === 'early' ? `
        <!-- Label showing cartilage thinning -->
        <line x1="280" y1="${240 + space}" x2="320" y2="${220 + space}" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>
        <rect x="320" y="${205 + space}" width="110" height="32" fill="#fff3e0" rx="6" stroke="#ff9800" stroke-width="2"/>
        <text x="375" y="${218 + space}" font-size="9" fill="#e65100" font-weight="700" text-anchor="middle">
          Cushion Thinning
        </text>
        <text x="375" y="${228 + space}" font-size="8" fill="#e65100" text-anchor="middle">
          (bones closer)
        </text>
      ` : ''}

      ${stage === 'advanced' ? `
        <!-- Label showing bone contact -->
        <line x1="100" y1="${240 + space}" x2="175" y2="${240 + space}" stroke="#d32f2f" stroke-width="2" marker-end="url(#arrowRed)"/>
        <rect x="20" y="${225 + space}" width="75" height="32" fill="#ffebee" rx="6" stroke="#d32f2f" stroke-width="2"/>
        <text x="57" y="${238 + space}" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">
          BONE-ON-BONE
        </text>
        <text x="57" y="${248 + space}" font-size="8" fill="#c62828" text-anchor="middle">
          (no cushion!)
        </text>
      ` : ''}

      ${stage === 'treatment' ? `
        <!-- Treatment healing glow around entire knee joint -->
        <ellipse cx="220" cy="${240 + space}" rx="85" ry="70" 
                 fill="none" stroke="#4caf50" stroke-width="4" opacity="0.7">
          <animate attributeName="opacity" values="0.4;0.9;0.4" dur="2.5s" repeatCount="indefinite"/>
          <animate attributeName="stroke-width" values="3;5;3" dur="2.5s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Secondary protective glow -->
        <ellipse cx="220" cy="${240 + space}" rx="95" ry="80" 
                 fill="none" stroke="#66bb6a" stroke-width="2" opacity="0.5">
          <animate attributeName="opacity" values="0.3;0.6;0.3" dur="3s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Cartilage regeneration visualization -->
        <ellipse cx="200" cy="${235 + space}" rx="22" ry="5" 
                 fill="#81d4fa" opacity="0.8" stroke="#4caf50" stroke-width="2">
          <animate attributeName="opacity" values="0.6;0.9;0.6" dur="2s" repeatCount="indefinite"/>
          <animate attributeName="ry" values="4;6;4" dur="2s" repeatCount="indefinite"/>
        </ellipse>
        <ellipse cx="240" cy="${235 + space}" rx="22" ry="5" 
                 fill="#81d4fa" opacity="0.8" stroke="#4caf50" stroke-width="2">
          <animate attributeName="opacity" values="0.6;0.9;0.6" dur="2s" repeatCount="indefinite"/>
          <animate attributeName="ry" values="4;6;4" dur="2s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Anti-inflammatory medication reducing swelling -->
        <ellipse cx="220" cy="${240 + space}" rx="60" ry="40" 
                 fill="#c8e6c9" opacity="0.3" filter="url(#glow3D)">
          <animate attributeName="opacity" values="0.2;0.5;0.2" dur="3s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Medication particles working on inflammation -->
        ${Array.from({length: 20}, (_, i) => {
          const angle = (i * 18) * Math.PI / 180;
          const px = 220 + Math.cos(angle) * 65;
          const py = (240 + space) + Math.sin(angle) * 50;
          const delay = i * 0.12;
          return `
            <circle cx="${px}" cy="${py}" r="3" fill="#4caf50" opacity="0.9">
              <animate attributeName="r" values="2;4.5;2" dur="${2.5 + delay}s" repeatCount="indefinite" begin="${delay}s"/>
              <animate attributeName="opacity" values="0.5;1;0.5" dur="${2.5 + delay}s" repeatCount="indefinite" begin="${delay}s"/>
            </circle>
          `;
        }).join('')}
        
        <!-- Strengthening muscles visualization (support structures) -->
        <rect x="140" y="${220 + space}" width="8" height="45" rx="4"
              fill="#66bb6a" opacity="0.6">
          <animate attributeName="opacity" values="0.4;0.8;0.4" dur="2.5s" repeatCount="indefinite"/>
        </rect>
        <rect x="292" y="${220 + space}" width="8" height="45" rx="4"
              fill="#66bb6a" opacity="0.6">
          <animate attributeName="opacity" values="0.4;0.8;0.4" dur="2.5s" repeatCount="indefinite"/>
        </rect>
        
        <!-- Lubrication improvement (synovial fluid) -->
        <ellipse cx="220" cy="${240 + space}" rx="45" ry="8" 
                 fill="#81d4fa" opacity="0.5" filter="url(#glow3D)">
          <animate attributeName="opacity" values="0.3;0.6;0.3" dur="2.8s" repeatCount="indefinite"/>
        </ellipse>
        
        <!-- Treatment effectiveness label -->
        <line x1="300" y1="${240 + space}" x2="340" y2="${220 + space}" stroke="#4caf50" stroke-width="2"/>
        <rect x="340" y="${205 + space}" width="90" height="32" fill="#e8f5e9" rx="6" stroke="#4caf50" stroke-width="2"/>
        <text x="385" y="${218 + space}" font-size="9" fill="#2e7d32" font-weight="700" text-anchor="middle">
          Healing
        </text>
        <text x="385" y="${228 + space}" font-size="8" fill="#2e7d32" text-anchor="middle">
          (less pain!)
        </text>
      ` : ''}
      
      <text x="220" y="40" font-size="20" fill="${c.core}" font-weight="700" text-anchor="middle">
        ${stage === 'healthy' ? 'Healthy Knee Joint' : stage === 'early' ? 'Early OA - Knee' : 'Severe OA - Knee'}
      </text>
      
      <text x="220" y="470" font-size="12" fill="#666" text-anchor="middle">
        ${space > 0 ? `Joint Space: ${space}mm` : 'Joint Space Collapsed'}
      </text>
    </svg>
  `;
  
  return {
  svg,
  title: info.title,
  description: info.description,
  patientInfo: `
    <div class="patient-info-box ${stage === 'healthy' ? 'good' : stage === 'treatment' ? 'good' : stage === 'advanced' ? 'critical' : ''}">
      <h5><i class="fas fa-user-md"></i> In Simple Terms</h5>
      <p>${info.simple}</p>
    </div>
    <div class="patient-info-box" style="margin-top: 1rem;">
      <h5><i class="fas fa-exclamation-triangle"></i> Your Mobility Risk</h5>
      <p>${info.riskInfo}</p>
    </div>
    ${info.impacts ? `
      <div style="margin-top: 1rem;">
        <h5 style="color: #c62828; margin-bottom: 0.5rem;">
          <i class="fas fa-heartbeat"></i> How This Affects Your Life:
        </h5>
        ${info.impacts.map(impact => `
          <div class="impact-indicator">
            <i class="fas fa-arrow-right"></i>
            <span>${impact}</span>
          </div>
        `).join('')}
      </div>
    ` : ''}
    ${info.benefits ? `
      <div style="margin-top: 1rem;">
        <h5 style="color: #2e7d32; margin-bottom: 0.5rem;">
          <i class="fas fa-plus-circle"></i> How Treatment Helps:
        </h5>
        ${info.benefits.map(benefit => `
          <div class="treatment-benefit">
            <i class="fas fa-check-circle"></i>
            <span>${benefit}</span>
          </div>
        `).join('')}
      </div>
    ` : ''}
  `,
  stats: {
    bmd: stage === 'healthy' ? 'Normal' : stage === 'early' ? 'Borderline' : stage === 'treatment' ? 'Improving' : 'Compromised',
    bmdClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
    risk: stage === 'healthy' ? 'None' : stage === 'early' ? 'Moderate Disability' : stage === 'treatment' ? 'Reduced Pain' : 'Severe Disability',
    riskClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
    cartilage: stage === 'healthy' ? 'Excellent - 6mm' : stage === 'early' ? 'Thinning - 3mm' : stage === 'treatment' ? 'Protected - 4mm' : 'Destroyed',
    cartClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical'
  }
};
}

function generateWrist3D(stage) {
  const colors = {
    healthy: { bone: '#f8bbd0', core: '#ec407a', porosity: '#4caf50' },
    early: { bone: '#ffcc80', core: '#ff9800', porosity: '#f57c00' },
    advanced: { bone: '#ef9a9a', core: '#e53935', porosity: '#b71c1c' },
    treatment: { bone: '#c8e6c9', core: '#66bb6a', porosity: '#4caf50' }
  };

  const patientInfo = {
  healthy: {
    title: "Strong Wrist Bones",
    description: "Your wrist bones have a dense honeycomb structure inside - like a strong scaffolding. This makes them resistant to breaking.",
    simple: "Like a sturdy scaffolding tower - can handle stress and impact!",
    riskInfo: "Very low chance of wrist fracture"
  },
  early: {
    title: "Wrist Bones Weakening (Osteopenia)",
    description: "The honeycomb structure inside is thinning out - fewer supporting struts. Your wrist is becoming more fragile.",
    simple: "Like a scaffolding with some bars removed - still standing but weaker",
    riskInfo: "Moderate risk - falls onto outstretched hand dangerous",
    impacts: [
      "Higher risk if you fall forward",
      "Wrist may feel weaker when lifting objects",
      "Minor injuries take longer to heal"
    ]
  },
  advanced: {
    title: "Very Fragile Wrist (Osteoporosis)",
    description: "Most of the honeycomb structure is gone - the bone is very porous and brittle. Even minor falls can cause fractures.",
    simple: "Like a scaffolding with most bars missing - collapses easily!",
    riskInfo: "CRITICAL - Can break from simple falls or bumps",
    impacts: [
      "Wrist fractures from minor falls (Colles' fracture)",
      "If wrist breaks: 6-8 weeks in cast",
      "Loss of hand function and independence",
      "Indicates whole skeleton is at risk",
      "Often the FIRST fracture - warning sign for hip/spine"
    ]
  },
  treatment: {
    title: "Wrist Strengthening with Treatment",
    description: "Medications are rebuilding the honeycomb structure - adding back supporting struts. The bone is becoming denser and stronger.",
    simple: "Like rebuilding that scaffolding - adding bars back for strength!",
    riskInfo: "Fracture risk reduced by 50-60%",
    benefits: [
      "Wrist bone density improves 5-8% in 18 months",
      "Fracture risk cut in half with medication",
      "Better grip strength and hand function",
      "Protects not just wrist - helps whole skeleton"
    ]
  }
};

const info = patientInfo[stage];


  const c = colors[stage];
  const trabecular = stage === 'healthy' ? 20 : stage === 'early' ? 12 : stage === 'treatment' ? 15 : 5;
  
  const svg = `
  <svg viewBox="0 0 450 560" style="width:100%;height:100%;" class="${stage === 'healthy' ? 'breathing-animation' : stage === 'advanced' ? 'rotating-view' : stage === 'treatment' ? 'treatment-glow' : ''}">
    <defs>
      <radialGradient id="wristBone3D_${stage}">
        <stop offset="0%" stop-color="#fff" stop-opacity="0.5"/>
        <stop offset="50%" stop-color="${c.bone}"/>
        <stop offset="100%" stop-color="${c.core}"/>
      </radialGradient>
      <filter id="glow3D_${stage}">
        <feGaussianBlur stdDeviation="4"/>
        <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
      </filter>
      <filter id="shadow3D_${stage}">
        <feDropShadow dx="5" dy="5" stdDeviation="5" flood-opacity="0.4"/>
      </filter>

    </defs>

    <!-- Title with patient-friendly language -->
   <rect x="45" y="45" width="410" height="60" fill="white".../>
   <text x="50" y="68" font-size="12"...>
     ${info.simple}
   </text>
   
  
      
      <!-- Radius (main forearm bone) shadow -->
      <rect x="183" y="83" width="85" height="180" rx="10" fill="#000" opacity="0.15"/>
      
      <!-- Radius -->
      <rect x="180" y="80" width="80" height="175" rx="10" fill="url(#wristBone3D)" 
            stroke="${c.core}" stroke-width="4" filter="url(#shadow3D)"/>
      
      <!-- Distal radius (wrist end) - most fracture-prone -->
      <rect x="175" y="240" width="90" height="35" rx="6" fill="url(#wristBone3D)" 
            stroke="${c.core}" stroke-width="4"/>
      
      <!-- Trabecular bone structure -->
      ${Array.from({length: trabecular}, (_, i) => {
        const y = 90 + (i * 8);
        return `
          <line x1="185" y1="${y}" x2="255" y2="${y}" stroke="${c.core}" 
                stroke-width="${stage === 'healthy' ? '1.5' : '0.8'}" opacity="${stage === 'healthy' ? '0.4' : '0.2'}"/>
        `;
      }).join('')}
      ${Array.from({length: trabecular/2}, (_, i) => {
        const x = 190 + (i * 12);
        return `
          <line x1="${x}" y1="90" x2="${x}" y2="250" stroke="${c.core}" 
                stroke-width="${stage === 'healthy' ? '1.5' : '0.8'}" opacity="${stage === 'healthy' ? '0.4' : '0.2'}"/>
        `;
      }).join('')}
      
      ${stage !== 'healthy' ? `
        <!-- Porosity visualization -->
        ${Array.from({length: stage === 'early' ? 15 : 30}, (_, i) => {
          const x = 185 + Math.random() * 70;
          const y = 90 + Math.random() * 160;
          const size = 2 + Math.random() * 3;
          return `
            <circle cx="${x}" cy="${y}" r="${size}" fill="${c.porosity}" opacity="0.6">
              <animate attributeName="opacity" values="0.4;0.7;0.4" dur="${1.5+Math.random()}s" repeatCount="indefinite"/>
            </circle>
          `;
        }).join('')}
      ` : ''}
      
      ${stage === 'advanced' ? `
        <!-- Colles' fracture line -->
        <path d="M 175,255 Q 220,250 265,255" stroke="#d32f2f" stroke-width="4" 
              fill="none" opacity="0.9" stroke-dasharray="6,4">
          <animate attributeName="opacity" values="0.7;1;0.7" dur="2s" repeatCount="indefinite"/>
        </path>
        <path d="M 185,250 L 195,265" stroke="#d32f2f" stroke-width="3" opacity="0.8"/>
        <path d="M 220,248 L 225,268" stroke="#d32f2f" stroke-width="3" opacity="0.8"/>
        <path d="M 250,250 L 245,265" stroke="#d32f2f" stroke-width="3" opacity="0.8"/>
        
        <!-- Displacement indicator -->
        <text x="280" y="260" font-size="11" fill="#d32f2f" font-weight="700">
          Displaced
        </text>
      ` : ''}
      
      <!-- Ulna (smaller forearm bone) -->
      <rect x="275" y="85" width="35" height="190" rx="6" fill="url(#wristBone3D)" 
            stroke="${c.core}" stroke-width="3" opacity="0.7"/>
      
      <!-- Carpal bones (wrist bones) -->
      ${[
        {x: 180, y: 285}, {x: 210, y: 282}, {x: 240, y: 285},
        {x: 195, y: 315}, {x: 225, y: 313}
      ].map(pos => `
        <ellipse cx="${pos.x}" cy="${pos.y}" rx="14" ry="12" fill="url(#wristBone3D)" 
                 stroke="${c.core}" stroke-width="2" opacity="0.9"/>
      `).join('')}
      
      <text x="220" y="40" font-size="20" fill="${c.core}" font-weight="700" text-anchor="middle">
       ${stage === 'healthy' ? 'Healthy Wrist' : stage === 'early' ? 'Osteopenic Wrist' : stage === 'treatment' ? 'Wrist Protected by Treatment' : "Colles' Fracture"}
      </text>
      
      <text x="220" y="410" font-size="12" fill="#666" text-anchor="middle">
        Distal Radius - Most Common Osteoporotic Fracture Site
      </text>

      <!-- Anatomical labels for patient education -->
      ${trabecular > 15 ? `
        <!-- Label for healthy trabecular structure -->
        <line x1="270" y1="180" x2="310" y2="160" stroke="#4caf50" stroke-width="2"/>
        <rect x="310" y="145" width="125" height="32" fill="#e8f5e9" rx="6" stroke="#4caf50" stroke-width="2"/>
        <text x="372" y="158" font-size="9" fill="#2e7d32" font-weight="700" text-anchor="middle">
          Strong Honeycomb
        </text>
        <text x="372" y="168" font-size="8" fill="#2e7d32" text-anchor="middle">
          (dense bone struts)
        </text>
      ` : trabecular > 10 ? `
        <!-- Label for thinning structure -->
        <line x1="270" y1="180" x2="310" y2="160" stroke="#ff9800" stroke-width="2" marker-end="url(#arrow)"/>
        <rect x="310" y="145" width="125" height="32" fill="#fff3e0" rx="6" stroke="#ff9800" stroke-width="2"/>
        <text x="372" y="158" font-size="9" fill="#e65100" font-weight="700" text-anchor="middle">
          Honeycomb Thinning
        </text>
        <text x="372" y="168" font-size="8" fill="#e65100" text-anchor="middle">
          (losing bone struts)
        </text>
      ` : `
        <!-- Label for weak structure -->
        <line x1="100" y1="180" x2="170" y2="180" stroke="#d32f2f" stroke-width="2" marker-end="url(#arrowRed)"/>
        <rect x="20" y="165" width="75" height="32" fill="#ffebee" rx="6" stroke="#d32f2f" stroke-width="2"/>
        <text x="57" y="178" font-size="9" fill="#c62828" font-weight="700" text-anchor="middle">
          VERY WEAK
        </text>
        <text x="57" y="188" font-size="8" fill="#c62828" text-anchor="middle">
          (porous bone)
        </text>
      `}

      ${stage === 'advanced' ? `
        <!-- Fracture zone indicator on distal radius -->
        <rect x="175" y="240" width="90" height="35" 
              fill="none" stroke="${c.core}" stroke-width="3" stroke-dasharray="6,4" opacity="0.8">
          <animate attributeName="opacity" values="0.6;1;0.6" dur="1.5s" repeatCount="indefinite"/>
        </rect>
        <text x="220" y="265" font-size="10" fill="${c.core}" font-weight="700" text-anchor="middle">
          FRACTURE ZONE
        </text>
        
        <!-- Common fracture type label -->
        <line x1="220" y1="285" x2="220" y2="320" stroke="#d32f2f" stroke-width="2"/>
        <rect x="145" y="320" width="150" height="38" fill="#ffebee" rx="6" stroke="#d32f2f" stroke-width="2"/>
        <text x="220" y="335" font-size="10" fill="#c62828" font-weight="700" text-anchor="middle">
          Colles' Fracture Risk
        </text>
        <text x="220" y="348" font-size="8" fill="#c62828" text-anchor="middle">
          (most common wrist break)
        </text>
      ` : ''}

      <!-- Arrow markers -->
      <defs>
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#ff9800"/>
        </marker>
        <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
          <path d="M0,0 L0,6 L9,3 z" fill="#d32f2f"/>
        </marker>
      </defs>

    </svg>
  `;
  
  return {
    svg,
    title: "Wrist & Distal Radius",
    description: stage === 'healthy'
      ? "Dense cortical shell with strong trabecular network inside. Distal radius structurally sound. Low fracture risk even from falls on outstretched hand. ANIMATION: The gentle breathing motion shows the bone's structural integrity - healthy bone has slight natural flex that absorbs impact."
      : stage === 'early'
      ? "Trabecular bone thinningâ€”distal radius becoming fragile. Increased fracture risk from minor falls. This is often the FIRST fracture site in osteoporosis. ANIMATION: See the reduced trabecular struts (fewer lines inside the bone) - these missing support beams make the wrist vulnerable to breaking."
      : stage === 'treatment'
      ? "Medications strengthening trabecular bone inside the distal radius. Bone density improving 5-8% over 2 years. Fracture risk reduced by 40-50%. The wrist, being mostly trabecular bone, responds well to treatment. ANIMATION: Green particles flowing into the bone represent medication depositing new bone mineral. The green glow shows the entire distal radius being strengthened from the inside out."
      : "Classic Colles' fractureâ€”distal radius broken and displaced backward. Caused by fall on outstretched hand. Indicates severe osteoporosis. Often requires surgery to repair. ANIMATION: The 3D rotation lets you see the displaced bone fragments from different angles - notice how the bone end tilts backward (dorsal displacement), creating the classic 'dinner fork' deformity.",
    stats: {
      bmd: stage === 'healthy' ? 'Normal (T-score: +0.3)' : stage === 'early' ? 'Osteopenia (T-score: -2.0)' : stage === 'treatment' ? 'Improving (T-score: -1.7)' : 'Fracture Present',
      bmdClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      risk: stage === 'healthy' ? 'Very Low (5%)' : stage === 'early' ? 'High (35%)' : stage === 'treatment' ? 'Reduced to 18%' : 'Fracture Occurred',
      riskClass: stage === 'healthy' ? 'stat-good' : stage === 'treatment' ? 'stat-moderate' : stage === 'early' ? 'stat-moderate' : 'stat-critical',
      cartilage: 'N/A',
      cartClass: 'stat-good'
    }
  };
}

// ==========================================
// INITIALIZATION
// ==========================================
document.addEventListener('DOMContentLoaded', function() {
  switchPhase('teens');
  initTopics();
  initBodySelector();
  initBodyDiagram();
});


// ==========================================
// PAGE NAVIGATION - SMOOTH SCROLL
// ==========================================

// Add smooth scrolling to page navigation links
document.addEventListener('DOMContentLoaded', function() {
  const pageNavLinks = document.querySelectorAll('.page-nav-link');
  
  pageNavLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      
      const targetId = this.getAttribute('href').substring(1);
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        const headerOffset = 140; // Account for both headers
        const elementPosition = targetElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
        
        window.scrollTo({
          top: offsetPosition,
          behavior: 'smooth'
        });
        
        // Update active state
        pageNavLinks.forEach(l => l.classList.remove('active'));
        this.classList.add('active');
      }
    });
  });
  
  // Update active link on scroll
  window.addEventListener('scroll', function() {
    const sections = ['timelineSection', 'topicsSection', 'simulationSection', 'riskSection', 'treatmentSection', 'preventionSection'];
    const scrollPos = window.pageYOffset + 200;
    
    sections.forEach(sectionId => {
      const section = document.getElementById(sectionId);
      if (section) {
        const sectionTop = section.offsetTop;
        const sectionBottom = sectionTop + section.offsetHeight;
        
        if (scrollPos >= sectionTop && scrollPos < sectionBottom) {
          pageNavLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${sectionId}`) {
              link.classList.add('active');
            }
          });
        }
      }
    });
  });
});
/* ===================== BONE CANVAS ANIMATION â€” HERO ORBIT ===================== */

</script>

<!-- ======= BONE ORBIT CANVAS ANIMATION ======= -->
<script>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HERO BACKGROUND PARTICLE CANVAS (floating dots)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function(){
  const canvas = document.getElementById('heroBoneCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, particles = [];

  function resize(){
    const hero = document.getElementById('heroSection');
    W = canvas.width  = hero ? hero.offsetWidth  : window.innerWidth;
    H = canvas.height = hero ? hero.offsetHeight : window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  const COLORS = ['#ec407a','#f06292','#ad1457','#9c5cf7','#ba68c8','#f48fb1'];

  class Particle{
    constructor(){this.reset(true);}
    reset(init){
      this.x = Math.random()*W;
      this.y = init ? Math.random()*H : -10;
      this.r = Math.random()*3+1;
      this.vx = (Math.random()-.5)*.4;
      this.vy = Math.random()*.45+.15;
      this.alpha = Math.random()*.45+.15;
      this.color = COLORS[Math.floor(Math.random()*COLORS.length)];
      this.pulse = Math.random()*Math.PI*2;
    }
    update(){
      this.x += this.vx; this.y += this.vy;
      this.pulse += .035;
      if(this.y > H+12) this.reset(false);
      if(this.x<-12||this.x>W+12) this.vx*=-1;
    }
    draw(){
      const pr = this.r + Math.sin(this.pulse)*.8;
      const g = ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,pr*3.5);
      g.addColorStop(0,this.color+'44'); g.addColorStop(1,'transparent');
      ctx.beginPath(); ctx.arc(this.x,this.y,pr*3.5,0,Math.PI*2);
      ctx.fillStyle=g; ctx.fill();
      ctx.beginPath(); ctx.arc(this.x,this.y,pr,0,Math.PI*2);
      ctx.fillStyle=this.color; ctx.globalAlpha=this.alpha;
      ctx.fill(); ctx.globalAlpha=1;
    }
  }

  for(let i=0;i<55;i++) particles.push(new Particle());

  function animBg(){
    ctx.clearRect(0,0,W,H);
    particles.forEach(p=>{p.update();p.draw();});
    requestAnimationFrame(animBg);
  }
  animBg();
})();

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HEADER PARTICLE CANVAS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function initHeaderParticles(){
  function start(){
    const canvas = document.getElementById('headerParticleCanvas');
    if(!canvas) return;
    const header = canvas.closest('.site-header') || canvas.parentElement;
    const ctx = canvas.getContext('2d');

    function resizeCanvas(){
      // Size from the header element, not the canvas itself (which is 0 until painted)
      canvas.width  = header.offsetWidth  || window.innerWidth;
      canvas.height = header.offsetHeight || 64;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    const particles = [];
    const particleCount = 100;

    class Particle {
      constructor(){
        this.reset();
      }
      reset(){
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.radius = Math.random() * 2 + 1;
      }
      update(){
        this.x += this.vx;
        this.y += this.vy;
        if(this.x < 0 || this.x > canvas.width)  this.vx *= -1;
        if(this.y < 0 || this.y > canvas.height)  this.vy *= -1;
      }
      draw(){
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(236,64,122,0.6)';
        ctx.fill();
      }
    }

    for(let i = 0; i < particleCount; i++) particles.push(new Particle());

    function connectParticles(){
      for(let i = 0; i < particles.length; i++){
        for(let j = i + 1; j < particles.length; j++){
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const distance = Math.sqrt(dx*dx + dy*dy);
          if(distance < 100){
            ctx.beginPath();
            ctx.strokeStyle = `rgba(236,64,122,${0.2*(1 - distance/100)})`;
            ctx.lineWidth = 1;
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.stroke();
          }
        }
      }
    }

    function animate(){
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach(p => { p.update(); p.draw(); });
      connectParticles();
      requestAnimationFrame(animate);
    }
    animate();
  }

  // Run after DOM is ready so offsetWidth/offsetHeight are available
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', start);
  } else {
    start();
  }
})();

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BONE ORBIT CANVAS â€” full live right-side animation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function(){
  const canvas = document.getElementById('boneOrbitCanvas');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let W, H, t = 0;
  let ripples = [];

  function resize(){
    W = canvas.width  = canvas.offsetWidth  || 480;
    H = canvas.height = canvas.offsetHeight || 480;
  }
  resize();
  window.addEventListener('resize', resize);

  /* ---- Orbiting nutrient particles ---- */
  const NUM_PARTICLES = 60;
  const pArr = [];
  const PCOLORS = ['#ec407a','#f06292','#f48fb1','#ad1457','#9c5cf7','#4caf50','#ff9800','#ba68c8'];
  for(let i=0;i<NUM_PARTICLES;i++){
    pArr.push({
      orbit: 30 + Math.random()*200,
      angle: Math.random()*Math.PI*2,
      speed: (Math.random()>.5?1:-1) * (0.004+Math.random()*0.012),
      r: Math.random()*3+1,
      color: PCOLORS[Math.floor(Math.random()*PCOLORS.length)],
      alpha: Math.random()*.5+.25,
      pulse: Math.random()*Math.PI*2,
      pspeed: 0.04+Math.random()*0.04,
    });
  }

  /* ---- Bone cross shape at center ---- */
  function drawBone(cx, cy, glow, t){
    const scale = 1 + Math.sin(t*0.02)*0.03;
    ctx.save();
    ctx.translate(cx, cy);
    ctx.scale(scale, scale);
    ctx.rotate(t*0.004);

    // Glow halo
    const halo = ctx.createRadialGradient(0,0,5,0,0,70);
    halo.addColorStop(0,'rgba(236,64,122,0.18)');
    halo.addColorStop(1,'rgba(236,64,122,0)');
    ctx.beginPath(); ctx.arc(0,0,70,0,Math.PI*2);
    ctx.fillStyle=halo; ctx.fill();

    // Bone shaft (vertical)
    const shaftGrad = ctx.createLinearGradient(-12,0,12,0);
    shaftGrad.addColorStop(0,'#f8bbd0');
    shaftGrad.addColorStop(0.5,'#fff');
    shaftGrad.addColorStop(1,'#f8bbd0');
    ctx.beginPath();
    ctx.roundRect(-9,-44,18,88,4);
    ctx.fillStyle=shaftGrad;
    ctx.shadowBlur=12; ctx.shadowColor='rgba(236,64,122,0.3)';
    ctx.fill(); ctx.shadowBlur=0;

    // Bone shaft (horizontal)
    ctx.beginPath();
    ctx.roundRect(-44,-9,88,18,4);
    ctx.fillStyle=shaftGrad; ctx.fill();

    // 4 rounded ends
    const ends = [[0,-44],[0,44],[-44,0],[44,0]];
    const endGrad = ctx.createRadialGradient(0,-44,0,0,-44,18);
    ends.forEach(([ex,ey])=>{
      const eg = ctx.createRadialGradient(ex,ey,0,ex,ey,20);
      eg.addColorStop(0,'#fff');
      eg.addColorStop(0.4,'#fce4ec');
      eg.addColorStop(1,'#ec407a');
      ctx.beginPath(); ctx.arc(ex,ey,20,0,Math.PI*2);
      ctx.fillStyle=eg;
      ctx.shadowBlur=10; ctx.shadowColor='rgba(236,64,122,0.4)';
      ctx.fill(); ctx.shadowBlur=0;
    });

    ctx.restore();
  }

  /* ---- Concentric orbit rings ---- */
  function drawOrbitRings(cx,cy,t){
    const ringRadii = [80,130,180,230];
    ringRadii.forEach((r,i)=>{
      ctx.beginPath();
      ctx.arc(cx,cy,r,0,Math.PI*2);
      ctx.strokeStyle=`rgba(236,64,122,${0.07+i*0.015})`;
      ctx.lineWidth = 1.2;
      ctx.setLineDash([5,6]);
      ctx.stroke();
      ctx.setLineDash([]);
    });

    // Rotating connector lines between particles on adjacent rings
    const rot = t*0.005;
    for(let i=0;i<4;i++){
      const a = rot + i*(Math.PI/2);
      const r1=80, r2=130;
      const x1=cx+Math.cos(a)*r1, y1=cy+Math.sin(a)*r1;
      const x2=cx+Math.cos(a+0.3)*r2, y2=cy+Math.sin(a+0.3)*r2;
      const lg = ctx.createLinearGradient(x1,y1,x2,y2);
      lg.addColorStop(0,'rgba(236,64,122,0.55)');
      lg.addColorStop(1,'rgba(236,64,122,0)');
      ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2);
      ctx.strokeStyle=lg; ctx.lineWidth=1.5; ctx.stroke();
    }
  }

  /* ---- Health label floating tags ---- */
  const LABELS = [
    {text:'Calcium', icon:'ðŸ¦´', orbit:200, angle:0,        speed:0.006, color:'#ec407a'},
    {text:'Estrogen', icon:'ðŸ’Š', orbit:155, angle:2.5,      speed:-0.008, color:'#9c5cf7'},
    {text:'Vit D',  icon:'â˜€ï¸', orbit:200, angle:Math.PI,   speed:0.005, color:'#ff9800'},
    {text:'BMD',    icon:'ðŸ“Š', orbit:155, angle:4.5,       speed:-0.007, color:'#4caf50'},
  ];
  LABELS.forEach(l=>{ l._angle = l.angle; });

  function drawLabel(lbl, cx, cy){
    const x = cx + Math.cos(lbl._angle) * lbl.orbit;
    const y = cy + Math.sin(lbl._angle) * lbl.orbit;
    const txt = `${lbl.icon} ${lbl.text}`;
    const metrics = ctx.measureText(txt);
    const pw = metrics.width+20, ph=26;
    const px=x-pw/2, py=y-ph/2;

    ctx.save();
    ctx.shadowBlur=14; ctx.shadowColor='rgba(0,0,0,0.12)';
    ctx.fillStyle='rgba(255,255,255,0.92)';
    ctx.beginPath(); ctx.roundRect(px,py,pw,ph,13); ctx.fill();
    ctx.strokeStyle=lbl.color+'55'; ctx.lineWidth=1.2;
    ctx.stroke(); ctx.shadowBlur=0;

    ctx.fillStyle=lbl.color; ctx.font='bold 11px Manrope,system-ui,sans-serif';
    ctx.textBaseline='middle'; ctx.textAlign='center';
    ctx.fillText(txt, x, y);
    ctx.restore();
  }

  /* ---- Pulse ripples from bone center ---- */
  function spawnRipple(cx,cy){
    ripples.push({x:cx,y:cy,r:0,maxR:90,alpha:.55});
  }
  let rippleTimer=0;

  function draw(){
    ctx.clearRect(0,0,W,H);
    const cx=W/2, cy=H/2;

    // Spawn ripple every 90 frames
    if(t%90===0) spawnRipple(cx,cy);

    // Draw ripples
    for(let i=ripples.length-1;i>=0;i--){
      const rp=ripples[i];
      rp.r+=1.8; rp.alpha-=0.007;
      if(rp.alpha<=0){ripples.splice(i,1);continue;}
      ctx.beginPath(); ctx.arc(rp.x,rp.y,rp.r,0,Math.PI*2);
      ctx.strokeStyle=`rgba(236,64,122,${rp.alpha*(1-rp.r/rp.maxR)})`;
      ctx.lineWidth=2; ctx.stroke();
    }

    drawOrbitRings(cx,cy,t);

    // Update + draw particles
    pArr.forEach(p=>{
      p.angle += p.speed;
      p.pulse += p.pspeed;
      const x = cx + Math.cos(p.angle)*p.orbit;
      const y = cy + Math.sin(p.angle)*p.orbit;
      const pr = p.r + Math.sin(p.pulse)*0.9;

      // Glow
      const g = ctx.createRadialGradient(x,y,0,x,y,pr*3.5);
      g.addColorStop(0,p.color+'55'); g.addColorStop(1,'transparent');
      ctx.beginPath(); ctx.arc(x,y,pr*3.5,0,Math.PI*2);
      ctx.fillStyle=g; ctx.fill();

      ctx.beginPath(); ctx.arc(x,y,pr,0,Math.PI*2);
      ctx.fillStyle=p.color; ctx.globalAlpha=p.alpha;
      ctx.fill(); ctx.globalAlpha=1;
    });

    // Connection lines between nearby particles
    for(let i=0;i<pArr.length;i++){
      for(let j=i+1;j<pArr.length;j++){
        const ai=pArr[i], aj=pArr[j];
        const xi=cx+Math.cos(ai.angle)*ai.orbit, yi=cy+Math.sin(ai.angle)*ai.orbit;
        const xj=cx+Math.cos(aj.angle)*aj.orbit, yj=cy+Math.sin(aj.angle)*aj.orbit;
        const d=Math.hypot(xi-xj,yi-yj);
        if(d<65){
          const lg=ctx.createLinearGradient(xi,yi,xj,yj);
          lg.addColorStop(0,ai.color+'44'); lg.addColorStop(1,aj.color+'44');
          ctx.beginPath(); ctx.moveTo(xi,yi); ctx.lineTo(xj,yj);
          ctx.strokeStyle=lg; ctx.globalAlpha=.18*(1-d/65);
          ctx.lineWidth=1; ctx.stroke(); ctx.globalAlpha=1;
        }
      }
    }

    drawBone(cx,cy,true,t);

    // Labels
    LABELS.forEach(lbl=>{
      lbl._angle += lbl.speed;
      drawLabel(lbl, cx, cy);
    });

    t++;
    requestAnimationFrame(draw);
  }
  draw();
})();

</script>
</html>
